var O1=Object.defineProperty;var L1=(n,e,t)=>e in n?O1(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var ht=(n,e,t)=>L1(n,typeof e!="symbol"?e+"":e,t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))i(o);new MutationObserver(o=>{for(const a of o)if(a.type==="childList")for(const c of a.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&i(c)}).observe(document,{childList:!0,subtree:!0});function t(o){const a={};return o.integrity&&(a.integrity=o.integrity),o.referrerPolicy&&(a.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?a.credentials="include":o.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function i(o){if(o.ep)return;o.ep=!0;const a=t(o);fetch(o.href,a)}})();function zf(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var Fh={exports:{}},Ja={},Uh={exports:{}},Me={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Qg;function M1(){if(Qg)return Me;Qg=1;var n=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),c=Symbol.for("react.context"),d=Symbol.for("react.forward_ref"),p=Symbol.for("react.suspense"),m=Symbol.for("react.memo"),v=Symbol.for("react.lazy"),E=Symbol.iterator;function w(z){return z===null||typeof z!="object"?null:(z=E&&z[E]||z["@@iterator"],typeof z=="function"?z:null)}var S={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},R=Object.assign,j={};function N(z,X,pe){this.props=z,this.context=X,this.refs=j,this.updater=pe||S}N.prototype.isReactComponent={},N.prototype.setState=function(z,X){if(typeof z!="object"&&typeof z!="function"&&z!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,z,X,"setState")},N.prototype.forceUpdate=function(z){this.updater.enqueueForceUpdate(this,z,"forceUpdate")};function O(){}O.prototype=N.prototype;function U(z,X,pe){this.props=z,this.context=X,this.refs=j,this.updater=pe||S}var q=U.prototype=new O;q.constructor=U,R(q,N.prototype),q.isPureReactComponent=!0;var J=Array.isArray,W=Object.prototype.hasOwnProperty,Q={current:null},k={key:!0,ref:!0,__self:!0,__source:!0};function x(z,X,pe){var xe,se={},me=null,Te=null;if(X!=null)for(xe in X.ref!==void 0&&(Te=X.ref),X.key!==void 0&&(me=""+X.key),X)W.call(X,xe)&&!k.hasOwnProperty(xe)&&(se[xe]=X[xe]);var _e=arguments.length-2;if(_e===1)se.children=pe;else if(1<_e){for(var Oe=Array(_e),be=0;be<_e;be++)Oe[be]=arguments[be+2];se.children=Oe}if(z&&z.defaultProps)for(xe in _e=z.defaultProps,_e)se[xe]===void 0&&(se[xe]=_e[xe]);return{$$typeof:n,type:z,key:me,ref:Te,props:se,_owner:Q.current}}function A(z,X){return{$$typeof:n,type:z.type,key:X,ref:z.ref,props:z.props,_owner:z._owner}}function P(z){return typeof z=="object"&&z!==null&&z.$$typeof===n}function M(z){var X={"=":"=0",":":"=2"};return"$"+z.replace(/[=:]/g,function(pe){return X[pe]})}var V=/\/+/g;function D(z,X){return typeof z=="object"&&z!==null&&z.key!=null?M(""+z.key):X.toString(36)}function ee(z,X,pe,xe,se){var me=typeof z;(me==="undefined"||me==="boolean")&&(z=null);var Te=!1;if(z===null)Te=!0;else switch(me){case"string":case"number":Te=!0;break;case"object":switch(z.$$typeof){case n:case e:Te=!0}}if(Te)return Te=z,se=se(Te),z=xe===""?"."+D(Te,0):xe,J(se)?(pe="",z!=null&&(pe=z.replace(V,"$&/")+"/"),ee(se,X,pe,"",function(be){return be})):se!=null&&(P(se)&&(se=A(se,pe+(!se.key||Te&&Te.key===se.key?"":(""+se.key).replace(V,"$&/")+"/")+z)),X.push(se)),1;if(Te=0,xe=xe===""?".":xe+":",J(z))for(var _e=0;_e<z.length;_e++){me=z[_e];var Oe=xe+D(me,_e);Te+=ee(me,X,pe,Oe,se)}else if(Oe=w(z),typeof Oe=="function")for(z=Oe.call(z),_e=0;!(me=z.next()).done;)me=me.value,Oe=xe+D(me,_e++),Te+=ee(me,X,pe,Oe,se);else if(me==="object")throw X=String(z),Error("Objects are not valid as a React child (found: "+(X==="[object Object]"?"object with keys {"+Object.keys(z).join(", ")+"}":X)+"). If you meant to render a collection of children, use an array instead.");return Te}function ue(z,X,pe){if(z==null)return z;var xe=[],se=0;return ee(z,xe,"","",function(me){return X.call(pe,me,se++)}),xe}function he(z){if(z._status===-1){var X=z._result;X=X(),X.then(function(pe){(z._status===0||z._status===-1)&&(z._status=1,z._result=pe)},function(pe){(z._status===0||z._status===-1)&&(z._status=2,z._result=pe)}),z._status===-1&&(z._status=0,z._result=X)}if(z._status===1)return z._result.default;throw z._result}var re={current:null},ae={transition:null},fe={ReactCurrentDispatcher:re,ReactCurrentBatchConfig:ae,ReactCurrentOwner:Q};function le(){throw Error("act(...) is not supported in production builds of React.")}return Me.Children={map:ue,forEach:function(z,X,pe){ue(z,function(){X.apply(this,arguments)},pe)},count:function(z){var X=0;return ue(z,function(){X++}),X},toArray:function(z){return ue(z,function(X){return X})||[]},only:function(z){if(!P(z))throw Error("React.Children.only expected to receive a single React element child.");return z}},Me.Component=N,Me.Fragment=t,Me.Profiler=o,Me.PureComponent=U,Me.StrictMode=i,Me.Suspense=p,Me.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=fe,Me.act=le,Me.cloneElement=function(z,X,pe){if(z==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+z+".");var xe=R({},z.props),se=z.key,me=z.ref,Te=z._owner;if(X!=null){if(X.ref!==void 0&&(me=X.ref,Te=Q.current),X.key!==void 0&&(se=""+X.key),z.type&&z.type.defaultProps)var _e=z.type.defaultProps;for(Oe in X)W.call(X,Oe)&&!k.hasOwnProperty(Oe)&&(xe[Oe]=X[Oe]===void 0&&_e!==void 0?_e[Oe]:X[Oe])}var Oe=arguments.length-2;if(Oe===1)xe.children=pe;else if(1<Oe){_e=Array(Oe);for(var be=0;be<Oe;be++)_e[be]=arguments[be+2];xe.children=_e}return{$$typeof:n,type:z.type,key:se,ref:me,props:xe,_owner:Te}},Me.createContext=function(z){return z={$$typeof:c,_currentValue:z,_currentValue2:z,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},z.Provider={$$typeof:a,_context:z},z.Consumer=z},Me.createElement=x,Me.createFactory=function(z){var X=x.bind(null,z);return X.type=z,X},Me.createRef=function(){return{current:null}},Me.forwardRef=function(z){return{$$typeof:d,render:z}},Me.isValidElement=P,Me.lazy=function(z){return{$$typeof:v,_payload:{_status:-1,_result:z},_init:he}},Me.memo=function(z,X){return{$$typeof:m,type:z,compare:X===void 0?null:X}},Me.startTransition=function(z){var X=ae.transition;ae.transition={};try{z()}finally{ae.transition=X}},Me.unstable_act=le,Me.useCallback=function(z,X){return re.current.useCallback(z,X)},Me.useContext=function(z){return re.current.useContext(z)},Me.useDebugValue=function(){},Me.useDeferredValue=function(z){return re.current.useDeferredValue(z)},Me.useEffect=function(z,X){return re.current.useEffect(z,X)},Me.useId=function(){return re.current.useId()},Me.useImperativeHandle=function(z,X,pe){return re.current.useImperativeHandle(z,X,pe)},Me.useInsertionEffect=function(z,X){return re.current.useInsertionEffect(z,X)},Me.useLayoutEffect=function(z,X){return re.current.useLayoutEffect(z,X)},Me.useMemo=function(z,X){return re.current.useMemo(z,X)},Me.useReducer=function(z,X,pe){return re.current.useReducer(z,X,pe)},Me.useRef=function(z){return re.current.useRef(z)},Me.useState=function(z){return re.current.useState(z)},Me.useSyncExternalStore=function(z,X,pe){return re.current.useSyncExternalStore(z,X,pe)},Me.useTransition=function(){return re.current.useTransition()},Me.version="18.3.1",Me}var Yg;function $f(){return Yg||(Yg=1,Uh.exports=M1()),Uh.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Xg;function V1(){if(Xg)return Ja;Xg=1;var n=$f(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),i=Object.prototype.hasOwnProperty,o=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,a={key:!0,ref:!0,__self:!0,__source:!0};function c(d,p,m){var v,E={},w=null,S=null;m!==void 0&&(w=""+m),p.key!==void 0&&(w=""+p.key),p.ref!==void 0&&(S=p.ref);for(v in p)i.call(p,v)&&!a.hasOwnProperty(v)&&(E[v]=p[v]);if(d&&d.defaultProps)for(v in p=d.defaultProps,p)E[v]===void 0&&(E[v]=p[v]);return{$$typeof:e,type:d,key:w,ref:S,props:E,_owner:o.current}}return Ja.Fragment=t,Ja.jsx=c,Ja.jsxs=c,Ja}var Jg;function F1(){return Jg||(Jg=1,Fh.exports=V1()),Fh.exports}var f=F1(),b=$f();const Hf=zf(b);var su={},Bh={exports:{}},hn={},zh={exports:{}},$h={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Zg;function U1(){return Zg||(Zg=1,function(n){function e(ae,fe){var le=ae.length;ae.push(fe);e:for(;0<le;){var z=le-1>>>1,X=ae[z];if(0<o(X,fe))ae[z]=fe,ae[le]=X,le=z;else break e}}function t(ae){return ae.length===0?null:ae[0]}function i(ae){if(ae.length===0)return null;var fe=ae[0],le=ae.pop();if(le!==fe){ae[0]=le;e:for(var z=0,X=ae.length,pe=X>>>1;z<pe;){var xe=2*(z+1)-1,se=ae[xe],me=xe+1,Te=ae[me];if(0>o(se,le))me<X&&0>o(Te,se)?(ae[z]=Te,ae[me]=le,z=me):(ae[z]=se,ae[xe]=le,z=xe);else if(me<X&&0>o(Te,le))ae[z]=Te,ae[me]=le,z=me;else break e}}return fe}function o(ae,fe){var le=ae.sortIndex-fe.sortIndex;return le!==0?le:ae.id-fe.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;n.unstable_now=function(){return a.now()}}else{var c=Date,d=c.now();n.unstable_now=function(){return c.now()-d}}var p=[],m=[],v=1,E=null,w=3,S=!1,R=!1,j=!1,N=typeof setTimeout=="function"?setTimeout:null,O=typeof clearTimeout=="function"?clearTimeout:null,U=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function q(ae){for(var fe=t(m);fe!==null;){if(fe.callback===null)i(m);else if(fe.startTime<=ae)i(m),fe.sortIndex=fe.expirationTime,e(p,fe);else break;fe=t(m)}}function J(ae){if(j=!1,q(ae),!R)if(t(p)!==null)R=!0,he(W);else{var fe=t(m);fe!==null&&re(J,fe.startTime-ae)}}function W(ae,fe){R=!1,j&&(j=!1,O(x),x=-1),S=!0;var le=w;try{for(q(fe),E=t(p);E!==null&&(!(E.expirationTime>fe)||ae&&!M());){var z=E.callback;if(typeof z=="function"){E.callback=null,w=E.priorityLevel;var X=z(E.expirationTime<=fe);fe=n.unstable_now(),typeof X=="function"?E.callback=X:E===t(p)&&i(p),q(fe)}else i(p);E=t(p)}if(E!==null)var pe=!0;else{var xe=t(m);xe!==null&&re(J,xe.startTime-fe),pe=!1}return pe}finally{E=null,w=le,S=!1}}var Q=!1,k=null,x=-1,A=5,P=-1;function M(){return!(n.unstable_now()-P<A)}function V(){if(k!==null){var ae=n.unstable_now();P=ae;var fe=!0;try{fe=k(!0,ae)}finally{fe?D():(Q=!1,k=null)}}else Q=!1}var D;if(typeof U=="function")D=function(){U(V)};else if(typeof MessageChannel<"u"){var ee=new MessageChannel,ue=ee.port2;ee.port1.onmessage=V,D=function(){ue.postMessage(null)}}else D=function(){N(V,0)};function he(ae){k=ae,Q||(Q=!0,D())}function re(ae,fe){x=N(function(){ae(n.unstable_now())},fe)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(ae){ae.callback=null},n.unstable_continueExecution=function(){R||S||(R=!0,he(W))},n.unstable_forceFrameRate=function(ae){0>ae||125<ae?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):A=0<ae?Math.floor(1e3/ae):5},n.unstable_getCurrentPriorityLevel=function(){return w},n.unstable_getFirstCallbackNode=function(){return t(p)},n.unstable_next=function(ae){switch(w){case 1:case 2:case 3:var fe=3;break;default:fe=w}var le=w;w=fe;try{return ae()}finally{w=le}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(ae,fe){switch(ae){case 1:case 2:case 3:case 4:case 5:break;default:ae=3}var le=w;w=ae;try{return fe()}finally{w=le}},n.unstable_scheduleCallback=function(ae,fe,le){var z=n.unstable_now();switch(typeof le=="object"&&le!==null?(le=le.delay,le=typeof le=="number"&&0<le?z+le:z):le=z,ae){case 1:var X=-1;break;case 2:X=250;break;case 5:X=1073741823;break;case 4:X=1e4;break;default:X=5e3}return X=le+X,ae={id:v++,callback:fe,priorityLevel:ae,startTime:le,expirationTime:X,sortIndex:-1},le>z?(ae.sortIndex=le,e(m,ae),t(p)===null&&ae===t(m)&&(j?(O(x),x=-1):j=!0,re(J,le-z))):(ae.sortIndex=X,e(p,ae),R||S||(R=!0,he(W))),ae},n.unstable_shouldYield=M,n.unstable_wrapCallback=function(ae){var fe=w;return function(){var le=w;w=fe;try{return ae.apply(this,arguments)}finally{w=le}}}}($h)),$h}var ey;function B1(){return ey||(ey=1,zh.exports=U1()),zh.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ty;function z1(){if(ty)return hn;ty=1;var n=$f(),e=B1();function t(r){for(var s="https://reactjs.org/docs/error-decoder.html?invariant="+r,l=1;l<arguments.length;l++)s+="&args[]="+encodeURIComponent(arguments[l]);return"Minified React error #"+r+"; visit "+s+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var i=new Set,o={};function a(r,s){c(r,s),c(r+"Capture",s)}function c(r,s){for(o[r]=s,r=0;r<s.length;r++)i.add(s[r])}var d=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),p=Object.prototype.hasOwnProperty,m=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,v={},E={};function w(r){return p.call(E,r)?!0:p.call(v,r)?!1:m.test(r)?E[r]=!0:(v[r]=!0,!1)}function S(r,s,l,h){if(l!==null&&l.type===0)return!1;switch(typeof s){case"function":case"symbol":return!0;case"boolean":return h?!1:l!==null?!l.acceptsBooleans:(r=r.toLowerCase().slice(0,5),r!=="data-"&&r!=="aria-");default:return!1}}function R(r,s,l,h){if(s===null||typeof s>"u"||S(r,s,l,h))return!0;if(h)return!1;if(l!==null)switch(l.type){case 3:return!s;case 4:return s===!1;case 5:return isNaN(s);case 6:return isNaN(s)||1>s}return!1}function j(r,s,l,h,g,_,I){this.acceptsBooleans=s===2||s===3||s===4,this.attributeName=h,this.attributeNamespace=g,this.mustUseProperty=l,this.propertyName=r,this.type=s,this.sanitizeURL=_,this.removeEmptyString=I}var N={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(r){N[r]=new j(r,0,!1,r,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(r){var s=r[0];N[s]=new j(s,1,!1,r[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(r){N[r]=new j(r,2,!1,r.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(r){N[r]=new j(r,2,!1,r,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(r){N[r]=new j(r,3,!1,r.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(r){N[r]=new j(r,3,!0,r,null,!1,!1)}),["capture","download"].forEach(function(r){N[r]=new j(r,4,!1,r,null,!1,!1)}),["cols","rows","size","span"].forEach(function(r){N[r]=new j(r,6,!1,r,null,!1,!1)}),["rowSpan","start"].forEach(function(r){N[r]=new j(r,5,!1,r.toLowerCase(),null,!1,!1)});var O=/[\-:]([a-z])/g;function U(r){return r[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(r){var s=r.replace(O,U);N[s]=new j(s,1,!1,r,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(r){var s=r.replace(O,U);N[s]=new j(s,1,!1,r,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(r){var s=r.replace(O,U);N[s]=new j(s,1,!1,r,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(r){N[r]=new j(r,1,!1,r.toLowerCase(),null,!1,!1)}),N.xlinkHref=new j("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(r){N[r]=new j(r,1,!1,r.toLowerCase(),null,!0,!0)});function q(r,s,l,h){var g=N.hasOwnProperty(s)?N[s]:null;(g!==null?g.type!==0:h||!(2<s.length)||s[0]!=="o"&&s[0]!=="O"||s[1]!=="n"&&s[1]!=="N")&&(R(s,l,g,h)&&(l=null),h||g===null?w(s)&&(l===null?r.removeAttribute(s):r.setAttribute(s,""+l)):g.mustUseProperty?r[g.propertyName]=l===null?g.type===3?!1:"":l:(s=g.attributeName,h=g.attributeNamespace,l===null?r.removeAttribute(s):(g=g.type,l=g===3||g===4&&l===!0?"":""+l,h?r.setAttributeNS(h,s,l):r.setAttribute(s,l))))}var J=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,W=Symbol.for("react.element"),Q=Symbol.for("react.portal"),k=Symbol.for("react.fragment"),x=Symbol.for("react.strict_mode"),A=Symbol.for("react.profiler"),P=Symbol.for("react.provider"),M=Symbol.for("react.context"),V=Symbol.for("react.forward_ref"),D=Symbol.for("react.suspense"),ee=Symbol.for("react.suspense_list"),ue=Symbol.for("react.memo"),he=Symbol.for("react.lazy"),re=Symbol.for("react.offscreen"),ae=Symbol.iterator;function fe(r){return r===null||typeof r!="object"?null:(r=ae&&r[ae]||r["@@iterator"],typeof r=="function"?r:null)}var le=Object.assign,z;function X(r){if(z===void 0)try{throw Error()}catch(l){var s=l.stack.trim().match(/\n( *(at )?)/);z=s&&s[1]||""}return`
`+z+r}var pe=!1;function xe(r,s){if(!r||pe)return"";pe=!0;var l=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(s)if(s=function(){throw Error()},Object.defineProperty(s.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(s,[])}catch(K){var h=K}Reflect.construct(r,[],s)}else{try{s.call()}catch(K){h=K}r.call(s.prototype)}else{try{throw Error()}catch(K){h=K}r()}}catch(K){if(K&&h&&typeof K.stack=="string"){for(var g=K.stack.split(`
`),_=h.stack.split(`
`),I=g.length-1,L=_.length-1;1<=I&&0<=L&&g[I]!==_[L];)L--;for(;1<=I&&0<=L;I--,L--)if(g[I]!==_[L]){if(I!==1||L!==1)do if(I--,L--,0>L||g[I]!==_[L]){var F=`
`+g[I].replace(" at new "," at ");return r.displayName&&F.includes("<anonymous>")&&(F=F.replace("<anonymous>",r.displayName)),F}while(1<=I&&0<=L);break}}}finally{pe=!1,Error.prepareStackTrace=l}return(r=r?r.displayName||r.name:"")?X(r):""}function se(r){switch(r.tag){case 5:return X(r.type);case 16:return X("Lazy");case 13:return X("Suspense");case 19:return X("SuspenseList");case 0:case 2:case 15:return r=xe(r.type,!1),r;case 11:return r=xe(r.type.render,!1),r;case 1:return r=xe(r.type,!0),r;default:return""}}function me(r){if(r==null)return null;if(typeof r=="function")return r.displayName||r.name||null;if(typeof r=="string")return r;switch(r){case k:return"Fragment";case Q:return"Portal";case A:return"Profiler";case x:return"StrictMode";case D:return"Suspense";case ee:return"SuspenseList"}if(typeof r=="object")switch(r.$$typeof){case M:return(r.displayName||"Context")+".Consumer";case P:return(r._context.displayName||"Context")+".Provider";case V:var s=r.render;return r=r.displayName,r||(r=s.displayName||s.name||"",r=r!==""?"ForwardRef("+r+")":"ForwardRef"),r;case ue:return s=r.displayName||null,s!==null?s:me(r.type)||"Memo";case he:s=r._payload,r=r._init;try{return me(r(s))}catch{}}return null}function Te(r){var s=r.type;switch(r.tag){case 24:return"Cache";case 9:return(s.displayName||"Context")+".Consumer";case 10:return(s._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return r=s.render,r=r.displayName||r.name||"",s.displayName||(r!==""?"ForwardRef("+r+")":"ForwardRef");case 7:return"Fragment";case 5:return s;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return me(s);case 8:return s===x?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof s=="function")return s.displayName||s.name||null;if(typeof s=="string")return s}return null}function _e(r){switch(typeof r){case"boolean":case"number":case"string":case"undefined":return r;case"object":return r;default:return""}}function Oe(r){var s=r.type;return(r=r.nodeName)&&r.toLowerCase()==="input"&&(s==="checkbox"||s==="radio")}function be(r){var s=Oe(r)?"checked":"value",l=Object.getOwnPropertyDescriptor(r.constructor.prototype,s),h=""+r[s];if(!r.hasOwnProperty(s)&&typeof l<"u"&&typeof l.get=="function"&&typeof l.set=="function"){var g=l.get,_=l.set;return Object.defineProperty(r,s,{configurable:!0,get:function(){return g.call(this)},set:function(I){h=""+I,_.call(this,I)}}),Object.defineProperty(r,s,{enumerable:l.enumerable}),{getValue:function(){return h},setValue:function(I){h=""+I},stopTracking:function(){r._valueTracker=null,delete r[s]}}}}function Qe(r){r._valueTracker||(r._valueTracker=be(r))}function Ve(r){if(!r)return!1;var s=r._valueTracker;if(!s)return!0;var l=s.getValue(),h="";return r&&(h=Oe(r)?r.checked?"true":"false":r.value),r=h,r!==l?(s.setValue(r),!0):!1}function et(r){if(r=r||(typeof document<"u"?document:void 0),typeof r>"u")return null;try{return r.activeElement||r.body}catch{return r.body}}function st(r,s){var l=s.checked;return le({},s,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:l??r._wrapperState.initialChecked})}function bt(r,s){var l=s.defaultValue==null?"":s.defaultValue,h=s.checked!=null?s.checked:s.defaultChecked;l=_e(s.value!=null?s.value:l),r._wrapperState={initialChecked:h,initialValue:l,controlled:s.type==="checkbox"||s.type==="radio"?s.checked!=null:s.value!=null}}function ii(r,s){s=s.checked,s!=null&&q(r,"checked",s,!1)}function Yi(r,s){ii(r,s);var l=_e(s.value),h=s.type;if(l!=null)h==="number"?(l===0&&r.value===""||r.value!=l)&&(r.value=""+l):r.value!==""+l&&(r.value=""+l);else if(h==="submit"||h==="reset"){r.removeAttribute("value");return}s.hasOwnProperty("value")?Ms(r,s.type,l):s.hasOwnProperty("defaultValue")&&Ms(r,s.type,_e(s.defaultValue)),s.checked==null&&s.defaultChecked!=null&&(r.defaultChecked=!!s.defaultChecked)}function Hl(r,s,l){if(s.hasOwnProperty("value")||s.hasOwnProperty("defaultValue")){var h=s.type;if(!(h!=="submit"&&h!=="reset"||s.value!==void 0&&s.value!==null))return;s=""+r._wrapperState.initialValue,l||s===r.value||(r.value=s),r.defaultValue=s}l=r.name,l!==""&&(r.name=""),r.defaultChecked=!!r._wrapperState.initialChecked,l!==""&&(r.name=l)}function Ms(r,s,l){(s!=="number"||et(r.ownerDocument)!==r)&&(l==null?r.defaultValue=""+r._wrapperState.initialValue:r.defaultValue!==""+l&&(r.defaultValue=""+l))}var kr=Array.isArray;function br(r,s,l,h){if(r=r.options,s){s={};for(var g=0;g<l.length;g++)s["$"+l[g]]=!0;for(l=0;l<r.length;l++)g=s.hasOwnProperty("$"+r[l].value),r[l].selected!==g&&(r[l].selected=g),g&&h&&(r[l].defaultSelected=!0)}else{for(l=""+_e(l),s=null,g=0;g<r.length;g++){if(r[g].value===l){r[g].selected=!0,h&&(r[g].defaultSelected=!0);return}s!==null||r[g].disabled||(s=r[g])}s!==null&&(s.selected=!0)}}function oa(r,s){if(s.dangerouslySetInnerHTML!=null)throw Error(t(91));return le({},s,{value:void 0,defaultValue:void 0,children:""+r._wrapperState.initialValue})}function Vs(r,s){var l=s.value;if(l==null){if(l=s.children,s=s.defaultValue,l!=null){if(s!=null)throw Error(t(92));if(kr(l)){if(1<l.length)throw Error(t(93));l=l[0]}s=l}s==null&&(s=""),l=s}r._wrapperState={initialValue:_e(l)}}function Fs(r,s){var l=_e(s.value),h=_e(s.defaultValue);l!=null&&(l=""+l,l!==r.value&&(r.value=l),s.defaultValue==null&&r.defaultValue!==l&&(r.defaultValue=l)),h!=null&&(r.defaultValue=""+h)}function aa(r){var s=r.textContent;s===r._wrapperState.initialValue&&s!==""&&s!==null&&(r.value=s)}function wt(r){switch(r){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Tt(r,s){return r==null||r==="http://www.w3.org/1999/xhtml"?wt(s):r==="http://www.w3.org/2000/svg"&&s==="foreignObject"?"http://www.w3.org/1999/xhtml":r}var Nr,la=function(r){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(s,l,h,g){MSApp.execUnsafeLocalFunction(function(){return r(s,l,h,g)})}:r}(function(r,s){if(r.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in r)r.innerHTML=s;else{for(Nr=Nr||document.createElement("div"),Nr.innerHTML="<svg>"+s.valueOf().toString()+"</svg>",s=Nr.firstChild;r.firstChild;)r.removeChild(r.firstChild);for(;s.firstChild;)r.appendChild(s.firstChild)}});function si(r,s){if(s){var l=r.firstChild;if(l&&l===r.lastChild&&l.nodeType===3){l.nodeValue=s;return}}r.textContent=s}var Xi={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Ji=["Webkit","ms","Moz","O"];Object.keys(Xi).forEach(function(r){Ji.forEach(function(s){s=s+r.charAt(0).toUpperCase()+r.substring(1),Xi[s]=Xi[r]})});function ca(r,s,l){return s==null||typeof s=="boolean"||s===""?"":l||typeof s!="number"||s===0||Xi.hasOwnProperty(r)&&Xi[r]?(""+s).trim():s+"px"}function ua(r,s){r=r.style;for(var l in s)if(s.hasOwnProperty(l)){var h=l.indexOf("--")===0,g=ca(l,s[l],h);l==="float"&&(l="cssFloat"),h?r.setProperty(l,g):r[l]=g}}var da=le({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ha(r,s){if(s){if(da[r]&&(s.children!=null||s.dangerouslySetInnerHTML!=null))throw Error(t(137,r));if(s.dangerouslySetInnerHTML!=null){if(s.children!=null)throw Error(t(60));if(typeof s.dangerouslySetInnerHTML!="object"||!("__html"in s.dangerouslySetInnerHTML))throw Error(t(61))}if(s.style!=null&&typeof s.style!="object")throw Error(t(62))}}function fa(r,s){if(r.indexOf("-")===-1)return typeof s.is=="string";switch(r){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Zi=null;function Us(r){return r=r.target||r.srcElement||window,r.correspondingUseElement&&(r=r.correspondingUseElement),r.nodeType===3?r.parentNode:r}var Bs=null,Sn=null,sr=null;function zs(r){if(r=Ma(r)){if(typeof Bs!="function")throw Error(t(280));var s=r.stateNode;s&&(s=Ec(s),Bs(r.stateNode,r.type,s))}}function or(r){Sn?sr?sr.push(r):sr=[r]:Sn=r}function pa(){if(Sn){var r=Sn,s=sr;if(sr=Sn=null,zs(r),s)for(r=0;r<s.length;r++)zs(s[r])}}function es(r,s){return r(s)}function ma(){}var Pr=!1;function ga(r,s,l){if(Pr)return r(s,l);Pr=!0;try{return es(r,s,l)}finally{Pr=!1,(Sn!==null||sr!==null)&&(ma(),pa())}}function pt(r,s){var l=r.stateNode;if(l===null)return null;var h=Ec(l);if(h===null)return null;l=h[s];e:switch(s){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(h=!h.disabled)||(r=r.type,h=!(r==="button"||r==="input"||r==="select"||r==="textarea")),r=!h;break e;default:r=!1}if(r)return null;if(l&&typeof l!="function")throw Error(t(231,s,typeof l));return l}var $s=!1;if(d)try{var Fn={};Object.defineProperty(Fn,"passive",{get:function(){$s=!0}}),window.addEventListener("test",Fn,Fn),window.removeEventListener("test",Fn,Fn)}catch{$s=!1}function ts(r,s,l,h,g,_,I,L,F){var K=Array.prototype.slice.call(arguments,3);try{s.apply(l,K)}catch(ne){this.onError(ne)}}var ns=!1,Hs=null,Un=!1,ya=null,fd={onError:function(r){ns=!0,Hs=r}};function qs(r,s,l,h,g,_,I,L,F){ns=!1,Hs=null,ts.apply(fd,arguments)}function ql(r,s,l,h,g,_,I,L,F){if(qs.apply(this,arguments),ns){if(ns){var K=Hs;ns=!1,Hs=null}else throw Error(t(198));Un||(Un=!0,ya=K)}}function Bn(r){var s=r,l=r;if(r.alternate)for(;s.return;)s=s.return;else{r=s;do s=r,s.flags&4098&&(l=s.return),r=s.return;while(r)}return s.tag===3?l:null}function rs(r){if(r.tag===13){var s=r.memoizedState;if(s===null&&(r=r.alternate,r!==null&&(s=r.memoizedState)),s!==null)return s.dehydrated}return null}function zn(r){if(Bn(r)!==r)throw Error(t(188))}function Gl(r){var s=r.alternate;if(!s){if(s=Bn(r),s===null)throw Error(t(188));return s!==r?null:r}for(var l=r,h=s;;){var g=l.return;if(g===null)break;var _=g.alternate;if(_===null){if(h=g.return,h!==null){l=h;continue}break}if(g.child===_.child){for(_=g.child;_;){if(_===l)return zn(g),r;if(_===h)return zn(g),s;_=_.sibling}throw Error(t(188))}if(l.return!==h.return)l=g,h=_;else{for(var I=!1,L=g.child;L;){if(L===l){I=!0,l=g,h=_;break}if(L===h){I=!0,h=g,l=_;break}L=L.sibling}if(!I){for(L=_.child;L;){if(L===l){I=!0,l=_,h=g;break}if(L===h){I=!0,h=_,l=g;break}L=L.sibling}if(!I)throw Error(t(189))}}if(l.alternate!==h)throw Error(t(190))}if(l.tag!==3)throw Error(t(188));return l.stateNode.current===l?r:s}function va(r){return r=Gl(r),r!==null?Gs(r):null}function Gs(r){if(r.tag===5||r.tag===6)return r;for(r=r.child;r!==null;){var s=Gs(r);if(s!==null)return s;r=r.sibling}return null}var Ws=e.unstable_scheduleCallback,_a=e.unstable_cancelCallback,Wl=e.unstable_shouldYield,pd=e.unstable_requestPaint,Je=e.unstable_now,Kl=e.unstable_getCurrentPriorityLevel,is=e.unstable_ImmediatePriority,oi=e.unstable_UserBlockingPriority,xn=e.unstable_NormalPriority,Ea=e.unstable_LowPriority,Ql=e.unstable_IdlePriority,ss=null,mn=null;function Yl(r){if(mn&&typeof mn.onCommitFiberRoot=="function")try{mn.onCommitFiberRoot(ss,r,void 0,(r.current.flags&128)===128)}catch{}}var Zt=Math.clz32?Math.clz32:Jl,wa=Math.log,Xl=Math.LN2;function Jl(r){return r>>>=0,r===0?32:31-(wa(r)/Xl|0)|0}var Ks=64,Qs=4194304;function ai(r){switch(r&-r){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return r&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return r}}function os(r,s){var l=r.pendingLanes;if(l===0)return 0;var h=0,g=r.suspendedLanes,_=r.pingedLanes,I=l&268435455;if(I!==0){var L=I&~g;L!==0?h=ai(L):(_&=I,_!==0&&(h=ai(_)))}else I=l&~g,I!==0?h=ai(I):_!==0&&(h=ai(_));if(h===0)return 0;if(s!==0&&s!==h&&!(s&g)&&(g=h&-h,_=s&-s,g>=_||g===16&&(_&4194240)!==0))return s;if(h&4&&(h|=l&16),s=r.entangledLanes,s!==0)for(r=r.entanglements,s&=h;0<s;)l=31-Zt(s),g=1<<l,h|=r[l],s&=~g;return h}function md(r,s){switch(r){case 1:case 2:case 4:return s+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Dr(r,s){for(var l=r.suspendedLanes,h=r.pingedLanes,g=r.expirationTimes,_=r.pendingLanes;0<_;){var I=31-Zt(_),L=1<<I,F=g[I];F===-1?(!(L&l)||L&h)&&(g[I]=md(L,s)):F<=s&&(r.expiredLanes|=L),_&=~L}}function gn(r){return r=r.pendingLanes&-1073741825,r!==0?r:r&1073741824?1073741824:0}function as(){var r=Ks;return Ks<<=1,!(Ks&4194240)&&(Ks=64),r}function li(r){for(var s=[],l=0;31>l;l++)s.push(r);return s}function ci(r,s,l){r.pendingLanes|=s,s!==536870912&&(r.suspendedLanes=0,r.pingedLanes=0),r=r.eventTimes,s=31-Zt(s),r[s]=l}function Xe(r,s){var l=r.pendingLanes&~s;r.pendingLanes=s,r.suspendedLanes=0,r.pingedLanes=0,r.expiredLanes&=s,r.mutableReadLanes&=s,r.entangledLanes&=s,s=r.entanglements;var h=r.eventTimes;for(r=r.expirationTimes;0<l;){var g=31-Zt(l),_=1<<g;s[g]=0,h[g]=-1,r[g]=-1,l&=~_}}function ui(r,s){var l=r.entangledLanes|=s;for(r=r.entanglements;l;){var h=31-Zt(l),g=1<<h;g&s|r[h]&s&&(r[h]|=s),l&=~g}}var ze=0;function di(r){return r&=-r,1<r?4<r?r&268435455?16:536870912:4:1}var Zl,Ys,ec,tc,nc,Ta=!1,ar=[],Mt=null,$n=null,Hn=null,hi=new Map,In=new Map,lr=[],gd="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function rc(r,s){switch(r){case"focusin":case"focusout":Mt=null;break;case"dragenter":case"dragleave":$n=null;break;case"mouseover":case"mouseout":Hn=null;break;case"pointerover":case"pointerout":hi.delete(s.pointerId);break;case"gotpointercapture":case"lostpointercapture":In.delete(s.pointerId)}}function sn(r,s,l,h,g,_){return r===null||r.nativeEvent!==_?(r={blockedOn:s,domEventName:l,eventSystemFlags:h,nativeEvent:_,targetContainers:[g]},s!==null&&(s=Ma(s),s!==null&&Ys(s)),r):(r.eventSystemFlags|=h,s=r.targetContainers,g!==null&&s.indexOf(g)===-1&&s.push(g),r)}function yd(r,s,l,h,g){switch(s){case"focusin":return Mt=sn(Mt,r,s,l,h,g),!0;case"dragenter":return $n=sn($n,r,s,l,h,g),!0;case"mouseover":return Hn=sn(Hn,r,s,l,h,g),!0;case"pointerover":var _=g.pointerId;return hi.set(_,sn(hi.get(_)||null,r,s,l,h,g)),!0;case"gotpointercapture":return _=g.pointerId,In.set(_,sn(In.get(_)||null,r,s,l,h,g)),!0}return!1}function ic(r){var s=hs(r.target);if(s!==null){var l=Bn(s);if(l!==null){if(s=l.tag,s===13){if(s=rs(l),s!==null){r.blockedOn=s,nc(r.priority,function(){ec(l)});return}}else if(s===3&&l.stateNode.current.memoizedState.isDehydrated){r.blockedOn=l.tag===3?l.stateNode.containerInfo:null;return}}}r.blockedOn=null}function jr(r){if(r.blockedOn!==null)return!1;for(var s=r.targetContainers;0<s.length;){var l=Xs(r.domEventName,r.eventSystemFlags,s[0],r.nativeEvent);if(l===null){l=r.nativeEvent;var h=new l.constructor(l.type,l);Zi=h,l.target.dispatchEvent(h),Zi=null}else return s=Ma(l),s!==null&&Ys(s),r.blockedOn=l,!1;s.shift()}return!0}function ls(r,s,l){jr(r)&&l.delete(s)}function sc(){Ta=!1,Mt!==null&&jr(Mt)&&(Mt=null),$n!==null&&jr($n)&&($n=null),Hn!==null&&jr(Hn)&&(Hn=null),hi.forEach(ls),In.forEach(ls)}function qn(r,s){r.blockedOn===s&&(r.blockedOn=null,Ta||(Ta=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,sc)))}function Gn(r){function s(g){return qn(g,r)}if(0<ar.length){qn(ar[0],r);for(var l=1;l<ar.length;l++){var h=ar[l];h.blockedOn===r&&(h.blockedOn=null)}}for(Mt!==null&&qn(Mt,r),$n!==null&&qn($n,r),Hn!==null&&qn(Hn,r),hi.forEach(s),In.forEach(s),l=0;l<lr.length;l++)h=lr[l],h.blockedOn===r&&(h.blockedOn=null);for(;0<lr.length&&(l=lr[0],l.blockedOn===null);)ic(l),l.blockedOn===null&&lr.shift()}var Or=J.ReactCurrentBatchConfig,fi=!0;function rt(r,s,l,h){var g=ze,_=Or.transition;Or.transition=null;try{ze=1,Sa(r,s,l,h)}finally{ze=g,Or.transition=_}}function vd(r,s,l,h){var g=ze,_=Or.transition;Or.transition=null;try{ze=4,Sa(r,s,l,h)}finally{ze=g,Or.transition=_}}function Sa(r,s,l,h){if(fi){var g=Xs(r,s,l,h);if(g===null)kd(r,s,h,cs,l),rc(r,h);else if(yd(g,r,s,l,h))h.stopPropagation();else if(rc(r,h),s&4&&-1<gd.indexOf(r)){for(;g!==null;){var _=Ma(g);if(_!==null&&Zl(_),_=Xs(r,s,l,h),_===null&&kd(r,s,h,cs,l),_===g)break;g=_}g!==null&&h.stopPropagation()}else kd(r,s,h,null,l)}}var cs=null;function Xs(r,s,l,h){if(cs=null,r=Us(h),r=hs(r),r!==null)if(s=Bn(r),s===null)r=null;else if(l=s.tag,l===13){if(r=rs(s),r!==null)return r;r=null}else if(l===3){if(s.stateNode.current.memoizedState.isDehydrated)return s.tag===3?s.stateNode.containerInfo:null;r=null}else s!==r&&(r=null);return cs=r,null}function xa(r){switch(r){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Kl()){case is:return 1;case oi:return 4;case xn:case Ea:return 16;case Ql:return 536870912;default:return 16}default:return 16}}var yn=null,Js=null,on=null;function Ia(){if(on)return on;var r,s=Js,l=s.length,h,g="value"in yn?yn.value:yn.textContent,_=g.length;for(r=0;r<l&&s[r]===g[r];r++);var I=l-r;for(h=1;h<=I&&s[l-h]===g[_-h];h++);return on=g.slice(r,1<h?1-h:void 0)}function Zs(r){var s=r.keyCode;return"charCode"in r?(r=r.charCode,r===0&&s===13&&(r=13)):r=s,r===10&&(r=13),32<=r||r===13?r:0}function cr(){return!0}function Ra(){return!1}function Vt(r){function s(l,h,g,_,I){this._reactName=l,this._targetInst=g,this.type=h,this.nativeEvent=_,this.target=I,this.currentTarget=null;for(var L in r)r.hasOwnProperty(L)&&(l=r[L],this[L]=l?l(_):_[L]);return this.isDefaultPrevented=(_.defaultPrevented!=null?_.defaultPrevented:_.returnValue===!1)?cr:Ra,this.isPropagationStopped=Ra,this}return le(s.prototype,{preventDefault:function(){this.defaultPrevented=!0;var l=this.nativeEvent;l&&(l.preventDefault?l.preventDefault():typeof l.returnValue!="unknown"&&(l.returnValue=!1),this.isDefaultPrevented=cr)},stopPropagation:function(){var l=this.nativeEvent;l&&(l.stopPropagation?l.stopPropagation():typeof l.cancelBubble!="unknown"&&(l.cancelBubble=!0),this.isPropagationStopped=cr)},persist:function(){},isPersistent:cr}),s}var Wn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(r){return r.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},eo=Vt(Wn),ur=le({},Wn,{view:0,detail:0}),_d=Vt(ur),to,Lr,pi,us=le({},ur,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:dr,button:0,buttons:0,relatedTarget:function(r){return r.relatedTarget===void 0?r.fromElement===r.srcElement?r.toElement:r.fromElement:r.relatedTarget},movementX:function(r){return"movementX"in r?r.movementX:(r!==pi&&(pi&&r.type==="mousemove"?(to=r.screenX-pi.screenX,Lr=r.screenY-pi.screenY):Lr=to=0,pi=r),to)},movementY:function(r){return"movementY"in r?r.movementY:Lr}}),no=Vt(us),Aa=le({},us,{dataTransfer:0}),oc=Vt(Aa),ro=le({},ur,{relatedTarget:0}),io=Vt(ro),ac=le({},Wn,{animationName:0,elapsedTime:0,pseudoElement:0}),Mr=Vt(ac),lc=le({},Wn,{clipboardData:function(r){return"clipboardData"in r?r.clipboardData:window.clipboardData}}),cc=Vt(lc),uc=le({},Wn,{data:0}),Ca=Vt(uc),so={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},en={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},dc={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function hc(r){var s=this.nativeEvent;return s.getModifierState?s.getModifierState(r):(r=dc[r])?!!s[r]:!1}function dr(){return hc}var u=le({},ur,{key:function(r){if(r.key){var s=so[r.key]||r.key;if(s!=="Unidentified")return s}return r.type==="keypress"?(r=Zs(r),r===13?"Enter":String.fromCharCode(r)):r.type==="keydown"||r.type==="keyup"?en[r.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:dr,charCode:function(r){return r.type==="keypress"?Zs(r):0},keyCode:function(r){return r.type==="keydown"||r.type==="keyup"?r.keyCode:0},which:function(r){return r.type==="keypress"?Zs(r):r.type==="keydown"||r.type==="keyup"?r.keyCode:0}}),y=Vt(u),T=le({},us,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),C=Vt(T),$=le({},ur,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:dr}),Y=Vt($),de=le({},Wn,{propertyName:0,elapsedTime:0,pseudoElement:0}),Ye=Vt(de),St=le({},us,{deltaX:function(r){return"deltaX"in r?r.deltaX:"wheelDeltaX"in r?-r.wheelDeltaX:0},deltaY:function(r){return"deltaY"in r?r.deltaY:"wheelDeltaY"in r?-r.wheelDeltaY:"wheelDelta"in r?-r.wheelDelta:0},deltaZ:0,deltaMode:0}),He=Vt(St),Nt=[9,13,27,32],vt=d&&"CompositionEvent"in window,Rn=null;d&&"documentMode"in document&&(Rn=document.documentMode);var vn=d&&"TextEvent"in window&&!Rn,ds=d&&(!vt||Rn&&8<Rn&&11>=Rn),oo=" ",$p=!1;function Hp(r,s){switch(r){case"keyup":return Nt.indexOf(s.keyCode)!==-1;case"keydown":return s.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function qp(r){return r=r.detail,typeof r=="object"&&"data"in r?r.data:null}var ao=!1;function DE(r,s){switch(r){case"compositionend":return qp(s);case"keypress":return s.which!==32?null:($p=!0,oo);case"textInput":return r=s.data,r===oo&&$p?null:r;default:return null}}function jE(r,s){if(ao)return r==="compositionend"||!vt&&Hp(r,s)?(r=Ia(),on=Js=yn=null,ao=!1,r):null;switch(r){case"paste":return null;case"keypress":if(!(s.ctrlKey||s.altKey||s.metaKey)||s.ctrlKey&&s.altKey){if(s.char&&1<s.char.length)return s.char;if(s.which)return String.fromCharCode(s.which)}return null;case"compositionend":return ds&&s.locale!=="ko"?null:s.data;default:return null}}var OE={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Gp(r){var s=r&&r.nodeName&&r.nodeName.toLowerCase();return s==="input"?!!OE[r.type]:s==="textarea"}function Wp(r,s,l,h){or(h),s=yc(s,"onChange"),0<s.length&&(l=new eo("onChange","change",null,l,h),r.push({event:l,listeners:s}))}var ka=null,ba=null;function LE(r){dm(r,0)}function fc(r){var s=fo(r);if(Ve(s))return r}function ME(r,s){if(r==="change")return s}var Kp=!1;if(d){var Ed;if(d){var wd="oninput"in document;if(!wd){var Qp=document.createElement("div");Qp.setAttribute("oninput","return;"),wd=typeof Qp.oninput=="function"}Ed=wd}else Ed=!1;Kp=Ed&&(!document.documentMode||9<document.documentMode)}function Yp(){ka&&(ka.detachEvent("onpropertychange",Xp),ba=ka=null)}function Xp(r){if(r.propertyName==="value"&&fc(ba)){var s=[];Wp(s,ba,r,Us(r)),ga(LE,s)}}function VE(r,s,l){r==="focusin"?(Yp(),ka=s,ba=l,ka.attachEvent("onpropertychange",Xp)):r==="focusout"&&Yp()}function FE(r){if(r==="selectionchange"||r==="keyup"||r==="keydown")return fc(ba)}function UE(r,s){if(r==="click")return fc(s)}function BE(r,s){if(r==="input"||r==="change")return fc(s)}function zE(r,s){return r===s&&(r!==0||1/r===1/s)||r!==r&&s!==s}var Kn=typeof Object.is=="function"?Object.is:zE;function Na(r,s){if(Kn(r,s))return!0;if(typeof r!="object"||r===null||typeof s!="object"||s===null)return!1;var l=Object.keys(r),h=Object.keys(s);if(l.length!==h.length)return!1;for(h=0;h<l.length;h++){var g=l[h];if(!p.call(s,g)||!Kn(r[g],s[g]))return!1}return!0}function Jp(r){for(;r&&r.firstChild;)r=r.firstChild;return r}function Zp(r,s){var l=Jp(r);r=0;for(var h;l;){if(l.nodeType===3){if(h=r+l.textContent.length,r<=s&&h>=s)return{node:l,offset:s-r};r=h}e:{for(;l;){if(l.nextSibling){l=l.nextSibling;break e}l=l.parentNode}l=void 0}l=Jp(l)}}function em(r,s){return r&&s?r===s?!0:r&&r.nodeType===3?!1:s&&s.nodeType===3?em(r,s.parentNode):"contains"in r?r.contains(s):r.compareDocumentPosition?!!(r.compareDocumentPosition(s)&16):!1:!1}function tm(){for(var r=window,s=et();s instanceof r.HTMLIFrameElement;){try{var l=typeof s.contentWindow.location.href=="string"}catch{l=!1}if(l)r=s.contentWindow;else break;s=et(r.document)}return s}function Td(r){var s=r&&r.nodeName&&r.nodeName.toLowerCase();return s&&(s==="input"&&(r.type==="text"||r.type==="search"||r.type==="tel"||r.type==="url"||r.type==="password")||s==="textarea"||r.contentEditable==="true")}function $E(r){var s=tm(),l=r.focusedElem,h=r.selectionRange;if(s!==l&&l&&l.ownerDocument&&em(l.ownerDocument.documentElement,l)){if(h!==null&&Td(l)){if(s=h.start,r=h.end,r===void 0&&(r=s),"selectionStart"in l)l.selectionStart=s,l.selectionEnd=Math.min(r,l.value.length);else if(r=(s=l.ownerDocument||document)&&s.defaultView||window,r.getSelection){r=r.getSelection();var g=l.textContent.length,_=Math.min(h.start,g);h=h.end===void 0?_:Math.min(h.end,g),!r.extend&&_>h&&(g=h,h=_,_=g),g=Zp(l,_);var I=Zp(l,h);g&&I&&(r.rangeCount!==1||r.anchorNode!==g.node||r.anchorOffset!==g.offset||r.focusNode!==I.node||r.focusOffset!==I.offset)&&(s=s.createRange(),s.setStart(g.node,g.offset),r.removeAllRanges(),_>h?(r.addRange(s),r.extend(I.node,I.offset)):(s.setEnd(I.node,I.offset),r.addRange(s)))}}for(s=[],r=l;r=r.parentNode;)r.nodeType===1&&s.push({element:r,left:r.scrollLeft,top:r.scrollTop});for(typeof l.focus=="function"&&l.focus(),l=0;l<s.length;l++)r=s[l],r.element.scrollLeft=r.left,r.element.scrollTop=r.top}}var HE=d&&"documentMode"in document&&11>=document.documentMode,lo=null,Sd=null,Pa=null,xd=!1;function nm(r,s,l){var h=l.window===l?l.document:l.nodeType===9?l:l.ownerDocument;xd||lo==null||lo!==et(h)||(h=lo,"selectionStart"in h&&Td(h)?h={start:h.selectionStart,end:h.selectionEnd}:(h=(h.ownerDocument&&h.ownerDocument.defaultView||window).getSelection(),h={anchorNode:h.anchorNode,anchorOffset:h.anchorOffset,focusNode:h.focusNode,focusOffset:h.focusOffset}),Pa&&Na(Pa,h)||(Pa=h,h=yc(Sd,"onSelect"),0<h.length&&(s=new eo("onSelect","select",null,s,l),r.push({event:s,listeners:h}),s.target=lo)))}function pc(r,s){var l={};return l[r.toLowerCase()]=s.toLowerCase(),l["Webkit"+r]="webkit"+s,l["Moz"+r]="moz"+s,l}var co={animationend:pc("Animation","AnimationEnd"),animationiteration:pc("Animation","AnimationIteration"),animationstart:pc("Animation","AnimationStart"),transitionend:pc("Transition","TransitionEnd")},Id={},rm={};d&&(rm=document.createElement("div").style,"AnimationEvent"in window||(delete co.animationend.animation,delete co.animationiteration.animation,delete co.animationstart.animation),"TransitionEvent"in window||delete co.transitionend.transition);function mc(r){if(Id[r])return Id[r];if(!co[r])return r;var s=co[r],l;for(l in s)if(s.hasOwnProperty(l)&&l in rm)return Id[r]=s[l];return r}var im=mc("animationend"),sm=mc("animationiteration"),om=mc("animationstart"),am=mc("transitionend"),lm=new Map,cm="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function mi(r,s){lm.set(r,s),a(s,[r])}for(var Rd=0;Rd<cm.length;Rd++){var Ad=cm[Rd],qE=Ad.toLowerCase(),GE=Ad[0].toUpperCase()+Ad.slice(1);mi(qE,"on"+GE)}mi(im,"onAnimationEnd"),mi(sm,"onAnimationIteration"),mi(om,"onAnimationStart"),mi("dblclick","onDoubleClick"),mi("focusin","onFocus"),mi("focusout","onBlur"),mi(am,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),a("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),a("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),a("onBeforeInput",["compositionend","keypress","textInput","paste"]),a("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),a("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),a("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Da="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),WE=new Set("cancel close invalid load scroll toggle".split(" ").concat(Da));function um(r,s,l){var h=r.type||"unknown-event";r.currentTarget=l,ql(h,s,void 0,r),r.currentTarget=null}function dm(r,s){s=(s&4)!==0;for(var l=0;l<r.length;l++){var h=r[l],g=h.event;h=h.listeners;e:{var _=void 0;if(s)for(var I=h.length-1;0<=I;I--){var L=h[I],F=L.instance,K=L.currentTarget;if(L=L.listener,F!==_&&g.isPropagationStopped())break e;um(g,L,K),_=F}else for(I=0;I<h.length;I++){if(L=h[I],F=L.instance,K=L.currentTarget,L=L.listener,F!==_&&g.isPropagationStopped())break e;um(g,L,K),_=F}}}if(Un)throw r=ya,Un=!1,ya=null,r}function tt(r,s){var l=s[Od];l===void 0&&(l=s[Od]=new Set);var h=r+"__bubble";l.has(h)||(hm(s,r,2,!1),l.add(h))}function Cd(r,s,l){var h=0;s&&(h|=4),hm(l,r,h,s)}var gc="_reactListening"+Math.random().toString(36).slice(2);function ja(r){if(!r[gc]){r[gc]=!0,i.forEach(function(l){l!=="selectionchange"&&(WE.has(l)||Cd(l,!1,r),Cd(l,!0,r))});var s=r.nodeType===9?r:r.ownerDocument;s===null||s[gc]||(s[gc]=!0,Cd("selectionchange",!1,s))}}function hm(r,s,l,h){switch(xa(s)){case 1:var g=rt;break;case 4:g=vd;break;default:g=Sa}l=g.bind(null,s,l,r),g=void 0,!$s||s!=="touchstart"&&s!=="touchmove"&&s!=="wheel"||(g=!0),h?g!==void 0?r.addEventListener(s,l,{capture:!0,passive:g}):r.addEventListener(s,l,!0):g!==void 0?r.addEventListener(s,l,{passive:g}):r.addEventListener(s,l,!1)}function kd(r,s,l,h,g){var _=h;if(!(s&1)&&!(s&2)&&h!==null)e:for(;;){if(h===null)return;var I=h.tag;if(I===3||I===4){var L=h.stateNode.containerInfo;if(L===g||L.nodeType===8&&L.parentNode===g)break;if(I===4)for(I=h.return;I!==null;){var F=I.tag;if((F===3||F===4)&&(F=I.stateNode.containerInfo,F===g||F.nodeType===8&&F.parentNode===g))return;I=I.return}for(;L!==null;){if(I=hs(L),I===null)return;if(F=I.tag,F===5||F===6){h=_=I;continue e}L=L.parentNode}}h=h.return}ga(function(){var K=_,ne=Us(l),ie=[];e:{var te=lm.get(r);if(te!==void 0){var ge=eo,Ee=r;switch(r){case"keypress":if(Zs(l)===0)break e;case"keydown":case"keyup":ge=y;break;case"focusin":Ee="focus",ge=io;break;case"focusout":Ee="blur",ge=io;break;case"beforeblur":case"afterblur":ge=io;break;case"click":if(l.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ge=no;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ge=oc;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ge=Y;break;case im:case sm:case om:ge=Mr;break;case am:ge=Ye;break;case"scroll":ge=_d;break;case"wheel":ge=He;break;case"copy":case"cut":case"paste":ge=cc;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ge=C}var we=(s&4)!==0,mt=!we&&r==="scroll",H=we?te!==null?te+"Capture":null:te;we=[];for(var B=K,G;B!==null;){G=B;var ce=G.stateNode;if(G.tag===5&&ce!==null&&(G=ce,H!==null&&(ce=pt(B,H),ce!=null&&we.push(Oa(B,ce,G)))),mt)break;B=B.return}0<we.length&&(te=new ge(te,Ee,null,l,ne),ie.push({event:te,listeners:we}))}}if(!(s&7)){e:{if(te=r==="mouseover"||r==="pointerover",ge=r==="mouseout"||r==="pointerout",te&&l!==Zi&&(Ee=l.relatedTarget||l.fromElement)&&(hs(Ee)||Ee[Vr]))break e;if((ge||te)&&(te=ne.window===ne?ne:(te=ne.ownerDocument)?te.defaultView||te.parentWindow:window,ge?(Ee=l.relatedTarget||l.toElement,ge=K,Ee=Ee?hs(Ee):null,Ee!==null&&(mt=Bn(Ee),Ee!==mt||Ee.tag!==5&&Ee.tag!==6)&&(Ee=null)):(ge=null,Ee=K),ge!==Ee)){if(we=no,ce="onMouseLeave",H="onMouseEnter",B="mouse",(r==="pointerout"||r==="pointerover")&&(we=C,ce="onPointerLeave",H="onPointerEnter",B="pointer"),mt=ge==null?te:fo(ge),G=Ee==null?te:fo(Ee),te=new we(ce,B+"leave",ge,l,ne),te.target=mt,te.relatedTarget=G,ce=null,hs(ne)===K&&(we=new we(H,B+"enter",Ee,l,ne),we.target=G,we.relatedTarget=mt,ce=we),mt=ce,ge&&Ee)t:{for(we=ge,H=Ee,B=0,G=we;G;G=uo(G))B++;for(G=0,ce=H;ce;ce=uo(ce))G++;for(;0<B-G;)we=uo(we),B--;for(;0<G-B;)H=uo(H),G--;for(;B--;){if(we===H||H!==null&&we===H.alternate)break t;we=uo(we),H=uo(H)}we=null}else we=null;ge!==null&&fm(ie,te,ge,we,!1),Ee!==null&&mt!==null&&fm(ie,mt,Ee,we,!0)}}e:{if(te=K?fo(K):window,ge=te.nodeName&&te.nodeName.toLowerCase(),ge==="select"||ge==="input"&&te.type==="file")var Se=ME;else if(Gp(te))if(Kp)Se=BE;else{Se=FE;var Ie=VE}else(ge=te.nodeName)&&ge.toLowerCase()==="input"&&(te.type==="checkbox"||te.type==="radio")&&(Se=UE);if(Se&&(Se=Se(r,K))){Wp(ie,Se,l,ne);break e}Ie&&Ie(r,te,K),r==="focusout"&&(Ie=te._wrapperState)&&Ie.controlled&&te.type==="number"&&Ms(te,"number",te.value)}switch(Ie=K?fo(K):window,r){case"focusin":(Gp(Ie)||Ie.contentEditable==="true")&&(lo=Ie,Sd=K,Pa=null);break;case"focusout":Pa=Sd=lo=null;break;case"mousedown":xd=!0;break;case"contextmenu":case"mouseup":case"dragend":xd=!1,nm(ie,l,ne);break;case"selectionchange":if(HE)break;case"keydown":case"keyup":nm(ie,l,ne)}var Re;if(vt)e:{switch(r){case"compositionstart":var Pe="onCompositionStart";break e;case"compositionend":Pe="onCompositionEnd";break e;case"compositionupdate":Pe="onCompositionUpdate";break e}Pe=void 0}else ao?Hp(r,l)&&(Pe="onCompositionEnd"):r==="keydown"&&l.keyCode===229&&(Pe="onCompositionStart");Pe&&(ds&&l.locale!=="ko"&&(ao||Pe!=="onCompositionStart"?Pe==="onCompositionEnd"&&ao&&(Re=Ia()):(yn=ne,Js="value"in yn?yn.value:yn.textContent,ao=!0)),Ie=yc(K,Pe),0<Ie.length&&(Pe=new Ca(Pe,r,null,l,ne),ie.push({event:Pe,listeners:Ie}),Re?Pe.data=Re:(Re=qp(l),Re!==null&&(Pe.data=Re)))),(Re=vn?DE(r,l):jE(r,l))&&(K=yc(K,"onBeforeInput"),0<K.length&&(ne=new Ca("onBeforeInput","beforeinput",null,l,ne),ie.push({event:ne,listeners:K}),ne.data=Re))}dm(ie,s)})}function Oa(r,s,l){return{instance:r,listener:s,currentTarget:l}}function yc(r,s){for(var l=s+"Capture",h=[];r!==null;){var g=r,_=g.stateNode;g.tag===5&&_!==null&&(g=_,_=pt(r,l),_!=null&&h.unshift(Oa(r,_,g)),_=pt(r,s),_!=null&&h.push(Oa(r,_,g))),r=r.return}return h}function uo(r){if(r===null)return null;do r=r.return;while(r&&r.tag!==5);return r||null}function fm(r,s,l,h,g){for(var _=s._reactName,I=[];l!==null&&l!==h;){var L=l,F=L.alternate,K=L.stateNode;if(F!==null&&F===h)break;L.tag===5&&K!==null&&(L=K,g?(F=pt(l,_),F!=null&&I.unshift(Oa(l,F,L))):g||(F=pt(l,_),F!=null&&I.push(Oa(l,F,L)))),l=l.return}I.length!==0&&r.push({event:s,listeners:I})}var KE=/\r\n?/g,QE=/\u0000|\uFFFD/g;function pm(r){return(typeof r=="string"?r:""+r).replace(KE,`
`).replace(QE,"")}function vc(r,s,l){if(s=pm(s),pm(r)!==s&&l)throw Error(t(425))}function _c(){}var bd=null,Nd=null;function Pd(r,s){return r==="textarea"||r==="noscript"||typeof s.children=="string"||typeof s.children=="number"||typeof s.dangerouslySetInnerHTML=="object"&&s.dangerouslySetInnerHTML!==null&&s.dangerouslySetInnerHTML.__html!=null}var Dd=typeof setTimeout=="function"?setTimeout:void 0,YE=typeof clearTimeout=="function"?clearTimeout:void 0,mm=typeof Promise=="function"?Promise:void 0,XE=typeof queueMicrotask=="function"?queueMicrotask:typeof mm<"u"?function(r){return mm.resolve(null).then(r).catch(JE)}:Dd;function JE(r){setTimeout(function(){throw r})}function jd(r,s){var l=s,h=0;do{var g=l.nextSibling;if(r.removeChild(l),g&&g.nodeType===8)if(l=g.data,l==="/$"){if(h===0){r.removeChild(g),Gn(s);return}h--}else l!=="$"&&l!=="$?"&&l!=="$!"||h++;l=g}while(l);Gn(s)}function gi(r){for(;r!=null;r=r.nextSibling){var s=r.nodeType;if(s===1||s===3)break;if(s===8){if(s=r.data,s==="$"||s==="$!"||s==="$?")break;if(s==="/$")return null}}return r}function gm(r){r=r.previousSibling;for(var s=0;r;){if(r.nodeType===8){var l=r.data;if(l==="$"||l==="$!"||l==="$?"){if(s===0)return r;s--}else l==="/$"&&s++}r=r.previousSibling}return null}var ho=Math.random().toString(36).slice(2),hr="__reactFiber$"+ho,La="__reactProps$"+ho,Vr="__reactContainer$"+ho,Od="__reactEvents$"+ho,ZE="__reactListeners$"+ho,e1="__reactHandles$"+ho;function hs(r){var s=r[hr];if(s)return s;for(var l=r.parentNode;l;){if(s=l[Vr]||l[hr]){if(l=s.alternate,s.child!==null||l!==null&&l.child!==null)for(r=gm(r);r!==null;){if(l=r[hr])return l;r=gm(r)}return s}r=l,l=r.parentNode}return null}function Ma(r){return r=r[hr]||r[Vr],!r||r.tag!==5&&r.tag!==6&&r.tag!==13&&r.tag!==3?null:r}function fo(r){if(r.tag===5||r.tag===6)return r.stateNode;throw Error(t(33))}function Ec(r){return r[La]||null}var Ld=[],po=-1;function yi(r){return{current:r}}function nt(r){0>po||(r.current=Ld[po],Ld[po]=null,po--)}function Ze(r,s){po++,Ld[po]=r.current,r.current=s}var vi={},qt=yi(vi),an=yi(!1),fs=vi;function mo(r,s){var l=r.type.contextTypes;if(!l)return vi;var h=r.stateNode;if(h&&h.__reactInternalMemoizedUnmaskedChildContext===s)return h.__reactInternalMemoizedMaskedChildContext;var g={},_;for(_ in l)g[_]=s[_];return h&&(r=r.stateNode,r.__reactInternalMemoizedUnmaskedChildContext=s,r.__reactInternalMemoizedMaskedChildContext=g),g}function ln(r){return r=r.childContextTypes,r!=null}function wc(){nt(an),nt(qt)}function ym(r,s,l){if(qt.current!==vi)throw Error(t(168));Ze(qt,s),Ze(an,l)}function vm(r,s,l){var h=r.stateNode;if(s=s.childContextTypes,typeof h.getChildContext!="function")return l;h=h.getChildContext();for(var g in h)if(!(g in s))throw Error(t(108,Te(r)||"Unknown",g));return le({},l,h)}function Tc(r){return r=(r=r.stateNode)&&r.__reactInternalMemoizedMergedChildContext||vi,fs=qt.current,Ze(qt,r),Ze(an,an.current),!0}function _m(r,s,l){var h=r.stateNode;if(!h)throw Error(t(169));l?(r=vm(r,s,fs),h.__reactInternalMemoizedMergedChildContext=r,nt(an),nt(qt),Ze(qt,r)):nt(an),Ze(an,l)}var Fr=null,Sc=!1,Md=!1;function Em(r){Fr===null?Fr=[r]:Fr.push(r)}function t1(r){Sc=!0,Em(r)}function _i(){if(!Md&&Fr!==null){Md=!0;var r=0,s=ze;try{var l=Fr;for(ze=1;r<l.length;r++){var h=l[r];do h=h(!0);while(h!==null)}Fr=null,Sc=!1}catch(g){throw Fr!==null&&(Fr=Fr.slice(r+1)),Ws(is,_i),g}finally{ze=s,Md=!1}}return null}var go=[],yo=0,xc=null,Ic=0,An=[],Cn=0,ps=null,Ur=1,Br="";function ms(r,s){go[yo++]=Ic,go[yo++]=xc,xc=r,Ic=s}function wm(r,s,l){An[Cn++]=Ur,An[Cn++]=Br,An[Cn++]=ps,ps=r;var h=Ur;r=Br;var g=32-Zt(h)-1;h&=~(1<<g),l+=1;var _=32-Zt(s)+g;if(30<_){var I=g-g%5;_=(h&(1<<I)-1).toString(32),h>>=I,g-=I,Ur=1<<32-Zt(s)+g|l<<g|h,Br=_+r}else Ur=1<<_|l<<g|h,Br=r}function Vd(r){r.return!==null&&(ms(r,1),wm(r,1,0))}function Fd(r){for(;r===xc;)xc=go[--yo],go[yo]=null,Ic=go[--yo],go[yo]=null;for(;r===ps;)ps=An[--Cn],An[Cn]=null,Br=An[--Cn],An[Cn]=null,Ur=An[--Cn],An[Cn]=null}var _n=null,En=null,it=!1,Qn=null;function Tm(r,s){var l=Pn(5,null,null,0);l.elementType="DELETED",l.stateNode=s,l.return=r,s=r.deletions,s===null?(r.deletions=[l],r.flags|=16):s.push(l)}function Sm(r,s){switch(r.tag){case 5:var l=r.type;return s=s.nodeType!==1||l.toLowerCase()!==s.nodeName.toLowerCase()?null:s,s!==null?(r.stateNode=s,_n=r,En=gi(s.firstChild),!0):!1;case 6:return s=r.pendingProps===""||s.nodeType!==3?null:s,s!==null?(r.stateNode=s,_n=r,En=null,!0):!1;case 13:return s=s.nodeType!==8?null:s,s!==null?(l=ps!==null?{id:Ur,overflow:Br}:null,r.memoizedState={dehydrated:s,treeContext:l,retryLane:1073741824},l=Pn(18,null,null,0),l.stateNode=s,l.return=r,r.child=l,_n=r,En=null,!0):!1;default:return!1}}function Ud(r){return(r.mode&1)!==0&&(r.flags&128)===0}function Bd(r){if(it){var s=En;if(s){var l=s;if(!Sm(r,s)){if(Ud(r))throw Error(t(418));s=gi(l.nextSibling);var h=_n;s&&Sm(r,s)?Tm(h,l):(r.flags=r.flags&-4097|2,it=!1,_n=r)}}else{if(Ud(r))throw Error(t(418));r.flags=r.flags&-4097|2,it=!1,_n=r}}}function xm(r){for(r=r.return;r!==null&&r.tag!==5&&r.tag!==3&&r.tag!==13;)r=r.return;_n=r}function Rc(r){if(r!==_n)return!1;if(!it)return xm(r),it=!0,!1;var s;if((s=r.tag!==3)&&!(s=r.tag!==5)&&(s=r.type,s=s!=="head"&&s!=="body"&&!Pd(r.type,r.memoizedProps)),s&&(s=En)){if(Ud(r))throw Im(),Error(t(418));for(;s;)Tm(r,s),s=gi(s.nextSibling)}if(xm(r),r.tag===13){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(t(317));e:{for(r=r.nextSibling,s=0;r;){if(r.nodeType===8){var l=r.data;if(l==="/$"){if(s===0){En=gi(r.nextSibling);break e}s--}else l!=="$"&&l!=="$!"&&l!=="$?"||s++}r=r.nextSibling}En=null}}else En=_n?gi(r.stateNode.nextSibling):null;return!0}function Im(){for(var r=En;r;)r=gi(r.nextSibling)}function vo(){En=_n=null,it=!1}function zd(r){Qn===null?Qn=[r]:Qn.push(r)}var n1=J.ReactCurrentBatchConfig;function Va(r,s,l){if(r=l.ref,r!==null&&typeof r!="function"&&typeof r!="object"){if(l._owner){if(l=l._owner,l){if(l.tag!==1)throw Error(t(309));var h=l.stateNode}if(!h)throw Error(t(147,r));var g=h,_=""+r;return s!==null&&s.ref!==null&&typeof s.ref=="function"&&s.ref._stringRef===_?s.ref:(s=function(I){var L=g.refs;I===null?delete L[_]:L[_]=I},s._stringRef=_,s)}if(typeof r!="string")throw Error(t(284));if(!l._owner)throw Error(t(290,r))}return r}function Ac(r,s){throw r=Object.prototype.toString.call(s),Error(t(31,r==="[object Object]"?"object with keys {"+Object.keys(s).join(", ")+"}":r))}function Rm(r){var s=r._init;return s(r._payload)}function Am(r){function s(H,B){if(r){var G=H.deletions;G===null?(H.deletions=[B],H.flags|=16):G.push(B)}}function l(H,B){if(!r)return null;for(;B!==null;)s(H,B),B=B.sibling;return null}function h(H,B){for(H=new Map;B!==null;)B.key!==null?H.set(B.key,B):H.set(B.index,B),B=B.sibling;return H}function g(H,B){return H=Ai(H,B),H.index=0,H.sibling=null,H}function _(H,B,G){return H.index=G,r?(G=H.alternate,G!==null?(G=G.index,G<B?(H.flags|=2,B):G):(H.flags|=2,B)):(H.flags|=1048576,B)}function I(H){return r&&H.alternate===null&&(H.flags|=2),H}function L(H,B,G,ce){return B===null||B.tag!==6?(B=Dh(G,H.mode,ce),B.return=H,B):(B=g(B,G),B.return=H,B)}function F(H,B,G,ce){var Se=G.type;return Se===k?ne(H,B,G.props.children,ce,G.key):B!==null&&(B.elementType===Se||typeof Se=="object"&&Se!==null&&Se.$$typeof===he&&Rm(Se)===B.type)?(ce=g(B,G.props),ce.ref=Va(H,B,G),ce.return=H,ce):(ce=Xc(G.type,G.key,G.props,null,H.mode,ce),ce.ref=Va(H,B,G),ce.return=H,ce)}function K(H,B,G,ce){return B===null||B.tag!==4||B.stateNode.containerInfo!==G.containerInfo||B.stateNode.implementation!==G.implementation?(B=jh(G,H.mode,ce),B.return=H,B):(B=g(B,G.children||[]),B.return=H,B)}function ne(H,B,G,ce,Se){return B===null||B.tag!==7?(B=Ss(G,H.mode,ce,Se),B.return=H,B):(B=g(B,G),B.return=H,B)}function ie(H,B,G){if(typeof B=="string"&&B!==""||typeof B=="number")return B=Dh(""+B,H.mode,G),B.return=H,B;if(typeof B=="object"&&B!==null){switch(B.$$typeof){case W:return G=Xc(B.type,B.key,B.props,null,H.mode,G),G.ref=Va(H,null,B),G.return=H,G;case Q:return B=jh(B,H.mode,G),B.return=H,B;case he:var ce=B._init;return ie(H,ce(B._payload),G)}if(kr(B)||fe(B))return B=Ss(B,H.mode,G,null),B.return=H,B;Ac(H,B)}return null}function te(H,B,G,ce){var Se=B!==null?B.key:null;if(typeof G=="string"&&G!==""||typeof G=="number")return Se!==null?null:L(H,B,""+G,ce);if(typeof G=="object"&&G!==null){switch(G.$$typeof){case W:return G.key===Se?F(H,B,G,ce):null;case Q:return G.key===Se?K(H,B,G,ce):null;case he:return Se=G._init,te(H,B,Se(G._payload),ce)}if(kr(G)||fe(G))return Se!==null?null:ne(H,B,G,ce,null);Ac(H,G)}return null}function ge(H,B,G,ce,Se){if(typeof ce=="string"&&ce!==""||typeof ce=="number")return H=H.get(G)||null,L(B,H,""+ce,Se);if(typeof ce=="object"&&ce!==null){switch(ce.$$typeof){case W:return H=H.get(ce.key===null?G:ce.key)||null,F(B,H,ce,Se);case Q:return H=H.get(ce.key===null?G:ce.key)||null,K(B,H,ce,Se);case he:var Ie=ce._init;return ge(H,B,G,Ie(ce._payload),Se)}if(kr(ce)||fe(ce))return H=H.get(G)||null,ne(B,H,ce,Se,null);Ac(B,ce)}return null}function Ee(H,B,G,ce){for(var Se=null,Ie=null,Re=B,Pe=B=0,jt=null;Re!==null&&Pe<G.length;Pe++){Re.index>Pe?(jt=Re,Re=null):jt=Re.sibling;var We=te(H,Re,G[Pe],ce);if(We===null){Re===null&&(Re=jt);break}r&&Re&&We.alternate===null&&s(H,Re),B=_(We,B,Pe),Ie===null?Se=We:Ie.sibling=We,Ie=We,Re=jt}if(Pe===G.length)return l(H,Re),it&&ms(H,Pe),Se;if(Re===null){for(;Pe<G.length;Pe++)Re=ie(H,G[Pe],ce),Re!==null&&(B=_(Re,B,Pe),Ie===null?Se=Re:Ie.sibling=Re,Ie=Re);return it&&ms(H,Pe),Se}for(Re=h(H,Re);Pe<G.length;Pe++)jt=ge(Re,H,Pe,G[Pe],ce),jt!==null&&(r&&jt.alternate!==null&&Re.delete(jt.key===null?Pe:jt.key),B=_(jt,B,Pe),Ie===null?Se=jt:Ie.sibling=jt,Ie=jt);return r&&Re.forEach(function(Ci){return s(H,Ci)}),it&&ms(H,Pe),Se}function we(H,B,G,ce){var Se=fe(G);if(typeof Se!="function")throw Error(t(150));if(G=Se.call(G),G==null)throw Error(t(151));for(var Ie=Se=null,Re=B,Pe=B=0,jt=null,We=G.next();Re!==null&&!We.done;Pe++,We=G.next()){Re.index>Pe?(jt=Re,Re=null):jt=Re.sibling;var Ci=te(H,Re,We.value,ce);if(Ci===null){Re===null&&(Re=jt);break}r&&Re&&Ci.alternate===null&&s(H,Re),B=_(Ci,B,Pe),Ie===null?Se=Ci:Ie.sibling=Ci,Ie=Ci,Re=jt}if(We.done)return l(H,Re),it&&ms(H,Pe),Se;if(Re===null){for(;!We.done;Pe++,We=G.next())We=ie(H,We.value,ce),We!==null&&(B=_(We,B,Pe),Ie===null?Se=We:Ie.sibling=We,Ie=We);return it&&ms(H,Pe),Se}for(Re=h(H,Re);!We.done;Pe++,We=G.next())We=ge(Re,H,Pe,We.value,ce),We!==null&&(r&&We.alternate!==null&&Re.delete(We.key===null?Pe:We.key),B=_(We,B,Pe),Ie===null?Se=We:Ie.sibling=We,Ie=We);return r&&Re.forEach(function(j1){return s(H,j1)}),it&&ms(H,Pe),Se}function mt(H,B,G,ce){if(typeof G=="object"&&G!==null&&G.type===k&&G.key===null&&(G=G.props.children),typeof G=="object"&&G!==null){switch(G.$$typeof){case W:e:{for(var Se=G.key,Ie=B;Ie!==null;){if(Ie.key===Se){if(Se=G.type,Se===k){if(Ie.tag===7){l(H,Ie.sibling),B=g(Ie,G.props.children),B.return=H,H=B;break e}}else if(Ie.elementType===Se||typeof Se=="object"&&Se!==null&&Se.$$typeof===he&&Rm(Se)===Ie.type){l(H,Ie.sibling),B=g(Ie,G.props),B.ref=Va(H,Ie,G),B.return=H,H=B;break e}l(H,Ie);break}else s(H,Ie);Ie=Ie.sibling}G.type===k?(B=Ss(G.props.children,H.mode,ce,G.key),B.return=H,H=B):(ce=Xc(G.type,G.key,G.props,null,H.mode,ce),ce.ref=Va(H,B,G),ce.return=H,H=ce)}return I(H);case Q:e:{for(Ie=G.key;B!==null;){if(B.key===Ie)if(B.tag===4&&B.stateNode.containerInfo===G.containerInfo&&B.stateNode.implementation===G.implementation){l(H,B.sibling),B=g(B,G.children||[]),B.return=H,H=B;break e}else{l(H,B);break}else s(H,B);B=B.sibling}B=jh(G,H.mode,ce),B.return=H,H=B}return I(H);case he:return Ie=G._init,mt(H,B,Ie(G._payload),ce)}if(kr(G))return Ee(H,B,G,ce);if(fe(G))return we(H,B,G,ce);Ac(H,G)}return typeof G=="string"&&G!==""||typeof G=="number"?(G=""+G,B!==null&&B.tag===6?(l(H,B.sibling),B=g(B,G),B.return=H,H=B):(l(H,B),B=Dh(G,H.mode,ce),B.return=H,H=B),I(H)):l(H,B)}return mt}var _o=Am(!0),Cm=Am(!1),Cc=yi(null),kc=null,Eo=null,$d=null;function Hd(){$d=Eo=kc=null}function qd(r){var s=Cc.current;nt(Cc),r._currentValue=s}function Gd(r,s,l){for(;r!==null;){var h=r.alternate;if((r.childLanes&s)!==s?(r.childLanes|=s,h!==null&&(h.childLanes|=s)):h!==null&&(h.childLanes&s)!==s&&(h.childLanes|=s),r===l)break;r=r.return}}function wo(r,s){kc=r,$d=Eo=null,r=r.dependencies,r!==null&&r.firstContext!==null&&(r.lanes&s&&(cn=!0),r.firstContext=null)}function kn(r){var s=r._currentValue;if($d!==r)if(r={context:r,memoizedValue:s,next:null},Eo===null){if(kc===null)throw Error(t(308));Eo=r,kc.dependencies={lanes:0,firstContext:r}}else Eo=Eo.next=r;return s}var gs=null;function Wd(r){gs===null?gs=[r]:gs.push(r)}function km(r,s,l,h){var g=s.interleaved;return g===null?(l.next=l,Wd(s)):(l.next=g.next,g.next=l),s.interleaved=l,zr(r,h)}function zr(r,s){r.lanes|=s;var l=r.alternate;for(l!==null&&(l.lanes|=s),l=r,r=r.return;r!==null;)r.childLanes|=s,l=r.alternate,l!==null&&(l.childLanes|=s),l=r,r=r.return;return l.tag===3?l.stateNode:null}var Ei=!1;function Kd(r){r.updateQueue={baseState:r.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function bm(r,s){r=r.updateQueue,s.updateQueue===r&&(s.updateQueue={baseState:r.baseState,firstBaseUpdate:r.firstBaseUpdate,lastBaseUpdate:r.lastBaseUpdate,shared:r.shared,effects:r.effects})}function $r(r,s){return{eventTime:r,lane:s,tag:0,payload:null,callback:null,next:null}}function wi(r,s,l){var h=r.updateQueue;if(h===null)return null;if(h=h.shared,Ge&2){var g=h.pending;return g===null?s.next=s:(s.next=g.next,g.next=s),h.pending=s,zr(r,l)}return g=h.interleaved,g===null?(s.next=s,Wd(h)):(s.next=g.next,g.next=s),h.interleaved=s,zr(r,l)}function bc(r,s,l){if(s=s.updateQueue,s!==null&&(s=s.shared,(l&4194240)!==0)){var h=s.lanes;h&=r.pendingLanes,l|=h,s.lanes=l,ui(r,l)}}function Nm(r,s){var l=r.updateQueue,h=r.alternate;if(h!==null&&(h=h.updateQueue,l===h)){var g=null,_=null;if(l=l.firstBaseUpdate,l!==null){do{var I={eventTime:l.eventTime,lane:l.lane,tag:l.tag,payload:l.payload,callback:l.callback,next:null};_===null?g=_=I:_=_.next=I,l=l.next}while(l!==null);_===null?g=_=s:_=_.next=s}else g=_=s;l={baseState:h.baseState,firstBaseUpdate:g,lastBaseUpdate:_,shared:h.shared,effects:h.effects},r.updateQueue=l;return}r=l.lastBaseUpdate,r===null?l.firstBaseUpdate=s:r.next=s,l.lastBaseUpdate=s}function Nc(r,s,l,h){var g=r.updateQueue;Ei=!1;var _=g.firstBaseUpdate,I=g.lastBaseUpdate,L=g.shared.pending;if(L!==null){g.shared.pending=null;var F=L,K=F.next;F.next=null,I===null?_=K:I.next=K,I=F;var ne=r.alternate;ne!==null&&(ne=ne.updateQueue,L=ne.lastBaseUpdate,L!==I&&(L===null?ne.firstBaseUpdate=K:L.next=K,ne.lastBaseUpdate=F))}if(_!==null){var ie=g.baseState;I=0,ne=K=F=null,L=_;do{var te=L.lane,ge=L.eventTime;if((h&te)===te){ne!==null&&(ne=ne.next={eventTime:ge,lane:0,tag:L.tag,payload:L.payload,callback:L.callback,next:null});e:{var Ee=r,we=L;switch(te=s,ge=l,we.tag){case 1:if(Ee=we.payload,typeof Ee=="function"){ie=Ee.call(ge,ie,te);break e}ie=Ee;break e;case 3:Ee.flags=Ee.flags&-65537|128;case 0:if(Ee=we.payload,te=typeof Ee=="function"?Ee.call(ge,ie,te):Ee,te==null)break e;ie=le({},ie,te);break e;case 2:Ei=!0}}L.callback!==null&&L.lane!==0&&(r.flags|=64,te=g.effects,te===null?g.effects=[L]:te.push(L))}else ge={eventTime:ge,lane:te,tag:L.tag,payload:L.payload,callback:L.callback,next:null},ne===null?(K=ne=ge,F=ie):ne=ne.next=ge,I|=te;if(L=L.next,L===null){if(L=g.shared.pending,L===null)break;te=L,L=te.next,te.next=null,g.lastBaseUpdate=te,g.shared.pending=null}}while(!0);if(ne===null&&(F=ie),g.baseState=F,g.firstBaseUpdate=K,g.lastBaseUpdate=ne,s=g.shared.interleaved,s!==null){g=s;do I|=g.lane,g=g.next;while(g!==s)}else _===null&&(g.shared.lanes=0);_s|=I,r.lanes=I,r.memoizedState=ie}}function Pm(r,s,l){if(r=s.effects,s.effects=null,r!==null)for(s=0;s<r.length;s++){var h=r[s],g=h.callback;if(g!==null){if(h.callback=null,h=l,typeof g!="function")throw Error(t(191,g));g.call(h)}}}var Fa={},fr=yi(Fa),Ua=yi(Fa),Ba=yi(Fa);function ys(r){if(r===Fa)throw Error(t(174));return r}function Qd(r,s){switch(Ze(Ba,s),Ze(Ua,r),Ze(fr,Fa),r=s.nodeType,r){case 9:case 11:s=(s=s.documentElement)?s.namespaceURI:Tt(null,"");break;default:r=r===8?s.parentNode:s,s=r.namespaceURI||null,r=r.tagName,s=Tt(s,r)}nt(fr),Ze(fr,s)}function To(){nt(fr),nt(Ua),nt(Ba)}function Dm(r){ys(Ba.current);var s=ys(fr.current),l=Tt(s,r.type);s!==l&&(Ze(Ua,r),Ze(fr,l))}function Yd(r){Ua.current===r&&(nt(fr),nt(Ua))}var ot=yi(0);function Pc(r){for(var s=r;s!==null;){if(s.tag===13){var l=s.memoizedState;if(l!==null&&(l=l.dehydrated,l===null||l.data==="$?"||l.data==="$!"))return s}else if(s.tag===19&&s.memoizedProps.revealOrder!==void 0){if(s.flags&128)return s}else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===r)break;for(;s.sibling===null;){if(s.return===null||s.return===r)return null;s=s.return}s.sibling.return=s.return,s=s.sibling}return null}var Xd=[];function Jd(){for(var r=0;r<Xd.length;r++)Xd[r]._workInProgressVersionPrimary=null;Xd.length=0}var Dc=J.ReactCurrentDispatcher,Zd=J.ReactCurrentBatchConfig,vs=0,at=null,xt=null,Pt=null,jc=!1,za=!1,$a=0,r1=0;function Gt(){throw Error(t(321))}function eh(r,s){if(s===null)return!1;for(var l=0;l<s.length&&l<r.length;l++)if(!Kn(r[l],s[l]))return!1;return!0}function th(r,s,l,h,g,_){if(vs=_,at=s,s.memoizedState=null,s.updateQueue=null,s.lanes=0,Dc.current=r===null||r.memoizedState===null?a1:l1,r=l(h,g),za){_=0;do{if(za=!1,$a=0,25<=_)throw Error(t(301));_+=1,Pt=xt=null,s.updateQueue=null,Dc.current=c1,r=l(h,g)}while(za)}if(Dc.current=Mc,s=xt!==null&&xt.next!==null,vs=0,Pt=xt=at=null,jc=!1,s)throw Error(t(300));return r}function nh(){var r=$a!==0;return $a=0,r}function pr(){var r={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Pt===null?at.memoizedState=Pt=r:Pt=Pt.next=r,Pt}function bn(){if(xt===null){var r=at.alternate;r=r!==null?r.memoizedState:null}else r=xt.next;var s=Pt===null?at.memoizedState:Pt.next;if(s!==null)Pt=s,xt=r;else{if(r===null)throw Error(t(310));xt=r,r={memoizedState:xt.memoizedState,baseState:xt.baseState,baseQueue:xt.baseQueue,queue:xt.queue,next:null},Pt===null?at.memoizedState=Pt=r:Pt=Pt.next=r}return Pt}function Ha(r,s){return typeof s=="function"?s(r):s}function rh(r){var s=bn(),l=s.queue;if(l===null)throw Error(t(311));l.lastRenderedReducer=r;var h=xt,g=h.baseQueue,_=l.pending;if(_!==null){if(g!==null){var I=g.next;g.next=_.next,_.next=I}h.baseQueue=g=_,l.pending=null}if(g!==null){_=g.next,h=h.baseState;var L=I=null,F=null,K=_;do{var ne=K.lane;if((vs&ne)===ne)F!==null&&(F=F.next={lane:0,action:K.action,hasEagerState:K.hasEagerState,eagerState:K.eagerState,next:null}),h=K.hasEagerState?K.eagerState:r(h,K.action);else{var ie={lane:ne,action:K.action,hasEagerState:K.hasEagerState,eagerState:K.eagerState,next:null};F===null?(L=F=ie,I=h):F=F.next=ie,at.lanes|=ne,_s|=ne}K=K.next}while(K!==null&&K!==_);F===null?I=h:F.next=L,Kn(h,s.memoizedState)||(cn=!0),s.memoizedState=h,s.baseState=I,s.baseQueue=F,l.lastRenderedState=h}if(r=l.interleaved,r!==null){g=r;do _=g.lane,at.lanes|=_,_s|=_,g=g.next;while(g!==r)}else g===null&&(l.lanes=0);return[s.memoizedState,l.dispatch]}function ih(r){var s=bn(),l=s.queue;if(l===null)throw Error(t(311));l.lastRenderedReducer=r;var h=l.dispatch,g=l.pending,_=s.memoizedState;if(g!==null){l.pending=null;var I=g=g.next;do _=r(_,I.action),I=I.next;while(I!==g);Kn(_,s.memoizedState)||(cn=!0),s.memoizedState=_,s.baseQueue===null&&(s.baseState=_),l.lastRenderedState=_}return[_,h]}function jm(){}function Om(r,s){var l=at,h=bn(),g=s(),_=!Kn(h.memoizedState,g);if(_&&(h.memoizedState=g,cn=!0),h=h.queue,sh(Vm.bind(null,l,h,r),[r]),h.getSnapshot!==s||_||Pt!==null&&Pt.memoizedState.tag&1){if(l.flags|=2048,qa(9,Mm.bind(null,l,h,g,s),void 0,null),Dt===null)throw Error(t(349));vs&30||Lm(l,s,g)}return g}function Lm(r,s,l){r.flags|=16384,r={getSnapshot:s,value:l},s=at.updateQueue,s===null?(s={lastEffect:null,stores:null},at.updateQueue=s,s.stores=[r]):(l=s.stores,l===null?s.stores=[r]:l.push(r))}function Mm(r,s,l,h){s.value=l,s.getSnapshot=h,Fm(s)&&Um(r)}function Vm(r,s,l){return l(function(){Fm(s)&&Um(r)})}function Fm(r){var s=r.getSnapshot;r=r.value;try{var l=s();return!Kn(r,l)}catch{return!0}}function Um(r){var s=zr(r,1);s!==null&&Zn(s,r,1,-1)}function Bm(r){var s=pr();return typeof r=="function"&&(r=r()),s.memoizedState=s.baseState=r,r={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ha,lastRenderedState:r},s.queue=r,r=r.dispatch=o1.bind(null,at,r),[s.memoizedState,r]}function qa(r,s,l,h){return r={tag:r,create:s,destroy:l,deps:h,next:null},s=at.updateQueue,s===null?(s={lastEffect:null,stores:null},at.updateQueue=s,s.lastEffect=r.next=r):(l=s.lastEffect,l===null?s.lastEffect=r.next=r:(h=l.next,l.next=r,r.next=h,s.lastEffect=r)),r}function zm(){return bn().memoizedState}function Oc(r,s,l,h){var g=pr();at.flags|=r,g.memoizedState=qa(1|s,l,void 0,h===void 0?null:h)}function Lc(r,s,l,h){var g=bn();h=h===void 0?null:h;var _=void 0;if(xt!==null){var I=xt.memoizedState;if(_=I.destroy,h!==null&&eh(h,I.deps)){g.memoizedState=qa(s,l,_,h);return}}at.flags|=r,g.memoizedState=qa(1|s,l,_,h)}function $m(r,s){return Oc(8390656,8,r,s)}function sh(r,s){return Lc(2048,8,r,s)}function Hm(r,s){return Lc(4,2,r,s)}function qm(r,s){return Lc(4,4,r,s)}function Gm(r,s){if(typeof s=="function")return r=r(),s(r),function(){s(null)};if(s!=null)return r=r(),s.current=r,function(){s.current=null}}function Wm(r,s,l){return l=l!=null?l.concat([r]):null,Lc(4,4,Gm.bind(null,s,r),l)}function oh(){}function Km(r,s){var l=bn();s=s===void 0?null:s;var h=l.memoizedState;return h!==null&&s!==null&&eh(s,h[1])?h[0]:(l.memoizedState=[r,s],r)}function Qm(r,s){var l=bn();s=s===void 0?null:s;var h=l.memoizedState;return h!==null&&s!==null&&eh(s,h[1])?h[0]:(r=r(),l.memoizedState=[r,s],r)}function Ym(r,s,l){return vs&21?(Kn(l,s)||(l=as(),at.lanes|=l,_s|=l,r.baseState=!0),s):(r.baseState&&(r.baseState=!1,cn=!0),r.memoizedState=l)}function i1(r,s){var l=ze;ze=l!==0&&4>l?l:4,r(!0);var h=Zd.transition;Zd.transition={};try{r(!1),s()}finally{ze=l,Zd.transition=h}}function Xm(){return bn().memoizedState}function s1(r,s,l){var h=Ii(r);if(l={lane:h,action:l,hasEagerState:!1,eagerState:null,next:null},Jm(r))Zm(s,l);else if(l=km(r,s,l,h),l!==null){var g=nn();Zn(l,r,h,g),eg(l,s,h)}}function o1(r,s,l){var h=Ii(r),g={lane:h,action:l,hasEagerState:!1,eagerState:null,next:null};if(Jm(r))Zm(s,g);else{var _=r.alternate;if(r.lanes===0&&(_===null||_.lanes===0)&&(_=s.lastRenderedReducer,_!==null))try{var I=s.lastRenderedState,L=_(I,l);if(g.hasEagerState=!0,g.eagerState=L,Kn(L,I)){var F=s.interleaved;F===null?(g.next=g,Wd(s)):(g.next=F.next,F.next=g),s.interleaved=g;return}}catch{}finally{}l=km(r,s,g,h),l!==null&&(g=nn(),Zn(l,r,h,g),eg(l,s,h))}}function Jm(r){var s=r.alternate;return r===at||s!==null&&s===at}function Zm(r,s){za=jc=!0;var l=r.pending;l===null?s.next=s:(s.next=l.next,l.next=s),r.pending=s}function eg(r,s,l){if(l&4194240){var h=s.lanes;h&=r.pendingLanes,l|=h,s.lanes=l,ui(r,l)}}var Mc={readContext:kn,useCallback:Gt,useContext:Gt,useEffect:Gt,useImperativeHandle:Gt,useInsertionEffect:Gt,useLayoutEffect:Gt,useMemo:Gt,useReducer:Gt,useRef:Gt,useState:Gt,useDebugValue:Gt,useDeferredValue:Gt,useTransition:Gt,useMutableSource:Gt,useSyncExternalStore:Gt,useId:Gt,unstable_isNewReconciler:!1},a1={readContext:kn,useCallback:function(r,s){return pr().memoizedState=[r,s===void 0?null:s],r},useContext:kn,useEffect:$m,useImperativeHandle:function(r,s,l){return l=l!=null?l.concat([r]):null,Oc(4194308,4,Gm.bind(null,s,r),l)},useLayoutEffect:function(r,s){return Oc(4194308,4,r,s)},useInsertionEffect:function(r,s){return Oc(4,2,r,s)},useMemo:function(r,s){var l=pr();return s=s===void 0?null:s,r=r(),l.memoizedState=[r,s],r},useReducer:function(r,s,l){var h=pr();return s=l!==void 0?l(s):s,h.memoizedState=h.baseState=s,r={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:r,lastRenderedState:s},h.queue=r,r=r.dispatch=s1.bind(null,at,r),[h.memoizedState,r]},useRef:function(r){var s=pr();return r={current:r},s.memoizedState=r},useState:Bm,useDebugValue:oh,useDeferredValue:function(r){return pr().memoizedState=r},useTransition:function(){var r=Bm(!1),s=r[0];return r=i1.bind(null,r[1]),pr().memoizedState=r,[s,r]},useMutableSource:function(){},useSyncExternalStore:function(r,s,l){var h=at,g=pr();if(it){if(l===void 0)throw Error(t(407));l=l()}else{if(l=s(),Dt===null)throw Error(t(349));vs&30||Lm(h,s,l)}g.memoizedState=l;var _={value:l,getSnapshot:s};return g.queue=_,$m(Vm.bind(null,h,_,r),[r]),h.flags|=2048,qa(9,Mm.bind(null,h,_,l,s),void 0,null),l},useId:function(){var r=pr(),s=Dt.identifierPrefix;if(it){var l=Br,h=Ur;l=(h&~(1<<32-Zt(h)-1)).toString(32)+l,s=":"+s+"R"+l,l=$a++,0<l&&(s+="H"+l.toString(32)),s+=":"}else l=r1++,s=":"+s+"r"+l.toString(32)+":";return r.memoizedState=s},unstable_isNewReconciler:!1},l1={readContext:kn,useCallback:Km,useContext:kn,useEffect:sh,useImperativeHandle:Wm,useInsertionEffect:Hm,useLayoutEffect:qm,useMemo:Qm,useReducer:rh,useRef:zm,useState:function(){return rh(Ha)},useDebugValue:oh,useDeferredValue:function(r){var s=bn();return Ym(s,xt.memoizedState,r)},useTransition:function(){var r=rh(Ha)[0],s=bn().memoizedState;return[r,s]},useMutableSource:jm,useSyncExternalStore:Om,useId:Xm,unstable_isNewReconciler:!1},c1={readContext:kn,useCallback:Km,useContext:kn,useEffect:sh,useImperativeHandle:Wm,useInsertionEffect:Hm,useLayoutEffect:qm,useMemo:Qm,useReducer:ih,useRef:zm,useState:function(){return ih(Ha)},useDebugValue:oh,useDeferredValue:function(r){var s=bn();return xt===null?s.memoizedState=r:Ym(s,xt.memoizedState,r)},useTransition:function(){var r=ih(Ha)[0],s=bn().memoizedState;return[r,s]},useMutableSource:jm,useSyncExternalStore:Om,useId:Xm,unstable_isNewReconciler:!1};function Yn(r,s){if(r&&r.defaultProps){s=le({},s),r=r.defaultProps;for(var l in r)s[l]===void 0&&(s[l]=r[l]);return s}return s}function ah(r,s,l,h){s=r.memoizedState,l=l(h,s),l=l==null?s:le({},s,l),r.memoizedState=l,r.lanes===0&&(r.updateQueue.baseState=l)}var Vc={isMounted:function(r){return(r=r._reactInternals)?Bn(r)===r:!1},enqueueSetState:function(r,s,l){r=r._reactInternals;var h=nn(),g=Ii(r),_=$r(h,g);_.payload=s,l!=null&&(_.callback=l),s=wi(r,_,g),s!==null&&(Zn(s,r,g,h),bc(s,r,g))},enqueueReplaceState:function(r,s,l){r=r._reactInternals;var h=nn(),g=Ii(r),_=$r(h,g);_.tag=1,_.payload=s,l!=null&&(_.callback=l),s=wi(r,_,g),s!==null&&(Zn(s,r,g,h),bc(s,r,g))},enqueueForceUpdate:function(r,s){r=r._reactInternals;var l=nn(),h=Ii(r),g=$r(l,h);g.tag=2,s!=null&&(g.callback=s),s=wi(r,g,h),s!==null&&(Zn(s,r,h,l),bc(s,r,h))}};function tg(r,s,l,h,g,_,I){return r=r.stateNode,typeof r.shouldComponentUpdate=="function"?r.shouldComponentUpdate(h,_,I):s.prototype&&s.prototype.isPureReactComponent?!Na(l,h)||!Na(g,_):!0}function ng(r,s,l){var h=!1,g=vi,_=s.contextType;return typeof _=="object"&&_!==null?_=kn(_):(g=ln(s)?fs:qt.current,h=s.contextTypes,_=(h=h!=null)?mo(r,g):vi),s=new s(l,_),r.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,s.updater=Vc,r.stateNode=s,s._reactInternals=r,h&&(r=r.stateNode,r.__reactInternalMemoizedUnmaskedChildContext=g,r.__reactInternalMemoizedMaskedChildContext=_),s}function rg(r,s,l,h){r=s.state,typeof s.componentWillReceiveProps=="function"&&s.componentWillReceiveProps(l,h),typeof s.UNSAFE_componentWillReceiveProps=="function"&&s.UNSAFE_componentWillReceiveProps(l,h),s.state!==r&&Vc.enqueueReplaceState(s,s.state,null)}function lh(r,s,l,h){var g=r.stateNode;g.props=l,g.state=r.memoizedState,g.refs={},Kd(r);var _=s.contextType;typeof _=="object"&&_!==null?g.context=kn(_):(_=ln(s)?fs:qt.current,g.context=mo(r,_)),g.state=r.memoizedState,_=s.getDerivedStateFromProps,typeof _=="function"&&(ah(r,s,_,l),g.state=r.memoizedState),typeof s.getDerivedStateFromProps=="function"||typeof g.getSnapshotBeforeUpdate=="function"||typeof g.UNSAFE_componentWillMount!="function"&&typeof g.componentWillMount!="function"||(s=g.state,typeof g.componentWillMount=="function"&&g.componentWillMount(),typeof g.UNSAFE_componentWillMount=="function"&&g.UNSAFE_componentWillMount(),s!==g.state&&Vc.enqueueReplaceState(g,g.state,null),Nc(r,l,g,h),g.state=r.memoizedState),typeof g.componentDidMount=="function"&&(r.flags|=4194308)}function So(r,s){try{var l="",h=s;do l+=se(h),h=h.return;while(h);var g=l}catch(_){g=`
Error generating stack: `+_.message+`
`+_.stack}return{value:r,source:s,stack:g,digest:null}}function ch(r,s,l){return{value:r,source:null,stack:l??null,digest:s??null}}function uh(r,s){try{console.error(s.value)}catch(l){setTimeout(function(){throw l})}}var u1=typeof WeakMap=="function"?WeakMap:Map;function ig(r,s,l){l=$r(-1,l),l.tag=3,l.payload={element:null};var h=s.value;return l.callback=function(){qc||(qc=!0,Ih=h),uh(r,s)},l}function sg(r,s,l){l=$r(-1,l),l.tag=3;var h=r.type.getDerivedStateFromError;if(typeof h=="function"){var g=s.value;l.payload=function(){return h(g)},l.callback=function(){uh(r,s)}}var _=r.stateNode;return _!==null&&typeof _.componentDidCatch=="function"&&(l.callback=function(){uh(r,s),typeof h!="function"&&(Si===null?Si=new Set([this]):Si.add(this));var I=s.stack;this.componentDidCatch(s.value,{componentStack:I!==null?I:""})}),l}function og(r,s,l){var h=r.pingCache;if(h===null){h=r.pingCache=new u1;var g=new Set;h.set(s,g)}else g=h.get(s),g===void 0&&(g=new Set,h.set(s,g));g.has(l)||(g.add(l),r=x1.bind(null,r,s,l),s.then(r,r))}function ag(r){do{var s;if((s=r.tag===13)&&(s=r.memoizedState,s=s!==null?s.dehydrated!==null:!0),s)return r;r=r.return}while(r!==null);return null}function lg(r,s,l,h,g){return r.mode&1?(r.flags|=65536,r.lanes=g,r):(r===s?r.flags|=65536:(r.flags|=128,l.flags|=131072,l.flags&=-52805,l.tag===1&&(l.alternate===null?l.tag=17:(s=$r(-1,1),s.tag=2,wi(l,s,1))),l.lanes|=1),r)}var d1=J.ReactCurrentOwner,cn=!1;function tn(r,s,l,h){s.child=r===null?Cm(s,null,l,h):_o(s,r.child,l,h)}function cg(r,s,l,h,g){l=l.render;var _=s.ref;return wo(s,g),h=th(r,s,l,h,_,g),l=nh(),r!==null&&!cn?(s.updateQueue=r.updateQueue,s.flags&=-2053,r.lanes&=~g,Hr(r,s,g)):(it&&l&&Vd(s),s.flags|=1,tn(r,s,h,g),s.child)}function ug(r,s,l,h,g){if(r===null){var _=l.type;return typeof _=="function"&&!Ph(_)&&_.defaultProps===void 0&&l.compare===null&&l.defaultProps===void 0?(s.tag=15,s.type=_,dg(r,s,_,h,g)):(r=Xc(l.type,null,h,s,s.mode,g),r.ref=s.ref,r.return=s,s.child=r)}if(_=r.child,!(r.lanes&g)){var I=_.memoizedProps;if(l=l.compare,l=l!==null?l:Na,l(I,h)&&r.ref===s.ref)return Hr(r,s,g)}return s.flags|=1,r=Ai(_,h),r.ref=s.ref,r.return=s,s.child=r}function dg(r,s,l,h,g){if(r!==null){var _=r.memoizedProps;if(Na(_,h)&&r.ref===s.ref)if(cn=!1,s.pendingProps=h=_,(r.lanes&g)!==0)r.flags&131072&&(cn=!0);else return s.lanes=r.lanes,Hr(r,s,g)}return dh(r,s,l,h,g)}function hg(r,s,l){var h=s.pendingProps,g=h.children,_=r!==null?r.memoizedState:null;if(h.mode==="hidden")if(!(s.mode&1))s.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ze(Io,wn),wn|=l;else{if(!(l&1073741824))return r=_!==null?_.baseLanes|l:l,s.lanes=s.childLanes=1073741824,s.memoizedState={baseLanes:r,cachePool:null,transitions:null},s.updateQueue=null,Ze(Io,wn),wn|=r,null;s.memoizedState={baseLanes:0,cachePool:null,transitions:null},h=_!==null?_.baseLanes:l,Ze(Io,wn),wn|=h}else _!==null?(h=_.baseLanes|l,s.memoizedState=null):h=l,Ze(Io,wn),wn|=h;return tn(r,s,g,l),s.child}function fg(r,s){var l=s.ref;(r===null&&l!==null||r!==null&&r.ref!==l)&&(s.flags|=512,s.flags|=2097152)}function dh(r,s,l,h,g){var _=ln(l)?fs:qt.current;return _=mo(s,_),wo(s,g),l=th(r,s,l,h,_,g),h=nh(),r!==null&&!cn?(s.updateQueue=r.updateQueue,s.flags&=-2053,r.lanes&=~g,Hr(r,s,g)):(it&&h&&Vd(s),s.flags|=1,tn(r,s,l,g),s.child)}function pg(r,s,l,h,g){if(ln(l)){var _=!0;Tc(s)}else _=!1;if(wo(s,g),s.stateNode===null)Uc(r,s),ng(s,l,h),lh(s,l,h,g),h=!0;else if(r===null){var I=s.stateNode,L=s.memoizedProps;I.props=L;var F=I.context,K=l.contextType;typeof K=="object"&&K!==null?K=kn(K):(K=ln(l)?fs:qt.current,K=mo(s,K));var ne=l.getDerivedStateFromProps,ie=typeof ne=="function"||typeof I.getSnapshotBeforeUpdate=="function";ie||typeof I.UNSAFE_componentWillReceiveProps!="function"&&typeof I.componentWillReceiveProps!="function"||(L!==h||F!==K)&&rg(s,I,h,K),Ei=!1;var te=s.memoizedState;I.state=te,Nc(s,h,I,g),F=s.memoizedState,L!==h||te!==F||an.current||Ei?(typeof ne=="function"&&(ah(s,l,ne,h),F=s.memoizedState),(L=Ei||tg(s,l,L,h,te,F,K))?(ie||typeof I.UNSAFE_componentWillMount!="function"&&typeof I.componentWillMount!="function"||(typeof I.componentWillMount=="function"&&I.componentWillMount(),typeof I.UNSAFE_componentWillMount=="function"&&I.UNSAFE_componentWillMount()),typeof I.componentDidMount=="function"&&(s.flags|=4194308)):(typeof I.componentDidMount=="function"&&(s.flags|=4194308),s.memoizedProps=h,s.memoizedState=F),I.props=h,I.state=F,I.context=K,h=L):(typeof I.componentDidMount=="function"&&(s.flags|=4194308),h=!1)}else{I=s.stateNode,bm(r,s),L=s.memoizedProps,K=s.type===s.elementType?L:Yn(s.type,L),I.props=K,ie=s.pendingProps,te=I.context,F=l.contextType,typeof F=="object"&&F!==null?F=kn(F):(F=ln(l)?fs:qt.current,F=mo(s,F));var ge=l.getDerivedStateFromProps;(ne=typeof ge=="function"||typeof I.getSnapshotBeforeUpdate=="function")||typeof I.UNSAFE_componentWillReceiveProps!="function"&&typeof I.componentWillReceiveProps!="function"||(L!==ie||te!==F)&&rg(s,I,h,F),Ei=!1,te=s.memoizedState,I.state=te,Nc(s,h,I,g);var Ee=s.memoizedState;L!==ie||te!==Ee||an.current||Ei?(typeof ge=="function"&&(ah(s,l,ge,h),Ee=s.memoizedState),(K=Ei||tg(s,l,K,h,te,Ee,F)||!1)?(ne||typeof I.UNSAFE_componentWillUpdate!="function"&&typeof I.componentWillUpdate!="function"||(typeof I.componentWillUpdate=="function"&&I.componentWillUpdate(h,Ee,F),typeof I.UNSAFE_componentWillUpdate=="function"&&I.UNSAFE_componentWillUpdate(h,Ee,F)),typeof I.componentDidUpdate=="function"&&(s.flags|=4),typeof I.getSnapshotBeforeUpdate=="function"&&(s.flags|=1024)):(typeof I.componentDidUpdate!="function"||L===r.memoizedProps&&te===r.memoizedState||(s.flags|=4),typeof I.getSnapshotBeforeUpdate!="function"||L===r.memoizedProps&&te===r.memoizedState||(s.flags|=1024),s.memoizedProps=h,s.memoizedState=Ee),I.props=h,I.state=Ee,I.context=F,h=K):(typeof I.componentDidUpdate!="function"||L===r.memoizedProps&&te===r.memoizedState||(s.flags|=4),typeof I.getSnapshotBeforeUpdate!="function"||L===r.memoizedProps&&te===r.memoizedState||(s.flags|=1024),h=!1)}return hh(r,s,l,h,_,g)}function hh(r,s,l,h,g,_){fg(r,s);var I=(s.flags&128)!==0;if(!h&&!I)return g&&_m(s,l,!1),Hr(r,s,_);h=s.stateNode,d1.current=s;var L=I&&typeof l.getDerivedStateFromError!="function"?null:h.render();return s.flags|=1,r!==null&&I?(s.child=_o(s,r.child,null,_),s.child=_o(s,null,L,_)):tn(r,s,L,_),s.memoizedState=h.state,g&&_m(s,l,!0),s.child}function mg(r){var s=r.stateNode;s.pendingContext?ym(r,s.pendingContext,s.pendingContext!==s.context):s.context&&ym(r,s.context,!1),Qd(r,s.containerInfo)}function gg(r,s,l,h,g){return vo(),zd(g),s.flags|=256,tn(r,s,l,h),s.child}var fh={dehydrated:null,treeContext:null,retryLane:0};function ph(r){return{baseLanes:r,cachePool:null,transitions:null}}function yg(r,s,l){var h=s.pendingProps,g=ot.current,_=!1,I=(s.flags&128)!==0,L;if((L=I)||(L=r!==null&&r.memoizedState===null?!1:(g&2)!==0),L?(_=!0,s.flags&=-129):(r===null||r.memoizedState!==null)&&(g|=1),Ze(ot,g&1),r===null)return Bd(s),r=s.memoizedState,r!==null&&(r=r.dehydrated,r!==null)?(s.mode&1?r.data==="$!"?s.lanes=8:s.lanes=1073741824:s.lanes=1,null):(I=h.children,r=h.fallback,_?(h=s.mode,_=s.child,I={mode:"hidden",children:I},!(h&1)&&_!==null?(_.childLanes=0,_.pendingProps=I):_=Jc(I,h,0,null),r=Ss(r,h,l,null),_.return=s,r.return=s,_.sibling=r,s.child=_,s.child.memoizedState=ph(l),s.memoizedState=fh,r):mh(s,I));if(g=r.memoizedState,g!==null&&(L=g.dehydrated,L!==null))return h1(r,s,I,h,L,g,l);if(_){_=h.fallback,I=s.mode,g=r.child,L=g.sibling;var F={mode:"hidden",children:h.children};return!(I&1)&&s.child!==g?(h=s.child,h.childLanes=0,h.pendingProps=F,s.deletions=null):(h=Ai(g,F),h.subtreeFlags=g.subtreeFlags&14680064),L!==null?_=Ai(L,_):(_=Ss(_,I,l,null),_.flags|=2),_.return=s,h.return=s,h.sibling=_,s.child=h,h=_,_=s.child,I=r.child.memoizedState,I=I===null?ph(l):{baseLanes:I.baseLanes|l,cachePool:null,transitions:I.transitions},_.memoizedState=I,_.childLanes=r.childLanes&~l,s.memoizedState=fh,h}return _=r.child,r=_.sibling,h=Ai(_,{mode:"visible",children:h.children}),!(s.mode&1)&&(h.lanes=l),h.return=s,h.sibling=null,r!==null&&(l=s.deletions,l===null?(s.deletions=[r],s.flags|=16):l.push(r)),s.child=h,s.memoizedState=null,h}function mh(r,s){return s=Jc({mode:"visible",children:s},r.mode,0,null),s.return=r,r.child=s}function Fc(r,s,l,h){return h!==null&&zd(h),_o(s,r.child,null,l),r=mh(s,s.pendingProps.children),r.flags|=2,s.memoizedState=null,r}function h1(r,s,l,h,g,_,I){if(l)return s.flags&256?(s.flags&=-257,h=ch(Error(t(422))),Fc(r,s,I,h)):s.memoizedState!==null?(s.child=r.child,s.flags|=128,null):(_=h.fallback,g=s.mode,h=Jc({mode:"visible",children:h.children},g,0,null),_=Ss(_,g,I,null),_.flags|=2,h.return=s,_.return=s,h.sibling=_,s.child=h,s.mode&1&&_o(s,r.child,null,I),s.child.memoizedState=ph(I),s.memoizedState=fh,_);if(!(s.mode&1))return Fc(r,s,I,null);if(g.data==="$!"){if(h=g.nextSibling&&g.nextSibling.dataset,h)var L=h.dgst;return h=L,_=Error(t(419)),h=ch(_,h,void 0),Fc(r,s,I,h)}if(L=(I&r.childLanes)!==0,cn||L){if(h=Dt,h!==null){switch(I&-I){case 4:g=2;break;case 16:g=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:g=32;break;case 536870912:g=268435456;break;default:g=0}g=g&(h.suspendedLanes|I)?0:g,g!==0&&g!==_.retryLane&&(_.retryLane=g,zr(r,g),Zn(h,r,g,-1))}return Nh(),h=ch(Error(t(421))),Fc(r,s,I,h)}return g.data==="$?"?(s.flags|=128,s.child=r.child,s=I1.bind(null,r),g._reactRetry=s,null):(r=_.treeContext,En=gi(g.nextSibling),_n=s,it=!0,Qn=null,r!==null&&(An[Cn++]=Ur,An[Cn++]=Br,An[Cn++]=ps,Ur=r.id,Br=r.overflow,ps=s),s=mh(s,h.children),s.flags|=4096,s)}function vg(r,s,l){r.lanes|=s;var h=r.alternate;h!==null&&(h.lanes|=s),Gd(r.return,s,l)}function gh(r,s,l,h,g){var _=r.memoizedState;_===null?r.memoizedState={isBackwards:s,rendering:null,renderingStartTime:0,last:h,tail:l,tailMode:g}:(_.isBackwards=s,_.rendering=null,_.renderingStartTime=0,_.last=h,_.tail=l,_.tailMode=g)}function _g(r,s,l){var h=s.pendingProps,g=h.revealOrder,_=h.tail;if(tn(r,s,h.children,l),h=ot.current,h&2)h=h&1|2,s.flags|=128;else{if(r!==null&&r.flags&128)e:for(r=s.child;r!==null;){if(r.tag===13)r.memoizedState!==null&&vg(r,l,s);else if(r.tag===19)vg(r,l,s);else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===s)break e;for(;r.sibling===null;){if(r.return===null||r.return===s)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}h&=1}if(Ze(ot,h),!(s.mode&1))s.memoizedState=null;else switch(g){case"forwards":for(l=s.child,g=null;l!==null;)r=l.alternate,r!==null&&Pc(r)===null&&(g=l),l=l.sibling;l=g,l===null?(g=s.child,s.child=null):(g=l.sibling,l.sibling=null),gh(s,!1,g,l,_);break;case"backwards":for(l=null,g=s.child,s.child=null;g!==null;){if(r=g.alternate,r!==null&&Pc(r)===null){s.child=g;break}r=g.sibling,g.sibling=l,l=g,g=r}gh(s,!0,l,null,_);break;case"together":gh(s,!1,null,null,void 0);break;default:s.memoizedState=null}return s.child}function Uc(r,s){!(s.mode&1)&&r!==null&&(r.alternate=null,s.alternate=null,s.flags|=2)}function Hr(r,s,l){if(r!==null&&(s.dependencies=r.dependencies),_s|=s.lanes,!(l&s.childLanes))return null;if(r!==null&&s.child!==r.child)throw Error(t(153));if(s.child!==null){for(r=s.child,l=Ai(r,r.pendingProps),s.child=l,l.return=s;r.sibling!==null;)r=r.sibling,l=l.sibling=Ai(r,r.pendingProps),l.return=s;l.sibling=null}return s.child}function f1(r,s,l){switch(s.tag){case 3:mg(s),vo();break;case 5:Dm(s);break;case 1:ln(s.type)&&Tc(s);break;case 4:Qd(s,s.stateNode.containerInfo);break;case 10:var h=s.type._context,g=s.memoizedProps.value;Ze(Cc,h._currentValue),h._currentValue=g;break;case 13:if(h=s.memoizedState,h!==null)return h.dehydrated!==null?(Ze(ot,ot.current&1),s.flags|=128,null):l&s.child.childLanes?yg(r,s,l):(Ze(ot,ot.current&1),r=Hr(r,s,l),r!==null?r.sibling:null);Ze(ot,ot.current&1);break;case 19:if(h=(l&s.childLanes)!==0,r.flags&128){if(h)return _g(r,s,l);s.flags|=128}if(g=s.memoizedState,g!==null&&(g.rendering=null,g.tail=null,g.lastEffect=null),Ze(ot,ot.current),h)break;return null;case 22:case 23:return s.lanes=0,hg(r,s,l)}return Hr(r,s,l)}var Eg,yh,wg,Tg;Eg=function(r,s){for(var l=s.child;l!==null;){if(l.tag===5||l.tag===6)r.appendChild(l.stateNode);else if(l.tag!==4&&l.child!==null){l.child.return=l,l=l.child;continue}if(l===s)break;for(;l.sibling===null;){if(l.return===null||l.return===s)return;l=l.return}l.sibling.return=l.return,l=l.sibling}},yh=function(){},wg=function(r,s,l,h){var g=r.memoizedProps;if(g!==h){r=s.stateNode,ys(fr.current);var _=null;switch(l){case"input":g=st(r,g),h=st(r,h),_=[];break;case"select":g=le({},g,{value:void 0}),h=le({},h,{value:void 0}),_=[];break;case"textarea":g=oa(r,g),h=oa(r,h),_=[];break;default:typeof g.onClick!="function"&&typeof h.onClick=="function"&&(r.onclick=_c)}ha(l,h);var I;l=null;for(K in g)if(!h.hasOwnProperty(K)&&g.hasOwnProperty(K)&&g[K]!=null)if(K==="style"){var L=g[K];for(I in L)L.hasOwnProperty(I)&&(l||(l={}),l[I]="")}else K!=="dangerouslySetInnerHTML"&&K!=="children"&&K!=="suppressContentEditableWarning"&&K!=="suppressHydrationWarning"&&K!=="autoFocus"&&(o.hasOwnProperty(K)?_||(_=[]):(_=_||[]).push(K,null));for(K in h){var F=h[K];if(L=g!=null?g[K]:void 0,h.hasOwnProperty(K)&&F!==L&&(F!=null||L!=null))if(K==="style")if(L){for(I in L)!L.hasOwnProperty(I)||F&&F.hasOwnProperty(I)||(l||(l={}),l[I]="");for(I in F)F.hasOwnProperty(I)&&L[I]!==F[I]&&(l||(l={}),l[I]=F[I])}else l||(_||(_=[]),_.push(K,l)),l=F;else K==="dangerouslySetInnerHTML"?(F=F?F.__html:void 0,L=L?L.__html:void 0,F!=null&&L!==F&&(_=_||[]).push(K,F)):K==="children"?typeof F!="string"&&typeof F!="number"||(_=_||[]).push(K,""+F):K!=="suppressContentEditableWarning"&&K!=="suppressHydrationWarning"&&(o.hasOwnProperty(K)?(F!=null&&K==="onScroll"&&tt("scroll",r),_||L===F||(_=[])):(_=_||[]).push(K,F))}l&&(_=_||[]).push("style",l);var K=_;(s.updateQueue=K)&&(s.flags|=4)}},Tg=function(r,s,l,h){l!==h&&(s.flags|=4)};function Ga(r,s){if(!it)switch(r.tailMode){case"hidden":s=r.tail;for(var l=null;s!==null;)s.alternate!==null&&(l=s),s=s.sibling;l===null?r.tail=null:l.sibling=null;break;case"collapsed":l=r.tail;for(var h=null;l!==null;)l.alternate!==null&&(h=l),l=l.sibling;h===null?s||r.tail===null?r.tail=null:r.tail.sibling=null:h.sibling=null}}function Wt(r){var s=r.alternate!==null&&r.alternate.child===r.child,l=0,h=0;if(s)for(var g=r.child;g!==null;)l|=g.lanes|g.childLanes,h|=g.subtreeFlags&14680064,h|=g.flags&14680064,g.return=r,g=g.sibling;else for(g=r.child;g!==null;)l|=g.lanes|g.childLanes,h|=g.subtreeFlags,h|=g.flags,g.return=r,g=g.sibling;return r.subtreeFlags|=h,r.childLanes=l,s}function p1(r,s,l){var h=s.pendingProps;switch(Fd(s),s.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Wt(s),null;case 1:return ln(s.type)&&wc(),Wt(s),null;case 3:return h=s.stateNode,To(),nt(an),nt(qt),Jd(),h.pendingContext&&(h.context=h.pendingContext,h.pendingContext=null),(r===null||r.child===null)&&(Rc(s)?s.flags|=4:r===null||r.memoizedState.isDehydrated&&!(s.flags&256)||(s.flags|=1024,Qn!==null&&(Ch(Qn),Qn=null))),yh(r,s),Wt(s),null;case 5:Yd(s);var g=ys(Ba.current);if(l=s.type,r!==null&&s.stateNode!=null)wg(r,s,l,h,g),r.ref!==s.ref&&(s.flags|=512,s.flags|=2097152);else{if(!h){if(s.stateNode===null)throw Error(t(166));return Wt(s),null}if(r=ys(fr.current),Rc(s)){h=s.stateNode,l=s.type;var _=s.memoizedProps;switch(h[hr]=s,h[La]=_,r=(s.mode&1)!==0,l){case"dialog":tt("cancel",h),tt("close",h);break;case"iframe":case"object":case"embed":tt("load",h);break;case"video":case"audio":for(g=0;g<Da.length;g++)tt(Da[g],h);break;case"source":tt("error",h);break;case"img":case"image":case"link":tt("error",h),tt("load",h);break;case"details":tt("toggle",h);break;case"input":bt(h,_),tt("invalid",h);break;case"select":h._wrapperState={wasMultiple:!!_.multiple},tt("invalid",h);break;case"textarea":Vs(h,_),tt("invalid",h)}ha(l,_),g=null;for(var I in _)if(_.hasOwnProperty(I)){var L=_[I];I==="children"?typeof L=="string"?h.textContent!==L&&(_.suppressHydrationWarning!==!0&&vc(h.textContent,L,r),g=["children",L]):typeof L=="number"&&h.textContent!==""+L&&(_.suppressHydrationWarning!==!0&&vc(h.textContent,L,r),g=["children",""+L]):o.hasOwnProperty(I)&&L!=null&&I==="onScroll"&&tt("scroll",h)}switch(l){case"input":Qe(h),Hl(h,_,!0);break;case"textarea":Qe(h),aa(h);break;case"select":case"option":break;default:typeof _.onClick=="function"&&(h.onclick=_c)}h=g,s.updateQueue=h,h!==null&&(s.flags|=4)}else{I=g.nodeType===9?g:g.ownerDocument,r==="http://www.w3.org/1999/xhtml"&&(r=wt(l)),r==="http://www.w3.org/1999/xhtml"?l==="script"?(r=I.createElement("div"),r.innerHTML="<script><\/script>",r=r.removeChild(r.firstChild)):typeof h.is=="string"?r=I.createElement(l,{is:h.is}):(r=I.createElement(l),l==="select"&&(I=r,h.multiple?I.multiple=!0:h.size&&(I.size=h.size))):r=I.createElementNS(r,l),r[hr]=s,r[La]=h,Eg(r,s,!1,!1),s.stateNode=r;e:{switch(I=fa(l,h),l){case"dialog":tt("cancel",r),tt("close",r),g=h;break;case"iframe":case"object":case"embed":tt("load",r),g=h;break;case"video":case"audio":for(g=0;g<Da.length;g++)tt(Da[g],r);g=h;break;case"source":tt("error",r),g=h;break;case"img":case"image":case"link":tt("error",r),tt("load",r),g=h;break;case"details":tt("toggle",r),g=h;break;case"input":bt(r,h),g=st(r,h),tt("invalid",r);break;case"option":g=h;break;case"select":r._wrapperState={wasMultiple:!!h.multiple},g=le({},h,{value:void 0}),tt("invalid",r);break;case"textarea":Vs(r,h),g=oa(r,h),tt("invalid",r);break;default:g=h}ha(l,g),L=g;for(_ in L)if(L.hasOwnProperty(_)){var F=L[_];_==="style"?ua(r,F):_==="dangerouslySetInnerHTML"?(F=F?F.__html:void 0,F!=null&&la(r,F)):_==="children"?typeof F=="string"?(l!=="textarea"||F!=="")&&si(r,F):typeof F=="number"&&si(r,""+F):_!=="suppressContentEditableWarning"&&_!=="suppressHydrationWarning"&&_!=="autoFocus"&&(o.hasOwnProperty(_)?F!=null&&_==="onScroll"&&tt("scroll",r):F!=null&&q(r,_,F,I))}switch(l){case"input":Qe(r),Hl(r,h,!1);break;case"textarea":Qe(r),aa(r);break;case"option":h.value!=null&&r.setAttribute("value",""+_e(h.value));break;case"select":r.multiple=!!h.multiple,_=h.value,_!=null?br(r,!!h.multiple,_,!1):h.defaultValue!=null&&br(r,!!h.multiple,h.defaultValue,!0);break;default:typeof g.onClick=="function"&&(r.onclick=_c)}switch(l){case"button":case"input":case"select":case"textarea":h=!!h.autoFocus;break e;case"img":h=!0;break e;default:h=!1}}h&&(s.flags|=4)}s.ref!==null&&(s.flags|=512,s.flags|=2097152)}return Wt(s),null;case 6:if(r&&s.stateNode!=null)Tg(r,s,r.memoizedProps,h);else{if(typeof h!="string"&&s.stateNode===null)throw Error(t(166));if(l=ys(Ba.current),ys(fr.current),Rc(s)){if(h=s.stateNode,l=s.memoizedProps,h[hr]=s,(_=h.nodeValue!==l)&&(r=_n,r!==null))switch(r.tag){case 3:vc(h.nodeValue,l,(r.mode&1)!==0);break;case 5:r.memoizedProps.suppressHydrationWarning!==!0&&vc(h.nodeValue,l,(r.mode&1)!==0)}_&&(s.flags|=4)}else h=(l.nodeType===9?l:l.ownerDocument).createTextNode(h),h[hr]=s,s.stateNode=h}return Wt(s),null;case 13:if(nt(ot),h=s.memoizedState,r===null||r.memoizedState!==null&&r.memoizedState.dehydrated!==null){if(it&&En!==null&&s.mode&1&&!(s.flags&128))Im(),vo(),s.flags|=98560,_=!1;else if(_=Rc(s),h!==null&&h.dehydrated!==null){if(r===null){if(!_)throw Error(t(318));if(_=s.memoizedState,_=_!==null?_.dehydrated:null,!_)throw Error(t(317));_[hr]=s}else vo(),!(s.flags&128)&&(s.memoizedState=null),s.flags|=4;Wt(s),_=!1}else Qn!==null&&(Ch(Qn),Qn=null),_=!0;if(!_)return s.flags&65536?s:null}return s.flags&128?(s.lanes=l,s):(h=h!==null,h!==(r!==null&&r.memoizedState!==null)&&h&&(s.child.flags|=8192,s.mode&1&&(r===null||ot.current&1?It===0&&(It=3):Nh())),s.updateQueue!==null&&(s.flags|=4),Wt(s),null);case 4:return To(),yh(r,s),r===null&&ja(s.stateNode.containerInfo),Wt(s),null;case 10:return qd(s.type._context),Wt(s),null;case 17:return ln(s.type)&&wc(),Wt(s),null;case 19:if(nt(ot),_=s.memoizedState,_===null)return Wt(s),null;if(h=(s.flags&128)!==0,I=_.rendering,I===null)if(h)Ga(_,!1);else{if(It!==0||r!==null&&r.flags&128)for(r=s.child;r!==null;){if(I=Pc(r),I!==null){for(s.flags|=128,Ga(_,!1),h=I.updateQueue,h!==null&&(s.updateQueue=h,s.flags|=4),s.subtreeFlags=0,h=l,l=s.child;l!==null;)_=l,r=h,_.flags&=14680066,I=_.alternate,I===null?(_.childLanes=0,_.lanes=r,_.child=null,_.subtreeFlags=0,_.memoizedProps=null,_.memoizedState=null,_.updateQueue=null,_.dependencies=null,_.stateNode=null):(_.childLanes=I.childLanes,_.lanes=I.lanes,_.child=I.child,_.subtreeFlags=0,_.deletions=null,_.memoizedProps=I.memoizedProps,_.memoizedState=I.memoizedState,_.updateQueue=I.updateQueue,_.type=I.type,r=I.dependencies,_.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext}),l=l.sibling;return Ze(ot,ot.current&1|2),s.child}r=r.sibling}_.tail!==null&&Je()>Ro&&(s.flags|=128,h=!0,Ga(_,!1),s.lanes=4194304)}else{if(!h)if(r=Pc(I),r!==null){if(s.flags|=128,h=!0,l=r.updateQueue,l!==null&&(s.updateQueue=l,s.flags|=4),Ga(_,!0),_.tail===null&&_.tailMode==="hidden"&&!I.alternate&&!it)return Wt(s),null}else 2*Je()-_.renderingStartTime>Ro&&l!==1073741824&&(s.flags|=128,h=!0,Ga(_,!1),s.lanes=4194304);_.isBackwards?(I.sibling=s.child,s.child=I):(l=_.last,l!==null?l.sibling=I:s.child=I,_.last=I)}return _.tail!==null?(s=_.tail,_.rendering=s,_.tail=s.sibling,_.renderingStartTime=Je(),s.sibling=null,l=ot.current,Ze(ot,h?l&1|2:l&1),s):(Wt(s),null);case 22:case 23:return bh(),h=s.memoizedState!==null,r!==null&&r.memoizedState!==null!==h&&(s.flags|=8192),h&&s.mode&1?wn&1073741824&&(Wt(s),s.subtreeFlags&6&&(s.flags|=8192)):Wt(s),null;case 24:return null;case 25:return null}throw Error(t(156,s.tag))}function m1(r,s){switch(Fd(s),s.tag){case 1:return ln(s.type)&&wc(),r=s.flags,r&65536?(s.flags=r&-65537|128,s):null;case 3:return To(),nt(an),nt(qt),Jd(),r=s.flags,r&65536&&!(r&128)?(s.flags=r&-65537|128,s):null;case 5:return Yd(s),null;case 13:if(nt(ot),r=s.memoizedState,r!==null&&r.dehydrated!==null){if(s.alternate===null)throw Error(t(340));vo()}return r=s.flags,r&65536?(s.flags=r&-65537|128,s):null;case 19:return nt(ot),null;case 4:return To(),null;case 10:return qd(s.type._context),null;case 22:case 23:return bh(),null;case 24:return null;default:return null}}var Bc=!1,Kt=!1,g1=typeof WeakSet=="function"?WeakSet:Set,ve=null;function xo(r,s){var l=r.ref;if(l!==null)if(typeof l=="function")try{l(null)}catch(h){dt(r,s,h)}else l.current=null}function vh(r,s,l){try{l()}catch(h){dt(r,s,h)}}var Sg=!1;function y1(r,s){if(bd=fi,r=tm(),Td(r)){if("selectionStart"in r)var l={start:r.selectionStart,end:r.selectionEnd};else e:{l=(l=r.ownerDocument)&&l.defaultView||window;var h=l.getSelection&&l.getSelection();if(h&&h.rangeCount!==0){l=h.anchorNode;var g=h.anchorOffset,_=h.focusNode;h=h.focusOffset;try{l.nodeType,_.nodeType}catch{l=null;break e}var I=0,L=-1,F=-1,K=0,ne=0,ie=r,te=null;t:for(;;){for(var ge;ie!==l||g!==0&&ie.nodeType!==3||(L=I+g),ie!==_||h!==0&&ie.nodeType!==3||(F=I+h),ie.nodeType===3&&(I+=ie.nodeValue.length),(ge=ie.firstChild)!==null;)te=ie,ie=ge;for(;;){if(ie===r)break t;if(te===l&&++K===g&&(L=I),te===_&&++ne===h&&(F=I),(ge=ie.nextSibling)!==null)break;ie=te,te=ie.parentNode}ie=ge}l=L===-1||F===-1?null:{start:L,end:F}}else l=null}l=l||{start:0,end:0}}else l=null;for(Nd={focusedElem:r,selectionRange:l},fi=!1,ve=s;ve!==null;)if(s=ve,r=s.child,(s.subtreeFlags&1028)!==0&&r!==null)r.return=s,ve=r;else for(;ve!==null;){s=ve;try{var Ee=s.alternate;if(s.flags&1024)switch(s.tag){case 0:case 11:case 15:break;case 1:if(Ee!==null){var we=Ee.memoizedProps,mt=Ee.memoizedState,H=s.stateNode,B=H.getSnapshotBeforeUpdate(s.elementType===s.type?we:Yn(s.type,we),mt);H.__reactInternalSnapshotBeforeUpdate=B}break;case 3:var G=s.stateNode.containerInfo;G.nodeType===1?G.textContent="":G.nodeType===9&&G.documentElement&&G.removeChild(G.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(ce){dt(s,s.return,ce)}if(r=s.sibling,r!==null){r.return=s.return,ve=r;break}ve=s.return}return Ee=Sg,Sg=!1,Ee}function Wa(r,s,l){var h=s.updateQueue;if(h=h!==null?h.lastEffect:null,h!==null){var g=h=h.next;do{if((g.tag&r)===r){var _=g.destroy;g.destroy=void 0,_!==void 0&&vh(s,l,_)}g=g.next}while(g!==h)}}function zc(r,s){if(s=s.updateQueue,s=s!==null?s.lastEffect:null,s!==null){var l=s=s.next;do{if((l.tag&r)===r){var h=l.create;l.destroy=h()}l=l.next}while(l!==s)}}function _h(r){var s=r.ref;if(s!==null){var l=r.stateNode;switch(r.tag){case 5:r=l;break;default:r=l}typeof s=="function"?s(r):s.current=r}}function xg(r){var s=r.alternate;s!==null&&(r.alternate=null,xg(s)),r.child=null,r.deletions=null,r.sibling=null,r.tag===5&&(s=r.stateNode,s!==null&&(delete s[hr],delete s[La],delete s[Od],delete s[ZE],delete s[e1])),r.stateNode=null,r.return=null,r.dependencies=null,r.memoizedProps=null,r.memoizedState=null,r.pendingProps=null,r.stateNode=null,r.updateQueue=null}function Ig(r){return r.tag===5||r.tag===3||r.tag===4}function Rg(r){e:for(;;){for(;r.sibling===null;){if(r.return===null||Ig(r.return))return null;r=r.return}for(r.sibling.return=r.return,r=r.sibling;r.tag!==5&&r.tag!==6&&r.tag!==18;){if(r.flags&2||r.child===null||r.tag===4)continue e;r.child.return=r,r=r.child}if(!(r.flags&2))return r.stateNode}}function Eh(r,s,l){var h=r.tag;if(h===5||h===6)r=r.stateNode,s?l.nodeType===8?l.parentNode.insertBefore(r,s):l.insertBefore(r,s):(l.nodeType===8?(s=l.parentNode,s.insertBefore(r,l)):(s=l,s.appendChild(r)),l=l._reactRootContainer,l!=null||s.onclick!==null||(s.onclick=_c));else if(h!==4&&(r=r.child,r!==null))for(Eh(r,s,l),r=r.sibling;r!==null;)Eh(r,s,l),r=r.sibling}function wh(r,s,l){var h=r.tag;if(h===5||h===6)r=r.stateNode,s?l.insertBefore(r,s):l.appendChild(r);else if(h!==4&&(r=r.child,r!==null))for(wh(r,s,l),r=r.sibling;r!==null;)wh(r,s,l),r=r.sibling}var Ft=null,Xn=!1;function Ti(r,s,l){for(l=l.child;l!==null;)Ag(r,s,l),l=l.sibling}function Ag(r,s,l){if(mn&&typeof mn.onCommitFiberUnmount=="function")try{mn.onCommitFiberUnmount(ss,l)}catch{}switch(l.tag){case 5:Kt||xo(l,s);case 6:var h=Ft,g=Xn;Ft=null,Ti(r,s,l),Ft=h,Xn=g,Ft!==null&&(Xn?(r=Ft,l=l.stateNode,r.nodeType===8?r.parentNode.removeChild(l):r.removeChild(l)):Ft.removeChild(l.stateNode));break;case 18:Ft!==null&&(Xn?(r=Ft,l=l.stateNode,r.nodeType===8?jd(r.parentNode,l):r.nodeType===1&&jd(r,l),Gn(r)):jd(Ft,l.stateNode));break;case 4:h=Ft,g=Xn,Ft=l.stateNode.containerInfo,Xn=!0,Ti(r,s,l),Ft=h,Xn=g;break;case 0:case 11:case 14:case 15:if(!Kt&&(h=l.updateQueue,h!==null&&(h=h.lastEffect,h!==null))){g=h=h.next;do{var _=g,I=_.destroy;_=_.tag,I!==void 0&&(_&2||_&4)&&vh(l,s,I),g=g.next}while(g!==h)}Ti(r,s,l);break;case 1:if(!Kt&&(xo(l,s),h=l.stateNode,typeof h.componentWillUnmount=="function"))try{h.props=l.memoizedProps,h.state=l.memoizedState,h.componentWillUnmount()}catch(L){dt(l,s,L)}Ti(r,s,l);break;case 21:Ti(r,s,l);break;case 22:l.mode&1?(Kt=(h=Kt)||l.memoizedState!==null,Ti(r,s,l),Kt=h):Ti(r,s,l);break;default:Ti(r,s,l)}}function Cg(r){var s=r.updateQueue;if(s!==null){r.updateQueue=null;var l=r.stateNode;l===null&&(l=r.stateNode=new g1),s.forEach(function(h){var g=R1.bind(null,r,h);l.has(h)||(l.add(h),h.then(g,g))})}}function Jn(r,s){var l=s.deletions;if(l!==null)for(var h=0;h<l.length;h++){var g=l[h];try{var _=r,I=s,L=I;e:for(;L!==null;){switch(L.tag){case 5:Ft=L.stateNode,Xn=!1;break e;case 3:Ft=L.stateNode.containerInfo,Xn=!0;break e;case 4:Ft=L.stateNode.containerInfo,Xn=!0;break e}L=L.return}if(Ft===null)throw Error(t(160));Ag(_,I,g),Ft=null,Xn=!1;var F=g.alternate;F!==null&&(F.return=null),g.return=null}catch(K){dt(g,s,K)}}if(s.subtreeFlags&12854)for(s=s.child;s!==null;)kg(s,r),s=s.sibling}function kg(r,s){var l=r.alternate,h=r.flags;switch(r.tag){case 0:case 11:case 14:case 15:if(Jn(s,r),mr(r),h&4){try{Wa(3,r,r.return),zc(3,r)}catch(we){dt(r,r.return,we)}try{Wa(5,r,r.return)}catch(we){dt(r,r.return,we)}}break;case 1:Jn(s,r),mr(r),h&512&&l!==null&&xo(l,l.return);break;case 5:if(Jn(s,r),mr(r),h&512&&l!==null&&xo(l,l.return),r.flags&32){var g=r.stateNode;try{si(g,"")}catch(we){dt(r,r.return,we)}}if(h&4&&(g=r.stateNode,g!=null)){var _=r.memoizedProps,I=l!==null?l.memoizedProps:_,L=r.type,F=r.updateQueue;if(r.updateQueue=null,F!==null)try{L==="input"&&_.type==="radio"&&_.name!=null&&ii(g,_),fa(L,I);var K=fa(L,_);for(I=0;I<F.length;I+=2){var ne=F[I],ie=F[I+1];ne==="style"?ua(g,ie):ne==="dangerouslySetInnerHTML"?la(g,ie):ne==="children"?si(g,ie):q(g,ne,ie,K)}switch(L){case"input":Yi(g,_);break;case"textarea":Fs(g,_);break;case"select":var te=g._wrapperState.wasMultiple;g._wrapperState.wasMultiple=!!_.multiple;var ge=_.value;ge!=null?br(g,!!_.multiple,ge,!1):te!==!!_.multiple&&(_.defaultValue!=null?br(g,!!_.multiple,_.defaultValue,!0):br(g,!!_.multiple,_.multiple?[]:"",!1))}g[La]=_}catch(we){dt(r,r.return,we)}}break;case 6:if(Jn(s,r),mr(r),h&4){if(r.stateNode===null)throw Error(t(162));g=r.stateNode,_=r.memoizedProps;try{g.nodeValue=_}catch(we){dt(r,r.return,we)}}break;case 3:if(Jn(s,r),mr(r),h&4&&l!==null&&l.memoizedState.isDehydrated)try{Gn(s.containerInfo)}catch(we){dt(r,r.return,we)}break;case 4:Jn(s,r),mr(r);break;case 13:Jn(s,r),mr(r),g=r.child,g.flags&8192&&(_=g.memoizedState!==null,g.stateNode.isHidden=_,!_||g.alternate!==null&&g.alternate.memoizedState!==null||(xh=Je())),h&4&&Cg(r);break;case 22:if(ne=l!==null&&l.memoizedState!==null,r.mode&1?(Kt=(K=Kt)||ne,Jn(s,r),Kt=K):Jn(s,r),mr(r),h&8192){if(K=r.memoizedState!==null,(r.stateNode.isHidden=K)&&!ne&&r.mode&1)for(ve=r,ne=r.child;ne!==null;){for(ie=ve=ne;ve!==null;){switch(te=ve,ge=te.child,te.tag){case 0:case 11:case 14:case 15:Wa(4,te,te.return);break;case 1:xo(te,te.return);var Ee=te.stateNode;if(typeof Ee.componentWillUnmount=="function"){h=te,l=te.return;try{s=h,Ee.props=s.memoizedProps,Ee.state=s.memoizedState,Ee.componentWillUnmount()}catch(we){dt(h,l,we)}}break;case 5:xo(te,te.return);break;case 22:if(te.memoizedState!==null){Pg(ie);continue}}ge!==null?(ge.return=te,ve=ge):Pg(ie)}ne=ne.sibling}e:for(ne=null,ie=r;;){if(ie.tag===5){if(ne===null){ne=ie;try{g=ie.stateNode,K?(_=g.style,typeof _.setProperty=="function"?_.setProperty("display","none","important"):_.display="none"):(L=ie.stateNode,F=ie.memoizedProps.style,I=F!=null&&F.hasOwnProperty("display")?F.display:null,L.style.display=ca("display",I))}catch(we){dt(r,r.return,we)}}}else if(ie.tag===6){if(ne===null)try{ie.stateNode.nodeValue=K?"":ie.memoizedProps}catch(we){dt(r,r.return,we)}}else if((ie.tag!==22&&ie.tag!==23||ie.memoizedState===null||ie===r)&&ie.child!==null){ie.child.return=ie,ie=ie.child;continue}if(ie===r)break e;for(;ie.sibling===null;){if(ie.return===null||ie.return===r)break e;ne===ie&&(ne=null),ie=ie.return}ne===ie&&(ne=null),ie.sibling.return=ie.return,ie=ie.sibling}}break;case 19:Jn(s,r),mr(r),h&4&&Cg(r);break;case 21:break;default:Jn(s,r),mr(r)}}function mr(r){var s=r.flags;if(s&2){try{e:{for(var l=r.return;l!==null;){if(Ig(l)){var h=l;break e}l=l.return}throw Error(t(160))}switch(h.tag){case 5:var g=h.stateNode;h.flags&32&&(si(g,""),h.flags&=-33);var _=Rg(r);wh(r,_,g);break;case 3:case 4:var I=h.stateNode.containerInfo,L=Rg(r);Eh(r,L,I);break;default:throw Error(t(161))}}catch(F){dt(r,r.return,F)}r.flags&=-3}s&4096&&(r.flags&=-4097)}function v1(r,s,l){ve=r,bg(r)}function bg(r,s,l){for(var h=(r.mode&1)!==0;ve!==null;){var g=ve,_=g.child;if(g.tag===22&&h){var I=g.memoizedState!==null||Bc;if(!I){var L=g.alternate,F=L!==null&&L.memoizedState!==null||Kt;L=Bc;var K=Kt;if(Bc=I,(Kt=F)&&!K)for(ve=g;ve!==null;)I=ve,F=I.child,I.tag===22&&I.memoizedState!==null?Dg(g):F!==null?(F.return=I,ve=F):Dg(g);for(;_!==null;)ve=_,bg(_),_=_.sibling;ve=g,Bc=L,Kt=K}Ng(r)}else g.subtreeFlags&8772&&_!==null?(_.return=g,ve=_):Ng(r)}}function Ng(r){for(;ve!==null;){var s=ve;if(s.flags&8772){var l=s.alternate;try{if(s.flags&8772)switch(s.tag){case 0:case 11:case 15:Kt||zc(5,s);break;case 1:var h=s.stateNode;if(s.flags&4&&!Kt)if(l===null)h.componentDidMount();else{var g=s.elementType===s.type?l.memoizedProps:Yn(s.type,l.memoizedProps);h.componentDidUpdate(g,l.memoizedState,h.__reactInternalSnapshotBeforeUpdate)}var _=s.updateQueue;_!==null&&Pm(s,_,h);break;case 3:var I=s.updateQueue;if(I!==null){if(l=null,s.child!==null)switch(s.child.tag){case 5:l=s.child.stateNode;break;case 1:l=s.child.stateNode}Pm(s,I,l)}break;case 5:var L=s.stateNode;if(l===null&&s.flags&4){l=L;var F=s.memoizedProps;switch(s.type){case"button":case"input":case"select":case"textarea":F.autoFocus&&l.focus();break;case"img":F.src&&(l.src=F.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(s.memoizedState===null){var K=s.alternate;if(K!==null){var ne=K.memoizedState;if(ne!==null){var ie=ne.dehydrated;ie!==null&&Gn(ie)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}Kt||s.flags&512&&_h(s)}catch(te){dt(s,s.return,te)}}if(s===r){ve=null;break}if(l=s.sibling,l!==null){l.return=s.return,ve=l;break}ve=s.return}}function Pg(r){for(;ve!==null;){var s=ve;if(s===r){ve=null;break}var l=s.sibling;if(l!==null){l.return=s.return,ve=l;break}ve=s.return}}function Dg(r){for(;ve!==null;){var s=ve;try{switch(s.tag){case 0:case 11:case 15:var l=s.return;try{zc(4,s)}catch(F){dt(s,l,F)}break;case 1:var h=s.stateNode;if(typeof h.componentDidMount=="function"){var g=s.return;try{h.componentDidMount()}catch(F){dt(s,g,F)}}var _=s.return;try{_h(s)}catch(F){dt(s,_,F)}break;case 5:var I=s.return;try{_h(s)}catch(F){dt(s,I,F)}}}catch(F){dt(s,s.return,F)}if(s===r){ve=null;break}var L=s.sibling;if(L!==null){L.return=s.return,ve=L;break}ve=s.return}}var _1=Math.ceil,$c=J.ReactCurrentDispatcher,Th=J.ReactCurrentOwner,Nn=J.ReactCurrentBatchConfig,Ge=0,Dt=null,_t=null,Ut=0,wn=0,Io=yi(0),It=0,Ka=null,_s=0,Hc=0,Sh=0,Qa=null,un=null,xh=0,Ro=1/0,qr=null,qc=!1,Ih=null,Si=null,Gc=!1,xi=null,Wc=0,Ya=0,Rh=null,Kc=-1,Qc=0;function nn(){return Ge&6?Je():Kc!==-1?Kc:Kc=Je()}function Ii(r){return r.mode&1?Ge&2&&Ut!==0?Ut&-Ut:n1.transition!==null?(Qc===0&&(Qc=as()),Qc):(r=ze,r!==0||(r=window.event,r=r===void 0?16:xa(r.type)),r):1}function Zn(r,s,l,h){if(50<Ya)throw Ya=0,Rh=null,Error(t(185));ci(r,l,h),(!(Ge&2)||r!==Dt)&&(r===Dt&&(!(Ge&2)&&(Hc|=l),It===4&&Ri(r,Ut)),dn(r,h),l===1&&Ge===0&&!(s.mode&1)&&(Ro=Je()+500,Sc&&_i()))}function dn(r,s){var l=r.callbackNode;Dr(r,s);var h=os(r,r===Dt?Ut:0);if(h===0)l!==null&&_a(l),r.callbackNode=null,r.callbackPriority=0;else if(s=h&-h,r.callbackPriority!==s){if(l!=null&&_a(l),s===1)r.tag===0?t1(Og.bind(null,r)):Em(Og.bind(null,r)),XE(function(){!(Ge&6)&&_i()}),l=null;else{switch(di(h)){case 1:l=is;break;case 4:l=oi;break;case 16:l=xn;break;case 536870912:l=Ql;break;default:l=xn}l=$g(l,jg.bind(null,r))}r.callbackPriority=s,r.callbackNode=l}}function jg(r,s){if(Kc=-1,Qc=0,Ge&6)throw Error(t(327));var l=r.callbackNode;if(Ao()&&r.callbackNode!==l)return null;var h=os(r,r===Dt?Ut:0);if(h===0)return null;if(h&30||h&r.expiredLanes||s)s=Yc(r,h);else{s=h;var g=Ge;Ge|=2;var _=Mg();(Dt!==r||Ut!==s)&&(qr=null,Ro=Je()+500,ws(r,s));do try{T1();break}catch(L){Lg(r,L)}while(!0);Hd(),$c.current=_,Ge=g,_t!==null?s=0:(Dt=null,Ut=0,s=It)}if(s!==0){if(s===2&&(g=gn(r),g!==0&&(h=g,s=Ah(r,g))),s===1)throw l=Ka,ws(r,0),Ri(r,h),dn(r,Je()),l;if(s===6)Ri(r,h);else{if(g=r.current.alternate,!(h&30)&&!E1(g)&&(s=Yc(r,h),s===2&&(_=gn(r),_!==0&&(h=_,s=Ah(r,_))),s===1))throw l=Ka,ws(r,0),Ri(r,h),dn(r,Je()),l;switch(r.finishedWork=g,r.finishedLanes=h,s){case 0:case 1:throw Error(t(345));case 2:Ts(r,un,qr);break;case 3:if(Ri(r,h),(h&130023424)===h&&(s=xh+500-Je(),10<s)){if(os(r,0)!==0)break;if(g=r.suspendedLanes,(g&h)!==h){nn(),r.pingedLanes|=r.suspendedLanes&g;break}r.timeoutHandle=Dd(Ts.bind(null,r,un,qr),s);break}Ts(r,un,qr);break;case 4:if(Ri(r,h),(h&4194240)===h)break;for(s=r.eventTimes,g=-1;0<h;){var I=31-Zt(h);_=1<<I,I=s[I],I>g&&(g=I),h&=~_}if(h=g,h=Je()-h,h=(120>h?120:480>h?480:1080>h?1080:1920>h?1920:3e3>h?3e3:4320>h?4320:1960*_1(h/1960))-h,10<h){r.timeoutHandle=Dd(Ts.bind(null,r,un,qr),h);break}Ts(r,un,qr);break;case 5:Ts(r,un,qr);break;default:throw Error(t(329))}}}return dn(r,Je()),r.callbackNode===l?jg.bind(null,r):null}function Ah(r,s){var l=Qa;return r.current.memoizedState.isDehydrated&&(ws(r,s).flags|=256),r=Yc(r,s),r!==2&&(s=un,un=l,s!==null&&Ch(s)),r}function Ch(r){un===null?un=r:un.push.apply(un,r)}function E1(r){for(var s=r;;){if(s.flags&16384){var l=s.updateQueue;if(l!==null&&(l=l.stores,l!==null))for(var h=0;h<l.length;h++){var g=l[h],_=g.getSnapshot;g=g.value;try{if(!Kn(_(),g))return!1}catch{return!1}}}if(l=s.child,s.subtreeFlags&16384&&l!==null)l.return=s,s=l;else{if(s===r)break;for(;s.sibling===null;){if(s.return===null||s.return===r)return!0;s=s.return}s.sibling.return=s.return,s=s.sibling}}return!0}function Ri(r,s){for(s&=~Sh,s&=~Hc,r.suspendedLanes|=s,r.pingedLanes&=~s,r=r.expirationTimes;0<s;){var l=31-Zt(s),h=1<<l;r[l]=-1,s&=~h}}function Og(r){if(Ge&6)throw Error(t(327));Ao();var s=os(r,0);if(!(s&1))return dn(r,Je()),null;var l=Yc(r,s);if(r.tag!==0&&l===2){var h=gn(r);h!==0&&(s=h,l=Ah(r,h))}if(l===1)throw l=Ka,ws(r,0),Ri(r,s),dn(r,Je()),l;if(l===6)throw Error(t(345));return r.finishedWork=r.current.alternate,r.finishedLanes=s,Ts(r,un,qr),dn(r,Je()),null}function kh(r,s){var l=Ge;Ge|=1;try{return r(s)}finally{Ge=l,Ge===0&&(Ro=Je()+500,Sc&&_i())}}function Es(r){xi!==null&&xi.tag===0&&!(Ge&6)&&Ao();var s=Ge;Ge|=1;var l=Nn.transition,h=ze;try{if(Nn.transition=null,ze=1,r)return r()}finally{ze=h,Nn.transition=l,Ge=s,!(Ge&6)&&_i()}}function bh(){wn=Io.current,nt(Io)}function ws(r,s){r.finishedWork=null,r.finishedLanes=0;var l=r.timeoutHandle;if(l!==-1&&(r.timeoutHandle=-1,YE(l)),_t!==null)for(l=_t.return;l!==null;){var h=l;switch(Fd(h),h.tag){case 1:h=h.type.childContextTypes,h!=null&&wc();break;case 3:To(),nt(an),nt(qt),Jd();break;case 5:Yd(h);break;case 4:To();break;case 13:nt(ot);break;case 19:nt(ot);break;case 10:qd(h.type._context);break;case 22:case 23:bh()}l=l.return}if(Dt=r,_t=r=Ai(r.current,null),Ut=wn=s,It=0,Ka=null,Sh=Hc=_s=0,un=Qa=null,gs!==null){for(s=0;s<gs.length;s++)if(l=gs[s],h=l.interleaved,h!==null){l.interleaved=null;var g=h.next,_=l.pending;if(_!==null){var I=_.next;_.next=g,h.next=I}l.pending=h}gs=null}return r}function Lg(r,s){do{var l=_t;try{if(Hd(),Dc.current=Mc,jc){for(var h=at.memoizedState;h!==null;){var g=h.queue;g!==null&&(g.pending=null),h=h.next}jc=!1}if(vs=0,Pt=xt=at=null,za=!1,$a=0,Th.current=null,l===null||l.return===null){It=1,Ka=s,_t=null;break}e:{var _=r,I=l.return,L=l,F=s;if(s=Ut,L.flags|=32768,F!==null&&typeof F=="object"&&typeof F.then=="function"){var K=F,ne=L,ie=ne.tag;if(!(ne.mode&1)&&(ie===0||ie===11||ie===15)){var te=ne.alternate;te?(ne.updateQueue=te.updateQueue,ne.memoizedState=te.memoizedState,ne.lanes=te.lanes):(ne.updateQueue=null,ne.memoizedState=null)}var ge=ag(I);if(ge!==null){ge.flags&=-257,lg(ge,I,L,_,s),ge.mode&1&&og(_,K,s),s=ge,F=K;var Ee=s.updateQueue;if(Ee===null){var we=new Set;we.add(F),s.updateQueue=we}else Ee.add(F);break e}else{if(!(s&1)){og(_,K,s),Nh();break e}F=Error(t(426))}}else if(it&&L.mode&1){var mt=ag(I);if(mt!==null){!(mt.flags&65536)&&(mt.flags|=256),lg(mt,I,L,_,s),zd(So(F,L));break e}}_=F=So(F,L),It!==4&&(It=2),Qa===null?Qa=[_]:Qa.push(_),_=I;do{switch(_.tag){case 3:_.flags|=65536,s&=-s,_.lanes|=s;var H=ig(_,F,s);Nm(_,H);break e;case 1:L=F;var B=_.type,G=_.stateNode;if(!(_.flags&128)&&(typeof B.getDerivedStateFromError=="function"||G!==null&&typeof G.componentDidCatch=="function"&&(Si===null||!Si.has(G)))){_.flags|=65536,s&=-s,_.lanes|=s;var ce=sg(_,L,s);Nm(_,ce);break e}}_=_.return}while(_!==null)}Fg(l)}catch(Se){s=Se,_t===l&&l!==null&&(_t=l=l.return);continue}break}while(!0)}function Mg(){var r=$c.current;return $c.current=Mc,r===null?Mc:r}function Nh(){(It===0||It===3||It===2)&&(It=4),Dt===null||!(_s&268435455)&&!(Hc&268435455)||Ri(Dt,Ut)}function Yc(r,s){var l=Ge;Ge|=2;var h=Mg();(Dt!==r||Ut!==s)&&(qr=null,ws(r,s));do try{w1();break}catch(g){Lg(r,g)}while(!0);if(Hd(),Ge=l,$c.current=h,_t!==null)throw Error(t(261));return Dt=null,Ut=0,It}function w1(){for(;_t!==null;)Vg(_t)}function T1(){for(;_t!==null&&!Wl();)Vg(_t)}function Vg(r){var s=zg(r.alternate,r,wn);r.memoizedProps=r.pendingProps,s===null?Fg(r):_t=s,Th.current=null}function Fg(r){var s=r;do{var l=s.alternate;if(r=s.return,s.flags&32768){if(l=m1(l,s),l!==null){l.flags&=32767,_t=l;return}if(r!==null)r.flags|=32768,r.subtreeFlags=0,r.deletions=null;else{It=6,_t=null;return}}else if(l=p1(l,s,wn),l!==null){_t=l;return}if(s=s.sibling,s!==null){_t=s;return}_t=s=r}while(s!==null);It===0&&(It=5)}function Ts(r,s,l){var h=ze,g=Nn.transition;try{Nn.transition=null,ze=1,S1(r,s,l,h)}finally{Nn.transition=g,ze=h}return null}function S1(r,s,l,h){do Ao();while(xi!==null);if(Ge&6)throw Error(t(327));l=r.finishedWork;var g=r.finishedLanes;if(l===null)return null;if(r.finishedWork=null,r.finishedLanes=0,l===r.current)throw Error(t(177));r.callbackNode=null,r.callbackPriority=0;var _=l.lanes|l.childLanes;if(Xe(r,_),r===Dt&&(_t=Dt=null,Ut=0),!(l.subtreeFlags&2064)&&!(l.flags&2064)||Gc||(Gc=!0,$g(xn,function(){return Ao(),null})),_=(l.flags&15990)!==0,l.subtreeFlags&15990||_){_=Nn.transition,Nn.transition=null;var I=ze;ze=1;var L=Ge;Ge|=4,Th.current=null,y1(r,l),kg(l,r),$E(Nd),fi=!!bd,Nd=bd=null,r.current=l,v1(l),pd(),Ge=L,ze=I,Nn.transition=_}else r.current=l;if(Gc&&(Gc=!1,xi=r,Wc=g),_=r.pendingLanes,_===0&&(Si=null),Yl(l.stateNode),dn(r,Je()),s!==null)for(h=r.onRecoverableError,l=0;l<s.length;l++)g=s[l],h(g.value,{componentStack:g.stack,digest:g.digest});if(qc)throw qc=!1,r=Ih,Ih=null,r;return Wc&1&&r.tag!==0&&Ao(),_=r.pendingLanes,_&1?r===Rh?Ya++:(Ya=0,Rh=r):Ya=0,_i(),null}function Ao(){if(xi!==null){var r=di(Wc),s=Nn.transition,l=ze;try{if(Nn.transition=null,ze=16>r?16:r,xi===null)var h=!1;else{if(r=xi,xi=null,Wc=0,Ge&6)throw Error(t(331));var g=Ge;for(Ge|=4,ve=r.current;ve!==null;){var _=ve,I=_.child;if(ve.flags&16){var L=_.deletions;if(L!==null){for(var F=0;F<L.length;F++){var K=L[F];for(ve=K;ve!==null;){var ne=ve;switch(ne.tag){case 0:case 11:case 15:Wa(8,ne,_)}var ie=ne.child;if(ie!==null)ie.return=ne,ve=ie;else for(;ve!==null;){ne=ve;var te=ne.sibling,ge=ne.return;if(xg(ne),ne===K){ve=null;break}if(te!==null){te.return=ge,ve=te;break}ve=ge}}}var Ee=_.alternate;if(Ee!==null){var we=Ee.child;if(we!==null){Ee.child=null;do{var mt=we.sibling;we.sibling=null,we=mt}while(we!==null)}}ve=_}}if(_.subtreeFlags&2064&&I!==null)I.return=_,ve=I;else e:for(;ve!==null;){if(_=ve,_.flags&2048)switch(_.tag){case 0:case 11:case 15:Wa(9,_,_.return)}var H=_.sibling;if(H!==null){H.return=_.return,ve=H;break e}ve=_.return}}var B=r.current;for(ve=B;ve!==null;){I=ve;var G=I.child;if(I.subtreeFlags&2064&&G!==null)G.return=I,ve=G;else e:for(I=B;ve!==null;){if(L=ve,L.flags&2048)try{switch(L.tag){case 0:case 11:case 15:zc(9,L)}}catch(Se){dt(L,L.return,Se)}if(L===I){ve=null;break e}var ce=L.sibling;if(ce!==null){ce.return=L.return,ve=ce;break e}ve=L.return}}if(Ge=g,_i(),mn&&typeof mn.onPostCommitFiberRoot=="function")try{mn.onPostCommitFiberRoot(ss,r)}catch{}h=!0}return h}finally{ze=l,Nn.transition=s}}return!1}function Ug(r,s,l){s=So(l,s),s=ig(r,s,1),r=wi(r,s,1),s=nn(),r!==null&&(ci(r,1,s),dn(r,s))}function dt(r,s,l){if(r.tag===3)Ug(r,r,l);else for(;s!==null;){if(s.tag===3){Ug(s,r,l);break}else if(s.tag===1){var h=s.stateNode;if(typeof s.type.getDerivedStateFromError=="function"||typeof h.componentDidCatch=="function"&&(Si===null||!Si.has(h))){r=So(l,r),r=sg(s,r,1),s=wi(s,r,1),r=nn(),s!==null&&(ci(s,1,r),dn(s,r));break}}s=s.return}}function x1(r,s,l){var h=r.pingCache;h!==null&&h.delete(s),s=nn(),r.pingedLanes|=r.suspendedLanes&l,Dt===r&&(Ut&l)===l&&(It===4||It===3&&(Ut&130023424)===Ut&&500>Je()-xh?ws(r,0):Sh|=l),dn(r,s)}function Bg(r,s){s===0&&(r.mode&1?(s=Qs,Qs<<=1,!(Qs&130023424)&&(Qs=4194304)):s=1);var l=nn();r=zr(r,s),r!==null&&(ci(r,s,l),dn(r,l))}function I1(r){var s=r.memoizedState,l=0;s!==null&&(l=s.retryLane),Bg(r,l)}function R1(r,s){var l=0;switch(r.tag){case 13:var h=r.stateNode,g=r.memoizedState;g!==null&&(l=g.retryLane);break;case 19:h=r.stateNode;break;default:throw Error(t(314))}h!==null&&h.delete(s),Bg(r,l)}var zg;zg=function(r,s,l){if(r!==null)if(r.memoizedProps!==s.pendingProps||an.current)cn=!0;else{if(!(r.lanes&l)&&!(s.flags&128))return cn=!1,f1(r,s,l);cn=!!(r.flags&131072)}else cn=!1,it&&s.flags&1048576&&wm(s,Ic,s.index);switch(s.lanes=0,s.tag){case 2:var h=s.type;Uc(r,s),r=s.pendingProps;var g=mo(s,qt.current);wo(s,l),g=th(null,s,h,r,g,l);var _=nh();return s.flags|=1,typeof g=="object"&&g!==null&&typeof g.render=="function"&&g.$$typeof===void 0?(s.tag=1,s.memoizedState=null,s.updateQueue=null,ln(h)?(_=!0,Tc(s)):_=!1,s.memoizedState=g.state!==null&&g.state!==void 0?g.state:null,Kd(s),g.updater=Vc,s.stateNode=g,g._reactInternals=s,lh(s,h,r,l),s=hh(null,s,h,!0,_,l)):(s.tag=0,it&&_&&Vd(s),tn(null,s,g,l),s=s.child),s;case 16:h=s.elementType;e:{switch(Uc(r,s),r=s.pendingProps,g=h._init,h=g(h._payload),s.type=h,g=s.tag=C1(h),r=Yn(h,r),g){case 0:s=dh(null,s,h,r,l);break e;case 1:s=pg(null,s,h,r,l);break e;case 11:s=cg(null,s,h,r,l);break e;case 14:s=ug(null,s,h,Yn(h.type,r),l);break e}throw Error(t(306,h,""))}return s;case 0:return h=s.type,g=s.pendingProps,g=s.elementType===h?g:Yn(h,g),dh(r,s,h,g,l);case 1:return h=s.type,g=s.pendingProps,g=s.elementType===h?g:Yn(h,g),pg(r,s,h,g,l);case 3:e:{if(mg(s),r===null)throw Error(t(387));h=s.pendingProps,_=s.memoizedState,g=_.element,bm(r,s),Nc(s,h,null,l);var I=s.memoizedState;if(h=I.element,_.isDehydrated)if(_={element:h,isDehydrated:!1,cache:I.cache,pendingSuspenseBoundaries:I.pendingSuspenseBoundaries,transitions:I.transitions},s.updateQueue.baseState=_,s.memoizedState=_,s.flags&256){g=So(Error(t(423)),s),s=gg(r,s,h,l,g);break e}else if(h!==g){g=So(Error(t(424)),s),s=gg(r,s,h,l,g);break e}else for(En=gi(s.stateNode.containerInfo.firstChild),_n=s,it=!0,Qn=null,l=Cm(s,null,h,l),s.child=l;l;)l.flags=l.flags&-3|4096,l=l.sibling;else{if(vo(),h===g){s=Hr(r,s,l);break e}tn(r,s,h,l)}s=s.child}return s;case 5:return Dm(s),r===null&&Bd(s),h=s.type,g=s.pendingProps,_=r!==null?r.memoizedProps:null,I=g.children,Pd(h,g)?I=null:_!==null&&Pd(h,_)&&(s.flags|=32),fg(r,s),tn(r,s,I,l),s.child;case 6:return r===null&&Bd(s),null;case 13:return yg(r,s,l);case 4:return Qd(s,s.stateNode.containerInfo),h=s.pendingProps,r===null?s.child=_o(s,null,h,l):tn(r,s,h,l),s.child;case 11:return h=s.type,g=s.pendingProps,g=s.elementType===h?g:Yn(h,g),cg(r,s,h,g,l);case 7:return tn(r,s,s.pendingProps,l),s.child;case 8:return tn(r,s,s.pendingProps.children,l),s.child;case 12:return tn(r,s,s.pendingProps.children,l),s.child;case 10:e:{if(h=s.type._context,g=s.pendingProps,_=s.memoizedProps,I=g.value,Ze(Cc,h._currentValue),h._currentValue=I,_!==null)if(Kn(_.value,I)){if(_.children===g.children&&!an.current){s=Hr(r,s,l);break e}}else for(_=s.child,_!==null&&(_.return=s);_!==null;){var L=_.dependencies;if(L!==null){I=_.child;for(var F=L.firstContext;F!==null;){if(F.context===h){if(_.tag===1){F=$r(-1,l&-l),F.tag=2;var K=_.updateQueue;if(K!==null){K=K.shared;var ne=K.pending;ne===null?F.next=F:(F.next=ne.next,ne.next=F),K.pending=F}}_.lanes|=l,F=_.alternate,F!==null&&(F.lanes|=l),Gd(_.return,l,s),L.lanes|=l;break}F=F.next}}else if(_.tag===10)I=_.type===s.type?null:_.child;else if(_.tag===18){if(I=_.return,I===null)throw Error(t(341));I.lanes|=l,L=I.alternate,L!==null&&(L.lanes|=l),Gd(I,l,s),I=_.sibling}else I=_.child;if(I!==null)I.return=_;else for(I=_;I!==null;){if(I===s){I=null;break}if(_=I.sibling,_!==null){_.return=I.return,I=_;break}I=I.return}_=I}tn(r,s,g.children,l),s=s.child}return s;case 9:return g=s.type,h=s.pendingProps.children,wo(s,l),g=kn(g),h=h(g),s.flags|=1,tn(r,s,h,l),s.child;case 14:return h=s.type,g=Yn(h,s.pendingProps),g=Yn(h.type,g),ug(r,s,h,g,l);case 15:return dg(r,s,s.type,s.pendingProps,l);case 17:return h=s.type,g=s.pendingProps,g=s.elementType===h?g:Yn(h,g),Uc(r,s),s.tag=1,ln(h)?(r=!0,Tc(s)):r=!1,wo(s,l),ng(s,h,g),lh(s,h,g,l),hh(null,s,h,!0,r,l);case 19:return _g(r,s,l);case 22:return hg(r,s,l)}throw Error(t(156,s.tag))};function $g(r,s){return Ws(r,s)}function A1(r,s,l,h){this.tag=r,this.key=l,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=s,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=h,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Pn(r,s,l,h){return new A1(r,s,l,h)}function Ph(r){return r=r.prototype,!(!r||!r.isReactComponent)}function C1(r){if(typeof r=="function")return Ph(r)?1:0;if(r!=null){if(r=r.$$typeof,r===V)return 11;if(r===ue)return 14}return 2}function Ai(r,s){var l=r.alternate;return l===null?(l=Pn(r.tag,s,r.key,r.mode),l.elementType=r.elementType,l.type=r.type,l.stateNode=r.stateNode,l.alternate=r,r.alternate=l):(l.pendingProps=s,l.type=r.type,l.flags=0,l.subtreeFlags=0,l.deletions=null),l.flags=r.flags&14680064,l.childLanes=r.childLanes,l.lanes=r.lanes,l.child=r.child,l.memoizedProps=r.memoizedProps,l.memoizedState=r.memoizedState,l.updateQueue=r.updateQueue,s=r.dependencies,l.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext},l.sibling=r.sibling,l.index=r.index,l.ref=r.ref,l}function Xc(r,s,l,h,g,_){var I=2;if(h=r,typeof r=="function")Ph(r)&&(I=1);else if(typeof r=="string")I=5;else e:switch(r){case k:return Ss(l.children,g,_,s);case x:I=8,g|=8;break;case A:return r=Pn(12,l,s,g|2),r.elementType=A,r.lanes=_,r;case D:return r=Pn(13,l,s,g),r.elementType=D,r.lanes=_,r;case ee:return r=Pn(19,l,s,g),r.elementType=ee,r.lanes=_,r;case re:return Jc(l,g,_,s);default:if(typeof r=="object"&&r!==null)switch(r.$$typeof){case P:I=10;break e;case M:I=9;break e;case V:I=11;break e;case ue:I=14;break e;case he:I=16,h=null;break e}throw Error(t(130,r==null?r:typeof r,""))}return s=Pn(I,l,s,g),s.elementType=r,s.type=h,s.lanes=_,s}function Ss(r,s,l,h){return r=Pn(7,r,h,s),r.lanes=l,r}function Jc(r,s,l,h){return r=Pn(22,r,h,s),r.elementType=re,r.lanes=l,r.stateNode={isHidden:!1},r}function Dh(r,s,l){return r=Pn(6,r,null,s),r.lanes=l,r}function jh(r,s,l){return s=Pn(4,r.children!==null?r.children:[],r.key,s),s.lanes=l,s.stateNode={containerInfo:r.containerInfo,pendingChildren:null,implementation:r.implementation},s}function k1(r,s,l,h,g){this.tag=s,this.containerInfo=r,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=li(0),this.expirationTimes=li(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=li(0),this.identifierPrefix=h,this.onRecoverableError=g,this.mutableSourceEagerHydrationData=null}function Oh(r,s,l,h,g,_,I,L,F){return r=new k1(r,s,l,L,F),s===1?(s=1,_===!0&&(s|=8)):s=0,_=Pn(3,null,null,s),r.current=_,_.stateNode=r,_.memoizedState={element:h,isDehydrated:l,cache:null,transitions:null,pendingSuspenseBoundaries:null},Kd(_),r}function b1(r,s,l){var h=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Q,key:h==null?null:""+h,children:r,containerInfo:s,implementation:l}}function Hg(r){if(!r)return vi;r=r._reactInternals;e:{if(Bn(r)!==r||r.tag!==1)throw Error(t(170));var s=r;do{switch(s.tag){case 3:s=s.stateNode.context;break e;case 1:if(ln(s.type)){s=s.stateNode.__reactInternalMemoizedMergedChildContext;break e}}s=s.return}while(s!==null);throw Error(t(171))}if(r.tag===1){var l=r.type;if(ln(l))return vm(r,l,s)}return s}function qg(r,s,l,h,g,_,I,L,F){return r=Oh(l,h,!0,r,g,_,I,L,F),r.context=Hg(null),l=r.current,h=nn(),g=Ii(l),_=$r(h,g),_.callback=s??null,wi(l,_,g),r.current.lanes=g,ci(r,g,h),dn(r,h),r}function Zc(r,s,l,h){var g=s.current,_=nn(),I=Ii(g);return l=Hg(l),s.context===null?s.context=l:s.pendingContext=l,s=$r(_,I),s.payload={element:r},h=h===void 0?null:h,h!==null&&(s.callback=h),r=wi(g,s,I),r!==null&&(Zn(r,g,I,_),bc(r,g,I)),I}function eu(r){if(r=r.current,!r.child)return null;switch(r.child.tag){case 5:return r.child.stateNode;default:return r.child.stateNode}}function Gg(r,s){if(r=r.memoizedState,r!==null&&r.dehydrated!==null){var l=r.retryLane;r.retryLane=l!==0&&l<s?l:s}}function Lh(r,s){Gg(r,s),(r=r.alternate)&&Gg(r,s)}var Wg=typeof reportError=="function"?reportError:function(r){console.error(r)};function Mh(r){this._internalRoot=r}tu.prototype.render=Mh.prototype.render=function(r){var s=this._internalRoot;if(s===null)throw Error(t(409));Zc(r,s,null,null)},tu.prototype.unmount=Mh.prototype.unmount=function(){var r=this._internalRoot;if(r!==null){this._internalRoot=null;var s=r.containerInfo;Es(function(){Zc(null,r,null,null)}),s[Vr]=null}};function tu(r){this._internalRoot=r}tu.prototype.unstable_scheduleHydration=function(r){if(r){var s=tc();r={blockedOn:null,target:r,priority:s};for(var l=0;l<lr.length&&s!==0&&s<lr[l].priority;l++);lr.splice(l,0,r),l===0&&ic(r)}};function Vh(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11)}function nu(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11&&(r.nodeType!==8||r.nodeValue!==" react-mount-point-unstable "))}function Kg(){}function N1(r,s,l,h,g){if(g){if(typeof h=="function"){var _=h;h=function(){var K=eu(I);_.call(K)}}var I=qg(s,h,r,0,null,!1,!1,"",Kg);return r._reactRootContainer=I,r[Vr]=I.current,ja(r.nodeType===8?r.parentNode:r),Es(),I}for(;g=r.lastChild;)r.removeChild(g);if(typeof h=="function"){var L=h;h=function(){var K=eu(F);L.call(K)}}var F=Oh(r,0,!1,null,null,!1,!1,"",Kg);return r._reactRootContainer=F,r[Vr]=F.current,ja(r.nodeType===8?r.parentNode:r),Es(function(){Zc(s,F,l,h)}),F}function ru(r,s,l,h,g){var _=l._reactRootContainer;if(_){var I=_;if(typeof g=="function"){var L=g;g=function(){var F=eu(I);L.call(F)}}Zc(s,I,r,g)}else I=N1(l,s,r,g,h);return eu(I)}Zl=function(r){switch(r.tag){case 3:var s=r.stateNode;if(s.current.memoizedState.isDehydrated){var l=ai(s.pendingLanes);l!==0&&(ui(s,l|1),dn(s,Je()),!(Ge&6)&&(Ro=Je()+500,_i()))}break;case 13:Es(function(){var h=zr(r,1);if(h!==null){var g=nn();Zn(h,r,1,g)}}),Lh(r,1)}},Ys=function(r){if(r.tag===13){var s=zr(r,134217728);if(s!==null){var l=nn();Zn(s,r,134217728,l)}Lh(r,134217728)}},ec=function(r){if(r.tag===13){var s=Ii(r),l=zr(r,s);if(l!==null){var h=nn();Zn(l,r,s,h)}Lh(r,s)}},tc=function(){return ze},nc=function(r,s){var l=ze;try{return ze=r,s()}finally{ze=l}},Bs=function(r,s,l){switch(s){case"input":if(Yi(r,l),s=l.name,l.type==="radio"&&s!=null){for(l=r;l.parentNode;)l=l.parentNode;for(l=l.querySelectorAll("input[name="+JSON.stringify(""+s)+'][type="radio"]'),s=0;s<l.length;s++){var h=l[s];if(h!==r&&h.form===r.form){var g=Ec(h);if(!g)throw Error(t(90));Ve(h),Yi(h,g)}}}break;case"textarea":Fs(r,l);break;case"select":s=l.value,s!=null&&br(r,!!l.multiple,s,!1)}},es=kh,ma=Es;var P1={usingClientEntryPoint:!1,Events:[Ma,fo,Ec,or,pa,kh]},Xa={findFiberByHostInstance:hs,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},D1={bundleType:Xa.bundleType,version:Xa.version,rendererPackageName:Xa.rendererPackageName,rendererConfig:Xa.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:J.ReactCurrentDispatcher,findHostInstanceByFiber:function(r){return r=va(r),r===null?null:r.stateNode},findFiberByHostInstance:Xa.findFiberByHostInstance,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var iu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!iu.isDisabled&&iu.supportsFiber)try{ss=iu.inject(D1),mn=iu}catch{}}return hn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=P1,hn.createPortal=function(r,s){var l=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Vh(s))throw Error(t(200));return b1(r,s,null,l)},hn.createRoot=function(r,s){if(!Vh(r))throw Error(t(299));var l=!1,h="",g=Wg;return s!=null&&(s.unstable_strictMode===!0&&(l=!0),s.identifierPrefix!==void 0&&(h=s.identifierPrefix),s.onRecoverableError!==void 0&&(g=s.onRecoverableError)),s=Oh(r,1,!1,null,null,l,!1,h,g),r[Vr]=s.current,ja(r.nodeType===8?r.parentNode:r),new Mh(s)},hn.findDOMNode=function(r){if(r==null)return null;if(r.nodeType===1)return r;var s=r._reactInternals;if(s===void 0)throw typeof r.render=="function"?Error(t(188)):(r=Object.keys(r).join(","),Error(t(268,r)));return r=va(s),r=r===null?null:r.stateNode,r},hn.flushSync=function(r){return Es(r)},hn.hydrate=function(r,s,l){if(!nu(s))throw Error(t(200));return ru(null,r,s,!0,l)},hn.hydrateRoot=function(r,s,l){if(!Vh(r))throw Error(t(405));var h=l!=null&&l.hydratedSources||null,g=!1,_="",I=Wg;if(l!=null&&(l.unstable_strictMode===!0&&(g=!0),l.identifierPrefix!==void 0&&(_=l.identifierPrefix),l.onRecoverableError!==void 0&&(I=l.onRecoverableError)),s=qg(s,null,r,1,l??null,g,!1,_,I),r[Vr]=s.current,ja(r),h)for(r=0;r<h.length;r++)l=h[r],g=l._getVersion,g=g(l._source),s.mutableSourceEagerHydrationData==null?s.mutableSourceEagerHydrationData=[l,g]:s.mutableSourceEagerHydrationData.push(l,g);return new tu(s)},hn.render=function(r,s,l){if(!nu(s))throw Error(t(200));return ru(null,r,s,!1,l)},hn.unmountComponentAtNode=function(r){if(!nu(r))throw Error(t(40));return r._reactRootContainer?(Es(function(){ru(null,null,r,!1,function(){r._reactRootContainer=null,r[Vr]=null})}),!0):!1},hn.unstable_batchedUpdates=kh,hn.unstable_renderSubtreeIntoContainer=function(r,s,l,h){if(!nu(l))throw Error(t(200));if(r==null||r._reactInternals===void 0)throw Error(t(38));return ru(r,s,l,!1,h)},hn.version="18.3.1-next-f1338f8080-20240426",hn}var ny;function Mv(){if(ny)return Bh.exports;ny=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),Bh.exports=z1(),Bh.exports}var ry;function $1(){if(ry)return su;ry=1;var n=Mv();return su.createRoot=n.createRoot,su.hydrateRoot=n.hydrateRoot,su}var H1=$1();const q1=zf(H1);var Za={},iy;function G1(){if(iy)return Za;iy=1,Object.defineProperty(Za,"__esModule",{value:!0}),Za.parse=c,Za.serialize=m;const n=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,e=/^[\u0021-\u003A\u003C-\u007E]*$/,t=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,i=/^[\u0020-\u003A\u003D-\u007E]*$/,o=Object.prototype.toString,a=(()=>{const w=function(){};return w.prototype=Object.create(null),w})();function c(w,S){const R=new a,j=w.length;if(j<2)return R;const N=(S==null?void 0:S.decode)||v;let O=0;do{const U=w.indexOf("=",O);if(U===-1)break;const q=w.indexOf(";",O),J=q===-1?j:q;if(U>J){O=w.lastIndexOf(";",U-1)+1;continue}const W=d(w,O,U),Q=p(w,U,W),k=w.slice(W,Q);if(R[k]===void 0){let x=d(w,U+1,J),A=p(w,J,x);const P=N(w.slice(x,A));R[k]=P}O=J+1}while(O<j);return R}function d(w,S,R){do{const j=w.charCodeAt(S);if(j!==32&&j!==9)return S}while(++S<R);return R}function p(w,S,R){for(;S>R;){const j=w.charCodeAt(--S);if(j!==32&&j!==9)return S+1}return R}function m(w,S,R){const j=(R==null?void 0:R.encode)||encodeURIComponent;if(!n.test(w))throw new TypeError(`argument name is invalid: ${w}`);const N=j(S);if(!e.test(N))throw new TypeError(`argument val is invalid: ${S}`);let O=w+"="+N;if(!R)return O;if(R.maxAge!==void 0){if(!Number.isInteger(R.maxAge))throw new TypeError(`option maxAge is invalid: ${R.maxAge}`);O+="; Max-Age="+R.maxAge}if(R.domain){if(!t.test(R.domain))throw new TypeError(`option domain is invalid: ${R.domain}`);O+="; Domain="+R.domain}if(R.path){if(!i.test(R.path))throw new TypeError(`option path is invalid: ${R.path}`);O+="; Path="+R.path}if(R.expires){if(!E(R.expires)||!Number.isFinite(R.expires.valueOf()))throw new TypeError(`option expires is invalid: ${R.expires}`);O+="; Expires="+R.expires.toUTCString()}if(R.httpOnly&&(O+="; HttpOnly"),R.secure&&(O+="; Secure"),R.partitioned&&(O+="; Partitioned"),R.priority)switch(typeof R.priority=="string"?R.priority.toLowerCase():void 0){case"low":O+="; Priority=Low";break;case"medium":O+="; Priority=Medium";break;case"high":O+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${R.priority}`)}if(R.sameSite)switch(typeof R.sameSite=="string"?R.sameSite.toLowerCase():R.sameSite){case!0:case"strict":O+="; SameSite=Strict";break;case"lax":O+="; SameSite=Lax";break;case"none":O+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${R.sameSite}`)}return O}function v(w){if(w.indexOf("%")===-1)return w;try{return decodeURIComponent(w)}catch{return w}}function E(w){return o.call(w)==="[object Date]"}return Za}G1();/**
 * react-router v7.0.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var sy="popstate";function W1(n={}){function e(i,o){let{pathname:a,search:c,hash:d}=i.location;return cf("",{pathname:a,search:c,hash:d},o.state&&o.state.usr||null,o.state&&o.state.key||"default")}function t(i,o){return typeof o=="string"?o:gl(o)}return Q1(e,t,null,n)}function ct(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function qi(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function K1(){return Math.random().toString(36).substring(2,10)}function oy(n,e){return{usr:n.state,key:n.key,idx:e}}function cf(n,e,t=null,i){return{pathname:typeof n=="string"?n:n.pathname,search:"",hash:"",...typeof e=="string"?Yo(e):e,state:t,key:e&&e.key||i||K1()}}function gl({pathname:n="/",search:e="",hash:t=""}){return e&&e!=="?"&&(n+=e.charAt(0)==="?"?e:"?"+e),t&&t!=="#"&&(n+=t.charAt(0)==="#"?t:"#"+t),n}function Yo(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substring(t),n=n.substring(0,t));let i=n.indexOf("?");i>=0&&(e.search=n.substring(i),n=n.substring(0,i)),n&&(e.pathname=n)}return e}function Q1(n,e,t,i={}){let{window:o=document.defaultView,v5Compat:a=!1}=i,c=o.history,d="POP",p=null,m=v();m==null&&(m=0,c.replaceState({...c.state,idx:m},""));function v(){return(c.state||{idx:null}).idx}function E(){d="POP";let N=v(),O=N==null?null:N-m;m=N,p&&p({action:d,location:j.location,delta:O})}function w(N,O){d="PUSH";let U=cf(j.location,N,O);m=v()+1;let q=oy(U,m),J=j.createHref(U);try{c.pushState(q,"",J)}catch(W){if(W instanceof DOMException&&W.name==="DataCloneError")throw W;o.location.assign(J)}a&&p&&p({action:d,location:j.location,delta:1})}function S(N,O){d="REPLACE";let U=cf(j.location,N,O);m=v();let q=oy(U,m),J=j.createHref(U);c.replaceState(q,"",J),a&&p&&p({action:d,location:j.location,delta:0})}function R(N){let O=o.location.origin!=="null"?o.location.origin:o.location.href,U=typeof N=="string"?N:gl(N);return U=U.replace(/ $/,"%20"),ct(O,`No window.location.(origin|href) available to create URL for href: ${U}`),new URL(U,O)}let j={get action(){return d},get location(){return n(o,c)},listen(N){if(p)throw new Error("A history only accepts one active listener");return o.addEventListener(sy,E),p=N,()=>{o.removeEventListener(sy,E),p=null}},createHref(N){return e(o,N)},createURL:R,encodeLocation(N){let O=R(N);return{pathname:O.pathname,search:O.search,hash:O.hash}},push:w,replace:S,go(N){return c.go(N)}};return j}function Vv(n,e,t="/"){return Y1(n,e,t,!1)}function Y1(n,e,t,i){let o=typeof e=="string"?Yo(e):e,a=Fi(o.pathname||"/",t);if(a==null)return null;let c=Fv(n);X1(c);let d=null;for(let p=0;d==null&&p<c.length;++p){let m=lw(a);d=ow(c[p],m,i)}return d}function Fv(n,e=[],t=[],i=""){let o=(a,c,d)=>{let p={relativePath:d===void 0?a.path||"":d,caseSensitive:a.caseSensitive===!0,childrenIndex:c,route:a};p.relativePath.startsWith("/")&&(ct(p.relativePath.startsWith(i),`Absolute route path "${p.relativePath}" nested under path "${i}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),p.relativePath=p.relativePath.slice(i.length));let m=Yr([i,p.relativePath]),v=t.concat(p);a.children&&a.children.length>0&&(ct(a.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${m}".`),Fv(a.children,e,v,m)),!(a.path==null&&!a.index)&&e.push({path:m,score:iw(m,a.index),routesMeta:v})};return n.forEach((a,c)=>{var d;if(a.path===""||!((d=a.path)!=null&&d.includes("?")))o(a,c);else for(let p of Uv(a.path))o(a,c,p)}),e}function Uv(n){let e=n.split("/");if(e.length===0)return[];let[t,...i]=e,o=t.endsWith("?"),a=t.replace(/\?$/,"");if(i.length===0)return o?[a,""]:[a];let c=Uv(i.join("/")),d=[];return d.push(...c.map(p=>p===""?a:[a,p].join("/"))),o&&d.push(...c),d.map(p=>n.startsWith("/")&&p===""?"/":p)}function X1(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:sw(e.routesMeta.map(i=>i.childrenIndex),t.routesMeta.map(i=>i.childrenIndex)))}var J1=/^:[\w-]+$/,Z1=3,ew=2,tw=1,nw=10,rw=-2,ay=n=>n==="*";function iw(n,e){let t=n.split("/"),i=t.length;return t.some(ay)&&(i+=rw),e&&(i+=ew),t.filter(o=>!ay(o)).reduce((o,a)=>o+(J1.test(a)?Z1:a===""?tw:nw),i)}function sw(n,e){return n.length===e.length&&n.slice(0,-1).every((i,o)=>i===e[o])?n[n.length-1]-e[e.length-1]:0}function ow(n,e,t=!1){let{routesMeta:i}=n,o={},a="/",c=[];for(let d=0;d<i.length;++d){let p=i[d],m=d===i.length-1,v=a==="/"?e:e.slice(a.length)||"/",E=xu({path:p.relativePath,caseSensitive:p.caseSensitive,end:m},v),w=p.route;if(!E&&m&&t&&!i[i.length-1].route.index&&(E=xu({path:p.relativePath,caseSensitive:p.caseSensitive,end:!1},v)),!E)return null;Object.assign(o,E.params),c.push({params:o,pathname:Yr([a,E.pathname]),pathnameBase:hw(Yr([a,E.pathnameBase])),route:w}),E.pathnameBase!=="/"&&(a=Yr([a,E.pathnameBase]))}return c}function xu(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,i]=aw(n.path,n.caseSensitive,n.end),o=e.match(t);if(!o)return null;let a=o[0],c=a.replace(/(.)\/+$/,"$1"),d=o.slice(1);return{params:i.reduce((m,{paramName:v,isOptional:E},w)=>{if(v==="*"){let R=d[w]||"";c=a.slice(0,a.length-R.length).replace(/(.)\/+$/,"$1")}const S=d[w];return E&&!S?m[v]=void 0:m[v]=(S||"").replace(/%2F/g,"/"),m},{}),pathname:a,pathnameBase:c,pattern:n}}function aw(n,e=!1,t=!0){qi(n==="*"||!n.endsWith("*")||n.endsWith("/*"),`Route path "${n}" will be treated as if it were "${n.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${n.replace(/\*$/,"/*")}".`);let i=[],o="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(c,d,p)=>(i.push({paramName:d,isOptional:p!=null}),p?"/?([^\\/]+)?":"/([^\\/]+)"));return n.endsWith("*")?(i.push({paramName:"*"}),o+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?o+="\\/*$":n!==""&&n!=="/"&&(o+="(?:(?=\\/|$))"),[new RegExp(o,e?void 0:"i"),i]}function lw(n){try{return n.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return qi(!1,`The URL path "${n}" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),n}}function Fi(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,i=n.charAt(t);return i&&i!=="/"?null:n.slice(t)||"/"}function cw(n,e="/"){let{pathname:t,search:i="",hash:o=""}=typeof n=="string"?Yo(n):n;return{pathname:t?t.startsWith("/")?t:uw(t,e):e,search:fw(i),hash:pw(o)}}function uw(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(o=>{o===".."?t.length>1&&t.pop():o!=="."&&t.push(o)}),t.length>1?t.join("/"):"/"}function Hh(n,e,t,i){return`Cannot include a '${n}' character in a manually specified \`to.${e}\` field [${JSON.stringify(i)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function dw(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function Bv(n){let e=dw(n);return e.map((t,i)=>i===e.length-1?t.pathname:t.pathnameBase)}function zv(n,e,t,i=!1){let o;typeof n=="string"?o=Yo(n):(o={...n},ct(!o.pathname||!o.pathname.includes("?"),Hh("?","pathname","search",o)),ct(!o.pathname||!o.pathname.includes("#"),Hh("#","pathname","hash",o)),ct(!o.search||!o.search.includes("#"),Hh("#","search","hash",o)));let a=n===""||o.pathname==="",c=a?"/":o.pathname,d;if(c==null)d=t;else{let E=e.length-1;if(!i&&c.startsWith("..")){let w=c.split("/");for(;w[0]==="..";)w.shift(),E-=1;o.pathname=w.join("/")}d=E>=0?e[E]:"/"}let p=cw(o,d),m=c&&c!=="/"&&c.endsWith("/"),v=(a||c===".")&&t.endsWith("/");return!p.pathname.endsWith("/")&&(m||v)&&(p.pathname+="/"),p}var Yr=n=>n.join("/").replace(/\/\/+/g,"/"),hw=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),fw=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,pw=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n;function mw(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}var $v=["POST","PUT","PATCH","DELETE"];new Set($v);var gw=["GET",...$v];new Set(gw);var Xo=b.createContext(null);Xo.displayName="DataRouter";var qu=b.createContext(null);qu.displayName="DataRouterState";var Hv=b.createContext({isTransitioning:!1});Hv.displayName="ViewTransition";var yw=b.createContext(new Map);yw.displayName="Fetchers";var vw=b.createContext(null);vw.displayName="Await";var Rr=b.createContext(null);Rr.displayName="Navigation";var Cl=b.createContext(null);Cl.displayName="Location";var Ar=b.createContext({outlet:null,matches:[],isDataRoute:!1});Ar.displayName="Route";var qf=b.createContext(null);qf.displayName="RouteError";function _w(n,{relative:e}={}){ct(kl(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:i}=b.useContext(Rr),{hash:o,pathname:a,search:c}=bl(n,{relative:e}),d=a;return t!=="/"&&(d=a==="/"?t:Yr([t,a])),i.createHref({pathname:d,search:c,hash:o})}function kl(){return b.useContext(Cl)!=null}function Gi(){return ct(kl(),"useLocation() may be used only in the context of a <Router> component."),b.useContext(Cl).location}var qv="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function Gv(n){b.useContext(Rr).static||b.useLayoutEffect(n)}function Wv(){let{isDataRoute:n}=b.useContext(Ar);return n?Dw():Ew()}function Ew(){ct(kl(),"useNavigate() may be used only in the context of a <Router> component.");let n=b.useContext(Xo),{basename:e,navigator:t}=b.useContext(Rr),{matches:i}=b.useContext(Ar),{pathname:o}=Gi(),a=JSON.stringify(Bv(i)),c=b.useRef(!1);return Gv(()=>{c.current=!0}),b.useCallback((p,m={})=>{if(qi(c.current,qv),!c.current)return;if(typeof p=="number"){t.go(p);return}let v=zv(p,JSON.parse(a),o,m.relative==="path");n==null&&e!=="/"&&(v.pathname=v.pathname==="/"?e:Yr([e,v.pathname])),(m.replace?t.replace:t.push)(v,m.state,m)},[e,t,a,o,n])}b.createContext(null);function ww(){let{matches:n}=b.useContext(Ar),e=n[n.length-1];return e?e.params:{}}function bl(n,{relative:e}={}){let{matches:t}=b.useContext(Ar),{pathname:i}=Gi(),o=JSON.stringify(Bv(t));return b.useMemo(()=>zv(n,JSON.parse(o),i,e==="path"),[n,o,i,e])}function Tw(n,e){return Kv(n,e)}function Kv(n,e,t,i){var j;ct(kl(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:o}=b.useContext(Rr),{matches:a}=b.useContext(Ar),c=a[a.length-1],d=c?c.params:{};c&&c.pathname;let p=c?c.pathnameBase:"/";c&&c.route;let m=Gi(),v;if(e){let N=typeof e=="string"?Yo(e):e;ct(p==="/"||((j=N.pathname)==null?void 0:j.startsWith(p)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${p}" but pathname "${N.pathname}" was given in the \`location\` prop.`),v=N}else v=m;let E=v.pathname||"/",w=E;if(p!=="/"){let N=p.replace(/^\//,"").split("/");w="/"+E.replace(/^\//,"").split("/").slice(N.length).join("/")}let S=Vv(n,{pathname:w}),R=Aw(S&&S.map(N=>Object.assign({},N,{params:Object.assign({},d,N.params),pathname:Yr([p,o.encodeLocation?o.encodeLocation(N.pathname).pathname:N.pathname]),pathnameBase:N.pathnameBase==="/"?p:Yr([p,o.encodeLocation?o.encodeLocation(N.pathnameBase).pathname:N.pathnameBase])})),a,t,i);return e&&R?b.createElement(Cl.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...v},navigationType:"POP"}},R):R}function Sw(){let n=Pw(),e=mw(n)?`${n.status} ${n.statusText}`:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,o={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return b.createElement(b.Fragment,null,b.createElement("h2",null,"Unexpected Application Error!"),b.createElement("h3",{style:{fontStyle:"italic"}},e),t?b.createElement("pre",{style:o},t):null,null)}var xw=b.createElement(Sw,null),Iw=class extends b.Component{constructor(n){super(n),this.state={location:n.location,revalidation:n.revalidation,error:n.error}}static getDerivedStateFromError(n){return{error:n}}static getDerivedStateFromProps(n,e){return e.location!==n.location||e.revalidation!=="idle"&&n.revalidation==="idle"?{error:n.error,location:n.location,revalidation:n.revalidation}:{error:n.error!==void 0?n.error:e.error,location:e.location,revalidation:n.revalidation||e.revalidation}}componentDidCatch(n,e){console.error("React Router caught the following error during render",n,e)}render(){return this.state.error!==void 0?b.createElement(Ar.Provider,{value:this.props.routeContext},b.createElement(qf.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function Rw({routeContext:n,match:e,children:t}){let i=b.useContext(Xo);return i&&i.static&&i.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=e.route.id),b.createElement(Ar.Provider,{value:n},t)}function Aw(n,e=[],t=null,i=null){if(n==null){if(!t)return null;if(t.errors)n=t.matches;else if(e.length===0&&!t.initialized&&t.matches.length>0)n=t.matches;else return null}let o=n,a=t==null?void 0:t.errors;if(a!=null){let p=o.findIndex(m=>m.route.id&&(a==null?void 0:a[m.route.id])!==void 0);ct(p>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(a).join(",")}`),o=o.slice(0,Math.min(o.length,p+1))}let c=!1,d=-1;if(t)for(let p=0;p<o.length;p++){let m=o[p];if((m.route.HydrateFallback||m.route.hydrateFallbackElement)&&(d=p),m.route.id){let{loaderData:v,errors:E}=t,w=m.route.loader&&!v.hasOwnProperty(m.route.id)&&(!E||E[m.route.id]===void 0);if(m.route.lazy||w){c=!0,d>=0?o=o.slice(0,d+1):o=[o[0]];break}}}return o.reduceRight((p,m,v)=>{let E,w=!1,S=null,R=null;t&&(E=a&&m.route.id?a[m.route.id]:void 0,S=m.route.errorElement||xw,c&&(d<0&&v===0?(jw("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),w=!0,R=null):d===v&&(w=!0,R=m.route.hydrateFallbackElement||null)));let j=e.concat(o.slice(0,v+1)),N=()=>{let O;return E?O=S:w?O=R:m.route.Component?O=b.createElement(m.route.Component,null):m.route.element?O=m.route.element:O=p,b.createElement(Rw,{match:m,routeContext:{outlet:p,matches:j,isDataRoute:t!=null},children:O})};return t&&(m.route.ErrorBoundary||m.route.errorElement||v===0)?b.createElement(Iw,{location:t.location,revalidation:t.revalidation,component:S,error:E,children:N(),routeContext:{outlet:null,matches:j,isDataRoute:!0}}):N()},null)}function Gf(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Cw(n){let e=b.useContext(Xo);return ct(e,Gf(n)),e}function kw(n){let e=b.useContext(qu);return ct(e,Gf(n)),e}function bw(n){let e=b.useContext(Ar);return ct(e,Gf(n)),e}function Wf(n){let e=bw(n),t=e.matches[e.matches.length-1];return ct(t.route.id,`${n} can only be used on routes that contain a unique "id"`),t.route.id}function Nw(){return Wf("useRouteId")}function Pw(){var i;let n=b.useContext(qf),e=kw("useRouteError"),t=Wf("useRouteError");return n!==void 0?n:(i=e.errors)==null?void 0:i[t]}function Dw(){let{router:n}=Cw("useNavigate"),e=Wf("useNavigate"),t=b.useRef(!1);return Gv(()=>{t.current=!0}),b.useCallback(async(o,a={})=>{qi(t.current,qv),t.current&&(typeof o=="number"?n.navigate(o):await n.navigate(o,{fromRouteId:e,...a}))},[n,e])}var ly={};function jw(n,e,t){ly[n]||(ly[n]=!0,qi(!1,t))}b.memo(Ow);function Ow({routes:n,future:e,state:t}){return Kv(n,void 0,t,e)}function gr(n){ct(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function Lw({basename:n="/",children:e=null,location:t,navigationType:i="POP",navigator:o,static:a=!1}){ct(!kl(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let c=n.replace(/^\/*/,"/"),d=b.useMemo(()=>({basename:c,navigator:o,static:a,future:{}}),[c,o,a]);typeof t=="string"&&(t=Yo(t));let{pathname:p="/",search:m="",hash:v="",state:E=null,key:w="default"}=t,S=b.useMemo(()=>{let R=Fi(p,c);return R==null?null:{location:{pathname:R,search:m,hash:v,state:E,key:w},navigationType:i}},[c,p,m,v,E,w,i]);return qi(S!=null,`<Router basename="${c}"> is not able to match the URL "${p}${m}${v}" because it does not start with the basename, so the <Router> won't render anything.`),S==null?null:b.createElement(Rr.Provider,{value:d},b.createElement(Cl.Provider,{children:e,value:S}))}function Mw({children:n,location:e}){return Tw(uf(n),e)}function uf(n,e=[]){let t=[];return b.Children.forEach(n,(i,o)=>{if(!b.isValidElement(i))return;let a=[...e,o];if(i.type===b.Fragment){t.push.apply(t,uf(i.props.children,a));return}ct(i.type===gr,`[${typeof i.type=="string"?i.type:i.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),ct(!i.props.index||!i.props.children,"An index route cannot have child routes.");let c={id:i.props.id||a.join("-"),caseSensitive:i.props.caseSensitive,element:i.props.element,Component:i.props.Component,index:i.props.index,path:i.props.path,loader:i.props.loader,action:i.props.action,hydrateFallbackElement:i.props.hydrateFallbackElement,HydrateFallback:i.props.HydrateFallback,errorElement:i.props.errorElement,ErrorBoundary:i.props.ErrorBoundary,hasErrorBoundary:i.props.hasErrorBoundary===!0||i.props.ErrorBoundary!=null||i.props.errorElement!=null,shouldRevalidate:i.props.shouldRevalidate,handle:i.props.handle,lazy:i.props.lazy};i.props.children&&(c.children=uf(i.props.children,a)),t.push(c)}),t}var fu="get",pu="application/x-www-form-urlencoded";function Gu(n){return n!=null&&typeof n.tagName=="string"}function Vw(n){return Gu(n)&&n.tagName.toLowerCase()==="button"}function Fw(n){return Gu(n)&&n.tagName.toLowerCase()==="form"}function Uw(n){return Gu(n)&&n.tagName.toLowerCase()==="input"}function Bw(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function zw(n,e){return n.button===0&&(!e||e==="_self")&&!Bw(n)}var ou=null;function $w(){if(ou===null)try{new FormData(document.createElement("form"),0),ou=!1}catch{ou=!0}return ou}var Hw=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function qh(n){return n!=null&&!Hw.has(n)?(qi(!1,`"${n}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${pu}"`),null):n}function qw(n,e){let t,i,o,a,c;if(Fw(n)){let d=n.getAttribute("action");i=d?Fi(d,e):null,t=n.getAttribute("method")||fu,o=qh(n.getAttribute("enctype"))||pu,a=new FormData(n)}else if(Vw(n)||Uw(n)&&(n.type==="submit"||n.type==="image")){let d=n.form;if(d==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let p=n.getAttribute("formaction")||d.getAttribute("action");if(i=p?Fi(p,e):null,t=n.getAttribute("formmethod")||d.getAttribute("method")||fu,o=qh(n.getAttribute("formenctype"))||qh(d.getAttribute("enctype"))||pu,a=new FormData(d,n),!$w()){let{name:m,type:v,value:E}=n;if(v==="image"){let w=m?`${m}.`:"";a.append(`${w}x`,"0"),a.append(`${w}y`,"0")}else m&&a.append(m,E)}}else{if(Gu(n))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=fu,i=null,o=pu,c=n}return a&&o==="text/plain"&&(c=a,a=void 0),{action:i,method:t.toLowerCase(),encType:o,formData:a,body:c}}function Kf(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}async function Gw(n,e){if(n.id in e)return e[n.id];try{let t=await import(n.module);return e[n.id]=t,t}catch(t){return console.error(`Error loading route module \`${n.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function Ww(n){return n==null?!1:n.href==null?n.rel==="preload"&&typeof n.imageSrcSet=="string"&&typeof n.imageSizes=="string":typeof n.rel=="string"&&typeof n.href=="string"}async function Kw(n,e,t){let i=await Promise.all(n.map(async o=>{let a=e.routes[o.route.id];if(a){let c=await Gw(a,t);return c.links?c.links():[]}return[]}));return Jw(i.flat(1).filter(Ww).filter(o=>o.rel==="stylesheet"||o.rel==="preload").map(o=>o.rel==="stylesheet"?{...o,rel:"prefetch",as:"style"}:{...o,rel:"prefetch"}))}function cy(n,e,t,i,o,a){let c=(p,m)=>t[m]?p.route.id!==t[m].route.id:!0,d=(p,m)=>{var v;return t[m].pathname!==p.pathname||((v=t[m].route.path)==null?void 0:v.endsWith("*"))&&t[m].params["*"]!==p.params["*"]};return a==="assets"?e.filter((p,m)=>c(p,m)||d(p,m)):a==="data"?e.filter((p,m)=>{var E;let v=i.routes[p.route.id];if(!v||!v.hasLoader)return!1;if(c(p,m)||d(p,m))return!0;if(p.route.shouldRevalidate){let w=p.route.shouldRevalidate({currentUrl:new URL(o.pathname+o.search+o.hash,window.origin),currentParams:((E=t[0])==null?void 0:E.params)||{},nextUrl:new URL(n,window.origin),nextParams:p.params,defaultShouldRevalidate:!0});if(typeof w=="boolean")return w}return!0}):[]}function Qw(n,e){return Yw(n.map(t=>{let i=e.routes[t.route.id];if(!i)return[];let o=[i.module];return i.imports&&(o=o.concat(i.imports)),o}).flat(1))}function Yw(n){return[...new Set(n)]}function Xw(n){let e={},t=Object.keys(n).sort();for(let i of t)e[i]=n[i];return e}function Jw(n,e){let t=new Set;return new Set(e),n.reduce((i,o)=>{let a=JSON.stringify(Xw(o));return t.has(a)||(t.add(a),i.push({key:a,link:o})),i},[])}function Zw(n){let e=typeof n=="string"?new URL(n,typeof window>"u"?"server://singlefetch/":window.location.origin):n;return e.pathname==="/"?e.pathname="_root.data":e.pathname=`${e.pathname.replace(/\/$/,"")}.data`,e}function eT(){let n=b.useContext(Xo);return Kf(n,"You must render this element inside a <DataRouterContext.Provider> element"),n}function tT(){let n=b.useContext(qu);return Kf(n,"You must render this element inside a <DataRouterStateContext.Provider> element"),n}var Qf=b.createContext(void 0);Qf.displayName="FrameworkContext";function Qv(){let n=b.useContext(Qf);return Kf(n,"You must render this element inside a <HydratedRouter> element"),n}function nT(n,e){let t=b.useContext(Qf),[i,o]=b.useState(!1),[a,c]=b.useState(!1),{onFocus:d,onBlur:p,onMouseEnter:m,onMouseLeave:v,onTouchStart:E}=e,w=b.useRef(null);b.useEffect(()=>{if(n==="render"&&c(!0),n==="viewport"){let j=O=>{O.forEach(U=>{c(U.isIntersecting)})},N=new IntersectionObserver(j,{threshold:.5});return w.current&&N.observe(w.current),()=>{N.disconnect()}}},[n]),b.useEffect(()=>{if(i){let j=setTimeout(()=>{c(!0)},100);return()=>{clearTimeout(j)}}},[i]);let S=()=>{o(!0)},R=()=>{o(!1),c(!1)};return t?n!=="intent"?[a,w,{}]:[a,w,{onFocus:el(d,S),onBlur:el(p,R),onMouseEnter:el(m,S),onMouseLeave:el(v,R),onTouchStart:el(E,S)}]:[!1,w,{}]}function el(n,e){return t=>{n&&n(t),t.defaultPrevented||e(t)}}function rT({page:n,...e}){let{router:t}=eT(),i=b.useMemo(()=>Vv(t.routes,n,t.basename),[t.routes,n,t.basename]);return i?b.createElement(sT,{page:n,matches:i,...e}):(console.warn(`Tried to prefetch ${n} but no routes matched.`),null)}function iT(n){let{manifest:e,routeModules:t}=Qv(),[i,o]=b.useState([]);return b.useEffect(()=>{let a=!1;return Kw(n,e,t).then(c=>{a||o(c)}),()=>{a=!0}},[n,e,t]),i}function sT({page:n,matches:e,...t}){let i=Gi(),{manifest:o,routeModules:a}=Qv(),{loaderData:c,matches:d}=tT(),p=b.useMemo(()=>cy(n,e,d,o,i,"data"),[n,e,d,o,i]),m=b.useMemo(()=>cy(n,e,d,o,i,"assets"),[n,e,d,o,i]),v=b.useMemo(()=>{if(n===i.pathname+i.search+i.hash)return[];let S=new Set,R=!1;if(e.forEach(N=>{var U;let O=o.routes[N.route.id];!O||!O.hasLoader||(!p.some(q=>q.route.id===N.route.id)&&N.route.id in c&&((U=a[N.route.id])!=null&&U.shouldRevalidate)||O.hasClientLoader?R=!0:S.add(N.route.id))}),S.size===0)return[];let j=Zw(n);return R&&S.size>0&&j.searchParams.set("_routes",e.filter(N=>S.has(N.route.id)).map(N=>N.route.id).join(",")),[j.pathname+j.search]},[c,i,o,p,e,n,a]),E=b.useMemo(()=>Qw(m,o),[m,o]),w=iT(m);return b.createElement(b.Fragment,null,v.map(S=>b.createElement("link",{key:S,rel:"prefetch",as:"fetch",href:S,...t})),E.map(S=>b.createElement("link",{key:S,rel:"modulepreload",href:S,...t})),w.map(({key:S,link:R})=>b.createElement("link",{key:S,...R})))}function oT(...n){return e=>{n.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var Yv=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{Yv&&(window.__reactRouterVersion="7.0.1")}catch{}function aT({basename:n,children:e,window:t}){let i=b.useRef();i.current==null&&(i.current=W1({window:t,v5Compat:!0}));let o=i.current,[a,c]=b.useState({action:o.action,location:o.location}),d=b.useCallback(p=>{b.startTransition(()=>c(p))},[c]);return b.useLayoutEffect(()=>o.listen(d),[o,d]),b.createElement(Lw,{basename:n,children:e,location:a.location,navigationType:a.action,navigator:o})}var Xv=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,er=b.forwardRef(function({onClick:e,discover:t="render",prefetch:i="none",relative:o,reloadDocument:a,replace:c,state:d,target:p,to:m,preventScrollReset:v,viewTransition:E,...w},S){let{basename:R}=b.useContext(Rr),j=typeof m=="string"&&Xv.test(m),N,O=!1;if(typeof m=="string"&&j&&(N=m,Yv))try{let A=new URL(window.location.href),P=m.startsWith("//")?new URL(A.protocol+m):new URL(m),M=Fi(P.pathname,R);P.origin===A.origin&&M!=null?m=M+P.search+P.hash:O=!0}catch{qi(!1,`<Link to="${m}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let U=_w(m,{relative:o}),[q,J,W]=nT(i,w),Q=dT(m,{replace:c,state:d,target:p,preventScrollReset:v,relative:o,viewTransition:E});function k(A){e&&e(A),A.defaultPrevented||Q(A)}let x=b.createElement("a",{...w,...W,href:N||U,onClick:O||a?e:k,ref:oT(S,J),target:p,"data-discover":!j&&t==="render"?"true":void 0});return q&&!j?b.createElement(b.Fragment,null,x,b.createElement(rT,{page:U})):x});er.displayName="Link";var lT=b.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:i="",end:o=!1,style:a,to:c,viewTransition:d,children:p,...m},v){let E=bl(c,{relative:m.relative}),w=Gi(),S=b.useContext(qu),{navigator:R,basename:j}=b.useContext(Rr),N=S!=null&&gT(E)&&d===!0,O=R.encodeLocation?R.encodeLocation(E).pathname:E.pathname,U=w.pathname,q=S&&S.navigation&&S.navigation.location?S.navigation.location.pathname:null;t||(U=U.toLowerCase(),q=q?q.toLowerCase():null,O=O.toLowerCase()),q&&j&&(q=Fi(q,j)||q);const J=O!=="/"&&O.endsWith("/")?O.length-1:O.length;let W=U===O||!o&&U.startsWith(O)&&U.charAt(J)==="/",Q=q!=null&&(q===O||!o&&q.startsWith(O)&&q.charAt(O.length)==="/"),k={isActive:W,isPending:Q,isTransitioning:N},x=W?e:void 0,A;typeof i=="function"?A=i(k):A=[i,W?"active":null,Q?"pending":null,N?"transitioning":null].filter(Boolean).join(" ");let P=typeof a=="function"?a(k):a;return b.createElement(er,{...m,"aria-current":x,className:A,ref:v,style:P,to:c,viewTransition:d},typeof p=="function"?p(k):p)});lT.displayName="NavLink";var cT=b.forwardRef(({discover:n="render",fetcherKey:e,navigate:t,reloadDocument:i,replace:o,state:a,method:c=fu,action:d,onSubmit:p,relative:m,preventScrollReset:v,viewTransition:E,...w},S)=>{let R=pT(),j=mT(d,{relative:m}),N=c.toLowerCase()==="get"?"get":"post",O=typeof d=="string"&&Xv.test(d),U=q=>{if(p&&p(q),q.defaultPrevented)return;q.preventDefault();let J=q.nativeEvent.submitter,W=(J==null?void 0:J.getAttribute("formmethod"))||c;R(J||q.currentTarget,{fetcherKey:e,method:W,navigate:t,replace:o,state:a,relative:m,preventScrollReset:v,viewTransition:E})};return b.createElement("form",{ref:S,method:N,action:j,onSubmit:i?p:U,...w,"data-discover":!O&&n==="render"?"true":void 0})});cT.displayName="Form";function uT(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Jv(n){let e=b.useContext(Xo);return ct(e,uT(n)),e}function dT(n,{target:e,replace:t,state:i,preventScrollReset:o,relative:a,viewTransition:c}={}){let d=Wv(),p=Gi(),m=bl(n,{relative:a});return b.useCallback(v=>{if(zw(v,e)){v.preventDefault();let E=t!==void 0?t:gl(p)===gl(m);d(n,{replace:E,state:i,preventScrollReset:o,relative:a,viewTransition:c})}},[p,d,m,t,i,e,n,o,a,c])}var hT=0,fT=()=>`__${String(++hT)}__`;function pT(){let{router:n}=Jv("useSubmit"),{basename:e}=b.useContext(Rr),t=Nw();return b.useCallback(async(i,o={})=>{let{action:a,method:c,encType:d,formData:p,body:m}=qw(i,e);if(o.navigate===!1){let v=o.fetcherKey||fT();await n.fetch(v,t,o.action||a,{preventScrollReset:o.preventScrollReset,formData:p,body:m,formMethod:o.method||c,formEncType:o.encType||d,flushSync:o.flushSync})}else await n.navigate(o.action||a,{preventScrollReset:o.preventScrollReset,formData:p,body:m,formMethod:o.method||c,formEncType:o.encType||d,replace:o.replace,state:o.state,fromRouteId:t,flushSync:o.flushSync,viewTransition:o.viewTransition})},[n,e,t])}function mT(n,{relative:e}={}){let{basename:t}=b.useContext(Rr),i=b.useContext(Ar);ct(i,"useFormAction must be used inside a RouteContext");let[o]=i.matches.slice(-1),a={...bl(n||".",{relative:e})},c=Gi();if(n==null){a.search=c.search;let d=new URLSearchParams(a.search),p=d.getAll("index");if(p.some(v=>v==="")){d.delete("index"),p.filter(E=>E).forEach(E=>d.append("index",E));let v=d.toString();a.search=v?`?${v}`:""}}return(!n||n===".")&&o.route.index&&(a.search=a.search?a.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(a.pathname=a.pathname==="/"?t:Yr([t,a.pathname])),gl(a)}function gT(n,e={}){let t=b.useContext(Hv);ct(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:i}=Jv("useViewTransitionState"),o=bl(n,{relative:e.relative});if(!t.isTransitioning)return!1;let a=Fi(t.currentLocation.pathname,i)||t.currentLocation.pathname,c=Fi(t.nextLocation.pathname,i)||t.nextLocation.pathname;return xu(o.pathname,c)!=null||xu(o.pathname,a)!=null}new TextEncoder;var yT=Mv();const Yf=()=>f.jsxs("svg",{viewBox:"0 0 48 48",version:"1",xmlns:"http://www.w3.org/2000/svg",className:"w-4 h-4",role:"img","aria-hidden":"true",children:[f.jsx("g",{id:"SVGRepo_bgCarrier",strokeWidth:"0"}),f.jsx("g",{id:"SVGRepo_tracerCarrier",strokeLinecap:"round",strokeLinejoin:"round"}),f.jsxs("g",{id:"SVGRepo_iconCarrier",children:[" ",f.jsx("polygon",{fill:"currentColor",points:"40.6,12.1 17,35.7 7.4,26.1 4.6,29 17,41.3 43.4,14.9"})," "]})]}),Zv=()=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"w-4 h-4",role:"img","aria-hidden":"true",children:f.jsx("path",{d:"m6 9 6 6 6-6"})}),e0=()=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"w-4 h-4",role:"img","aria-hidden":"true",children:f.jsx("path",{d:"m18 15-6-6-6 6"})}),rn=()=>f.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",role:"img","aria-hidden":"true",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),vT=()=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"w-4 h-4",children:f.jsx("path",{d:"m 3.75,4.25 h 14 c 1.108,0 2,0.892 2,2 v 14 c 0,1.108 -0.892,2 -2,2 h -14 c -1.108,0 -2,-0.892 -2,-2 v -14 c 0,-1.108 0.892,-2 2,-2 z m 2.5,-2.5 h 14 c 1.108,0 2,0.892 2,2 v 14"})}),Wu=()=>f.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"w-4 h-4",role:"img","aria-hidden":"true",children:[f.jsx("path",{d:"M12 20h9"}),f.jsx("path",{d:"M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4 9.5-9.5z"})]}),_T=()=>f.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"w-4 h-4",role:"img","aria-hidden":"true",children:[f.jsx("path",{d:"M21 6H3"}),f.jsx("path",{d:"M10 12H21"}),f.jsx("path",{d:"M15 18H21"})]}),t0=()=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",className:"w-4 h-4",children:f.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v6z"})}),ET=()=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 locked",viewBox:"0 0 24 24",fill:"currentColor",stroke:"currentColor",strokeWidth:2,children:f.jsx("path",{d:"m8 11v-4c0-5.3333 8-5.3333 8 0v4h2c1.1046 0 2 0.89543 2 2v7c0 1.1046-0.89543 2-2 2h-12c-1.1046 0-2-0.89543-2-2v-7c0-1.1046 0.89543-2 2-2zm8.0466-3.9873c-0.016275-5.096-8.0033-4.9871-8.0233 0.019012-0.005291 1.3228-0.015873 3.9683-0.015873 3.9683h8.0519s-0.0085-2.6582-0.01273-3.9873z"})}),wT=()=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 unlocked",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,children:f.jsxs("svg",{fill:"none",stroke:"currentColor",strokeWidth:"2",className:"h-4 w-4",version:"1.1",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:[f.jsx("defs",{children:f.jsxs("mask",{id:"mask-powermask-path-effect4132",maskUnits:"userSpaceOnUse",children:[f.jsx("path",{id:"mask-powermask-path-effect4132_box",d:"m2 1h20v23h-20z",fill:"#fff"}),f.jsx("rect",{x:"13.737",y:"6.8416",width:"5.0534",height:"2.0496",d:"m 13.736565,6.8415651 h 5.053393 v 2.0496281 h -5.053393 z",fill:"none",stroke:"#000",strokeWidth:"2.1531"})]})}),f.jsx("path",{d:"m8 11v-4c0-5.3333 8-5.3333 8 0v4h2c1.1046 0 2 0.89543 2 2v7c0 1.1046-0.89543 2-2 2h-12c-1.1046 0-2-0.89543-2-2v-7c0-1.1046 0.89543-2 2-2zm8.0466-3.9873c-0.016275-5.096-8.0033-4.9871-8.0233 0.019012-0.005291 1.3228-0.015873 3.9683-0.015873 3.9683h8.0519s-0.0085-2.6582-0.01273-3.9873z",mask:"url(#mask-powermask-path-effect4132)"})]})}),Cs=({isVisible:n,children:e})=>f.jsx("div",{className:`
                transition-all duration-300 ease-in-out
                ${n?"max-h-[3300px] opacity-100":"max-h-0 opacity-0 overflow-hidden !m-0"}
            `,children:e}),Jo=({isOpen:n,onClose:e,title:t,children:i,fullHeight:o=!1})=>(b.useEffect(()=>{if(n){const a=window.scrollY;document.body.style.position="fixed",document.body.style.top=`-${a}px`,document.body.style.width="100%",document.body.style.overflow="hidden"}else document.body.style.position="",document.body.style.top="",document.body.style.width="",document.body.style.overflow="";return()=>{document.body.style.position="",document.body.style.top="",document.body.style.width="",document.body.style.overflow=""}},[n]),n?f.jsxs(f.Fragment,{children:[f.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-40 transition-opacity duration-300",role:"presentation"}),f.jsx("div",{className:"fixed inset-0 z-50",children:f.jsx("div",{className:`flex min-h-full ${o?"":"items-center"} justify-center p-4`,onClick:e,children:f.jsxs("div",{className:"relative transform overflow-hidden bg-dark-lighter border border-gray-600 shadow-xl transition-all w-full max-w-4xl max-h-[90vh] flex flex-col",onClick:a=>a.stopPropagation(),role:"dialog",children:[f.jsxs("div",{className:"px-6 py-4 border-b border-gray-600 flex justify-between items-center",children:[f.jsx("h3",{className:"text-xl font-semibold ",children:t}),f.jsx(ke,{"aria-label":"Close modal",variant:"secondary",onClick:e,children:f.jsx(rn,{})})]}),f.jsx("div",{className:"px-6 py-4 overflow-y-auto",children:i})]})})})]}):null),Nl=({isOpen:n,onClose:e,onConfirm:t,title:i,message:o,confirmLabel:a="Confirm",cancelLabel:c="Cancel"})=>{const d=()=>{t(),e()};return f.jsx(Jo,{isOpen:n,onClose:e,title:i,children:f.jsxs("div",{className:"space-y-4",children:[typeof o=="string"?f.jsx("p",{children:o}):o,f.jsxs("div",{className:"flex justify-end gap-3",children:[f.jsx(ke,{variant:"secondary",onClick:e,children:c}),f.jsx(ke,{variant:"danger",onClick:d,children:a})]})]})})},n0=({isOpen:n,onClose:e,title:t,children:i,position:o="right",width:a="w-80",hideCloseButton:c=!1})=>{const[d,p]=b.useState(!1),[m,v]=b.useState(!1);if(b.useEffect(()=>{if(n){const w=window.scrollY;document.body.style.position="fixed",document.body.style.top=`-${w}px`,document.body.style.width="100%",document.body.style.overflow="hidden",v(!0),requestAnimationFrame(()=>{requestAnimationFrame(()=>{p(!0)})})}else{const w=document.body.style.top;document.body.style.position="",document.body.style.top="",document.body.style.width="",document.body.style.overflow="",window.scrollTo(0,parseInt(w||"0")*-1),p(!1);const S=setTimeout(()=>v(!1),300);return()=>clearTimeout(S)}return()=>{document.body.style.position="",document.body.style.top="",document.body.style.width="",document.body.style.overflow=""}},[n]),!m)return null;const E=o==="left"?`${d?"translate-x-0":"-translate-x-full"}`:`${d?"translate-x-0":"translate-x-full"}`;return yT.createPortal(f.jsxs("div",{className:`
                fixed inset-0 z-50
                transition-opacity duration-300 ease-in-out
                ${d?"opacity-100":"opacity-0"}
            `,children:[f.jsx("div",{"data-testid":"offcanvas-backdrop",className:"absolute inset-0 bg-black bg-opacity-50",onClick:e}),f.jsxs("div",{"data-testid":"offcanvas-panel",className:`
                    fixed ${o}-0 top-0 h-full ${a}
                    bg-dark-lighter p-6 shadow-lg
                    transform transition-transform duration-300 ease-in-out overflow-y-auto
                    ${E}
                `,onClick:w=>w.stopPropagation(),children:[(t||!c)&&f.jsxs("div",{className:"flex justify-between items-center mb-6",children:[t&&f.jsx("h3",{className:"text-xl font-semibold ",children:t}),!c&&f.jsx(ke,{"aria-label":"Close offcanvas",variant:"secondary",onClick:e,children:f.jsx(rn,{})})]}),f.jsx("div",{className:`
                    transition-opacity duration-200 ease-in-out delay-150 h-[calc(100vh-3rem)]
                    ${d?"opacity-100":"opacity-0"}
                `,children:i})]})]}),document.body)},Tr=({title:n,description:e,children:t,action:i})=>f.jsxs("div",{className:"space-y-8",children:[f.jsxs("div",{children:[f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsx("h1",{className:"text-2xl font-bold ",children:n}),i&&f.jsx(ke,{"aria-label":i.label,variant:i.variant||"primary",onClick:i.onClick,children:i.label})]}),e&&f.jsx("p",{className:"text-sm text-gray-400 order-2 w-full",children:e})]}),t]}),ul="0.18.0",TT=[{version:"0.18.0",date:"2025-01-26",changes:["Added login","Added firebase storage","Styling & performance tweaks"]},{version:"0.17.0",date:"2025-01-21",changes:["Added gear upgrade analysis","Fixed a bug with gear/ship link"]},{version:"0.16.4",date:"2025-01-15",changes:["Added persistent filters/sorting on gear and ship inventories","Upgrade suggestion tweaks"]},{version:"0.16.3",date:"2025-01-13",changes:["Added upgrade suggestions","Added max limit to predefined modes secondary requirements"]},{version:"0.16.2",date:"2025-01-10",changes:["Added secondary requirements to autogear"]},{version:"0.16.1",date:"2025-01-09",changes:["Adjusted effective hp calculation to be much more accurate, thanks to Engwaraato for the new formula"]},{version:"0.16.0",date:"2025-01-09",changes:["Added backup and restore feature","Added ship details page with stat breakdown, refits and implants and gear slot analysis","Updated ship data with more accurate stats, and more ships"]},{version:"0.15.1",date:"2025-01-07",changes:["Adjust stat forms","Added Valkyrie ship, and adjust Liberator stats","Add stat breakdown for ships"]},{version:"0.15.0",date:"2025-01-06",changes:["Added encounter export as image","Added encounter description","further adjustments to autogear algorithm"]},{version:"0.14.3",date:"2025-01-06",changes:["Autogear algorithm now always include the gear of the selected ship in the calculations"]},{version:"0.14.2",date:"2025-01-05",changes:["Fixed a bug with main stat value calculation on types hacking and security"]},{version:"0.14.1",date:"2025-01-05",changes:["Added buffer role to autogearing predefined modes, focusing on speed, boost set and lastly effective hp","Added manual stat priority weights","Several adjustments to autogear algorithm and simulation, focusing on debuffers and defenders"]},{version:"0.14.0",date:"2025-01-03",changes:["Added home page","Added joke corner"]},{version:"0.13.0",date:"2025-01-03",changes:["Added main stat value suggestions in gear form, based on stars and level"]},{version:"0.12.1",date:"2024-12-31",changes:["Adjusted gear piece display to show the ship it is equipped on"]},{version:"0.12.0",date:"2024-12-31",changes:["Added ship lock state, that will lock the equipment on the ship"]},{version:"0.11.0",date:"2024-12-28",changes:["Added encounter list"]},{version:"0.10.0",date:"2024-12-22",changes:["Added shipId to gear to stop duplicated gear on ships, both for ship page and autogearing","Added team loadouts"]},{version:"0.9.1",date:"2024-12-21",changes:["Reworked autogear strategies to get better results","Added autogear progress indicator","Adjusted autogear view"]},{version:"0.9.0",date:"2024-12-20",changes:["Added autogear brute force mode","Improved predefined modes"]},{version:"0.8.0",date:"2024-12-19",changes:["Added autogear predefined modes","- Added Attacker (max damage)","- Added Defender (max HP/def combo)","- Added Debuffer (270 hacking / max damage)","- Added Supporter (max heal output)"]},{version:"0.7.2",date:"2024-12-16",changes:["Fixed a bug with stat exclusion","Added static ship data for all ships, instead of fetching from rocky"]},{version:"0.7.1",date:"2024-12-15",changes:["Added stat normalization","Optimized gear and ship forms"]},{version:"0.7",date:"2024-12-14",changes:["Added notifications"]},{version:"0.6",date:"2024-12-14",changes:["Added loadouts / ship profiles"]},{version:"0.5",date:"2024-12-12",changes:["Added sorting","Formatting improvements"]},{version:"0.4",date:"2024-12-12",changes:["Added the rest of the gear sets","Added stat labels","Added autogear attack simulation section","Formatting improvements"]},{version:"0.3",date:"2024-12-12",changes:["Added more filters","Fixed a bug with the changelog modal","Added active filter display in the gear and ship inventories"]},{version:"0.2.1",date:"2024-12-11",changes:["Bugfix ship form","Modal closes on click outside"]},{version:"0.2.0",date:"2024-03-20",changes:["Added changelog system","Improved mobile responsiveness","Fixed various UI bugs","Added filters"]},{version:"0.1.0",date:"2024-03-15",changes:["Initial release","Ship management system","Gear inventory system","Auto-gear calculator","Engineering stats page"]}],df="Starborne Planner",ST="Alvbert / Kenneth Susort (kennethsusort@gmail.com)",tr={ATLAS_SYNDICATE:{name:"Atlas Syndicate",iconUrl:"https://cdn.discordapp.com/emojis/1133426145023492116.webp"},BINDERBURG:{name:"Binderburg",iconUrl:"https://cdn.discordapp.com/emojis/1133426146579583056.webp"},EVERLIVING:{name:"Everliving",iconUrl:"https://cdn.discordapp.com/emojis/1133426149050032168.webp"},FRONTIER_LEGION:{name:"Frontier Legion",iconUrl:"https://cdn.discordapp.com/emojis/1133426150522228737.webp"},GELECEK:{name:"Gelecek",iconUrl:"https://cdn.discordapp.com/emojis/1133426152371925132.webp"},MPL:{name:"MPL",iconUrl:"https://cdn.discordapp.com/emojis/1133426156201316462.webp"},MARAUDERS:{name:"Marauders",iconUrl:"https://cdn.discordapp.com/emojis/1133426154888495114.webp"},TERRAN_COMBINE:{name:"Terran Combine",iconUrl:"https://cdn.discordapp.com/emojis/1133426138149044374.webp"},TIANCHAO:{name:"Tianchao",iconUrl:"https://cdn.discordapp.com/emojis/1133426140946636820.webp"},XAOC:{name:"XAOC",iconUrl:"https://cdn.discordapp.com/emojis/1133426142423031818.webp"}},yt={FORTITUDE:{name:"Fortitude",stats:[{name:"hp",value:15,type:"percentage"}],iconUrl:"https://cdn.discordapp.com/emojis/1212063652031766618.webp"},ATTACK:{name:"Attack",stats:[{name:"attack",value:15,type:"percentage"}],iconUrl:"https://cdn.discordapp.com/emojis/1212063625150468236.webp"},DEFENSE:{name:"Defense",stats:[{name:"defence",value:15,type:"percentage"}],iconUrl:"https://cdn.discordapp.com/emojis/1212063636605116507.webp"},PROTECTION:{name:"Protection",stats:[{name:"defence",value:10,type:"percentage"},{name:"security",value:20,type:"flat"}],iconUrl:"https://cdn.discordapp.com/emojis/1212063640333590609.webp"},AMBUSH:{name:"Ambush",stats:[{name:"attack",value:10,type:"percentage"},{name:"speed",value:5,type:"percentage"}],iconUrl:"https://cdn.discordapp.com/emojis/1212063875424452688.webp"},CRITICAL:{name:"Critical",stats:[{name:"crit",value:5,type:"percentage"},{name:"critDamage",value:10,type:"percentage"}],iconUrl:"https://cdn.discordapp.com/emojis/1212063633668964373.webp"},SPEED:{name:"Speed",stats:[{name:"speed",value:15,type:"percentage"}],iconUrl:"https://cdn.discordapp.com/emojis/1212063621723586580.webp"},BOOST:{name:"Boost",stats:[],iconUrl:"https://cdn.discordapp.com/emojis/1212063630842011678.webp",minPieces:4},BURNER:{name:"Burner",stats:[{name:"attack",value:15,type:"percentage"}],iconUrl:"https://cdn.discordapp.com/emojis/1312034712268832808.webp"},DECIMATION:{name:"Decimation",stats:[],iconUrl:"https://cdn.discordapp.com/emojis/1212063643328577546.webp"},HACKING:{name:"Hacking",stats:[{name:"hacking",value:30,type:"flat"}],iconUrl:"https://cdn.discordapp.com/emojis/1212063646541152276.webp"},LEECH:{name:"Leech",stats:[],iconUrl:"https://cdn.discordapp.com/emojis/1212063612789858395.webp"},REPAIR:{name:"Repair",stats:[{name:"healModifier",value:20,type:"percentage"}],iconUrl:"https://cdn.discordapp.com/emojis/1212063614698127410.webp"},REFLECT:{name:"Reflect",stats:[],iconUrl:"https://cdn.discordapp.com/emojis/1212063615918546985.webp"},REVENGE:{name:"Revenge",stats:[],iconUrl:"https://cdn.discordapp.com/emojis/1212063617839800361.webp"},SHIELD:{name:"Shield",stats:[],iconUrl:"https://cdn.discordapp.com/emojis/1212063619739816037.webp"},CLOAKING:{name:"Cloaking",stats:[],iconUrl:"https://cdn.discordapp.com/emojis/1212063623661486090.webp"},ABYSSAL_ASSAULT:{name:"Abyssal Assault",stats:[{name:"attack",value:15,type:"percentage"},{name:"critDamage",value:5,type:"percentage"}],iconUrl:"https://cdn.discordapp.com/emojis/1212063626899357716.webp"},ABYSSAL_SAFEGUARD:{name:"Abyssal Safeguard",stats:[{name:"hp",value:15,type:"percentage"},{name:"security",value:10,type:"flat"}],iconUrl:"https://cdn.discordapp.com/emojis/1212063611531427850.webp"},ABYSSAL_WARD:{name:"Abyssal Ward",stats:[{name:"defence",value:15,type:"percentage"},{name:"hp",value:5,type:"percentage"}],iconUrl:"https://cdn.discordapp.com/emojis/1212063876863238214.webp"},ABYSSAL_BREACH:{name:"Abyssal Breach",stats:[{name:"hacking",value:30,type:"flat"},{name:"crit",value:5,type:"percentage"}],iconUrl:"https://cdn.discordapp.com/emojis/1212064208011657272.webp"},OMNICORE:{name:"Omnicore",stats:[{name:"attack",value:10,type:"percentage"},{name:"defence",value:10,type:"percentage"},{name:"hacking",value:10,type:"percentage"},{name:"security",value:10,type:"percentage"},{name:"crit",value:10,type:"percentage"},{name:"critDamage",value:10,type:"percentage"},{name:"speed",value:10,type:"percentage"},{name:"hp",value:10,type:"percentage"}],iconUrl:"https://cdn.discordapp.com/emojis/1312034714919505920.webp"},SWIFTNESS:{name:"Swiftness",stats:[{name:"speed",value:15,type:"percentage"},{name:"hacking",value:10,type:"flat"}],iconUrl:"https://cdn.discordapp.com/emojis/1312034718010834965.webp"},RECOVERY:{name:"Recovery",stats:[{name:"hp",value:10,type:"percentage"},{name:"healModifier",value:10,type:"percentage"}],iconUrl:"https://cdn.discordapp.com/emojis/1312034716295368785.webp"},EXPLOIT:{name:"Exploit",stats:[{name:"hacking",value:20,type:"flat"},{name:"attack",value:10,type:"percentage"}],iconUrl:"https://cdn.discordapp.com/emojis/1312034713745227796.webp"}},Gh=18.33,Wh=15,Ue={weapon:{label:"Weapon",availableMainStats:["attack"],expectedContribution:Wh},hull:{label:"Hull",availableMainStats:["hp"],expectedContribution:Wh},generator:{label:"Generator",availableMainStats:["defence"],expectedContribution:Wh},sensor:{label:"Sensor",availableMainStats:["hp","attack","defence","crit","critDamage","healModifier"],expectedContribution:Gh},software:{label:"Software",availableMainStats:["hp","attack","defence","hacking","speed"],expectedContribution:Gh},thrusters:{label:"Thrusters",availableMainStats:["hp","attack","defence","speed"],expectedContribution:Gh}},xT=Object.keys(Ue),jn={common:{value:"common",label:"Common",bgColor:"bg-rarity-common",textColor:"text-rarity-common",borderColor:"border-rarity-common"},uncommon:{value:"uncommon",label:"Uncommon",bgColor:"bg-rarity-uncommon",textColor:"text-rarity-uncommon",borderColor:"border-rarity-uncommon"},rare:{value:"rare",label:"Rare",bgColor:"bg-rarity-rare",textColor:"text-rarity-rare",borderColor:"border-rarity-rare"},epic:{value:"epic",label:"Epic",bgColor:"bg-rarity-epic",textColor:"text-rarity-epic",borderColor:"border-rarity-epic"},legendary:{value:"legendary",label:"Legendary",bgColor:"bg-rarity-legendary",textColor:"text-rarity-legendary",borderColor:"border-rarity-legendary"}},vr=Object.keys(jn).reverse(),r0=n=>[...n].sort((e,t)=>vr.indexOf(e)-vr.indexOf(t)),i0={AEGIS:{name:"Aegis",affinity:"Antimatter",rarity:"legendary",faction:"ATLAS_SYNDICATE",role:"SUPPORTER",hp:17873,attack:2356,defense:2381,hacking:87,security:37,critRate:0,critDamage:4,speed:98},APEX:{name:"Apex",affinity:"CHEMICAL",rarity:"legendary",faction:"ATLAS_SYNDICATE",role:"DEBUFFER",hp:11826,attack:3993,defense:1924,hacking:108,security:28,critRate:6,critDamage:22,speed:85},ANEMONE:{name:"Anemone",affinity:"Thermal",rarity:"legendary",faction:"GELECEK",role:"DEFENDER",hp:22045,attack:3224,defense:3591,hacking:100,security:41,critRate:0,critDamage:0,speed:69},ANJIAN:{name:"Anjian",affinity:"Chemical",rarity:"rare",faction:"TIANCHAO",role:"ATTACKER",hp:8956,attack:4042,defense:1885,hacking:92,security:0,critRate:11,critDamage:34,speed:82},ARUM:{name:"Arum",affinity:"Thermal",rarity:"epic",faction:"GELECEK",role:"DEBUFFER",hp:12056,attack:3596,defense:1786,hacking:118,security:19,critRate:0,critDamage:10,speed:80},ASPHYXIATOR:{name:"Asphyxiator",affinity:"Thermal",rarity:"legendary",faction:"MARAUDERS",role:"DEBUFFER",hp:13204,attack:4092,defense:1786,hacking:106,security:5,critRate:22,critDamage:10,speed:93},BERSERKER:{name:"Berserker",affinity:"Electric",rarity:"rare",faction:"MARAUDERS",role:"ATTACKER",hp:9415,attack:4538,defense:1131,hacking:76,security:0,critRate:25,critDamage:38,speed:81},BIZON:{name:"Bizon",affinity:"ANTIMATTER",rarity:"epic",faction:"XAOC",role:"DEBUFFER",hp:9989,attack:3794,defense:1667,hacking:100,security:12,critRate:15,critDamage:52,speed:82},BUTCHER:{name:"Butcher",affinity:"Thermal",rarity:"epic",faction:"MARAUDERS",role:"ATTACKER",hp:12056,attack:4216,defense:1587,hacking:82,security:0,critRate:23,critDamage:38,speed:83},CINYA:{name:"Cinya",affinity:"Antimatter",rarity:"rare",faction:"TERRAN_COMBINE",role:"DEFENDER",hp:14812,attack:2430,defense:3194,hacking:84,security:33,critRate:0,critDamage:20,speed:60},COBALT:{name:"Cobalt",affinity:"THERMAL",rarity:"epic",faction:"MPL",role:"ATTACKER",hp:12860,attack:3918,defense:1607,hacking:76,security:24,critRate:11,critDamage:58,speed:73},CROCUS:{name:"Crocus",affinity:"Thermal",rarity:"legendary",faction:"GELECEK",role:"DEBUFFER",hp:13204,attack:3844,defense:1984,hacking:115,security:16,critRate:4,critDamage:18,speed:89},CRUCIALIS:{name:"Crucialis",affinity:"Electric",rarity:"rare",faction:"ATLAS_SYNDICATE",role:"ATTACKER",hp:11138,attack:3546,defense:1270,hacking:74,security:17,critRate:17,critDamage:42,speed:79},CULTIVATOR:{name:"Cultivator",affinity:"Chemical",rarity:"legendary",faction:"BINDERBURG",role:"SUPPORTER",hp:18371,attack:1686,defense:2698,hacking:95,security:41,critRate:4,critDamage:20,speed:88},CURATOR:{name:"Curator",affinity:"Chemical",rarity:"legendary",faction:"BINDERBURG",role:"DEBUFFER",hp:15730,attack:3770,defense:1885,hacking:116,security:24,critRate:2,critDamage:30,speed:77},DEFIANT:{name:"Defiant",affinity:"Chemical",rarity:"epic",faction:"FRONTIER_LEGION",role:"DEFENDER",hp:17797,attack:2802,defense:3551,hacking:81,security:22,critRate:7,critDamage:12,speed:71},DEMOLISHER:{name:"Demolisher",affinity:"Antimatter",rarity:"legendary",faction:"MARAUDERS",role:"ATTACKER",hp:11138,attack:4464,defense:2143,hacking:87,security:1,critRate:28,critDamage:30,speed:88},FAUST:{name:"Faust",affinity:"Thermal",rarity:"Rare",faction:"Everliving",role:"Supporter",hp:9760,attack:1463,defense:2480,hacking:87,security:30,critRate:5,critDamage:20,speed:88},FLAMEL:{name:"Flamel",affinity:"Antimatter",rarity:"epic",faction:"EVERLIVING",role:"SUPPORTER",hp:14467,attack:1587,defense:2579,hacking:89,security:24,critRate:7,critDamage:20,speed:90},FRONTLINE:{name:"Frontline",affinity:"Electric",rarity:"legendary",faction:"ATLAS_SYNDICATE",role:"ATTACKER",hp:8726,attack:4365,defense:1924,hacking:83,security:12,critRate:16,critDamage:58,speed:78},GALLANT:{name:"Gallant",affinity:"Thermal",rarity:"rare",faction:"FRONTIER_LEGION",role:"ATTACKER",hp:11138,attack:4117,defense:2044,hacking:79,security:14,critRate:8,critDamage:42,speed:80},GRIF:{name:"Grif",affinity:"Chemical",rarity:"legendary",faction:"XAOC",role:"SUPPORTER",hp:13778,attack:3298,defense:2321,hacking:88,security:30,critRate:18,critDamage:34,speed:90},GUARDIAN:{name:"Guardian",affinity:"Antimatter",rarity:"epic",faction:"MPL",role:"DEFENDER",hp:15730,attack:2232,defense:3135,hacking:92,security:29,critRate:0,critDamage:12,speed:66},HARVESTER:{name:"Harvester",affinity:"Electric",rarity:"rare",faction:"BINDERBURG",role:"SUPPORTER",hp:12515,attack:1314,defense:2758,hacking:92,security:34,critRate:1,critDamage:20,speed:81},HAYYAN:{name:"Hayyan",affinity:"Electric",rarity:"legendary",faction:"EVERLIVING",role:"SUPPORTER",hp:15616,attack:2282,defense:2420,hacking:90,security:33,critRate:8,critDamage:20,speed:91},HELIODOR:{name:"Heliodor",affinity:"Thermal",rarity:"epic",faction:"MPL",role:"SUPPORTER",hp:13434,attack:1463,defense:2063,hacking:86,security:37,critRate:7,critDamage:20,speed:85},HERMES:{name:"Hermes",affinity:"Thermal",rarity:"legendary",faction:"EVERLIVING",role:"SUPPORTER",hp:18606,attack:1835,defense:2778,hacking:90,security:29,critRate:8,critDamage:36,speed:79},HUANYING:{name:"Huanying",affinity:"Thermal",rarity:"rare",faction:"TIANCHAO",role:"DEBUFFER",hp:11023,attack:3670,defense:1171,hacking:107,security:11,critRate:5,critDamage:22,speed:83},INCINERATOR:{name:"Incinerator",affinity:"ELECTRIC",rarity:"legendary",faction:"MARAUDERS",role:"ATTACKER",hp:11138,attack:4464,defense:1786,hacking:1,security:0,critRate:24,critDamage:38,speed:84},IONSCORP:{name:"Ionscorp",affinity:"Chemical",rarity:"rare",faction:"ATLAS_SYNDICATE",role:"ATTACKER",hp:11138,attack:3993,defense:1270,hacking:86,security:17,critRate:5,critDamage:50,speed:75},IRIDIUM:{name:"Iridium",affinity:"Antimatter",rarity:"legendary",faction:"MPL",role:"DEFENDER",hp:23883,attack:2282,defense:3412,hacking:89,security:56,critRate:1,critDamage:4,speed:63},ISHA:{name:"Isha",affinity:"ANTIMATTER",rarity:"legendary",faction:"TERRAN_COMBINE",role:"DEFENDER",hp:19290,attack:2579,defense:4404,hacking:87,security:49,critRate:3,critDamage:8,speed:69},JUDGE:{name:"Judge",affinity:"Electric",rarity:"legendary",faction:"FRONTIER_LEGION",role:"ATTACKER",hp:10793,attack:4935,defense:1627,hacking:82,security:9,critRate:19,critDamage:50,speed:87},KAFA:{name:"Kafa",affinity:"Chemical",rarity:"rare",faction:"TERRAN_COMBINE",role:"DEFENDER",hp:14812,attack:1538,defense:3551,hacking:84,security:29,critRate:0,critDamage:20,speed:60},KINETIK:{name:"Kinetik",affinity:"Electric",rarity:"rare",faction:"ATLAS_SYNDICATE",role:"DEFENDER",hp:19290,attack:2108,defense:3036,hacking:86,security:27,critRate:2,critDamage:4,speed:64},LAIKA:{name:"Laika",affinity:"Thermal",rarity:"rare",faction:"XAOC",role:"DEFENDER",hp:17567,attack:2604,defense:2976,hacking:75,security:8,critRate:12,critDamage:34,speed:72},LAKSPUR:{name:"Lakspur",affinity:"ELECTRIC",rarity:"rare",faction:"GELECEK",role:"DEBUFFER",hp:11482,attack:3472,defense:2401,hacking:112,security:17,critRate:0,critDamage:2,speed:78},LIBERATOR:{name:"Liberator",affinity:"Thermal",rarity:"legendary",faction:"FRONTIER_LEGION",role:"ATTACKER",hp:12860,attack:4489,defense:1984,hacking:70,security:9,critRate:23,critDamage:50,speed:87},LODOLITE:{name:"Lodolite",affinity:"Antimatter",rarity:"legendary",faction:"MPL",role:"ATTACKER",hp:14008,attack:4613,defense:2163,hacking:77,security:21,critRate:16,critDamage:42,speed:78},LOS:{name:"Los",affinity:"Electric",rarity:"legendary",faction:"XAOC",role:"ATTACKER",hp:9071,attack:4861,defense:2222,hacking:86,security:9,critRate:18,critDamage:56,speed:78},LUXX:{name:"Luxx",affinity:"Antimatter",rarity:"epic",faction:"ATLAS_SYNDICATE",role:"ATTACKER",hp:9645,attack:4117,defense:1726,hacking:76,security:19,critRate:15,critDamage:58,speed:77},MADAX:{name:"Madax",affinity:"Electric",rarity:"legendary",faction:"TERRAN_COMBINE",role:"DEFENDER",hp:18256,attack:2356,defense:4047,hacking:87,security:49,critRate:5,critDamage:12,speed:63},MAGNOLIA:{name:"Magnolia",affinity:"Electric",rarity:"rare",faction:"GELECEK",role:"ATTACKER",hp:11482,attack:3844,defense:2044,hacking:89,security:5,critRate:3,critDamage:22,speed:85},MANGLER:{name:"Mangler",affinity:"Chemical",rarity:"rare",faction:"MARAUDERS",role:"ATTACKER",hp:9415,attack:4092,defense:1488,hacking:80,security:2,critRate:25,critDamage:30,speed:85},MEDVED:{name:"Medved",affinity:"Thermal",rarity:"rare",faction:"XAOC",role:"ATTACKER",hp:9415,attack:4489,defense:1924,hacking:83,security:2,critRate:11,critDamage:64,speed:75},MEIYING:{name:"Meiying",affinity:"Thermal",rarity:"legendary",faction:"TIANCHAO",role:"ATTACKER",hp:12745,attack:4861,defense:1825,hacking:95,security:2,critRate:14,critDamage:42,speed:85},MORAO:{name:"Morao",affinity:"Thermal",rarity:"epic",faction:"TERRAN_COMBINE",role:"DEFENDER",hp:15386,attack:2108,defense:3293,hacking:86,security:35,critRate:4,critDamage:20,speed:62},NEMESIS:{name:"Nemesis",affinity:"Chemical",rarity:"epic",faction:"ATLAS_SYNDICATE",role:"DEFENDER",hp:15730,attack:2232,defense:3135,hacking:92,security:29,critRate:0,critDamage:12,speed:66},NOSOROG:{name:"Nosorog",affinity:"Chemical",rarity:"epic",faction:"XAOC",role:"DEFENDER",hp:16075,attack:2728,defense:3432,hacking:77,security:22,critRate:10,critDamage:18,speed:66},NUQTU:{name:"Nuqtu",affinity:"Electric",rarity:"legendary",faction:"TERRAN_COMBINE",role:"ATTACKER",hp:10449,attack:4241,defense:2797,hacking:79,security:18,critRate:16,critDamage:58,speed:78},OBSIDIAN:{name:"Obsidian",affinity:"Thermal",rarity:"legendary",faction:"MPL",role:"ATTACKER",hp:16075,attack:4613,defense:1805,hacking:89,security:21,critRate:16,critDamage:50,speed:70},OLEANDER:{name:"Oleander",affinity:"Chemical",rarity:"legendary",faction:"GELECEK",role:"SUPPORTER",hp:17912,attack:1761,defense:2083,hacking:102,security:33,critRate:6,critDamage:8,speed:88},OPAL:{name:"Opal",affinity:"Electric",rarity:"epic",faction:"MPL",role:"DEFENDER",hp:21012,attack:2034,defense:2659,hacking:88,security:34,critRate:0,critDamage:4,speed:66},OREL:{name:"Orel",affinity:"ANTIMATTER",rarity:"epic",faction:"XAOC",role:"SUPPORTER",hp:18142,attack:2951,defense:2718,hacking:77,security:22,critRate:10,critDamage:26,speed:74},PANGUAN:{name:"Panguan",affinity:"Chemical",rarity:"legendary",faction:"TIANCHAO",role:"ATTACKER",hp:10678,attack:4414,defense:1468,hacking:99,security:2,critRate:18,critDamage:50,speed:81},PANON:{name:"Panon",affinity:"Thermal",rarity:"legendary",faction:"TERRAN_COMBINE",role:"DEFENDER",hp:20323,attack:2356,defense:4047,hacking:87,security:47,critRate:5,critDamage:4,speed:71},PARACELSUS:{name:"Paracelsus",affinity:"Chemical",rarity:"rare",faction:"EVERLIVING",role:"SUPPORTER",hp:11826,attack:1463,defense:2837,hacking:87,security:18,critRate:5,critDamage:20,speed:88},PROSPECT:{name:"Prospect",affinity:"Chemical",rarity:"rare",faction:"MPL",role:"DEFENDER",hp:20438,attack:1910,defense:2559,hacking:86,security:28,critRate:2,critDamage:12,speed:60},PROVIDER:{name:"Provider",affinity:"ANTIMATTER",rarity:"epic",faction:"BINDERBURG",role:"DEBUFFER",hp:12515,attack:3522,defense:1686,hacking:115,security:19,critRate:0,critDamage:22,speed:80},PURIFIER:{name:"Purifier",affinity:"Chemical",rarity:"rare",faction:"BINDERBURG",role:"SUPPORTER",hp:14582,attack:1314,defense:2401,hacking:92,security:38,critRate:1,critDamage:20,speed:81},RAVAGER:{name:"Ravager",affinity:"Chemical",rarity:"legendary",faction:"MARAUDERS",role:"ATTACKER",hp:13204,attack:4910,defense:1786,hacking:79,security:1,critRate:28,critDamage:30,speed:88},REDEEMER:{name:"Redeemer",affinity:"Thermal",rarity:"rare",faction:"FRONTIER_LEGION",role:"DEFENDER",hp:15156,attack:2232,defense:3095,hacking:79,security:24,critRate:1,critDamage:12,speed:69},REFINE:{name:"Refine",affinity:"Electric",rarity:"rare",faction:"MPL",role:"SUPPORTER",hp:12860,attack:1339,defense:2321,hacking:92,security:39,critRate:5,critDamage:20,speed:83},RHODIUM:{name:"Rhodium",affinity:"CHEMICAL",rarity:"epic",faction:"MPL",role:"ATTACKER",hp:12860,attack:4142,defense:1607,hacking:76,security:20,critRate:15,critDamage:58,speed:77},RIKRA:{name:"Rikra",affinity:"Thermal",rarity:"rare",faction:"TERRAN_COMBINE",role:"ATTACKER",hp:10793,attack:3869,defense:1786,hacking:76,security:19,critRate:13,critDamage:50,speed:71},RIPPER:{name:"Ripper",affinity:"Electric",rarity:"epic",faction:"MARAUDERS",role:"DEBUFFER",hp:9989,attack:3398,defense:1944,hacking:101,security:12,critRate:13,critDamage:10,speed:88},RUINER:{name:"Ruiner",affinity:"CHEMICAL",rarity:"epic",faction:"MARAUDERS",role:"DEBUFFER",hp:9989,attack:3844,defense:1587,hacking:101,security:16,critRate:17,critDamage:2,speed:84},RYS:{name:"Rys",affinity:"Chemical",rarity:"rare",faction:"XAOC",role:"ATTACKER",hp:7348,attack:4042,defense:1924,hacking:83,security:10,critRate:7,critDamage:56,speed:79},SALVATION:{name:"Salvation",affinity:"Chemical",rarity:"epic",faction:"BINDERBURG",role:"SUPPORTER",hp:15156,attack:1438,defense:2500,hacking:94,security:36,critRate:3,critDamage:20,speed:87},SANSI:{name:"Sansi",affinity:"Chemical",rarity:"legendary",faction:"TIANCHAO",role:"DEFENDER",hp:22620,attack:2976,defense:3432,hacking:91,security:45,critRate:7,critDamage:12,speed:82},SEFUBA:{name:"Sefuba",affinity:"Chemical",rarity:"epic",faction:"TERRAN_COMBINE",role:"ATTACKER",hp:9300,attack:4439,defense:2242,hacking:78,security:17,critRate:15,critDamage:50,speed:77},SENTINEL:{name:"Sentinel",affinity:"Thermal",rarity:"legendary",faction:"FRONTIER_LEGION",role:"SUPPORTER",hp:13434,attack:3373,defense:2797,hacking:80,security:26,critRate:15,critDamage:20,speed:95},SHA_XING:{name:"Sha Xing",affinity:"Thermal",rarity:"Epic",faction:"Tianchao",role:"Attacker",hp:11597,attack:4166,defense:1627,hacking:94,security:5,critRate:9,critDamage:42,speed:88},SHASHOU:{name:"Shashou",affinity:"Antimatter",rarity:"rare",faction:"TIANCHAO",role:"ATTACKER",hp:11023,attack:4042,defense:1885,hacking:92,security:0,critRate:7,critDamage:42,speed:82},SHELTER:{name:"Shelter",affinity:"Thermal",rarity:"rare",faction:"MPL",role:"SUPPORTER",hp:14927,attack:1339,defense:1964,hacking:96,security:35,critRate:5,critDamage:20,speed:79},SHEPARD:{name:"Shepard",affinity:"Electric",rarity:"rare",faction:"BINDERBURG",role:"DEFENDER",hp:20094,attack:1885,defense:2996,hacking:82,security:31,critRate:0,critDamage:12,speed:66},SNAPDRAGON:{name:"Snapdragon",affinity:"Electric",rarity:"epic",faction:"GELECEK",role:"ATTACKER",hp:9989,attack:3968,defense:1786,hacking:103,security:7,critRate:21,critDamage:38,speed:83},SOKOL:{name:"Sokol",affinity:"Chemical",rarity:"epic",faction:"XAOC",role:"ATTACKER",hp:9989,attack:4166,defense:2024,hacking:85,security:4,critRate:13,critDamage:64,speed:85},STALWART:{name:"Stalwart",affinity:"Electric",rarity:"epic",faction:"FRONTIER_LEGION",role:"ATTACKER",hp:9645,attack:4241,defense:2143,hacking:81,security:8,critRate:14,critDamage:42,speed:86},SUSTAINER:{name:"Sustainer",affinity:"Chemical",rarity:"legendary",faction:"BINDERBURG",role:"ATTACKER",hp:15730,attack:4142,defense:2242,hacking:93,security:20,critRate:12,critDamage:42,speed:76},TORCHER:{name:"Torcher",affinity:"Chemical",rarity:"rare",faction:"MARAUDERS",role:"DEBUFFER",hp:9415,attack:3274,defense:1488,hacking:103,security:10,critRate:11,critDamage:10,speed:82},TORMENTER:{name:"Tormenter",affinity:"ELECTRIC",rarity:"epic",faction:"MARAUDERS",role:"DEFENDER",hp:16075,attack:2778,defense:2460,hacking:74,security:18,critRate:12,critDamage:16,speed:76},TYCHO:{name:"Tycho",affinity:"Thermal",rarity:"rare",faction:"EVERLIVING",role:"DEFENDER",hp:17338,attack:2480,defense:3075,hacking:81,security:19,critRate:6,critDamage:4,speed:69},TYGR:{name:"Tygr",affinity:"THERMAL",rarity:"legendary",faction:"XAOC",role:"DEBUFFER",hp:13204,attack:4042,defense:1865,hacking:105,security:17,critRate:12,critDamage:44,speed:83},VALERIAN:{name:"Valerian",affinity:"Electric",rarity:"legendary",faction:"GELECEK",role:"DEBUFFER",hp:11138,attack:2951,defense:1984,hacking:119,security:20,critRate:12,critDamage:26,speed:81},VALIANT:{name:"Valiant",affinity:"Electric",rarity:"rare",faction:"FRONTIER_LEGION",role:"ATTACKER",hp:11138,attack:4117,defense:1686,hacking:67,security:6,critRate:16,critDamage:50,speed:84},VALKYRIE:{name:"Valkyrie",affinity:"Chemical",rarity:"Legendary",faction:"Frontier Legion",role:"Debuffer",hp:13893,attack:3894,defense:2520,hacking:101,security:17,critRate:9,critDamage:14,speed:96},VINDICATOR:{name:"Vindicator",affinity:"ELECTRIC",rarity:"legendary",faction:"BINDERBURG",role:"DEFENDER",hp:21471,attack:2703,defense:3492,hacking:97,security:47,critRate:5,critDamage:12,speed:65},VOLK:{name:"Volk",affinity:"THERMAL",rarity:"epic",faction:"XAOC",role:"SUPPORTER",hp:14697,attack:1711,defense:1766,hacking:83,security:29,critRate:17,critDamage:26,speed:89},VORON:{name:"Voron",affinity:"Chemical",rarity:"legendary",faction:"XAOC",role:"DEFENDER",hp:21012,attack:3646,defense:3115,hacking:90,security:40,critRate:11,critDamage:30,speed:75},WARDEN:{name:"Warden",affinity:"Thermal",rarity:"epic",faction:"BINDERBURG",role:"DEFENDER",hp:18601,attack:2232,defense:2738,hacking:100,security:29,critRate:0,critDamage:4,speed:64},WISTERIA:{name:"Wisteria",affinity:"CHEMICAL",rarity:"epic",faction:"GELECEK",role:"ATTACKER",hp:9989,attack:3968,defense:2143,hacking:99,security:3,critRate:25,critDamage:46,speed:79},XCELLENCE:{name:"Xcellence",affinity:"Chemical",rarity:"legendary",faction:"ATLAS_SYNDICATE",role:"ATTACKER",hp:10793,attack:4811,defense:1924,hacking:93,security:16,critRate:12,critDamage:34,speed:82},YARROW:{name:"Yarrow",affinity:"Antimatter",rarity:"rare",faction:"GELECEK",role:"DEBUFFER",hp:11482,attack:3026,defense:1686,hacking:112,security:21,critRate:0,critDamage:2,speed:82},YAZID:{name:"Yazid",affinity:"Electric",rarity:"epic",faction:"EVERLIVING",role:"SUPPORTER",hp:17912,attack:2158,defense:3174,hacking:87,security:21,critRate:4,critDamage:12,speed:71},YUYAN:{name:"Yuyan",affinity:"Chemical",rarity:"epic",faction:"TIANCHAO",role:"DEBUFFER",hp:9530,attack:4241,defense:1270,hacking:113,security:17,critRate:11,critDamage:30,speed:81},ZEOLITE:{name:"Zeolite",affinity:"Electric",rarity:"legendary",faction:"MPL",role:"DEBUFFER",hp:14008,attack:3794,defense:1805,hacking:108,security:33,critRate:6,critDamage:30,speed:83},ZOSIMOS:{name:"Zosimos",affinity:"Antimatter",rarity:"legendary",faction:"EVERLIVING",role:"DEBUFFER",hp:15041,attack:3472,defense:2321,hacking:111,security:12,critRate:6,critDamage:22,speed:88}},lt={ATTACKER:{name:"Attacker",description:"Maximize damage output",iconUrl:"https://cdn.discordapp.com/emojis/1082314151596142662.webp"},DEFENDER:{name:"Defender",description:"Maximize HP and defense",iconUrl:"https://cdn.discordapp.com/emojis/1082314174920663053.webp"},DEBUFFER:{name:"Debuffer",description:"Maximize damage output while having 270 hacking or more",iconUrl:"https://cdn.discordapp.com/emojis/1082314199100829787.webp"},SUPPORTER:{name:"Supporter",description:"Maximize healing output",iconUrl:"https://cdn.discordapp.com/emojis/1082314233301188750.webp"},SUPPORTER_BUFFER:{name:"Supporter(Buffer)",description:"Max speed, then HP/defense, big bonus if boost set",iconUrl:"https://cdn.discordapp.com/emojis/1082314233301188750.webp"}},Co=5e3,ko=50,Rt={attack:{label:"Attack",shortLabel:"ATK",allowedTypes:["flat","percentage"],engineeringAllowedTypes:["percentage"],maxValue:{flat:Co,percentage:ko}},hp:{label:"HP",shortLabel:"HP",allowedTypes:["flat","percentage"],engineeringAllowedTypes:["percentage"],maxValue:{flat:Co,percentage:ko}},defence:{label:"Defense",shortLabel:"DEF",allowedTypes:["flat","percentage"],engineeringAllowedTypes:["percentage"],maxValue:{flat:Co,percentage:ko}},crit:{label:"Crit Rate",shortLabel:"CR",allowedTypes:["percentage"],engineeringAllowedTypes:[],maxValue:{percentage:ko,flat:0}},critDamage:{label:"Crit Power",shortLabel:"CP",allowedTypes:["percentage"],engineeringAllowedTypes:["percentage"],maxValue:{percentage:ko,flat:0}},healModifier:{label:"Heal Modifier",shortLabel:"HM",allowedTypes:["percentage"],engineeringAllowedTypes:[],maxValue:{percentage:ko,flat:0}},speed:{label:"Speed",shortLabel:"SPD",allowedTypes:["flat","percentage"],engineeringAllowedTypes:[],maxValue:{flat:Co,percentage:0}},hacking:{label:"Hacking",shortLabel:"HACK",allowedTypes:["flat","percentage"],engineeringAllowedTypes:["flat"],maxValue:{flat:Co,percentage:0}},security:{label:"Security",shortLabel:"SEC",allowedTypes:["flat","percentage"],engineeringAllowedTypes:["flat"],maxValue:{flat:Co,percentage:0}}},IT={weapon:["attack"],hull:["hp"],generator:["defence"],sensor:["hp","attack","defence","crit","critDamage"],software:["hp","attack","defence","hacking","security"],thrusters:["hp","attack","defence","speed"]},RT={hp:1e4,attack:5e3,defense:5e3,hacking:100,security:100,critChance:25,critDamage:50,speed:100},uy="/favicon.ico";var dy={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const s0=function(n){const e=[];let t=0;for(let i=0;i<n.length;i++){let o=n.charCodeAt(i);o<128?e[t++]=o:o<2048?(e[t++]=o>>6|192,e[t++]=o&63|128):(o&64512)===55296&&i+1<n.length&&(n.charCodeAt(i+1)&64512)===56320?(o=65536+((o&1023)<<10)+(n.charCodeAt(++i)&1023),e[t++]=o>>18|240,e[t++]=o>>12&63|128,e[t++]=o>>6&63|128,e[t++]=o&63|128):(e[t++]=o>>12|224,e[t++]=o>>6&63|128,e[t++]=o&63|128)}return e},AT=function(n){const e=[];let t=0,i=0;for(;t<n.length;){const o=n[t++];if(o<128)e[i++]=String.fromCharCode(o);else if(o>191&&o<224){const a=n[t++];e[i++]=String.fromCharCode((o&31)<<6|a&63)}else if(o>239&&o<365){const a=n[t++],c=n[t++],d=n[t++],p=((o&7)<<18|(a&63)<<12|(c&63)<<6|d&63)-65536;e[i++]=String.fromCharCode(55296+(p>>10)),e[i++]=String.fromCharCode(56320+(p&1023))}else{const a=n[t++],c=n[t++];e[i++]=String.fromCharCode((o&15)<<12|(a&63)<<6|c&63)}}return e.join("")},o0={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let o=0;o<n.length;o+=3){const a=n[o],c=o+1<n.length,d=c?n[o+1]:0,p=o+2<n.length,m=p?n[o+2]:0,v=a>>2,E=(a&3)<<4|d>>4;let w=(d&15)<<2|m>>6,S=m&63;p||(S=64,c||(w=64)),i.push(t[v],t[E],t[w],t[S])}return i.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(s0(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):AT(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let o=0;o<n.length;){const a=t[n.charAt(o++)],d=o<n.length?t[n.charAt(o)]:0;++o;const m=o<n.length?t[n.charAt(o)]:64;++o;const E=o<n.length?t[n.charAt(o)]:64;if(++o,a==null||d==null||m==null||E==null)throw new CT;const w=a<<2|d>>4;if(i.push(w),m!==64){const S=d<<4&240|m>>2;if(i.push(S),E!==64){const R=m<<6&192|E;i.push(R)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class CT extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const kT=function(n){const e=s0(n);return o0.encodeByteArray(e,!0)},Iu=function(n){return kT(n).replace(/\./g,"")},a0=function(n){try{return o0.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bT(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NT=()=>bT().__FIREBASE_DEFAULTS__,PT=()=>{if(typeof process>"u"||typeof dy>"u")return;const n=dy.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},DT=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&a0(n[1]);return e&&JSON.parse(e)},Ku=()=>{try{return NT()||PT()||DT()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},l0=n=>{var e,t;return(t=(e=Ku())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},jT=n=>{const e=l0(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),i]:[e.substring(0,t),i]},c0=()=>{var n;return(n=Ku())===null||n===void 0?void 0:n.config},u0=n=>{var e;return(e=Ku())===null||e===void 0?void 0:e[`_${n}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OT{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,i))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LT(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},i=e||"demo-project",o=n.iat||0,a=n.sub||n.user_id;if(!a)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const c=Object.assign({iss:`https://securetoken.google.com/${i}`,aud:i,iat:o,exp:o+3600,auth_time:o,sub:a,user_id:a,firebase:{sign_in_provider:"custom",identities:{}}},n);return[Iu(JSON.stringify(t)),Iu(JSON.stringify(c)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jt(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function MT(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Jt())}function VT(){var n;const e=(n=Ku())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function FT(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function UT(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function BT(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function zT(){const n=Jt();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function $T(){return!VT()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function HT(){try{return typeof indexedDB=="object"}catch{return!1}}function qT(){return new Promise((n,e)=>{try{let t=!0;const i="validate-browser-context-for-indexeddb-analytics-module",o=self.indexedDB.open(i);o.onsuccess=()=>{o.result.close(),t||self.indexedDB.deleteDatabase(i),n(!0)},o.onupgradeneeded=()=>{t=!1},o.onerror=()=>{var a;e(((a=o.error)===null||a===void 0?void 0:a.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GT="FirebaseError";class ri extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name=GT,Object.setPrototypeOf(this,ri.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Pl.prototype.create)}}class Pl{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){const i=t[0]||{},o=`${this.service}/${e}`,a=this.errors[e],c=a?WT(a,i):"Error",d=`${this.serviceName}: ${c} (${o}).`;return new ri(o,d,i)}}function WT(n,e){return n.replace(KT,(t,i)=>{const o=e[i];return o!=null?String(o):`<${i}?>`})}const KT=/\{\$([^}]+)}/g;function QT(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Ru(n,e){if(n===e)return!0;const t=Object.keys(n),i=Object.keys(e);for(const o of t){if(!i.includes(o))return!1;const a=n[o],c=e[o];if(hy(a)&&hy(c)){if(!Ru(a,c))return!1}else if(a!==c)return!1}for(const o of i)if(!t.includes(o))return!1;return!0}function hy(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dl(n){const e=[];for(const[t,i]of Object.entries(n))Array.isArray(i)?i.forEach(o=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(o))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function il(n){const e={};return n.replace(/^\?/,"").split("&").forEach(i=>{if(i){const[o,a]=i.split("=");e[decodeURIComponent(o)]=decodeURIComponent(a)}}),e}function sl(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function YT(n,e){const t=new XT(n,e);return t.subscribe.bind(t)}class XT{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,i){let o;if(e===void 0&&t===void 0&&i===void 0)throw new Error("Missing Observer.");JT(e,["next","error","complete"])?o=e:o={next:e,error:t,complete:i},o.next===void 0&&(o.next=Kh),o.error===void 0&&(o.error=Kh),o.complete===void 0&&(o.complete=Kh);const a=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?o.error(this.finalError):o.complete()}catch{}}),this.observers.push(o),a}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function JT(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Kh(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tn(n){return n&&n._delegate?n._delegate:n}class ks{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xs="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZT{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const i=new OT;if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{const o=this.getOrInitializeService({instanceIdentifier:t});o&&i.resolve(o)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const i=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),o=(t=e==null?void 0:e.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(i)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:i})}catch(a){if(o)return null;throw a}else{if(o)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(tS(e))try{this.getOrInitializeService({instanceIdentifier:xs})}catch{}for(const[t,i]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(t);try{const a=this.getOrInitializeService({instanceIdentifier:o});i.resolve(a)}catch{}}}}clearInstance(e=xs){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=xs){return this.instances.has(e)}getOptions(e=xs){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const o=this.getOrInitializeService({instanceIdentifier:i,options:t});for(const[a,c]of this.instancesDeferred.entries()){const d=this.normalizeInstanceIdentifier(a);i===d&&c.resolve(o)}return o}onInit(e,t){var i;const o=this.normalizeInstanceIdentifier(t),a=(i=this.onInitCallbacks.get(o))!==null&&i!==void 0?i:new Set;a.add(e),this.onInitCallbacks.set(o,a);const c=this.instances.get(o);return c&&e(c,o),()=>{a.delete(e)}}invokeOnInitCallbacks(e,t){const i=this.onInitCallbacks.get(t);if(i)for(const o of i)try{o(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:eS(e),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=xs){return this.component?this.component.multipleInstances?e:xs:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function eS(n){return n===xs?void 0:n}function tS(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nS{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new ZT(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Fe;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(Fe||(Fe={}));const rS={debug:Fe.DEBUG,verbose:Fe.VERBOSE,info:Fe.INFO,warn:Fe.WARN,error:Fe.ERROR,silent:Fe.SILENT},iS=Fe.INFO,sS={[Fe.DEBUG]:"log",[Fe.VERBOSE]:"log",[Fe.INFO]:"info",[Fe.WARN]:"warn",[Fe.ERROR]:"error"},oS=(n,e,...t)=>{if(e<n.logLevel)return;const i=new Date().toISOString(),o=sS[e];if(o)console[o](`[${i}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Xf{constructor(e){this.name=e,this._logLevel=iS,this._logHandler=oS,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Fe))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?rS[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Fe.DEBUG,...e),this._logHandler(this,Fe.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Fe.VERBOSE,...e),this._logHandler(this,Fe.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Fe.INFO,...e),this._logHandler(this,Fe.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Fe.WARN,...e),this._logHandler(this,Fe.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Fe.ERROR,...e),this._logHandler(this,Fe.ERROR,...e)}}const aS=(n,e)=>e.some(t=>n instanceof t);let fy,py;function lS(){return fy||(fy=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function cS(){return py||(py=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const d0=new WeakMap,hf=new WeakMap,h0=new WeakMap,Qh=new WeakMap,Jf=new WeakMap;function uS(n){const e=new Promise((t,i)=>{const o=()=>{n.removeEventListener("success",a),n.removeEventListener("error",c)},a=()=>{t(ji(n.result)),o()},c=()=>{i(n.error),o()};n.addEventListener("success",a),n.addEventListener("error",c)});return e.then(t=>{t instanceof IDBCursor&&d0.set(t,n)}).catch(()=>{}),Jf.set(e,n),e}function dS(n){if(hf.has(n))return;const e=new Promise((t,i)=>{const o=()=>{n.removeEventListener("complete",a),n.removeEventListener("error",c),n.removeEventListener("abort",c)},a=()=>{t(),o()},c=()=>{i(n.error||new DOMException("AbortError","AbortError")),o()};n.addEventListener("complete",a),n.addEventListener("error",c),n.addEventListener("abort",c)});hf.set(n,e)}let ff={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return hf.get(n);if(e==="objectStoreNames")return n.objectStoreNames||h0.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return ji(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function hS(n){ff=n(ff)}function fS(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const i=n.call(Yh(this),e,...t);return h0.set(i,e.sort?e.sort():[e]),ji(i)}:cS().includes(n)?function(...e){return n.apply(Yh(this),e),ji(d0.get(this))}:function(...e){return ji(n.apply(Yh(this),e))}}function pS(n){return typeof n=="function"?fS(n):(n instanceof IDBTransaction&&dS(n),aS(n,lS())?new Proxy(n,ff):n)}function ji(n){if(n instanceof IDBRequest)return uS(n);if(Qh.has(n))return Qh.get(n);const e=pS(n);return e!==n&&(Qh.set(n,e),Jf.set(e,n)),e}const Yh=n=>Jf.get(n);function mS(n,e,{blocked:t,upgrade:i,blocking:o,terminated:a}={}){const c=indexedDB.open(n,e),d=ji(c);return i&&c.addEventListener("upgradeneeded",p=>{i(ji(c.result),p.oldVersion,p.newVersion,ji(c.transaction),p)}),t&&c.addEventListener("blocked",p=>t(p.oldVersion,p.newVersion,p)),d.then(p=>{a&&p.addEventListener("close",()=>a()),o&&p.addEventListener("versionchange",m=>o(m.oldVersion,m.newVersion,m))}).catch(()=>{}),d}const gS=["get","getKey","getAll","getAllKeys","count"],yS=["put","add","delete","clear"],Xh=new Map;function my(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Xh.get(e))return Xh.get(e);const t=e.replace(/FromIndex$/,""),i=e!==t,o=yS.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!(o||gS.includes(t)))return;const a=async function(c,...d){const p=this.transaction(c,o?"readwrite":"readonly");let m=p.store;return i&&(m=m.index(d.shift())),(await Promise.all([m[t](...d),o&&p.done]))[0]};return Xh.set(e,a),a}hS(n=>({...n,get:(e,t,i)=>my(e,t)||n.get(e,t,i),has:(e,t)=>!!my(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vS{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(_S(t)){const i=t.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(t=>t).join(" ")}}function _S(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const pf="@firebase/app",gy="0.10.18";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zr=new Xf("@firebase/app"),ES="@firebase/app-compat",wS="@firebase/analytics-compat",TS="@firebase/analytics",SS="@firebase/app-check-compat",xS="@firebase/app-check",IS="@firebase/auth",RS="@firebase/auth-compat",AS="@firebase/database",CS="@firebase/data-connect",kS="@firebase/database-compat",bS="@firebase/functions",NS="@firebase/functions-compat",PS="@firebase/installations",DS="@firebase/installations-compat",jS="@firebase/messaging",OS="@firebase/messaging-compat",LS="@firebase/performance",MS="@firebase/performance-compat",VS="@firebase/remote-config",FS="@firebase/remote-config-compat",US="@firebase/storage",BS="@firebase/storage-compat",zS="@firebase/firestore",$S="@firebase/vertexai",HS="@firebase/firestore-compat",qS="firebase",GS="11.2.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mf="[DEFAULT]",WS={[pf]:"fire-core",[ES]:"fire-core-compat",[TS]:"fire-analytics",[wS]:"fire-analytics-compat",[xS]:"fire-app-check",[SS]:"fire-app-check-compat",[IS]:"fire-auth",[RS]:"fire-auth-compat",[AS]:"fire-rtdb",[CS]:"fire-data-connect",[kS]:"fire-rtdb-compat",[bS]:"fire-fn",[NS]:"fire-fn-compat",[PS]:"fire-iid",[DS]:"fire-iid-compat",[jS]:"fire-fcm",[OS]:"fire-fcm-compat",[LS]:"fire-perf",[MS]:"fire-perf-compat",[VS]:"fire-rc",[FS]:"fire-rc-compat",[US]:"fire-gcs",[BS]:"fire-gcs-compat",[zS]:"fire-fst",[HS]:"fire-fst-compat",[$S]:"fire-vertex","fire-js":"fire-js",[qS]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Au=new Map,KS=new Map,gf=new Map;function yy(n,e){try{n.container.addComponent(e)}catch(t){Zr.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function Fo(n){const e=n.name;if(gf.has(e))return Zr.debug(`There were multiple attempts to register component ${e}.`),!1;gf.set(e,n);for(const t of Au.values())yy(t,n);for(const t of KS.values())yy(t,n);return!0}function Zf(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function nr(n){return n.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QS={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Oi=new Pl("app","Firebase",QS);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YS{constructor(e,t,i){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new ks("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Oi.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zo=GS;function f0(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const i=Object.assign({name:mf,automaticDataCollectionEnabled:!1},e),o=i.name;if(typeof o!="string"||!o)throw Oi.create("bad-app-name",{appName:String(o)});if(t||(t=c0()),!t)throw Oi.create("no-options");const a=Au.get(o);if(a){if(Ru(t,a.options)&&Ru(i,a.config))return a;throw Oi.create("duplicate-app",{appName:o})}const c=new nS(o);for(const p of gf.values())c.addComponent(p);const d=new YS(t,i,c);return Au.set(o,d),d}function p0(n=mf){const e=Au.get(n);if(!e&&n===mf&&c0())return f0();if(!e)throw Oi.create("no-app",{appName:n});return e}function Li(n,e,t){var i;let o=(i=WS[n])!==null&&i!==void 0?i:n;t&&(o+=`-${t}`);const a=o.match(/\s|\//),c=e.match(/\s|\//);if(a||c){const d=[`Unable to register library "${o}" with version "${e}":`];a&&d.push(`library name "${o}" contains illegal characters (whitespace or "/")`),a&&c&&d.push("and"),c&&d.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Zr.warn(d.join(" "));return}Fo(new ks(`${o}-version`,()=>({library:o,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XS="firebase-heartbeat-database",JS=1,yl="firebase-heartbeat-store";let Jh=null;function m0(){return Jh||(Jh=mS(XS,JS,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(yl)}catch(t){console.warn(t)}}}}).catch(n=>{throw Oi.create("idb-open",{originalErrorMessage:n.message})})),Jh}async function ZS(n){try{const t=(await m0()).transaction(yl),i=await t.objectStore(yl).get(g0(n));return await t.done,i}catch(e){if(e instanceof ri)Zr.warn(e.message);else{const t=Oi.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Zr.warn(t.message)}}}async function vy(n,e){try{const i=(await m0()).transaction(yl,"readwrite");await i.objectStore(yl).put(e,g0(n)),await i.done}catch(t){if(t instanceof ri)Zr.warn(t.message);else{const i=Oi.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});Zr.warn(i.message)}}}function g0(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ex=1024,tx=30*24*60*60*1e3;class nx{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new ix(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){var e,t;try{const o=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),a=_y();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===a||this._heartbeatsCache.heartbeats.some(c=>c.date===a)?void 0:(this._heartbeatsCache.heartbeats.push({date:a,agent:o}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(c=>{const d=new Date(c.date).valueOf();return Date.now()-d<=tx}),this._storage.overwrite(this._heartbeatsCache))}catch(i){Zr.warn(i)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=_y(),{heartbeatsToSend:i,unsentEntries:o}=rx(this._heartbeatsCache.heartbeats),a=Iu(JSON.stringify({version:2,heartbeats:i}));return this._heartbeatsCache.lastSentHeartbeatDate=t,o.length>0?(this._heartbeatsCache.heartbeats=o,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),a}catch(t){return Zr.warn(t),""}}}function _y(){return new Date().toISOString().substring(0,10)}function rx(n,e=ex){const t=[];let i=n.slice();for(const o of n){const a=t.find(c=>c.agent===o.agent);if(a){if(a.dates.push(o.date),Ey(t)>e){a.dates.pop();break}}else if(t.push({agent:o.agent,dates:[o.date]}),Ey(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}class ix{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return HT()?qT().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await ZS(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const o=await this.read();return vy(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:o.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const o=await this.read();return vy(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:o.lastSentHeartbeatDate,heartbeats:[...o.heartbeats,...e.heartbeats]})}else return}}function Ey(n){return Iu(JSON.stringify({version:2,heartbeats:n})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sx(n){Fo(new ks("platform-logger",e=>new vS(e),"PRIVATE")),Fo(new ks("heartbeat",e=>new nx(e),"PRIVATE")),Li(pf,gy,n),Li(pf,gy,"esm2017"),Li("fire-js","")}sx("");function ep(n,e){var t={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,i=Object.getOwnPropertySymbols(n);o<i.length;o++)e.indexOf(i[o])<0&&Object.prototype.propertyIsEnumerable.call(n,i[o])&&(t[i[o]]=n[i[o]]);return t}function y0(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const ox=y0,v0=new Pl("auth","Firebase",y0());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cu=new Xf("@firebase/auth");function ax(n,...e){Cu.logLevel<=Fe.WARN&&Cu.warn(`Auth (${Zo}): ${n}`,...e)}function mu(n,...e){Cu.logLevel<=Fe.ERROR&&Cu.error(`Auth (${Zo}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mn(n,...e){throw np(n,...e)}function ir(n,...e){return np(n,...e)}function tp(n,e,t){const i=Object.assign(Object.assign({},ox()),{[e]:t});return new Pl("auth","Firebase",i).create(e,{appName:n.name})}function Xr(n){return tp(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function lx(n,e,t){const i=t;if(!(e instanceof i))throw i.name!==e.constructor.name&&Mn(n,"argument-error"),tp(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function np(n,...e){if(typeof n!="string"){const t=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=n.name),n._errorFactory.create(t,...i)}return v0.create(n,...e)}function Ne(n,e,...t){if(!n)throw np(e,...t)}function Wr(n){const e="INTERNAL ASSERTION FAILED: "+n;throw mu(e),new Error(e)}function ei(n,e){n||Wr(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yf(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function cx(){return wy()==="http:"||wy()==="https:"}function wy(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ux(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(cx()||UT()||"connection"in navigator)?navigator.onLine:!0}function dx(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jl{constructor(e,t){this.shortDelay=e,this.longDelay=t,ei(t>e,"Short delay should be less than long delay!"),this.isMobile=MT()||BT()}get(){return ux()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rp(n,e){ei(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _0{static initialize(e,t,i){this.fetchImpl=e,t&&(this.headersImpl=t),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Wr("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Wr("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Wr("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hx={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fx=new jl(3e4,6e4);function Wi(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}async function Ki(n,e,t,i,o={}){return E0(n,o,async()=>{let a={},c={};i&&(e==="GET"?c=i:a={body:JSON.stringify(i)});const d=Dl(Object.assign({key:n.config.apiKey},c)).slice(1),p=await n._getAdditionalHeaders();p["Content-Type"]="application/json",n.languageCode&&(p["X-Firebase-Locale"]=n.languageCode);const m=Object.assign({method:e,headers:p},a);return FT()||(m.referrerPolicy="no-referrer"),_0.fetch()(w0(n,n.config.apiHost,t,d),m)})}async function E0(n,e,t){n._canInitEmulator=!1;const i=Object.assign(Object.assign({},hx),e);try{const o=new mx(n),a=await Promise.race([t(),o.promise]);o.clearNetworkTimeout();const c=await a.json();if("needConfirmation"in c)throw au(n,"account-exists-with-different-credential",c);if(a.ok&&!("errorMessage"in c))return c;{const d=a.ok?c.errorMessage:c.error.message,[p,m]=d.split(" : ");if(p==="FEDERATED_USER_ID_ALREADY_LINKED")throw au(n,"credential-already-in-use",c);if(p==="EMAIL_EXISTS")throw au(n,"email-already-in-use",c);if(p==="USER_DISABLED")throw au(n,"user-disabled",c);const v=i[p]||p.toLowerCase().replace(/[_\s]+/g,"-");if(m)throw tp(n,v,m);Mn(n,v)}}catch(o){if(o instanceof ri)throw o;Mn(n,"network-request-failed",{message:String(o)})}}async function Ol(n,e,t,i,o={}){const a=await Ki(n,e,t,i,o);return"mfaPendingCredential"in a&&Mn(n,"multi-factor-auth-required",{_serverResponse:a}),a}function w0(n,e,t,i){const o=`${e}${t}?${i}`;return n.config.emulator?rp(n.config,o):`${n.config.apiScheme}://${o}`}function px(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class mx{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,i)=>{this.timer=setTimeout(()=>i(ir(this.auth,"network-request-failed")),fx.get())})}}function au(n,e,t){const i={appName:n.name};t.email&&(i.email=t.email),t.phoneNumber&&(i.phoneNumber=t.phoneNumber);const o=ir(n,e,i);return o.customData._tokenResponse=t,o}function Ty(n){return n!==void 0&&n.enterprise!==void 0}class gx{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return px(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function yx(n,e){return Ki(n,"GET","/v2/recaptchaConfig",Wi(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vx(n,e){return Ki(n,"POST","/v1/accounts:delete",e)}async function T0(n,e){return Ki(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dl(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function _x(n,e=!1){const t=Tn(n),i=await t.getIdToken(e),o=ip(i);Ne(o&&o.exp&&o.auth_time&&o.iat,t.auth,"internal-error");const a=typeof o.firebase=="object"?o.firebase:void 0,c=a==null?void 0:a.sign_in_provider;return{claims:o,token:i,authTime:dl(Zh(o.auth_time)),issuedAtTime:dl(Zh(o.iat)),expirationTime:dl(Zh(o.exp)),signInProvider:c||null,signInSecondFactor:(a==null?void 0:a.sign_in_second_factor)||null}}function Zh(n){return Number(n)*1e3}function ip(n){const[e,t,i]=n.split(".");if(e===void 0||t===void 0||i===void 0)return mu("JWT malformed, contained fewer than 3 sections"),null;try{const o=a0(t);return o?JSON.parse(o):(mu("Failed to decode base64 JWT payload"),null)}catch(o){return mu("Caught error parsing JWT payload as JSON",o==null?void 0:o.toString()),null}}function Sy(n){const e=ip(n);return Ne(e,"internal-error"),Ne(typeof e.exp<"u","internal-error"),Ne(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vl(n,e,t=!1){if(t)return e;try{return await e}catch(i){throw i instanceof ri&&Ex(i)&&n.auth.currentUser===n&&await n.auth.signOut(),i}}function Ex({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wx{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const i=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),i}else{this.errorBackoff=3e4;const o=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,o)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vf{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=dl(this.lastLoginAt),this.creationTime=dl(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ku(n){var e;const t=n.auth,i=await n.getIdToken(),o=await vl(n,T0(t,{idToken:i}));Ne(o==null?void 0:o.users.length,t,"internal-error");const a=o.users[0];n._notifyReloadListener(a);const c=!((e=a.providerUserInfo)===null||e===void 0)&&e.length?S0(a.providerUserInfo):[],d=Sx(n.providerData,c),p=n.isAnonymous,m=!(n.email&&a.passwordHash)&&!(d!=null&&d.length),v=p?m:!1,E={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:d,metadata:new vf(a.createdAt,a.lastLoginAt),isAnonymous:v};Object.assign(n,E)}async function Tx(n){const e=Tn(n);await ku(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function Sx(n,e){return[...n.filter(i=>!e.some(o=>o.providerId===i.providerId)),...e]}function S0(n){return n.map(e=>{var{providerId:t}=e,i=ep(e,["providerId"]);return{providerId:t,uid:i.rawId||"",displayName:i.displayName||null,email:i.email||null,phoneNumber:i.phoneNumber||null,photoURL:i.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function xx(n,e){const t=await E0(n,{},async()=>{const i=Dl({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:o,apiKey:a}=n.config,c=w0(n,o,"/v1/token",`key=${a}`),d=await n._getAdditionalHeaders();return d["Content-Type"]="application/x-www-form-urlencoded",_0.fetch()(c,{method:"POST",headers:d,body:i})});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function Ix(n,e){return Ki(n,"POST","/v2/accounts:revokeToken",Wi(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jo{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Ne(e.idToken,"internal-error"),Ne(typeof e.idToken<"u","internal-error"),Ne(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Sy(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Ne(e.length!==0,"internal-error");const t=Sy(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(Ne(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:i,refreshToken:o,expiresIn:a}=await xx(e,t);this.updateTokensAndExpiration(i,o,Number(a))}updateTokensAndExpiration(e,t,i){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,t){const{refreshToken:i,accessToken:o,expirationTime:a}=t,c=new jo;return i&&(Ne(typeof i=="string","internal-error",{appName:e}),c.refreshToken=i),o&&(Ne(typeof o=="string","internal-error",{appName:e}),c.accessToken=o),a&&(Ne(typeof a=="number","internal-error",{appName:e}),c.expirationTime=a),c}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new jo,this.toJSON())}_performRefresh(){return Wr("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ki(n,e){Ne(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class Kr{constructor(e){var{uid:t,auth:i,stsTokenManager:o}=e,a=ep(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new wx(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=i,this.stsTokenManager=o,this.accessToken=o.accessToken,this.displayName=a.displayName||null,this.email=a.email||null,this.emailVerified=a.emailVerified||!1,this.phoneNumber=a.phoneNumber||null,this.photoURL=a.photoURL||null,this.isAnonymous=a.isAnonymous||!1,this.tenantId=a.tenantId||null,this.providerData=a.providerData?[...a.providerData]:[],this.metadata=new vf(a.createdAt||void 0,a.lastLoginAt||void 0)}async getIdToken(e){const t=await vl(this,this.stsTokenManager.getToken(this.auth,e));return Ne(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return _x(this,e)}reload(){return Tx(this)}_assign(e){this!==e&&(Ne(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Kr(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){Ne(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),t&&await ku(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(nr(this.auth.app))return Promise.reject(Xr(this.auth));const e=await this.getIdToken();return await vl(this,vx(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var i,o,a,c,d,p,m,v;const E=(i=t.displayName)!==null&&i!==void 0?i:void 0,w=(o=t.email)!==null&&o!==void 0?o:void 0,S=(a=t.phoneNumber)!==null&&a!==void 0?a:void 0,R=(c=t.photoURL)!==null&&c!==void 0?c:void 0,j=(d=t.tenantId)!==null&&d!==void 0?d:void 0,N=(p=t._redirectEventId)!==null&&p!==void 0?p:void 0,O=(m=t.createdAt)!==null&&m!==void 0?m:void 0,U=(v=t.lastLoginAt)!==null&&v!==void 0?v:void 0,{uid:q,emailVerified:J,isAnonymous:W,providerData:Q,stsTokenManager:k}=t;Ne(q&&k,e,"internal-error");const x=jo.fromJSON(this.name,k);Ne(typeof q=="string",e,"internal-error"),ki(E,e.name),ki(w,e.name),Ne(typeof J=="boolean",e,"internal-error"),Ne(typeof W=="boolean",e,"internal-error"),ki(S,e.name),ki(R,e.name),ki(j,e.name),ki(N,e.name),ki(O,e.name),ki(U,e.name);const A=new Kr({uid:q,auth:e,email:w,emailVerified:J,displayName:E,isAnonymous:W,photoURL:R,phoneNumber:S,tenantId:j,stsTokenManager:x,createdAt:O,lastLoginAt:U});return Q&&Array.isArray(Q)&&(A.providerData=Q.map(P=>Object.assign({},P))),N&&(A._redirectEventId=N),A}static async _fromIdTokenResponse(e,t,i=!1){const o=new jo;o.updateFromServerResponse(t);const a=new Kr({uid:t.localId,auth:e,stsTokenManager:o,isAnonymous:i});return await ku(a),a}static async _fromGetAccountInfoResponse(e,t,i){const o=t.users[0];Ne(o.localId!==void 0,"internal-error");const a=o.providerUserInfo!==void 0?S0(o.providerUserInfo):[],c=!(o.email&&o.passwordHash)&&!(a!=null&&a.length),d=new jo;d.updateFromIdToken(i);const p=new Kr({uid:o.localId,auth:e,stsTokenManager:d,isAnonymous:c}),m={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:a,metadata:new vf(o.createdAt,o.lastLoginAt),isAnonymous:!(o.email&&o.passwordHash)&&!(a!=null&&a.length)};return Object.assign(p,m),p}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xy=new Map;function Qr(n){ei(n instanceof Function,"Expected a class definition");let e=xy.get(n);return e?(ei(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,xy.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x0{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}x0.type="NONE";const Iy=x0;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gu(n,e,t){return`firebase:${n}:${e}:${t}`}class Oo{constructor(e,t,i){this.persistence=e,this.auth=t,this.userKey=i;const{config:o,name:a}=this.auth;this.fullUserKey=gu(this.userKey,o.apiKey,a),this.fullPersistenceKey=gu("persistence",o.apiKey,a),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?Kr._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,i="authUser"){if(!t.length)return new Oo(Qr(Iy),e,i);const o=(await Promise.all(t.map(async m=>{if(await m._isAvailable())return m}))).filter(m=>m);let a=o[0]||Qr(Iy);const c=gu(i,e.config.apiKey,e.name);let d=null;for(const m of t)try{const v=await m._get(c);if(v){const E=Kr._fromJSON(e,v);m!==a&&(d=E),a=m;break}}catch{}const p=o.filter(m=>m._shouldAllowMigration);return!a._shouldAllowMigration||!p.length?new Oo(a,e,i):(a=p[0],d&&await a._set(c,d.toJSON()),await Promise.all(t.map(async m=>{if(m!==a)try{await m._remove(c)}catch{}})),new Oo(a,e,i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ry(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(C0(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(I0(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(b0(e))return"Blackberry";if(N0(e))return"Webos";if(R0(e))return"Safari";if((e.includes("chrome/")||A0(e))&&!e.includes("edge/"))return"Chrome";if(k0(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=n.match(t);if((i==null?void 0:i.length)===2)return i[1]}return"Other"}function I0(n=Jt()){return/firefox\//i.test(n)}function R0(n=Jt()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function A0(n=Jt()){return/crios\//i.test(n)}function C0(n=Jt()){return/iemobile/i.test(n)}function k0(n=Jt()){return/android/i.test(n)}function b0(n=Jt()){return/blackberry/i.test(n)}function N0(n=Jt()){return/webos/i.test(n)}function sp(n=Jt()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function Rx(n=Jt()){var e;return sp(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function Ax(){return zT()&&document.documentMode===10}function P0(n=Jt()){return sp(n)||k0(n)||N0(n)||b0(n)||/windows phone/i.test(n)||C0(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function D0(n,e=[]){let t;switch(n){case"Browser":t=Ry(Jt());break;case"Worker":t=`${Ry(Jt())}-${n}`;break;default:t=n}const i=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Zo}/${i}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cx{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const i=a=>new Promise((c,d)=>{try{const p=e(a);c(p)}catch(p){d(p)}});i.onAbort=t,this.queue.push(i);const o=this.queue.length-1;return()=>{this.queue[o]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const i of this.queue)await i(e),i.onAbort&&t.push(i.onAbort)}catch(i){t.reverse();for(const o of t)try{o()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i==null?void 0:i.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function kx(n,e={}){return Ki(n,"GET","/v2/passwordPolicy",Wi(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bx=6;class Nx{constructor(e){var t,i,o,a;const c=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=c.minPasswordLength)!==null&&t!==void 0?t:bx,c.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=c.maxPasswordLength),c.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=c.containsLowercaseCharacter),c.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=c.containsUppercaseCharacter),c.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=c.containsNumericCharacter),c.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=c.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(o=(i=e.allowedNonAlphanumericCharacters)===null||i===void 0?void 0:i.join(""))!==null&&o!==void 0?o:"",this.forceUpgradeOnSignin=(a=e.forceUpgradeOnSignin)!==null&&a!==void 0?a:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,i,o,a,c,d;const p={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,p),this.validatePasswordCharacterOptions(e,p),p.isValid&&(p.isValid=(t=p.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),p.isValid&&(p.isValid=(i=p.meetsMaxPasswordLength)!==null&&i!==void 0?i:!0),p.isValid&&(p.isValid=(o=p.containsLowercaseLetter)!==null&&o!==void 0?o:!0),p.isValid&&(p.isValid=(a=p.containsUppercaseLetter)!==null&&a!==void 0?a:!0),p.isValid&&(p.isValid=(c=p.containsNumericCharacter)!==null&&c!==void 0?c:!0),p.isValid&&(p.isValid=(d=p.containsNonAlphanumericCharacter)!==null&&d!==void 0?d:!0),p}validatePasswordLengthOptions(e,t){const i=this.customStrengthOptions.minPasswordLength,o=this.customStrengthOptions.maxPasswordLength;i&&(t.meetsMinPasswordLength=e.length>=i),o&&(t.meetsMaxPasswordLength=e.length<=o)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let i;for(let o=0;o<e.length;o++)i=e.charAt(o),this.updatePasswordCharacterOptionsStatuses(t,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(e,t,i,o,a){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=o)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Px{constructor(e,t,i,o){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=i,this.config=o,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Ay(this),this.idTokenSubscription=new Ay(this),this.beforeStateQueue=new Cx(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=v0,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=o.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Qr(t)),this._initializationPromise=this.queue(async()=>{var i,o;if(!this._deleted&&(this.persistenceManager=await Oo.create(this,e),!this._deleted)){if(!((i=this._popupRedirectResolver)===null||i===void 0)&&i._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((o=this.currentUser)===null||o===void 0?void 0:o.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await T0(this,{idToken:e}),i=await Kr._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(i)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(nr(this.app)){const c=this.app.settings.authIdToken;return c?new Promise(d=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(c).then(d,d))}):this.directlySetCurrentUser(null)}const i=await this.assertedPersistence.getCurrentUser();let o=i,a=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const c=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,d=o==null?void 0:o._redirectEventId,p=await this.tryRedirectSignIn(e);(!c||c===d)&&(p!=null&&p.user)&&(o=p.user,a=!0)}if(!o)return this.directlySetCurrentUser(null);if(!o._redirectEventId){if(a)try{await this.beforeStateQueue.runMiddleware(o)}catch(c){o=i,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(c))}return o?this.reloadAndSetCurrentUserOrClear(o):this.directlySetCurrentUser(null)}return Ne(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===o._redirectEventId?this.directlySetCurrentUser(o):this.reloadAndSetCurrentUserOrClear(o)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await ku(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=dx()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(nr(this.app))return Promise.reject(Xr(this));const t=e?Tn(e):null;return t&&Ne(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Ne(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return nr(this.app)?Promise.reject(Xr(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return nr(this.app)?Promise.reject(Xr(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Qr(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await kx(this),t=new Nx(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new Pl("auth","Firebase",e())}onAuthStateChanged(e,t,i){return this.registerStateListener(this.authStateSubscription,e,t,i)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,i){return this.registerStateListener(this.idTokenSubscription,e,t,i)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const i=this.onAuthStateChanged(()=>{i(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(i.tenantId=this.tenantId),await Ix(this,i)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,t){const i=await this.getOrInitRedirectPersistenceManager(t);return e===null?i.removeCurrentUser():i.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Qr(e)||this._popupRedirectResolver;Ne(t,this,"argument-error"),this.redirectPersistenceManager=await Oo.create(this,[Qr(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,i;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((i=this.redirectUser)===null||i===void 0?void 0:i._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const i=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==i&&(this.lastNotifiedUid=i,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,i,o){if(this._deleted)return()=>{};const a=typeof t=="function"?t:t.next.bind(t);let c=!1;const d=this._isInitialized?Promise.resolve():this._initializationPromise;if(Ne(d,this,"internal-error"),d.then(()=>{c||a(this.currentUser)}),typeof t=="function"){const p=e.addObserver(t,i,o);return()=>{c=!0,p()}}else{const p=e.addObserver(t);return()=>{c=!0,p()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Ne(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=D0(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const i=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());i&&(t["X-Firebase-Client"]=i);const o=await this._getAppCheckToken();return o&&(t["X-Firebase-AppCheck"]=o),t}async _getAppCheckToken(){var e;const t=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return t!=null&&t.error&&ax(`Error while retrieving App Check token: ${t.error}`),t==null?void 0:t.token}}function Qi(n){return Tn(n)}class Ay{constructor(e){this.auth=e,this.observer=null,this.addObserver=YT(t=>this.observer=t)}get next(){return Ne(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Qu={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function Dx(n){Qu=n}function j0(n){return Qu.loadJS(n)}function jx(){return Qu.recaptchaEnterpriseScript}function Ox(){return Qu.gapiScript}function Lx(n){return`__${n}${Math.floor(Math.random()*1e6)}`}class Mx{constructor(){this.enterprise=new Vx}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class Vx{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const Fx="recaptcha-enterprise",O0="NO_RECAPTCHA";class Ux{constructor(e){this.type=Fx,this.auth=Qi(e)}async verify(e="verify",t=!1){async function i(a){if(!t){if(a.tenantId==null&&a._agentRecaptchaConfig!=null)return a._agentRecaptchaConfig.siteKey;if(a.tenantId!=null&&a._tenantRecaptchaConfigs[a.tenantId]!==void 0)return a._tenantRecaptchaConfigs[a.tenantId].siteKey}return new Promise(async(c,d)=>{yx(a,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(p=>{if(p.recaptchaKey===void 0)d(new Error("recaptcha Enterprise site key undefined"));else{const m=new gx(p);return a.tenantId==null?a._agentRecaptchaConfig=m:a._tenantRecaptchaConfigs[a.tenantId]=m,c(m.siteKey)}}).catch(p=>{d(p)})})}function o(a,c,d){const p=window.grecaptcha;Ty(p)?p.enterprise.ready(()=>{p.enterprise.execute(a,{action:e}).then(m=>{c(m)}).catch(()=>{c(O0)})}):d(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new Mx().execute("siteKey",{action:"verify"}):new Promise((a,c)=>{i(this.auth).then(d=>{if(!t&&Ty(window.grecaptcha))o(d,a,c);else{if(typeof window>"u"){c(new Error("RecaptchaVerifier is only supported in browser"));return}let p=jx();p.length!==0&&(p+=d),j0(p).then(()=>{o(d,a,c)}).catch(m=>{c(m)})}}).catch(d=>{c(d)})})}}async function Cy(n,e,t,i=!1,o=!1){const a=new Ux(n);let c;if(o)c=O0;else try{c=await a.verify(t)}catch{c=await a.verify(t,!0)}const d=Object.assign({},e);if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in d){const p=d.phoneEnrollmentInfo.phoneNumber,m=d.phoneEnrollmentInfo.recaptchaToken;Object.assign(d,{phoneEnrollmentInfo:{phoneNumber:p,recaptchaToken:m,captchaResponse:c,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in d){const p=d.phoneSignInInfo.recaptchaToken;Object.assign(d,{phoneSignInInfo:{recaptchaToken:p,captchaResponse:c,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return d}return i?Object.assign(d,{captchaResp:c}):Object.assign(d,{captchaResponse:c}),Object.assign(d,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(d,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),d}async function _f(n,e,t,i,o){var a;if(!((a=n._getRecaptchaConfig())===null||a===void 0)&&a.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const c=await Cy(n,e,t,t==="getOobCode");return i(n,c)}else return i(n,e).catch(async c=>{if(c.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const d=await Cy(n,e,t,t==="getOobCode");return i(n,d)}else return Promise.reject(c)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bx(n,e){const t=Zf(n,"auth");if(t.isInitialized()){const o=t.getImmediate(),a=t.getOptions();if(Ru(a,e??{}))return o;Mn(o,"already-initialized")}return t.initialize({options:e})}function zx(n,e){const t=(e==null?void 0:e.persistence)||[],i=(Array.isArray(t)?t:[t]).map(Qr);e!=null&&e.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(i,e==null?void 0:e.popupRedirectResolver)}function $x(n,e,t){const i=Qi(n);Ne(i._canInitEmulator,i,"emulator-config-failed"),Ne(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const o=!1,a=L0(e),{host:c,port:d}=Hx(e),p=d===null?"":`:${d}`;i.config.emulator={url:`${a}//${c}${p}/`},i.settings.appVerificationDisabledForTesting=!0,i.emulatorConfig=Object.freeze({host:c,port:d,protocol:a.replace(":",""),options:Object.freeze({disableWarnings:o})}),qx()}function L0(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function Hx(n){const e=L0(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const i=t[2].split("@").pop()||"",o=/^(\[[^\]]+\])(:|$)/.exec(i);if(o){const a=o[1];return{host:a,port:ky(i.substr(a.length+1))}}else{const[a,c]=i.split(":");return{host:a,port:ky(c)}}}function ky(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function qx(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class op{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Wr("not implemented")}_getIdTokenResponse(e){return Wr("not implemented")}_linkToIdToken(e,t){return Wr("not implemented")}_getReauthenticationResolver(e){return Wr("not implemented")}}async function Gx(n,e){return Ki(n,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Wx(n,e){return Ol(n,"POST","/v1/accounts:signInWithPassword",Wi(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Kx(n,e){return Ol(n,"POST","/v1/accounts:signInWithEmailLink",Wi(n,e))}async function Qx(n,e){return Ol(n,"POST","/v1/accounts:signInWithEmailLink",Wi(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _l extends op{constructor(e,t,i,o=null){super("password",i),this._email=e,this._password=t,this._tenantId=o}static _fromEmailAndPassword(e,t){return new _l(e,t,"password")}static _fromEmailAndCode(e,t,i=null){return new _l(e,t,"emailLink",i)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t!=null&&t.email&&(t!=null&&t.password)){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return _f(e,t,"signInWithPassword",Wx);case"emailLink":return Kx(e,{email:this._email,oobCode:this._password});default:Mn(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const i={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return _f(e,i,"signUpPassword",Gx);case"emailLink":return Qx(e,{idToken:t,email:this._email,oobCode:this._password});default:Mn(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Lo(n,e){return Ol(n,"POST","/v1/accounts:signInWithIdp",Wi(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yx="http://localhost";class bs extends op{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new bs(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Mn("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:o}=t,a=ep(t,["providerId","signInMethod"]);if(!i||!o)return null;const c=new bs(i,o);return c.idToken=a.idToken||void 0,c.accessToken=a.accessToken||void 0,c.secret=a.secret,c.nonce=a.nonce,c.pendingToken=a.pendingToken||null,c}_getIdTokenResponse(e){const t=this.buildRequest();return Lo(e,t)}_linkToIdToken(e,t){const i=this.buildRequest();return i.idToken=t,Lo(e,i)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Lo(e,t)}buildRequest(){const e={requestUri:Yx,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Dl(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xx(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function Jx(n){const e=il(sl(n)).link,t=e?il(sl(e)).deep_link_id:null,i=il(sl(n)).deep_link_id;return(i?il(sl(i)).link:null)||i||t||e||n}class ap{constructor(e){var t,i,o,a,c,d;const p=il(sl(e)),m=(t=p.apiKey)!==null&&t!==void 0?t:null,v=(i=p.oobCode)!==null&&i!==void 0?i:null,E=Xx((o=p.mode)!==null&&o!==void 0?o:null);Ne(m&&v&&E,"argument-error"),this.apiKey=m,this.operation=E,this.code=v,this.continueUrl=(a=p.continueUrl)!==null&&a!==void 0?a:null,this.languageCode=(c=p.languageCode)!==null&&c!==void 0?c:null,this.tenantId=(d=p.tenantId)!==null&&d!==void 0?d:null}static parseLink(e){const t=Jx(e);try{return new ap(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ea{constructor(){this.providerId=ea.PROVIDER_ID}static credential(e,t){return _l._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const i=ap.parseLink(t);return Ne(i,"argument-error"),_l._fromEmailAndCode(e,i.code,i.tenantId)}}ea.PROVIDER_ID="password";ea.EMAIL_PASSWORD_SIGN_IN_METHOD="password";ea.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lp{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ll extends lp{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bi extends Ll{constructor(){super("facebook.com")}static credential(e){return bs._fromParams({providerId:bi.PROVIDER_ID,signInMethod:bi.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return bi.credentialFromTaggedObject(e)}static credentialFromError(e){return bi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return bi.credential(e.oauthAccessToken)}catch{return null}}}bi.FACEBOOK_SIGN_IN_METHOD="facebook.com";bi.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gr extends Ll{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return bs._fromParams({providerId:Gr.PROVIDER_ID,signInMethod:Gr.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Gr.credentialFromTaggedObject(e)}static credentialFromError(e){return Gr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:i}=e;if(!t&&!i)return null;try{return Gr.credential(t,i)}catch{return null}}}Gr.GOOGLE_SIGN_IN_METHOD="google.com";Gr.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ni extends Ll{constructor(){super("github.com")}static credential(e){return bs._fromParams({providerId:Ni.PROVIDER_ID,signInMethod:Ni.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ni.credentialFromTaggedObject(e)}static credentialFromError(e){return Ni.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ni.credential(e.oauthAccessToken)}catch{return null}}}Ni.GITHUB_SIGN_IN_METHOD="github.com";Ni.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pi extends Ll{constructor(){super("twitter.com")}static credential(e,t){return bs._fromParams({providerId:Pi.PROVIDER_ID,signInMethod:Pi.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Pi.credentialFromTaggedObject(e)}static credentialFromError(e){return Pi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:i}=e;if(!t||!i)return null;try{return Pi.credential(t,i)}catch{return null}}}Pi.TWITTER_SIGN_IN_METHOD="twitter.com";Pi.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Zx(n,e){return Ol(n,"POST","/v1/accounts:signUp",Wi(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ns{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,i,o=!1){const a=await Kr._fromIdTokenResponse(e,i,o),c=by(i);return new Ns({user:a,providerId:c,_tokenResponse:i,operationType:t})}static async _forOperation(e,t,i){await e._updateTokensIfNecessary(i,!0);const o=by(i);return new Ns({user:e,providerId:o,_tokenResponse:i,operationType:t})}}function by(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bu extends ri{constructor(e,t,i,o){var a;super(t.code,t.message),this.operationType=i,this.user=o,Object.setPrototypeOf(this,bu.prototype),this.customData={appName:e.name,tenantId:(a=e.tenantId)!==null&&a!==void 0?a:void 0,_serverResponse:t.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,t,i,o){return new bu(e,t,i,o)}}function M0(n,e,t,i){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(a=>{throw a.code==="auth/multi-factor-auth-required"?bu._fromErrorAndOperation(n,a,e,i):a})}async function eI(n,e,t=!1){const i=await vl(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return Ns._forOperation(n,"link",i)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function tI(n,e,t=!1){const{auth:i}=n;if(nr(i.app))return Promise.reject(Xr(i));const o="reauthenticate";try{const a=await vl(n,M0(i,o,e,n),t);Ne(a.idToken,i,"internal-error");const c=ip(a.idToken);Ne(c,i,"internal-error");const{sub:d}=c;return Ne(n.uid===d,i,"user-mismatch"),Ns._forOperation(n,o,a)}catch(a){throw(a==null?void 0:a.code)==="auth/user-not-found"&&Mn(i,"user-mismatch"),a}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function V0(n,e,t=!1){if(nr(n.app))return Promise.reject(Xr(n));const i="signIn",o=await M0(n,i,e),a=await Ns._fromIdTokenResponse(n,i,o);return t||await n._updateCurrentUser(a.user),a}async function nI(n,e){return V0(Qi(n),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function F0(n){const e=Qi(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function rI(n,e,t){if(nr(n.app))return Promise.reject(Xr(n));const i=Qi(n),c=await _f(i,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",Zx).catch(p=>{throw p.code==="auth/password-does-not-meet-requirements"&&F0(n),p}),d=await Ns._fromIdTokenResponse(i,"signIn",c);return await i._updateCurrentUser(d.user),d}function iI(n,e,t){return nr(n.app)?Promise.reject(Xr(n)):nI(Tn(n),ea.credential(e,t)).catch(async i=>{throw i.code==="auth/password-does-not-meet-requirements"&&F0(n),i})}function sI(n,e,t,i){return Tn(n).onIdTokenChanged(e,t,i)}function oI(n,e,t){return Tn(n).beforeAuthStateChanged(e,t)}function aI(n,e,t,i){return Tn(n).onAuthStateChanged(e,t,i)}function lI(n){return Tn(n).signOut()}const Nu="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U0{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Nu,"1"),this.storage.removeItem(Nu),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cI=1e3,uI=10;class B0 extends U0{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=P0(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const i=this.storage.getItem(t),o=this.localCache[t];i!==o&&e(t,o,i)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((c,d,p)=>{this.notifyListeners(c,p)});return}const i=e.key;t?this.detachListener():this.stopPolling();const o=()=>{const c=this.storage.getItem(i);!t&&this.localCache[i]===c||this.notifyListeners(i,c)},a=this.storage.getItem(i);Ax()&&a!==e.newValue&&e.newValue!==e.oldValue?setTimeout(o,uI):o()}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const o of Array.from(i))o(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:i}),!0)})},cI)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}B0.type="LOCAL";const dI=B0;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z0 extends U0{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}z0.type="SESSION";const $0=z0;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hI(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yu{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(o=>o.isListeningto(e));if(t)return t;const i=new Yu(e);return this.receivers.push(i),i}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:i,eventType:o,data:a}=t.data,c=this.handlersMap[o];if(!(c!=null&&c.size))return;t.ports[0].postMessage({status:"ack",eventId:i,eventType:o});const d=Array.from(c).map(async m=>m(t.origin,a)),p=await hI(d);t.ports[0].postMessage({status:"done",eventId:i,eventType:o,response:p})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Yu.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cp(n="",e=10){let t="";for(let i=0;i<e;i++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fI{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,i=50){const o=typeof MessageChannel<"u"?new MessageChannel:null;if(!o)throw new Error("connection_unavailable");let a,c;return new Promise((d,p)=>{const m=cp("",20);o.port1.start();const v=setTimeout(()=>{p(new Error("unsupported_event"))},i);c={messageChannel:o,onMessage(E){const w=E;if(w.data.eventId===m)switch(w.data.status){case"ack":clearTimeout(v),a=setTimeout(()=>{p(new Error("timeout"))},3e3);break;case"done":clearTimeout(a),d(w.data.response);break;default:clearTimeout(v),clearTimeout(a),p(new Error("invalid_response"));break}}},this.handlers.add(c),o.port1.addEventListener("message",c.onMessage),this.target.postMessage({eventType:e,eventId:m,data:t},[o.port2])}).finally(()=>{c&&this.removeMessageHandler(c)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _r(){return window}function pI(n){_r().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function H0(){return typeof _r().WorkerGlobalScope<"u"&&typeof _r().importScripts=="function"}async function mI(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function gI(){var n;return((n=navigator==null?void 0:navigator.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function yI(){return H0()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q0="firebaseLocalStorageDb",vI=1,Pu="firebaseLocalStorage",G0="fbase_key";class Ml{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Xu(n,e){return n.transaction([Pu],e?"readwrite":"readonly").objectStore(Pu)}function _I(){const n=indexedDB.deleteDatabase(q0);return new Ml(n).toPromise()}function Ef(){const n=indexedDB.open(q0,vI);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const i=n.result;try{i.createObjectStore(Pu,{keyPath:G0})}catch(o){t(o)}}),n.addEventListener("success",async()=>{const i=n.result;i.objectStoreNames.contains(Pu)?e(i):(i.close(),await _I(),e(await Ef()))})})}async function Ny(n,e,t){const i=Xu(n,!0).put({[G0]:e,value:t});return new Ml(i).toPromise()}async function EI(n,e){const t=Xu(n,!1).get(e),i=await new Ml(t).toPromise();return i===void 0?null:i.value}function Py(n,e){const t=Xu(n,!0).delete(e);return new Ml(t).toPromise()}const wI=800,TI=3;class W0{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Ef(),this.db)}async _withRetries(e){let t=0;for(;;)try{const i=await this._openDb();return await e(i)}catch(i){if(t++>TI)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return H0()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Yu._getInstance(yI()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await mI(),!this.activeServiceWorker)return;this.sender=new fI(this.activeServiceWorker);const i=await this.sender._send("ping",{},800);i&&!((e=i[0])===null||e===void 0)&&e.fulfilled&&!((t=i[0])===null||t===void 0)&&t.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||gI()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Ef();return await Ny(e,Nu,"1"),await Py(e,Nu),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(i=>Ny(i,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(i=>EI(i,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>Py(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(o=>{const a=Xu(o,!1).getAll();return new Ml(a).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],i=new Set;if(e.length!==0)for(const{fbase_key:o,value:a}of e)i.add(o),JSON.stringify(this.localCache[o])!==JSON.stringify(a)&&(this.notifyListeners(o,a),t.push(o));for(const o of Object.keys(this.localCache))this.localCache[o]&&!i.has(o)&&(this.notifyListeners(o,null),t.push(o));return t}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const o of Array.from(i))o(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),wI)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}W0.type="LOCAL";const SI=W0;new jl(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function K0(n,e){return e?Qr(e):(Ne(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class up extends op{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Lo(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Lo(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Lo(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function xI(n){return V0(n.auth,new up(n),n.bypassAuthState)}function II(n){const{auth:e,user:t}=n;return Ne(t,e,"internal-error"),tI(t,new up(n),n.bypassAuthState)}async function RI(n){const{auth:e,user:t}=n;return Ne(t,e,"internal-error"),eI(t,new up(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q0{constructor(e,t,i,o,a=!1){this.auth=e,this.resolver=i,this.user=o,this.bypassAuthState=a,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:i,postBody:o,tenantId:a,error:c,type:d}=e;if(c){this.reject(c);return}const p={auth:this.auth,requestUri:t,sessionId:i,tenantId:a||void 0,postBody:o||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(d)(p))}catch(m){this.reject(m)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return xI;case"linkViaPopup":case"linkViaRedirect":return RI;case"reauthViaPopup":case"reauthViaRedirect":return II;default:Mn(this.auth,"internal-error")}}resolve(e){ei(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){ei(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AI=new jl(2e3,1e4);async function CI(n,e,t){if(nr(n.app))return Promise.reject(ir(n,"operation-not-supported-in-this-environment"));const i=Qi(n);lx(n,e,lp);const o=K0(i,t);return new Rs(i,"signInViaPopup",e,o).executeNotNull()}class Rs extends Q0{constructor(e,t,i,o,a){super(e,t,o,a),this.provider=i,this.authWindow=null,this.pollId=null,Rs.currentPopupAction&&Rs.currentPopupAction.cancel(),Rs.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Ne(e,this.auth,"internal-error"),e}async onExecution(){ei(this.filter.length===1,"Popup operations only handle one event");const e=cp();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(ir(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(ir(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Rs.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,i;if(!((i=(t=this.authWindow)===null||t===void 0?void 0:t.window)===null||i===void 0)&&i.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(ir(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,AI.get())};e()}}Rs.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kI="pendingRedirect",yu=new Map;class bI extends Q0{constructor(e,t,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,i),this.eventId=null}async execute(){let e=yu.get(this.auth._key());if(!e){try{const i=await NI(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(i)}catch(t){e=()=>Promise.reject(t)}yu.set(this.auth._key(),e)}return this.bypassAuthState||yu.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function NI(n,e){const t=jI(e),i=DI(n);if(!await i._isAvailable())return!1;const o=await i._get(t)==="true";return await i._remove(t),o}function PI(n,e){yu.set(n._key(),e)}function DI(n){return Qr(n._redirectPersistence)}function jI(n){return gu(kI,n.config.apiKey,n.name)}async function OI(n,e,t=!1){if(nr(n.app))return Promise.reject(Xr(n));const i=Qi(n),o=K0(i,e),c=await new bI(i,o,t).execute();return c&&!t&&(delete c.user._redirectEventId,await i._persistUserIfCurrent(c.user),await i._setRedirectUser(null,e)),c}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LI=10*60*1e3;class MI{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(t=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!VI(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var i;if(e.error&&!Y0(e)){const o=((i=e.error.code)===null||i===void 0?void 0:i.split("auth/")[1])||"internal-error";t.onError(ir(this.auth,o))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const i=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=LI&&this.cachedEventUids.clear(),this.cachedEventUids.has(Dy(e))}saveEventToCache(e){this.cachedEventUids.add(Dy(e)),this.lastProcessedEventTime=Date.now()}}function Dy(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function Y0({type:n,error:e}){return n==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function VI(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Y0(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function FI(n,e={}){return Ki(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UI=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,BI=/^https?/;async function zI(n){if(n.config.emulator)return;const{authorizedDomains:e}=await FI(n);for(const t of e)try{if($I(t))return}catch{}Mn(n,"unauthorized-domain")}function $I(n){const e=yf(),{protocol:t,hostname:i}=new URL(e);if(n.startsWith("chrome-extension://")){const c=new URL(n);return c.hostname===""&&i===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&c.hostname===i}if(!BI.test(t))return!1;if(UI.test(n))return i===n;const o=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+o+"|"+o+")$","i").test(i)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HI=new jl(3e4,6e4);function jy(){const n=_r().___jsl;if(n!=null&&n.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function qI(n){return new Promise((e,t)=>{var i,o,a;function c(){jy(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{jy(),t(ir(n,"network-request-failed"))},timeout:HI.get()})}if(!((o=(i=_r().gapi)===null||i===void 0?void 0:i.iframes)===null||o===void 0)&&o.Iframe)e(gapi.iframes.getContext());else if(!((a=_r().gapi)===null||a===void 0)&&a.load)c();else{const d=Lx("iframefcb");return _r()[d]=()=>{gapi.load?c():t(ir(n,"network-request-failed"))},j0(`${Ox()}?onload=${d}`).catch(p=>t(p))}}).catch(e=>{throw vu=null,e})}let vu=null;function GI(n){return vu=vu||qI(n),vu}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WI=new jl(5e3,15e3),KI="__/auth/iframe",QI="emulator/auth/iframe",YI={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},XI=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function JI(n){const e=n.config;Ne(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?rp(e,QI):`https://${n.config.authDomain}/${KI}`,i={apiKey:e.apiKey,appName:n.name,v:Zo},o=XI.get(n.config.apiHost);o&&(i.eid=o);const a=n._getFrameworks();return a.length&&(i.fw=a.join(",")),`${t}?${Dl(i).slice(1)}`}async function ZI(n){const e=await GI(n),t=_r().gapi;return Ne(t,n,"internal-error"),e.open({where:document.body,url:JI(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:YI,dontclear:!0},i=>new Promise(async(o,a)=>{await i.restyle({setHideOnLeave:!1});const c=ir(n,"network-request-failed"),d=_r().setTimeout(()=>{a(c)},WI.get());function p(){_r().clearTimeout(d),o(i)}i.ping(p).then(p,()=>{a(c)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eR={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},tR=500,nR=600,rR="_blank",iR="http://localhost";class Oy{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function sR(n,e,t,i=tR,o=nR){const a=Math.max((window.screen.availHeight-o)/2,0).toString(),c=Math.max((window.screen.availWidth-i)/2,0).toString();let d="";const p=Object.assign(Object.assign({},eR),{width:i.toString(),height:o.toString(),top:a,left:c}),m=Jt().toLowerCase();t&&(d=A0(m)?rR:t),I0(m)&&(e=e||iR,p.scrollbars="yes");const v=Object.entries(p).reduce((w,[S,R])=>`${w}${S}=${R},`,"");if(Rx(m)&&d!=="_self")return oR(e||"",d),new Oy(null);const E=window.open(e||"",d,v);Ne(E,n,"popup-blocked");try{E.focus()}catch{}return new Oy(E)}function oR(n,e){const t=document.createElement("a");t.href=n,t.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(i)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aR="__/auth/handler",lR="emulator/auth/handler",cR=encodeURIComponent("fac");async function Ly(n,e,t,i,o,a){Ne(n.config.authDomain,n,"auth-domain-config-required"),Ne(n.config.apiKey,n,"invalid-api-key");const c={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:i,v:Zo,eventId:o};if(e instanceof lp){e.setDefaultLanguage(n.languageCode),c.providerId=e.providerId||"",QT(e.getCustomParameters())||(c.customParameters=JSON.stringify(e.getCustomParameters()));for(const[v,E]of Object.entries({}))c[v]=E}if(e instanceof Ll){const v=e.getScopes().filter(E=>E!=="");v.length>0&&(c.scopes=v.join(","))}n.tenantId&&(c.tid=n.tenantId);const d=c;for(const v of Object.keys(d))d[v]===void 0&&delete d[v];const p=await n._getAppCheckToken(),m=p?`#${cR}=${encodeURIComponent(p)}`:"";return`${uR(n)}?${Dl(d).slice(1)}${m}`}function uR({config:n}){return n.emulator?rp(n,lR):`https://${n.authDomain}/${aR}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ef="webStorageSupport";class dR{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=$0,this._completeRedirectFn=OI,this._overrideRedirectResult=PI}async _openPopup(e,t,i,o){var a;ei((a=this.eventManagers[e._key()])===null||a===void 0?void 0:a.manager,"_initialize() not called before _openPopup()");const c=await Ly(e,t,i,yf(),o);return sR(e,c,cp())}async _openRedirect(e,t,i,o){await this._originValidation(e);const a=await Ly(e,t,i,yf(),o);return pI(a),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:o,promise:a}=this.eventManagers[t];return o?Promise.resolve(o):(ei(a,"If manager is not set, promise should be"),a)}const i=this.initAndGetManager(e);return this.eventManagers[t]={promise:i},i.catch(()=>{delete this.eventManagers[t]}),i}async initAndGetManager(e){const t=await ZI(e),i=new MI(e);return t.register("authEvent",o=>(Ne(o==null?void 0:o.authEvent,e,"invalid-auth-event"),{status:i.onEvent(o.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=t,i}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(ef,{type:ef},o=>{var a;const c=(a=o==null?void 0:o[0])===null||a===void 0?void 0:a[ef];c!==void 0&&t(!!c),Mn(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=zI(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return P0()||R0()||sp()}}const hR=dR;var My="@firebase/auth",Vy="1.8.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fR{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(i=>{e((i==null?void 0:i.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Ne(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pR(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function mR(n){Fo(new ks("auth",(e,{options:t})=>{const i=e.getProvider("app").getImmediate(),o=e.getProvider("heartbeat"),a=e.getProvider("app-check-internal"),{apiKey:c,authDomain:d}=i.options;Ne(c&&!c.includes(":"),"invalid-api-key",{appName:i.name});const p={apiKey:c,authDomain:d,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:D0(n)},m=new Px(i,o,a,p);return zx(m,t),m},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,i)=>{e.getProvider("auth-internal").initialize()})),Fo(new ks("auth-internal",e=>{const t=Qi(e.getProvider("auth").getImmediate());return(i=>new fR(i))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Li(My,Vy,pR(n)),Li(My,Vy,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gR=5*60,yR=u0("authIdTokenMaxAge")||gR;let Fy=null;const vR=n=>async e=>{const t=e&&await e.getIdTokenResult(),i=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(i&&i>yR)return;const o=t==null?void 0:t.token;Fy!==o&&(Fy=o,await fetch(n,{method:o?"POST":"DELETE",headers:o?{Authorization:`Bearer ${o}`}:{}}))};function _R(n=p0()){const e=Zf(n,"auth");if(e.isInitialized())return e.getImmediate();const t=Bx(n,{popupRedirectResolver:hR,persistence:[SI,dI,$0]}),i=u0("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){const a=new URL(i,location.origin);if(location.origin===a.origin){const c=vR(a.toString());oI(t,c,()=>c(t.currentUser)),sI(t,d=>c(d))}}const o=l0("auth");return o&&$x(t,`http://${o}`),t}function ER(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}Dx({loadJS(n){return new Promise((e,t)=>{const i=document.createElement("script");i.setAttribute("src",n),i.onload=e,i.onerror=o=>{const a=ir("internal-error");a.customData=o,t(a)},i.type="text/javascript",i.charset="UTF-8",ER().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});mR("Browser");var wR="firebase",TR="11.2.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Li(wR,TR,"app");var Uy=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Mi,X0;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(k,x){function A(){}A.prototype=x.prototype,k.D=x.prototype,k.prototype=new A,k.prototype.constructor=k,k.C=function(P,M,V){for(var D=Array(arguments.length-2),ee=2;ee<arguments.length;ee++)D[ee-2]=arguments[ee];return x.prototype[M].apply(P,D)}}function t(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(i,t),i.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function o(k,x,A){A||(A=0);var P=Array(16);if(typeof x=="string")for(var M=0;16>M;++M)P[M]=x.charCodeAt(A++)|x.charCodeAt(A++)<<8|x.charCodeAt(A++)<<16|x.charCodeAt(A++)<<24;else for(M=0;16>M;++M)P[M]=x[A++]|x[A++]<<8|x[A++]<<16|x[A++]<<24;x=k.g[0],A=k.g[1],M=k.g[2];var V=k.g[3],D=x+(V^A&(M^V))+P[0]+3614090360&4294967295;x=A+(D<<7&4294967295|D>>>25),D=V+(M^x&(A^M))+P[1]+3905402710&4294967295,V=x+(D<<12&4294967295|D>>>20),D=M+(A^V&(x^A))+P[2]+606105819&4294967295,M=V+(D<<17&4294967295|D>>>15),D=A+(x^M&(V^x))+P[3]+3250441966&4294967295,A=M+(D<<22&4294967295|D>>>10),D=x+(V^A&(M^V))+P[4]+4118548399&4294967295,x=A+(D<<7&4294967295|D>>>25),D=V+(M^x&(A^M))+P[5]+1200080426&4294967295,V=x+(D<<12&4294967295|D>>>20),D=M+(A^V&(x^A))+P[6]+2821735955&4294967295,M=V+(D<<17&4294967295|D>>>15),D=A+(x^M&(V^x))+P[7]+4249261313&4294967295,A=M+(D<<22&4294967295|D>>>10),D=x+(V^A&(M^V))+P[8]+1770035416&4294967295,x=A+(D<<7&4294967295|D>>>25),D=V+(M^x&(A^M))+P[9]+2336552879&4294967295,V=x+(D<<12&4294967295|D>>>20),D=M+(A^V&(x^A))+P[10]+4294925233&4294967295,M=V+(D<<17&4294967295|D>>>15),D=A+(x^M&(V^x))+P[11]+2304563134&4294967295,A=M+(D<<22&4294967295|D>>>10),D=x+(V^A&(M^V))+P[12]+1804603682&4294967295,x=A+(D<<7&4294967295|D>>>25),D=V+(M^x&(A^M))+P[13]+4254626195&4294967295,V=x+(D<<12&4294967295|D>>>20),D=M+(A^V&(x^A))+P[14]+2792965006&4294967295,M=V+(D<<17&4294967295|D>>>15),D=A+(x^M&(V^x))+P[15]+1236535329&4294967295,A=M+(D<<22&4294967295|D>>>10),D=x+(M^V&(A^M))+P[1]+4129170786&4294967295,x=A+(D<<5&4294967295|D>>>27),D=V+(A^M&(x^A))+P[6]+3225465664&4294967295,V=x+(D<<9&4294967295|D>>>23),D=M+(x^A&(V^x))+P[11]+643717713&4294967295,M=V+(D<<14&4294967295|D>>>18),D=A+(V^x&(M^V))+P[0]+3921069994&4294967295,A=M+(D<<20&4294967295|D>>>12),D=x+(M^V&(A^M))+P[5]+3593408605&4294967295,x=A+(D<<5&4294967295|D>>>27),D=V+(A^M&(x^A))+P[10]+38016083&4294967295,V=x+(D<<9&4294967295|D>>>23),D=M+(x^A&(V^x))+P[15]+3634488961&4294967295,M=V+(D<<14&4294967295|D>>>18),D=A+(V^x&(M^V))+P[4]+3889429448&4294967295,A=M+(D<<20&4294967295|D>>>12),D=x+(M^V&(A^M))+P[9]+568446438&4294967295,x=A+(D<<5&4294967295|D>>>27),D=V+(A^M&(x^A))+P[14]+3275163606&4294967295,V=x+(D<<9&4294967295|D>>>23),D=M+(x^A&(V^x))+P[3]+4107603335&4294967295,M=V+(D<<14&4294967295|D>>>18),D=A+(V^x&(M^V))+P[8]+1163531501&4294967295,A=M+(D<<20&4294967295|D>>>12),D=x+(M^V&(A^M))+P[13]+2850285829&4294967295,x=A+(D<<5&4294967295|D>>>27),D=V+(A^M&(x^A))+P[2]+4243563512&4294967295,V=x+(D<<9&4294967295|D>>>23),D=M+(x^A&(V^x))+P[7]+1735328473&4294967295,M=V+(D<<14&4294967295|D>>>18),D=A+(V^x&(M^V))+P[12]+2368359562&4294967295,A=M+(D<<20&4294967295|D>>>12),D=x+(A^M^V)+P[5]+4294588738&4294967295,x=A+(D<<4&4294967295|D>>>28),D=V+(x^A^M)+P[8]+2272392833&4294967295,V=x+(D<<11&4294967295|D>>>21),D=M+(V^x^A)+P[11]+1839030562&4294967295,M=V+(D<<16&4294967295|D>>>16),D=A+(M^V^x)+P[14]+4259657740&4294967295,A=M+(D<<23&4294967295|D>>>9),D=x+(A^M^V)+P[1]+2763975236&4294967295,x=A+(D<<4&4294967295|D>>>28),D=V+(x^A^M)+P[4]+1272893353&4294967295,V=x+(D<<11&4294967295|D>>>21),D=M+(V^x^A)+P[7]+4139469664&4294967295,M=V+(D<<16&4294967295|D>>>16),D=A+(M^V^x)+P[10]+3200236656&4294967295,A=M+(D<<23&4294967295|D>>>9),D=x+(A^M^V)+P[13]+681279174&4294967295,x=A+(D<<4&4294967295|D>>>28),D=V+(x^A^M)+P[0]+3936430074&4294967295,V=x+(D<<11&4294967295|D>>>21),D=M+(V^x^A)+P[3]+3572445317&4294967295,M=V+(D<<16&4294967295|D>>>16),D=A+(M^V^x)+P[6]+76029189&4294967295,A=M+(D<<23&4294967295|D>>>9),D=x+(A^M^V)+P[9]+3654602809&4294967295,x=A+(D<<4&4294967295|D>>>28),D=V+(x^A^M)+P[12]+3873151461&4294967295,V=x+(D<<11&4294967295|D>>>21),D=M+(V^x^A)+P[15]+530742520&4294967295,M=V+(D<<16&4294967295|D>>>16),D=A+(M^V^x)+P[2]+3299628645&4294967295,A=M+(D<<23&4294967295|D>>>9),D=x+(M^(A|~V))+P[0]+4096336452&4294967295,x=A+(D<<6&4294967295|D>>>26),D=V+(A^(x|~M))+P[7]+1126891415&4294967295,V=x+(D<<10&4294967295|D>>>22),D=M+(x^(V|~A))+P[14]+2878612391&4294967295,M=V+(D<<15&4294967295|D>>>17),D=A+(V^(M|~x))+P[5]+4237533241&4294967295,A=M+(D<<21&4294967295|D>>>11),D=x+(M^(A|~V))+P[12]+1700485571&4294967295,x=A+(D<<6&4294967295|D>>>26),D=V+(A^(x|~M))+P[3]+2399980690&4294967295,V=x+(D<<10&4294967295|D>>>22),D=M+(x^(V|~A))+P[10]+4293915773&4294967295,M=V+(D<<15&4294967295|D>>>17),D=A+(V^(M|~x))+P[1]+2240044497&4294967295,A=M+(D<<21&4294967295|D>>>11),D=x+(M^(A|~V))+P[8]+1873313359&4294967295,x=A+(D<<6&4294967295|D>>>26),D=V+(A^(x|~M))+P[15]+4264355552&4294967295,V=x+(D<<10&4294967295|D>>>22),D=M+(x^(V|~A))+P[6]+2734768916&4294967295,M=V+(D<<15&4294967295|D>>>17),D=A+(V^(M|~x))+P[13]+1309151649&4294967295,A=M+(D<<21&4294967295|D>>>11),D=x+(M^(A|~V))+P[4]+4149444226&4294967295,x=A+(D<<6&4294967295|D>>>26),D=V+(A^(x|~M))+P[11]+3174756917&4294967295,V=x+(D<<10&4294967295|D>>>22),D=M+(x^(V|~A))+P[2]+718787259&4294967295,M=V+(D<<15&4294967295|D>>>17),D=A+(V^(M|~x))+P[9]+3951481745&4294967295,k.g[0]=k.g[0]+x&4294967295,k.g[1]=k.g[1]+(M+(D<<21&4294967295|D>>>11))&4294967295,k.g[2]=k.g[2]+M&4294967295,k.g[3]=k.g[3]+V&4294967295}i.prototype.u=function(k,x){x===void 0&&(x=k.length);for(var A=x-this.blockSize,P=this.B,M=this.h,V=0;V<x;){if(M==0)for(;V<=A;)o(this,k,V),V+=this.blockSize;if(typeof k=="string"){for(;V<x;)if(P[M++]=k.charCodeAt(V++),M==this.blockSize){o(this,P),M=0;break}}else for(;V<x;)if(P[M++]=k[V++],M==this.blockSize){o(this,P),M=0;break}}this.h=M,this.o+=x},i.prototype.v=function(){var k=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);k[0]=128;for(var x=1;x<k.length-8;++x)k[x]=0;var A=8*this.o;for(x=k.length-8;x<k.length;++x)k[x]=A&255,A/=256;for(this.u(k),k=Array(16),x=A=0;4>x;++x)for(var P=0;32>P;P+=8)k[A++]=this.g[x]>>>P&255;return k};function a(k,x){var A=d;return Object.prototype.hasOwnProperty.call(A,k)?A[k]:A[k]=x(k)}function c(k,x){this.h=x;for(var A=[],P=!0,M=k.length-1;0<=M;M--){var V=k[M]|0;P&&V==x||(A[M]=V,P=!1)}this.g=A}var d={};function p(k){return-128<=k&&128>k?a(k,function(x){return new c([x|0],0>x?-1:0)}):new c([k|0],0>k?-1:0)}function m(k){if(isNaN(k)||!isFinite(k))return E;if(0>k)return N(m(-k));for(var x=[],A=1,P=0;k>=A;P++)x[P]=k/A|0,A*=4294967296;return new c(x,0)}function v(k,x){if(k.length==0)throw Error("number format error: empty string");if(x=x||10,2>x||36<x)throw Error("radix out of range: "+x);if(k.charAt(0)=="-")return N(v(k.substring(1),x));if(0<=k.indexOf("-"))throw Error('number format error: interior "-" character');for(var A=m(Math.pow(x,8)),P=E,M=0;M<k.length;M+=8){var V=Math.min(8,k.length-M),D=parseInt(k.substring(M,M+V),x);8>V?(V=m(Math.pow(x,V)),P=P.j(V).add(m(D))):(P=P.j(A),P=P.add(m(D)))}return P}var E=p(0),w=p(1),S=p(16777216);n=c.prototype,n.m=function(){if(j(this))return-N(this).m();for(var k=0,x=1,A=0;A<this.g.length;A++){var P=this.i(A);k+=(0<=P?P:4294967296+P)*x,x*=4294967296}return k},n.toString=function(k){if(k=k||10,2>k||36<k)throw Error("radix out of range: "+k);if(R(this))return"0";if(j(this))return"-"+N(this).toString(k);for(var x=m(Math.pow(k,6)),A=this,P="";;){var M=J(A,x).g;A=O(A,M.j(x));var V=((0<A.g.length?A.g[0]:A.h)>>>0).toString(k);if(A=M,R(A))return V+P;for(;6>V.length;)V="0"+V;P=V+P}},n.i=function(k){return 0>k?0:k<this.g.length?this.g[k]:this.h};function R(k){if(k.h!=0)return!1;for(var x=0;x<k.g.length;x++)if(k.g[x]!=0)return!1;return!0}function j(k){return k.h==-1}n.l=function(k){return k=O(this,k),j(k)?-1:R(k)?0:1};function N(k){for(var x=k.g.length,A=[],P=0;P<x;P++)A[P]=~k.g[P];return new c(A,~k.h).add(w)}n.abs=function(){return j(this)?N(this):this},n.add=function(k){for(var x=Math.max(this.g.length,k.g.length),A=[],P=0,M=0;M<=x;M++){var V=P+(this.i(M)&65535)+(k.i(M)&65535),D=(V>>>16)+(this.i(M)>>>16)+(k.i(M)>>>16);P=D>>>16,V&=65535,D&=65535,A[M]=D<<16|V}return new c(A,A[A.length-1]&-2147483648?-1:0)};function O(k,x){return k.add(N(x))}n.j=function(k){if(R(this)||R(k))return E;if(j(this))return j(k)?N(this).j(N(k)):N(N(this).j(k));if(j(k))return N(this.j(N(k)));if(0>this.l(S)&&0>k.l(S))return m(this.m()*k.m());for(var x=this.g.length+k.g.length,A=[],P=0;P<2*x;P++)A[P]=0;for(P=0;P<this.g.length;P++)for(var M=0;M<k.g.length;M++){var V=this.i(P)>>>16,D=this.i(P)&65535,ee=k.i(M)>>>16,ue=k.i(M)&65535;A[2*P+2*M]+=D*ue,U(A,2*P+2*M),A[2*P+2*M+1]+=V*ue,U(A,2*P+2*M+1),A[2*P+2*M+1]+=D*ee,U(A,2*P+2*M+1),A[2*P+2*M+2]+=V*ee,U(A,2*P+2*M+2)}for(P=0;P<x;P++)A[P]=A[2*P+1]<<16|A[2*P];for(P=x;P<2*x;P++)A[P]=0;return new c(A,0)};function U(k,x){for(;(k[x]&65535)!=k[x];)k[x+1]+=k[x]>>>16,k[x]&=65535,x++}function q(k,x){this.g=k,this.h=x}function J(k,x){if(R(x))throw Error("division by zero");if(R(k))return new q(E,E);if(j(k))return x=J(N(k),x),new q(N(x.g),N(x.h));if(j(x))return x=J(k,N(x)),new q(N(x.g),x.h);if(30<k.g.length){if(j(k)||j(x))throw Error("slowDivide_ only works with positive integers.");for(var A=w,P=x;0>=P.l(k);)A=W(A),P=W(P);var M=Q(A,1),V=Q(P,1);for(P=Q(P,2),A=Q(A,2);!R(P);){var D=V.add(P);0>=D.l(k)&&(M=M.add(A),V=D),P=Q(P,1),A=Q(A,1)}return x=O(k,M.j(x)),new q(M,x)}for(M=E;0<=k.l(x);){for(A=Math.max(1,Math.floor(k.m()/x.m())),P=Math.ceil(Math.log(A)/Math.LN2),P=48>=P?1:Math.pow(2,P-48),V=m(A),D=V.j(x);j(D)||0<D.l(k);)A-=P,V=m(A),D=V.j(x);R(V)&&(V=w),M=M.add(V),k=O(k,D)}return new q(M,k)}n.A=function(k){return J(this,k).h},n.and=function(k){for(var x=Math.max(this.g.length,k.g.length),A=[],P=0;P<x;P++)A[P]=this.i(P)&k.i(P);return new c(A,this.h&k.h)},n.or=function(k){for(var x=Math.max(this.g.length,k.g.length),A=[],P=0;P<x;P++)A[P]=this.i(P)|k.i(P);return new c(A,this.h|k.h)},n.xor=function(k){for(var x=Math.max(this.g.length,k.g.length),A=[],P=0;P<x;P++)A[P]=this.i(P)^k.i(P);return new c(A,this.h^k.h)};function W(k){for(var x=k.g.length+1,A=[],P=0;P<x;P++)A[P]=k.i(P)<<1|k.i(P-1)>>>31;return new c(A,k.h)}function Q(k,x){var A=x>>5;x%=32;for(var P=k.g.length-A,M=[],V=0;V<P;V++)M[V]=0<x?k.i(V+A)>>>x|k.i(V+A+1)<<32-x:k.i(V+A);return new c(M,k.h)}i.prototype.digest=i.prototype.v,i.prototype.reset=i.prototype.s,i.prototype.update=i.prototype.u,X0=i,c.prototype.add=c.prototype.add,c.prototype.multiply=c.prototype.j,c.prototype.modulo=c.prototype.A,c.prototype.compare=c.prototype.l,c.prototype.toNumber=c.prototype.m,c.prototype.toString=c.prototype.toString,c.prototype.getBits=c.prototype.i,c.fromNumber=m,c.fromString=v,Mi=c}).apply(typeof Uy<"u"?Uy:typeof self<"u"?self:typeof window<"u"?window:{});var lu=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var J0,ol,Z0,_u,wf,e_,t_,n_;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(u,y,T){return u==Array.prototype||u==Object.prototype||(u[y]=T.value),u};function t(u){u=[typeof globalThis=="object"&&globalThis,u,typeof window=="object"&&window,typeof self=="object"&&self,typeof lu=="object"&&lu];for(var y=0;y<u.length;++y){var T=u[y];if(T&&T.Math==Math)return T}throw Error("Cannot find global object")}var i=t(this);function o(u,y){if(y)e:{var T=i;u=u.split(".");for(var C=0;C<u.length-1;C++){var $=u[C];if(!($ in T))break e;T=T[$]}u=u[u.length-1],C=T[u],y=y(C),y!=C&&y!=null&&e(T,u,{configurable:!0,writable:!0,value:y})}}function a(u,y){u instanceof String&&(u+="");var T=0,C=!1,$={next:function(){if(!C&&T<u.length){var Y=T++;return{value:y(Y,u[Y]),done:!1}}return C=!0,{done:!0,value:void 0}}};return $[Symbol.iterator]=function(){return $},$}o("Array.prototype.values",function(u){return u||function(){return a(this,function(y,T){return T})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var c=c||{},d=this||self;function p(u){var y=typeof u;return y=y!="object"?y:u?Array.isArray(u)?"array":y:"null",y=="array"||y=="object"&&typeof u.length=="number"}function m(u){var y=typeof u;return y=="object"&&u!=null||y=="function"}function v(u,y,T){return u.call.apply(u.bind,arguments)}function E(u,y,T){if(!u)throw Error();if(2<arguments.length){var C=Array.prototype.slice.call(arguments,2);return function(){var $=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply($,C),u.apply(y,$)}}return function(){return u.apply(y,arguments)}}function w(u,y,T){return w=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?v:E,w.apply(null,arguments)}function S(u,y){var T=Array.prototype.slice.call(arguments,1);return function(){var C=T.slice();return C.push.apply(C,arguments),u.apply(this,C)}}function R(u,y){function T(){}T.prototype=y.prototype,u.aa=y.prototype,u.prototype=new T,u.prototype.constructor=u,u.Qb=function(C,$,Y){for(var de=Array(arguments.length-2),Ye=2;Ye<arguments.length;Ye++)de[Ye-2]=arguments[Ye];return y.prototype[$].apply(C,de)}}function j(u){const y=u.length;if(0<y){const T=Array(y);for(let C=0;C<y;C++)T[C]=u[C];return T}return[]}function N(u,y){for(let T=1;T<arguments.length;T++){const C=arguments[T];if(p(C)){const $=u.length||0,Y=C.length||0;u.length=$+Y;for(let de=0;de<Y;de++)u[$+de]=C[de]}else u.push(C)}}class O{constructor(y,T){this.i=y,this.j=T,this.h=0,this.g=null}get(){let y;return 0<this.h?(this.h--,y=this.g,this.g=y.next,y.next=null):y=this.i(),y}}function U(u){return/^[\s\xa0]*$/.test(u)}function q(){var u=d.navigator;return u&&(u=u.userAgent)?u:""}function J(u){return J[" "](u),u}J[" "]=function(){};var W=q().indexOf("Gecko")!=-1&&!(q().toLowerCase().indexOf("webkit")!=-1&&q().indexOf("Edge")==-1)&&!(q().indexOf("Trident")!=-1||q().indexOf("MSIE")!=-1)&&q().indexOf("Edge")==-1;function Q(u,y,T){for(const C in u)y.call(T,u[C],C,u)}function k(u,y){for(const T in u)y.call(void 0,u[T],T,u)}function x(u){const y={};for(const T in u)y[T]=u[T];return y}const A="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function P(u,y){let T,C;for(let $=1;$<arguments.length;$++){C=arguments[$];for(T in C)u[T]=C[T];for(let Y=0;Y<A.length;Y++)T=A[Y],Object.prototype.hasOwnProperty.call(C,T)&&(u[T]=C[T])}}function M(u){var y=1;u=u.split(":");const T=[];for(;0<y&&u.length;)T.push(u.shift()),y--;return u.length&&T.push(u.join(":")),T}function V(u){d.setTimeout(()=>{throw u},0)}function D(){var u=fe;let y=null;return u.g&&(y=u.g,u.g=u.g.next,u.g||(u.h=null),y.next=null),y}class ee{constructor(){this.h=this.g=null}add(y,T){const C=ue.get();C.set(y,T),this.h?this.h.next=C:this.g=C,this.h=C}}var ue=new O(()=>new he,u=>u.reset());class he{constructor(){this.next=this.g=this.h=null}set(y,T){this.h=y,this.g=T,this.next=null}reset(){this.next=this.g=this.h=null}}let re,ae=!1,fe=new ee,le=()=>{const u=d.Promise.resolve(void 0);re=()=>{u.then(z)}};var z=()=>{for(var u;u=D();){try{u.h.call(u.g)}catch(T){V(T)}var y=ue;y.j(u),100>y.h&&(y.h++,u.next=y.g,y.g=u)}ae=!1};function X(){this.s=this.s,this.C=this.C}X.prototype.s=!1,X.prototype.ma=function(){this.s||(this.s=!0,this.N())},X.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function pe(u,y){this.type=u,this.g=this.target=y,this.defaultPrevented=!1}pe.prototype.h=function(){this.defaultPrevented=!0};var xe=function(){if(!d.addEventListener||!Object.defineProperty)return!1;var u=!1,y=Object.defineProperty({},"passive",{get:function(){u=!0}});try{const T=()=>{};d.addEventListener("test",T,y),d.removeEventListener("test",T,y)}catch{}return u}();function se(u,y){if(pe.call(this,u?u.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,u){var T=this.type=u.type,C=u.changedTouches&&u.changedTouches.length?u.changedTouches[0]:null;if(this.target=u.target||u.srcElement,this.g=y,y=u.relatedTarget){if(W){e:{try{J(y.nodeName);var $=!0;break e}catch{}$=!1}$||(y=null)}}else T=="mouseover"?y=u.fromElement:T=="mouseout"&&(y=u.toElement);this.relatedTarget=y,C?(this.clientX=C.clientX!==void 0?C.clientX:C.pageX,this.clientY=C.clientY!==void 0?C.clientY:C.pageY,this.screenX=C.screenX||0,this.screenY=C.screenY||0):(this.clientX=u.clientX!==void 0?u.clientX:u.pageX,this.clientY=u.clientY!==void 0?u.clientY:u.pageY,this.screenX=u.screenX||0,this.screenY=u.screenY||0),this.button=u.button,this.key=u.key||"",this.ctrlKey=u.ctrlKey,this.altKey=u.altKey,this.shiftKey=u.shiftKey,this.metaKey=u.metaKey,this.pointerId=u.pointerId||0,this.pointerType=typeof u.pointerType=="string"?u.pointerType:me[u.pointerType]||"",this.state=u.state,this.i=u,u.defaultPrevented&&se.aa.h.call(this)}}R(se,pe);var me={2:"touch",3:"pen",4:"mouse"};se.prototype.h=function(){se.aa.h.call(this);var u=this.i;u.preventDefault?u.preventDefault():u.returnValue=!1};var Te="closure_listenable_"+(1e6*Math.random()|0),_e=0;function Oe(u,y,T,C,$){this.listener=u,this.proxy=null,this.src=y,this.type=T,this.capture=!!C,this.ha=$,this.key=++_e,this.da=this.fa=!1}function be(u){u.da=!0,u.listener=null,u.proxy=null,u.src=null,u.ha=null}function Qe(u){this.src=u,this.g={},this.h=0}Qe.prototype.add=function(u,y,T,C,$){var Y=u.toString();u=this.g[Y],u||(u=this.g[Y]=[],this.h++);var de=et(u,y,C,$);return-1<de?(y=u[de],T||(y.fa=!1)):(y=new Oe(y,this.src,Y,!!C,$),y.fa=T,u.push(y)),y};function Ve(u,y){var T=y.type;if(T in u.g){var C=u.g[T],$=Array.prototype.indexOf.call(C,y,void 0),Y;(Y=0<=$)&&Array.prototype.splice.call(C,$,1),Y&&(be(y),u.g[T].length==0&&(delete u.g[T],u.h--))}}function et(u,y,T,C){for(var $=0;$<u.length;++$){var Y=u[$];if(!Y.da&&Y.listener==y&&Y.capture==!!T&&Y.ha==C)return $}return-1}var st="closure_lm_"+(1e6*Math.random()|0),bt={};function ii(u,y,T,C,$){if(Array.isArray(y)){for(var Y=0;Y<y.length;Y++)ii(u,y[Y],T,C,$);return null}return T=aa(T),u&&u[Te]?u.K(y,T,m(C)?!!C.capture:!!C,$):Yi(u,y,T,!1,C,$)}function Yi(u,y,T,C,$,Y){if(!y)throw Error("Invalid event type");var de=m($)?!!$.capture:!!$,Ye=Vs(u);if(Ye||(u[st]=Ye=new Qe(u)),T=Ye.add(y,T,C,de,Y),T.proxy)return T;if(C=Hl(),T.proxy=C,C.src=u,C.listener=T,u.addEventListener)xe||($=de),$===void 0&&($=!1),u.addEventListener(y.toString(),C,$);else if(u.attachEvent)u.attachEvent(br(y.toString()),C);else if(u.addListener&&u.removeListener)u.addListener(C);else throw Error("addEventListener and attachEvent are unavailable.");return T}function Hl(){function u(T){return y.call(u.src,u.listener,T)}const y=oa;return u}function Ms(u,y,T,C,$){if(Array.isArray(y))for(var Y=0;Y<y.length;Y++)Ms(u,y[Y],T,C,$);else C=m(C)?!!C.capture:!!C,T=aa(T),u&&u[Te]?(u=u.i,y=String(y).toString(),y in u.g&&(Y=u.g[y],T=et(Y,T,C,$),-1<T&&(be(Y[T]),Array.prototype.splice.call(Y,T,1),Y.length==0&&(delete u.g[y],u.h--)))):u&&(u=Vs(u))&&(y=u.g[y.toString()],u=-1,y&&(u=et(y,T,C,$)),(T=-1<u?y[u]:null)&&kr(T))}function kr(u){if(typeof u!="number"&&u&&!u.da){var y=u.src;if(y&&y[Te])Ve(y.i,u);else{var T=u.type,C=u.proxy;y.removeEventListener?y.removeEventListener(T,C,u.capture):y.detachEvent?y.detachEvent(br(T),C):y.addListener&&y.removeListener&&y.removeListener(C),(T=Vs(y))?(Ve(T,u),T.h==0&&(T.src=null,y[st]=null)):be(u)}}}function br(u){return u in bt?bt[u]:bt[u]="on"+u}function oa(u,y){if(u.da)u=!0;else{y=new se(y,this);var T=u.listener,C=u.ha||u.src;u.fa&&kr(u),u=T.call(C,y)}return u}function Vs(u){return u=u[st],u instanceof Qe?u:null}var Fs="__closure_events_fn_"+(1e9*Math.random()>>>0);function aa(u){return typeof u=="function"?u:(u[Fs]||(u[Fs]=function(y){return u.handleEvent(y)}),u[Fs])}function wt(){X.call(this),this.i=new Qe(this),this.M=this,this.F=null}R(wt,X),wt.prototype[Te]=!0,wt.prototype.removeEventListener=function(u,y,T,C){Ms(this,u,y,T,C)};function Tt(u,y){var T,C=u.F;if(C)for(T=[];C;C=C.F)T.push(C);if(u=u.M,C=y.type||y,typeof y=="string")y=new pe(y,u);else if(y instanceof pe)y.target=y.target||u;else{var $=y;y=new pe(C,u),P(y,$)}if($=!0,T)for(var Y=T.length-1;0<=Y;Y--){var de=y.g=T[Y];$=Nr(de,C,!0,y)&&$}if(de=y.g=u,$=Nr(de,C,!0,y)&&$,$=Nr(de,C,!1,y)&&$,T)for(Y=0;Y<T.length;Y++)de=y.g=T[Y],$=Nr(de,C,!1,y)&&$}wt.prototype.N=function(){if(wt.aa.N.call(this),this.i){var u=this.i,y;for(y in u.g){for(var T=u.g[y],C=0;C<T.length;C++)be(T[C]);delete u.g[y],u.h--}}this.F=null},wt.prototype.K=function(u,y,T,C){return this.i.add(String(u),y,!1,T,C)},wt.prototype.L=function(u,y,T,C){return this.i.add(String(u),y,!0,T,C)};function Nr(u,y,T,C){if(y=u.i.g[String(y)],!y)return!0;y=y.concat();for(var $=!0,Y=0;Y<y.length;++Y){var de=y[Y];if(de&&!de.da&&de.capture==T){var Ye=de.listener,St=de.ha||de.src;de.fa&&Ve(u.i,de),$=Ye.call(St,C)!==!1&&$}}return $&&!C.defaultPrevented}function la(u,y,T){if(typeof u=="function")T&&(u=w(u,T));else if(u&&typeof u.handleEvent=="function")u=w(u.handleEvent,u);else throw Error("Invalid listener argument");return 2147483647<Number(y)?-1:d.setTimeout(u,y||0)}function si(u){u.g=la(()=>{u.g=null,u.i&&(u.i=!1,si(u))},u.l);const y=u.h;u.h=null,u.m.apply(null,y)}class Xi extends X{constructor(y,T){super(),this.m=y,this.l=T,this.h=null,this.i=!1,this.g=null}j(y){this.h=arguments,this.g?this.i=!0:si(this)}N(){super.N(),this.g&&(d.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Ji(u){X.call(this),this.h=u,this.g={}}R(Ji,X);var ca=[];function ua(u){Q(u.g,function(y,T){this.g.hasOwnProperty(T)&&kr(y)},u),u.g={}}Ji.prototype.N=function(){Ji.aa.N.call(this),ua(this)},Ji.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var da=d.JSON.stringify,ha=d.JSON.parse,fa=class{stringify(u){return d.JSON.stringify(u,void 0)}parse(u){return d.JSON.parse(u,void 0)}};function Zi(){}Zi.prototype.h=null;function Us(u){return u.h||(u.h=u.i())}function Bs(){}var Sn={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function sr(){pe.call(this,"d")}R(sr,pe);function zs(){pe.call(this,"c")}R(zs,pe);var or={},pa=null;function es(){return pa=pa||new wt}or.La="serverreachability";function ma(u){pe.call(this,or.La,u)}R(ma,pe);function Pr(u){const y=es();Tt(y,new ma(y))}or.STAT_EVENT="statevent";function ga(u,y){pe.call(this,or.STAT_EVENT,u),this.stat=y}R(ga,pe);function pt(u){const y=es();Tt(y,new ga(y,u))}or.Ma="timingevent";function $s(u,y){pe.call(this,or.Ma,u),this.size=y}R($s,pe);function Fn(u,y){if(typeof u!="function")throw Error("Fn must not be null and must be a function");return d.setTimeout(function(){u()},y)}function ts(){this.g=!0}ts.prototype.xa=function(){this.g=!1};function ns(u,y,T,C,$,Y){u.info(function(){if(u.g)if(Y)for(var de="",Ye=Y.split("&"),St=0;St<Ye.length;St++){var He=Ye[St].split("=");if(1<He.length){var Nt=He[0];He=He[1];var vt=Nt.split("_");de=2<=vt.length&&vt[1]=="type"?de+(Nt+"="+He+"&"):de+(Nt+"=redacted&")}}else de=null;else de=Y;return"XMLHTTP REQ ("+C+") [attempt "+$+"]: "+y+`
`+T+`
`+de})}function Hs(u,y,T,C,$,Y,de){u.info(function(){return"XMLHTTP RESP ("+C+") [ attempt "+$+"]: "+y+`
`+T+`
`+Y+" "+de})}function Un(u,y,T,C){u.info(function(){return"XMLHTTP TEXT ("+y+"): "+fd(u,T)+(C?" "+C:"")})}function ya(u,y){u.info(function(){return"TIMEOUT: "+y})}ts.prototype.info=function(){};function fd(u,y){if(!u.g)return y;if(!y)return null;try{var T=JSON.parse(y);if(T){for(u=0;u<T.length;u++)if(Array.isArray(T[u])){var C=T[u];if(!(2>C.length)){var $=C[1];if(Array.isArray($)&&!(1>$.length)){var Y=$[0];if(Y!="noop"&&Y!="stop"&&Y!="close")for(var de=1;de<$.length;de++)$[de]=""}}}}return da(T)}catch{return y}}var qs={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},ql={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Bn;function rs(){}R(rs,Zi),rs.prototype.g=function(){return new XMLHttpRequest},rs.prototype.i=function(){return{}},Bn=new rs;function zn(u,y,T,C){this.j=u,this.i=y,this.l=T,this.R=C||1,this.U=new Ji(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Gl}function Gl(){this.i=null,this.g="",this.h=!1}var va={},Gs={};function Ws(u,y,T){u.L=1,u.v=ui(gn(y)),u.m=T,u.P=!0,_a(u,null)}function _a(u,y){u.F=Date.now(),Je(u),u.A=gn(u.v);var T=u.A,C=u.R;Array.isArray(C)||(C=[String(C)]),hi(T.i,"t",C),u.C=0,T=u.j.J,u.h=new Gl,u.g=uc(u.j,T?y:null,!u.m),0<u.O&&(u.M=new Xi(w(u.Y,u,u.g),u.O)),y=u.U,T=u.g,C=u.ca;var $="readystatechange";Array.isArray($)||($&&(ca[0]=$.toString()),$=ca);for(var Y=0;Y<$.length;Y++){var de=ii(T,$[Y],C||y.handleEvent,!1,y.h||y);if(!de)break;y.g[de.key]=de}y=u.H?x(u.H):{},u.m?(u.u||(u.u="POST"),y["Content-Type"]="application/x-www-form-urlencoded",u.g.ea(u.A,u.u,u.m,y)):(u.u="GET",u.g.ea(u.A,u.u,null,y)),Pr(),ns(u.i,u.u,u.A,u.l,u.R,u.m)}zn.prototype.ca=function(u){u=u.target;const y=this.M;y&&on(u)==3?y.j():this.Y(u)},zn.prototype.Y=function(u){try{if(u==this.g)e:{const vt=on(this.g);var y=this.g.Ba();const Rn=this.g.Z();if(!(3>vt)&&(vt!=3||this.g&&(this.h.h||this.g.oa()||Ia(this.g)))){this.J||vt!=4||y==7||(y==8||0>=Rn?Pr(3):Pr(2)),is(this);var T=this.g.Z();this.X=T;t:if(Wl(this)){var C=Ia(this.g);u="";var $=C.length,Y=on(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){xn(this),oi(this);var de="";break t}this.h.i=new d.TextDecoder}for(y=0;y<$;y++)this.h.h=!0,u+=this.h.i.decode(C[y],{stream:!(Y&&y==$-1)});C.length=0,this.h.g+=u,this.C=0,de=this.h.g}else de=this.g.oa();if(this.o=T==200,Hs(this.i,this.u,this.A,this.l,this.R,vt,T),this.o){if(this.T&&!this.K){t:{if(this.g){var Ye,St=this.g;if((Ye=St.g?St.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!U(Ye)){var He=Ye;break t}}He=null}if(T=He)Un(this.i,this.l,T,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Ea(this,T);else{this.o=!1,this.s=3,pt(12),xn(this),oi(this);break e}}if(this.P){T=!0;let vn;for(;!this.J&&this.C<de.length;)if(vn=pd(this,de),vn==Gs){vt==4&&(this.s=4,pt(14),T=!1),Un(this.i,this.l,null,"[Incomplete Response]");break}else if(vn==va){this.s=4,pt(15),Un(this.i,this.l,de,"[Invalid Chunk]"),T=!1;break}else Un(this.i,this.l,vn,null),Ea(this,vn);if(Wl(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),vt!=4||de.length!=0||this.h.h||(this.s=1,pt(16),T=!1),this.o=this.o&&T,!T)Un(this.i,this.l,de,"[Invalid Chunked Response]"),xn(this),oi(this);else if(0<de.length&&!this.W){this.W=!0;var Nt=this.j;Nt.g==this&&Nt.ba&&!Nt.M&&(Nt.j.info("Great, no buffering proxy detected. Bytes received: "+de.length),Aa(Nt),Nt.M=!0,pt(11))}}else Un(this.i,this.l,de,null),Ea(this,de);vt==4&&xn(this),this.o&&!this.J&&(vt==4?io(this.j,this):(this.o=!1,Je(this)))}else Zs(this.g),T==400&&0<de.indexOf("Unknown SID")?(this.s=3,pt(12)):(this.s=0,pt(13)),xn(this),oi(this)}}}catch{}finally{}};function Wl(u){return u.g?u.u=="GET"&&u.L!=2&&u.j.Ca:!1}function pd(u,y){var T=u.C,C=y.indexOf(`
`,T);return C==-1?Gs:(T=Number(y.substring(T,C)),isNaN(T)?va:(C+=1,C+T>y.length?Gs:(y=y.slice(C,C+T),u.C=C+T,y)))}zn.prototype.cancel=function(){this.J=!0,xn(this)};function Je(u){u.S=Date.now()+u.I,Kl(u,u.I)}function Kl(u,y){if(u.B!=null)throw Error("WatchDog timer not null");u.B=Fn(w(u.ba,u),y)}function is(u){u.B&&(d.clearTimeout(u.B),u.B=null)}zn.prototype.ba=function(){this.B=null;const u=Date.now();0<=u-this.S?(ya(this.i,this.A),this.L!=2&&(Pr(),pt(17)),xn(this),this.s=2,oi(this)):Kl(this,this.S-u)};function oi(u){u.j.G==0||u.J||io(u.j,u)}function xn(u){is(u);var y=u.M;y&&typeof y.ma=="function"&&y.ma(),u.M=null,ua(u.U),u.g&&(y=u.g,u.g=null,y.abort(),y.ma())}function Ea(u,y){try{var T=u.j;if(T.G!=0&&(T.g==u||Zt(T.h,u))){if(!u.K&&Zt(T.h,u)&&T.G==3){try{var C=T.Da.g.parse(y)}catch{C=null}if(Array.isArray(C)&&C.length==3){var $=C;if($[0]==0){e:if(!T.u){if(T.g)if(T.g.F+3e3<u.F)ro(T),Wn(T);else break e;no(T),pt(18)}}else T.za=$[1],0<T.za-T.T&&37500>$[2]&&T.F&&T.v==0&&!T.C&&(T.C=Fn(w(T.Za,T),6e3));if(1>=Yl(T.h)&&T.ca){try{T.ca()}catch{}T.ca=void 0}}else Mr(T,11)}else if((u.K||T.g==u)&&ro(T),!U(y))for($=T.Da.g.parse(y),y=0;y<$.length;y++){let He=$[y];if(T.T=He[0],He=He[1],T.G==2)if(He[0]=="c"){T.K=He[1],T.ia=He[2];const Nt=He[3];Nt!=null&&(T.la=Nt,T.j.info("VER="+T.la));const vt=He[4];vt!=null&&(T.Aa=vt,T.j.info("SVER="+T.Aa));const Rn=He[5];Rn!=null&&typeof Rn=="number"&&0<Rn&&(C=1.5*Rn,T.L=C,T.j.info("backChannelRequestTimeoutMs_="+C)),C=T;const vn=u.g;if(vn){const ds=vn.g?vn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(ds){var Y=C.h;Y.g||ds.indexOf("spdy")==-1&&ds.indexOf("quic")==-1&&ds.indexOf("h2")==-1||(Y.j=Y.l,Y.g=new Set,Y.h&&(wa(Y,Y.h),Y.h=null))}if(C.D){const oo=vn.g?vn.g.getResponseHeader("X-HTTP-Session-Id"):null;oo&&(C.ya=oo,Xe(C.I,C.D,oo))}}T.G=3,T.l&&T.l.ua(),T.ba&&(T.R=Date.now()-u.F,T.j.info("Handshake RTT: "+T.R+"ms")),C=T;var de=u;if(C.qa=cc(C,C.J?C.ia:null,C.W),de.K){Xl(C.h,de);var Ye=de,St=C.L;St&&(Ye.I=St),Ye.B&&(is(Ye),Je(Ye)),C.g=de}else us(C);0<T.i.length&&ur(T)}else He[0]!="stop"&&He[0]!="close"||Mr(T,7);else T.G==3&&(He[0]=="stop"||He[0]=="close"?He[0]=="stop"?Mr(T,7):Vt(T):He[0]!="noop"&&T.l&&T.l.ta(He),T.v=0)}}Pr(4)}catch{}}var Ql=class{constructor(u,y){this.g=u,this.map=y}};function ss(u){this.l=u||10,d.PerformanceNavigationTiming?(u=d.performance.getEntriesByType("navigation"),u=0<u.length&&(u[0].nextHopProtocol=="hq"||u[0].nextHopProtocol=="h2")):u=!!(d.chrome&&d.chrome.loadTimes&&d.chrome.loadTimes()&&d.chrome.loadTimes().wasFetchedViaSpdy),this.j=u?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function mn(u){return u.h?!0:u.g?u.g.size>=u.j:!1}function Yl(u){return u.h?1:u.g?u.g.size:0}function Zt(u,y){return u.h?u.h==y:u.g?u.g.has(y):!1}function wa(u,y){u.g?u.g.add(y):u.h=y}function Xl(u,y){u.h&&u.h==y?u.h=null:u.g&&u.g.has(y)&&u.g.delete(y)}ss.prototype.cancel=function(){if(this.i=Jl(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const u of this.g.values())u.cancel();this.g.clear()}};function Jl(u){if(u.h!=null)return u.i.concat(u.h.D);if(u.g!=null&&u.g.size!==0){let y=u.i;for(const T of u.g.values())y=y.concat(T.D);return y}return j(u.i)}function Ks(u){if(u.V&&typeof u.V=="function")return u.V();if(typeof Map<"u"&&u instanceof Map||typeof Set<"u"&&u instanceof Set)return Array.from(u.values());if(typeof u=="string")return u.split("");if(p(u)){for(var y=[],T=u.length,C=0;C<T;C++)y.push(u[C]);return y}y=[],T=0;for(C in u)y[T++]=u[C];return y}function Qs(u){if(u.na&&typeof u.na=="function")return u.na();if(!u.V||typeof u.V!="function"){if(typeof Map<"u"&&u instanceof Map)return Array.from(u.keys());if(!(typeof Set<"u"&&u instanceof Set)){if(p(u)||typeof u=="string"){var y=[];u=u.length;for(var T=0;T<u;T++)y.push(T);return y}y=[],T=0;for(const C in u)y[T++]=C;return y}}}function ai(u,y){if(u.forEach&&typeof u.forEach=="function")u.forEach(y,void 0);else if(p(u)||typeof u=="string")Array.prototype.forEach.call(u,y,void 0);else for(var T=Qs(u),C=Ks(u),$=C.length,Y=0;Y<$;Y++)y.call(void 0,C[Y],T&&T[Y],u)}var os=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function md(u,y){if(u){u=u.split("&");for(var T=0;T<u.length;T++){var C=u[T].indexOf("="),$=null;if(0<=C){var Y=u[T].substring(0,C);$=u[T].substring(C+1)}else Y=u[T];y(Y,$?decodeURIComponent($.replace(/\+/g," ")):"")}}}function Dr(u){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,u instanceof Dr){this.h=u.h,as(this,u.j),this.o=u.o,this.g=u.g,li(this,u.s),this.l=u.l;var y=u.i,T=new ar;T.i=y.i,y.g&&(T.g=new Map(y.g),T.h=y.h),ci(this,T),this.m=u.m}else u&&(y=String(u).match(os))?(this.h=!1,as(this,y[1]||"",!0),this.o=ze(y[2]||""),this.g=ze(y[3]||"",!0),li(this,y[4]),this.l=ze(y[5]||"",!0),ci(this,y[6]||"",!0),this.m=ze(y[7]||"")):(this.h=!1,this.i=new ar(null,this.h))}Dr.prototype.toString=function(){var u=[],y=this.j;y&&u.push(di(y,Ys,!0),":");var T=this.g;return(T||y=="file")&&(u.push("//"),(y=this.o)&&u.push(di(y,Ys,!0),"@"),u.push(encodeURIComponent(String(T)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),T=this.s,T!=null&&u.push(":",String(T))),(T=this.l)&&(this.g&&T.charAt(0)!="/"&&u.push("/"),u.push(di(T,T.charAt(0)=="/"?tc:ec,!0))),(T=this.i.toString())&&u.push("?",T),(T=this.m)&&u.push("#",di(T,Ta)),u.join("")};function gn(u){return new Dr(u)}function as(u,y,T){u.j=T?ze(y,!0):y,u.j&&(u.j=u.j.replace(/:$/,""))}function li(u,y){if(y){if(y=Number(y),isNaN(y)||0>y)throw Error("Bad port number "+y);u.s=y}else u.s=null}function ci(u,y,T){y instanceof ar?(u.i=y,lr(u.i,u.h)):(T||(y=di(y,nc)),u.i=new ar(y,u.h))}function Xe(u,y,T){u.i.set(y,T)}function ui(u){return Xe(u,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),u}function ze(u,y){return u?y?decodeURI(u.replace(/%25/g,"%2525")):decodeURIComponent(u):""}function di(u,y,T){return typeof u=="string"?(u=encodeURI(u).replace(y,Zl),T&&(u=u.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),u):null}function Zl(u){return u=u.charCodeAt(0),"%"+(u>>4&15).toString(16)+(u&15).toString(16)}var Ys=/[#\/\?@]/g,ec=/[#\?:]/g,tc=/[#\?]/g,nc=/[#\?@]/g,Ta=/#/g;function ar(u,y){this.h=this.g=null,this.i=u||null,this.j=!!y}function Mt(u){u.g||(u.g=new Map,u.h=0,u.i&&md(u.i,function(y,T){u.add(decodeURIComponent(y.replace(/\+/g," ")),T)}))}n=ar.prototype,n.add=function(u,y){Mt(this),this.i=null,u=In(this,u);var T=this.g.get(u);return T||this.g.set(u,T=[]),T.push(y),this.h+=1,this};function $n(u,y){Mt(u),y=In(u,y),u.g.has(y)&&(u.i=null,u.h-=u.g.get(y).length,u.g.delete(y))}function Hn(u,y){return Mt(u),y=In(u,y),u.g.has(y)}n.forEach=function(u,y){Mt(this),this.g.forEach(function(T,C){T.forEach(function($){u.call(y,$,C,this)},this)},this)},n.na=function(){Mt(this);const u=Array.from(this.g.values()),y=Array.from(this.g.keys()),T=[];for(let C=0;C<y.length;C++){const $=u[C];for(let Y=0;Y<$.length;Y++)T.push(y[C])}return T},n.V=function(u){Mt(this);let y=[];if(typeof u=="string")Hn(this,u)&&(y=y.concat(this.g.get(In(this,u))));else{u=Array.from(this.g.values());for(let T=0;T<u.length;T++)y=y.concat(u[T])}return y},n.set=function(u,y){return Mt(this),this.i=null,u=In(this,u),Hn(this,u)&&(this.h-=this.g.get(u).length),this.g.set(u,[y]),this.h+=1,this},n.get=function(u,y){return u?(u=this.V(u),0<u.length?String(u[0]):y):y};function hi(u,y,T){$n(u,y),0<T.length&&(u.i=null,u.g.set(In(u,y),j(T)),u.h+=T.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const u=[],y=Array.from(this.g.keys());for(var T=0;T<y.length;T++){var C=y[T];const Y=encodeURIComponent(String(C)),de=this.V(C);for(C=0;C<de.length;C++){var $=Y;de[C]!==""&&($+="="+encodeURIComponent(String(de[C]))),u.push($)}}return this.i=u.join("&")};function In(u,y){return y=String(y),u.j&&(y=y.toLowerCase()),y}function lr(u,y){y&&!u.j&&(Mt(u),u.i=null,u.g.forEach(function(T,C){var $=C.toLowerCase();C!=$&&($n(this,C),hi(this,$,T))},u)),u.j=y}function gd(u,y){const T=new ts;if(d.Image){const C=new Image;C.onload=S(sn,T,"TestLoadImage: loaded",!0,y,C),C.onerror=S(sn,T,"TestLoadImage: error",!1,y,C),C.onabort=S(sn,T,"TestLoadImage: abort",!1,y,C),C.ontimeout=S(sn,T,"TestLoadImage: timeout",!1,y,C),d.setTimeout(function(){C.ontimeout&&C.ontimeout()},1e4),C.src=u}else y(!1)}function rc(u,y){const T=new ts,C=new AbortController,$=setTimeout(()=>{C.abort(),sn(T,"TestPingServer: timeout",!1,y)},1e4);fetch(u,{signal:C.signal}).then(Y=>{clearTimeout($),Y.ok?sn(T,"TestPingServer: ok",!0,y):sn(T,"TestPingServer: server error",!1,y)}).catch(()=>{clearTimeout($),sn(T,"TestPingServer: error",!1,y)})}function sn(u,y,T,C,$){try{$&&($.onload=null,$.onerror=null,$.onabort=null,$.ontimeout=null),C(T)}catch{}}function yd(){this.g=new fa}function ic(u,y,T){const C=T||"";try{ai(u,function($,Y){let de=$;m($)&&(de=da($)),y.push(C+Y+"="+encodeURIComponent(de))})}catch($){throw y.push(C+"type="+encodeURIComponent("_badmap")),$}}function jr(u){this.l=u.Ub||null,this.j=u.eb||!1}R(jr,Zi),jr.prototype.g=function(){return new ls(this.l,this.j)},jr.prototype.i=function(u){return function(){return u}}({});function ls(u,y){wt.call(this),this.D=u,this.o=y,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}R(ls,wt),n=ls.prototype,n.open=function(u,y){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=u,this.A=y,this.readyState=1,Gn(this)},n.send=function(u){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const y={headers:this.u,method:this.B,credentials:this.m,cache:void 0};u&&(y.body=u),(this.D||d).fetch(new Request(this.A,y)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,qn(this)),this.readyState=0},n.Sa=function(u){if(this.g&&(this.l=u,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=u.headers,this.readyState=2,Gn(this)),this.g&&(this.readyState=3,Gn(this),this.g)))if(this.responseType==="arraybuffer")u.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof d.ReadableStream<"u"&&"body"in u){if(this.j=u.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;sc(this)}else u.text().then(this.Ra.bind(this),this.ga.bind(this))};function sc(u){u.j.read().then(u.Pa.bind(u)).catch(u.ga.bind(u))}n.Pa=function(u){if(this.g){if(this.o&&u.value)this.response.push(u.value);else if(!this.o){var y=u.value?u.value:new Uint8Array(0);(y=this.v.decode(y,{stream:!u.done}))&&(this.response=this.responseText+=y)}u.done?qn(this):Gn(this),this.readyState==3&&sc(this)}},n.Ra=function(u){this.g&&(this.response=this.responseText=u,qn(this))},n.Qa=function(u){this.g&&(this.response=u,qn(this))},n.ga=function(){this.g&&qn(this)};function qn(u){u.readyState=4,u.l=null,u.j=null,u.v=null,Gn(u)}n.setRequestHeader=function(u,y){this.u.append(u,y)},n.getResponseHeader=function(u){return this.h&&this.h.get(u.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const u=[],y=this.h.entries();for(var T=y.next();!T.done;)T=T.value,u.push(T[0]+": "+T[1]),T=y.next();return u.join(`\r
`)};function Gn(u){u.onreadystatechange&&u.onreadystatechange.call(u)}Object.defineProperty(ls.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(u){this.m=u?"include":"same-origin"}});function Or(u){let y="";return Q(u,function(T,C){y+=C,y+=":",y+=T,y+=`\r
`}),y}function fi(u,y,T){e:{for(C in T){var C=!1;break e}C=!0}C||(T=Or(T),typeof u=="string"?T!=null&&encodeURIComponent(String(T)):Xe(u,y,T))}function rt(u){wt.call(this),this.headers=new Map,this.o=u||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}R(rt,wt);var vd=/^https?$/i,Sa=["POST","PUT"];n=rt.prototype,n.Ha=function(u){this.J=u},n.ea=function(u,y,T,C){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+u);y=y?y.toUpperCase():"GET",this.D=u,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Bn.g(),this.v=this.o?Us(this.o):Us(Bn),this.g.onreadystatechange=w(this.Ea,this);try{this.B=!0,this.g.open(y,String(u),!0),this.B=!1}catch(Y){cs(this,Y);return}if(u=T||"",T=new Map(this.headers),C)if(Object.getPrototypeOf(C)===Object.prototype)for(var $ in C)T.set($,C[$]);else if(typeof C.keys=="function"&&typeof C.get=="function")for(const Y of C.keys())T.set(Y,C.get(Y));else throw Error("Unknown input type for opt_headers: "+String(C));C=Array.from(T.keys()).find(Y=>Y.toLowerCase()=="content-type"),$=d.FormData&&u instanceof d.FormData,!(0<=Array.prototype.indexOf.call(Sa,y,void 0))||C||$||T.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[Y,de]of T)this.g.setRequestHeader(Y,de);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Js(this),this.u=!0,this.g.send(u),this.u=!1}catch(Y){cs(this,Y)}};function cs(u,y){u.h=!1,u.g&&(u.j=!0,u.g.abort(),u.j=!1),u.l=y,u.m=5,Xs(u),yn(u)}function Xs(u){u.A||(u.A=!0,Tt(u,"complete"),Tt(u,"error"))}n.abort=function(u){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=u||7,Tt(this,"complete"),Tt(this,"abort"),yn(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),yn(this,!0)),rt.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?xa(this):this.bb())},n.bb=function(){xa(this)};function xa(u){if(u.h&&typeof c<"u"&&(!u.v[1]||on(u)!=4||u.Z()!=2)){if(u.u&&on(u)==4)la(u.Ea,0,u);else if(Tt(u,"readystatechange"),on(u)==4){u.h=!1;try{const de=u.Z();e:switch(de){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var y=!0;break e;default:y=!1}var T;if(!(T=y)){var C;if(C=de===0){var $=String(u.D).match(os)[1]||null;!$&&d.self&&d.self.location&&($=d.self.location.protocol.slice(0,-1)),C=!vd.test($?$.toLowerCase():"")}T=C}if(T)Tt(u,"complete"),Tt(u,"success");else{u.m=6;try{var Y=2<on(u)?u.g.statusText:""}catch{Y=""}u.l=Y+" ["+u.Z()+"]",Xs(u)}}finally{yn(u)}}}}function yn(u,y){if(u.g){Js(u);const T=u.g,C=u.v[0]?()=>{}:null;u.g=null,u.v=null,y||Tt(u,"ready");try{T.onreadystatechange=C}catch{}}}function Js(u){u.I&&(d.clearTimeout(u.I),u.I=null)}n.isActive=function(){return!!this.g};function on(u){return u.g?u.g.readyState:0}n.Z=function(){try{return 2<on(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(u){if(this.g){var y=this.g.responseText;return u&&y.indexOf(u)==0&&(y=y.substring(u.length)),ha(y)}};function Ia(u){try{if(!u.g)return null;if("response"in u.g)return u.g.response;switch(u.H){case"":case"text":return u.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in u.g)return u.g.mozResponseArrayBuffer}return null}catch{return null}}function Zs(u){const y={};u=(u.g&&2<=on(u)&&u.g.getAllResponseHeaders()||"").split(`\r
`);for(let C=0;C<u.length;C++){if(U(u[C]))continue;var T=M(u[C]);const $=T[0];if(T=T[1],typeof T!="string")continue;T=T.trim();const Y=y[$]||[];y[$]=Y,Y.push(T)}k(y,function(C){return C.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function cr(u,y,T){return T&&T.internalChannelParams&&T.internalChannelParams[u]||y}function Ra(u){this.Aa=0,this.i=[],this.j=new ts,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=cr("failFast",!1,u),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=cr("baseRetryDelayMs",5e3,u),this.cb=cr("retryDelaySeedMs",1e4,u),this.Wa=cr("forwardChannelMaxRetries",2,u),this.wa=cr("forwardChannelRequestTimeoutMs",2e4,u),this.pa=u&&u.xmlHttpFactory||void 0,this.Xa=u&&u.Tb||void 0,this.Ca=u&&u.useFetchStreams||!1,this.L=void 0,this.J=u&&u.supportsCrossDomainXhr||!1,this.K="",this.h=new ss(u&&u.concurrentRequestLimit),this.Da=new yd,this.P=u&&u.fastHandshake||!1,this.O=u&&u.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=u&&u.Rb||!1,u&&u.xa&&this.j.xa(),u&&u.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&u&&u.detectBufferingProxy||!1,this.ja=void 0,u&&u.longPollingTimeout&&0<u.longPollingTimeout&&(this.ja=u.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=Ra.prototype,n.la=8,n.G=1,n.connect=function(u,y,T,C){pt(0),this.W=u,this.H=y||{},T&&C!==void 0&&(this.H.OSID=T,this.H.OAID=C),this.F=this.X,this.I=cc(this,null,this.W),ur(this)};function Vt(u){if(eo(u),u.G==3){var y=u.U++,T=gn(u.I);if(Xe(T,"SID",u.K),Xe(T,"RID",y),Xe(T,"TYPE","terminate"),Lr(u,T),y=new zn(u,u.j,y),y.L=2,y.v=ui(gn(T)),T=!1,d.navigator&&d.navigator.sendBeacon)try{T=d.navigator.sendBeacon(y.v.toString(),"")}catch{}!T&&d.Image&&(new Image().src=y.v,T=!0),T||(y.g=uc(y.j,null),y.g.ea(y.v)),y.F=Date.now(),Je(y)}lc(u)}function Wn(u){u.g&&(Aa(u),u.g.cancel(),u.g=null)}function eo(u){Wn(u),u.u&&(d.clearTimeout(u.u),u.u=null),ro(u),u.h.cancel(),u.s&&(typeof u.s=="number"&&d.clearTimeout(u.s),u.s=null)}function ur(u){if(!mn(u.h)&&!u.s){u.s=!0;var y=u.Ga;re||le(),ae||(re(),ae=!0),fe.add(y,u),u.B=0}}function _d(u,y){return Yl(u.h)>=u.h.j-(u.s?1:0)?!1:u.s?(u.i=y.D.concat(u.i),!0):u.G==1||u.G==2||u.B>=(u.Va?0:u.Wa)?!1:(u.s=Fn(w(u.Ga,u,y),ac(u,u.B)),u.B++,!0)}n.Ga=function(u){if(this.s)if(this.s=null,this.G==1){if(!u){this.U=Math.floor(1e5*Math.random()),u=this.U++;const $=new zn(this,this.j,u);let Y=this.o;if(this.S&&(Y?(Y=x(Y),P(Y,this.S)):Y=this.S),this.m!==null||this.O||($.H=Y,Y=null),this.P)e:{for(var y=0,T=0;T<this.i.length;T++){t:{var C=this.i[T];if("__data__"in C.map&&(C=C.map.__data__,typeof C=="string")){C=C.length;break t}C=void 0}if(C===void 0)break;if(y+=C,4096<y){y=T;break e}if(y===4096||T===this.i.length-1){y=T+1;break e}}y=1e3}else y=1e3;y=pi(this,$,y),T=gn(this.I),Xe(T,"RID",u),Xe(T,"CVER",22),this.D&&Xe(T,"X-HTTP-Session-Id",this.D),Lr(this,T),Y&&(this.O?y="headers="+encodeURIComponent(String(Or(Y)))+"&"+y:this.m&&fi(T,this.m,Y)),wa(this.h,$),this.Ua&&Xe(T,"TYPE","init"),this.P?(Xe(T,"$req",y),Xe(T,"SID","null"),$.T=!0,Ws($,T,null)):Ws($,T,y),this.G=2}}else this.G==3&&(u?to(this,u):this.i.length==0||mn(this.h)||to(this))};function to(u,y){var T;y?T=y.l:T=u.U++;const C=gn(u.I);Xe(C,"SID",u.K),Xe(C,"RID",T),Xe(C,"AID",u.T),Lr(u,C),u.m&&u.o&&fi(C,u.m,u.o),T=new zn(u,u.j,T,u.B+1),u.m===null&&(T.H=u.o),y&&(u.i=y.D.concat(u.i)),y=pi(u,T,1e3),T.I=Math.round(.5*u.wa)+Math.round(.5*u.wa*Math.random()),wa(u.h,T),Ws(T,C,y)}function Lr(u,y){u.H&&Q(u.H,function(T,C){Xe(y,C,T)}),u.l&&ai({},function(T,C){Xe(y,C,T)})}function pi(u,y,T){T=Math.min(u.i.length,T);var C=u.l?w(u.l.Na,u.l,u):null;e:{var $=u.i;let Y=-1;for(;;){const de=["count="+T];Y==-1?0<T?(Y=$[0].g,de.push("ofs="+Y)):Y=0:de.push("ofs="+Y);let Ye=!0;for(let St=0;St<T;St++){let He=$[St].g;const Nt=$[St].map;if(He-=Y,0>He)Y=Math.max(0,$[St].g-100),Ye=!1;else try{ic(Nt,de,"req"+He+"_")}catch{C&&C(Nt)}}if(Ye){C=de.join("&");break e}}}return u=u.i.splice(0,T),y.D=u,C}function us(u){if(!u.g&&!u.u){u.Y=1;var y=u.Fa;re||le(),ae||(re(),ae=!0),fe.add(y,u),u.v=0}}function no(u){return u.g||u.u||3<=u.v?!1:(u.Y++,u.u=Fn(w(u.Fa,u),ac(u,u.v)),u.v++,!0)}n.Fa=function(){if(this.u=null,oc(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var u=2*this.R;this.j.info("BP detection timer enabled: "+u),this.A=Fn(w(this.ab,this),u)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,pt(10),Wn(this),oc(this))};function Aa(u){u.A!=null&&(d.clearTimeout(u.A),u.A=null)}function oc(u){u.g=new zn(u,u.j,"rpc",u.Y),u.m===null&&(u.g.H=u.o),u.g.O=0;var y=gn(u.qa);Xe(y,"RID","rpc"),Xe(y,"SID",u.K),Xe(y,"AID",u.T),Xe(y,"CI",u.F?"0":"1"),!u.F&&u.ja&&Xe(y,"TO",u.ja),Xe(y,"TYPE","xmlhttp"),Lr(u,y),u.m&&u.o&&fi(y,u.m,u.o),u.L&&(u.g.I=u.L);var T=u.g;u=u.ia,T.L=1,T.v=ui(gn(y)),T.m=null,T.P=!0,_a(T,u)}n.Za=function(){this.C!=null&&(this.C=null,Wn(this),no(this),pt(19))};function ro(u){u.C!=null&&(d.clearTimeout(u.C),u.C=null)}function io(u,y){var T=null;if(u.g==y){ro(u),Aa(u),u.g=null;var C=2}else if(Zt(u.h,y))T=y.D,Xl(u.h,y),C=1;else return;if(u.G!=0){if(y.o)if(C==1){T=y.m?y.m.length:0,y=Date.now()-y.F;var $=u.B;C=es(),Tt(C,new $s(C,T)),ur(u)}else us(u);else if($=y.s,$==3||$==0&&0<y.X||!(C==1&&_d(u,y)||C==2&&no(u)))switch(T&&0<T.length&&(y=u.h,y.i=y.i.concat(T)),$){case 1:Mr(u,5);break;case 4:Mr(u,10);break;case 3:Mr(u,6);break;default:Mr(u,2)}}}function ac(u,y){let T=u.Ta+Math.floor(Math.random()*u.cb);return u.isActive()||(T*=2),T*y}function Mr(u,y){if(u.j.info("Error code "+y),y==2){var T=w(u.fb,u),C=u.Xa;const $=!C;C=new Dr(C||"//www.google.com/images/cleardot.gif"),d.location&&d.location.protocol=="http"||as(C,"https"),ui(C),$?gd(C.toString(),T):rc(C.toString(),T)}else pt(2);u.G=0,u.l&&u.l.sa(y),lc(u),eo(u)}n.fb=function(u){u?(this.j.info("Successfully pinged google.com"),pt(2)):(this.j.info("Failed to ping google.com"),pt(1))};function lc(u){if(u.G=0,u.ka=[],u.l){const y=Jl(u.h);(y.length!=0||u.i.length!=0)&&(N(u.ka,y),N(u.ka,u.i),u.h.i.length=0,j(u.i),u.i.length=0),u.l.ra()}}function cc(u,y,T){var C=T instanceof Dr?gn(T):new Dr(T);if(C.g!="")y&&(C.g=y+"."+C.g),li(C,C.s);else{var $=d.location;C=$.protocol,y=y?y+"."+$.hostname:$.hostname,$=+$.port;var Y=new Dr(null);C&&as(Y,C),y&&(Y.g=y),$&&li(Y,$),T&&(Y.l=T),C=Y}return T=u.D,y=u.ya,T&&y&&Xe(C,T,y),Xe(C,"VER",u.la),Lr(u,C),C}function uc(u,y,T){if(y&&!u.J)throw Error("Can't create secondary domain capable XhrIo object.");return y=u.Ca&&!u.pa?new rt(new jr({eb:T})):new rt(u.pa),y.Ha(u.J),y}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Ca(){}n=Ca.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function so(){}so.prototype.g=function(u,y){return new en(u,y)};function en(u,y){wt.call(this),this.g=new Ra(y),this.l=u,this.h=y&&y.messageUrlParams||null,u=y&&y.messageHeaders||null,y&&y.clientProtocolHeaderRequired&&(u?u["X-Client-Protocol"]="webchannel":u={"X-Client-Protocol":"webchannel"}),this.g.o=u,u=y&&y.initMessageHeaders||null,y&&y.messageContentType&&(u?u["X-WebChannel-Content-Type"]=y.messageContentType:u={"X-WebChannel-Content-Type":y.messageContentType}),y&&y.va&&(u?u["X-WebChannel-Client-Profile"]=y.va:u={"X-WebChannel-Client-Profile":y.va}),this.g.S=u,(u=y&&y.Sb)&&!U(u)&&(this.g.m=u),this.v=y&&y.supportsCrossDomainXhr||!1,this.u=y&&y.sendRawJson||!1,(y=y&&y.httpSessionIdParam)&&!U(y)&&(this.g.D=y,u=this.h,u!==null&&y in u&&(u=this.h,y in u&&delete u[y])),this.j=new dr(this)}R(en,wt),en.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},en.prototype.close=function(){Vt(this.g)},en.prototype.o=function(u){var y=this.g;if(typeof u=="string"){var T={};T.__data__=u,u=T}else this.u&&(T={},T.__data__=da(u),u=T);y.i.push(new Ql(y.Ya++,u)),y.G==3&&ur(y)},en.prototype.N=function(){this.g.l=null,delete this.j,Vt(this.g),delete this.g,en.aa.N.call(this)};function dc(u){sr.call(this),u.__headers__&&(this.headers=u.__headers__,this.statusCode=u.__status__,delete u.__headers__,delete u.__status__);var y=u.__sm__;if(y){e:{for(const T in y){u=T;break e}u=void 0}(this.i=u)&&(u=this.i,y=y!==null&&u in y?y[u]:void 0),this.data=y}else this.data=u}R(dc,sr);function hc(){zs.call(this),this.status=1}R(hc,zs);function dr(u){this.g=u}R(dr,Ca),dr.prototype.ua=function(){Tt(this.g,"a")},dr.prototype.ta=function(u){Tt(this.g,new dc(u))},dr.prototype.sa=function(u){Tt(this.g,new hc)},dr.prototype.ra=function(){Tt(this.g,"b")},so.prototype.createWebChannel=so.prototype.g,en.prototype.send=en.prototype.o,en.prototype.open=en.prototype.m,en.prototype.close=en.prototype.close,n_=function(){return new so},t_=function(){return es()},e_=or,wf={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},qs.NO_ERROR=0,qs.TIMEOUT=8,qs.HTTP_ERROR=6,_u=qs,ql.COMPLETE="complete",Z0=ql,Bs.EventType=Sn,Sn.OPEN="a",Sn.CLOSE="b",Sn.ERROR="c",Sn.MESSAGE="d",wt.prototype.listen=wt.prototype.K,ol=Bs,rt.prototype.listenOnce=rt.prototype.L,rt.prototype.getLastError=rt.prototype.Ka,rt.prototype.getLastErrorCode=rt.prototype.Ba,rt.prototype.getStatus=rt.prototype.Z,rt.prototype.getResponseJson=rt.prototype.Oa,rt.prototype.getResponseText=rt.prototype.oa,rt.prototype.send=rt.prototype.ea,rt.prototype.setWithCredentials=rt.prototype.Ha,J0=rt}).apply(typeof lu<"u"?lu:typeof self<"u"?self:typeof window<"u"?window:{});const By="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yt{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Yt.UNAUTHENTICATED=new Yt(null),Yt.GOOGLE_CREDENTIALS=new Yt("google-credentials-uid"),Yt.FIRST_PARTY=new Yt("first-party-uid"),Yt.MOCK_USER=new Yt("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ta="11.2.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ps=new Xf("@firebase/firestore");function bo(){return Ps.logLevel}function ye(n,...e){if(Ps.logLevel<=Fe.DEBUG){const t=e.map(dp);Ps.debug(`Firestore (${ta}): ${n}`,...t)}}function ti(n,...e){if(Ps.logLevel<=Fe.ERROR){const t=e.map(dp);Ps.error(`Firestore (${ta}): ${n}`,...t)}}function Uo(n,...e){if(Ps.logLevel<=Fe.WARN){const t=e.map(dp);Ps.warn(`Firestore (${ta}): ${n}`,...t)}}function dp(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(t){return JSON.stringify(t)}(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function De(n="Unexpected state"){const e=`FIRESTORE (${ta}) INTERNAL ASSERTION FAILED: `+n;throw ti(e),new Error(e)}function Ke(n,e){n||De()}function Le(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oe={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Ae extends ri{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vi{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r_{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class SR{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(Yt.UNAUTHENTICATED))}shutdown(){}}class xR{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class IR{constructor(e){this.t=e,this.currentUser=Yt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Ke(this.o===void 0);let i=this.i;const o=p=>this.i!==i?(i=this.i,t(p)):Promise.resolve();let a=new Vi;this.o=()=>{this.i++,this.currentUser=this.u(),a.resolve(),a=new Vi,e.enqueueRetryable(()=>o(this.currentUser))};const c=()=>{const p=a;e.enqueueRetryable(async()=>{await p.promise,await o(this.currentUser)})},d=p=>{ye("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=p,this.o&&(this.auth.addAuthTokenListener(this.o),c())};this.t.onInit(p=>d(p)),setTimeout(()=>{if(!this.auth){const p=this.t.getImmediate({optional:!0});p?d(p):(ye("FirebaseAuthCredentialsProvider","Auth not yet detected"),a.resolve(),a=new Vi)}},0),c()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(i=>this.i!==e?(ye("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(Ke(typeof i.accessToken=="string"),new r_(i.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Ke(e===null||typeof e=="string"),new Yt(e)}}class RR{constructor(e,t,i){this.l=e,this.h=t,this.P=i,this.type="FirstParty",this.user=Yt.FIRST_PARTY,this.T=new Map}I(){return this.P?this.P():null}get headers(){this.T.set("X-Goog-AuthUser",this.l);const e=this.I();return e&&this.T.set("Authorization",e),this.h&&this.T.set("X-Goog-Iam-Authorization-Token",this.h),this.T}}class AR{constructor(e,t,i){this.l=e,this.h=t,this.P=i}getToken(){return Promise.resolve(new RR(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(Yt.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class CR{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class kR{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){Ke(this.o===void 0);const i=a=>{a.error!=null&&ye("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${a.error.message}`);const c=a.token!==this.R;return this.R=a.token,ye("FirebaseAppCheckTokenProvider",`Received ${c?"new":"existing"} token.`),c?t(a.token):Promise.resolve()};this.o=a=>{e.enqueueRetryable(()=>i(a))};const o=a=>{ye("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=a,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(a=>o(a)),setTimeout(()=>{if(!this.appCheck){const a=this.A.getImmediate({optional:!0});a?o(a):ye("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(Ke(typeof t.token=="string"),this.R=t.token,new CR(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bR(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let i=0;i<n;i++)t[i]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i_{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length;let i="";for(;i.length<20;){const o=bR(40);for(let a=0;a<o.length;++a)i.length<20&&o[a]<t&&(i+=e.charAt(o[a]%e.length))}return i}}function $e(n,e){return n<e?-1:n>e?1:0}function Bo(n,e,t){return n.length===e.length&&n.every((i,o)=>t(i,e[o]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ct{static now(){return Ct.fromMillis(Date.now())}static fromDate(e){return Ct.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),i=Math.floor(1e6*(e-1e3*t));return new Ct(t,i)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Ae(oe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Ae(oe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new Ae(oe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Ae(oe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?$e(this.nanoseconds,e.nanoseconds):$e(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class je{static fromTimestamp(e){return new je(e)}static min(){return new je(new Ct(0,0))}static max(){return new je(new Ct(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yr{constructor(e,t,i){t===void 0?t=0:t>e.length&&De(),i===void 0?i=e.length-t:i>e.length-t&&De(),this.segments=e,this.offset=t,this.len=i}get length(){return this.len}isEqual(e){return yr.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof yr?e.forEach(i=>{t.push(i)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,i=this.limit();t<i;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const i=Math.min(e.length,t.length);for(let o=0;o<i;o++){const a=yr.compareSegments(e.get(o),t.get(o));if(a!==0)return a}return Math.sign(e.length-t.length)}static compareSegments(e,t){const i=yr.isNumericId(e),o=yr.isNumericId(t);return i&&!o?-1:!i&&o?1:i&&o?yr.extractNumericId(e).compare(yr.extractNumericId(t)):e<t?-1:e>t?1:0}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Mi.fromString(e.substring(4,e.length-2))}}class ft extends yr{construct(e,t,i){return new ft(e,t,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const i of e){if(i.indexOf("//")>=0)throw new Ae(oe.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);t.push(...i.split("/").filter(o=>o.length>0))}return new ft(t)}static emptyPath(){return new ft([])}}const NR=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class zt extends yr{construct(e,t,i){return new zt(e,t,i)}static isValidIdentifier(e){return NR.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),zt.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new zt(["__name__"])}static fromServerFormat(e){const t=[];let i="",o=0;const a=()=>{if(i.length===0)throw new Ae(oe.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(i),i=""};let c=!1;for(;o<e.length;){const d=e[o];if(d==="\\"){if(o+1===e.length)throw new Ae(oe.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const p=e[o+1];if(p!=="\\"&&p!=="."&&p!=="`")throw new Ae(oe.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=p,o+=2}else d==="`"?(c=!c,o++):d!=="."||c?(i+=d,o++):(a(),o++)}if(a(),c)throw new Ae(oe.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new zt(t)}static emptyPath(){return new zt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ce{constructor(e){this.path=e}static fromPath(e){return new Ce(ft.fromString(e))}static fromName(e){return new Ce(ft.fromString(e).popFirst(5))}static empty(){return new Ce(ft.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ft.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return ft.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Ce(new ft(e.slice()))}}function PR(n,e){const t=n.toTimestamp().seconds,i=n.toTimestamp().nanoseconds+1,o=je.fromTimestamp(i===1e9?new Ct(t+1,0):new Ct(t,i));return new Ui(o,Ce.empty(),e)}function DR(n){return new Ui(n.readTime,n.key,-1)}class Ui{constructor(e,t,i){this.readTime=e,this.documentKey=t,this.largestBatchId=i}static min(){return new Ui(je.min(),Ce.empty(),-1)}static max(){return new Ui(je.max(),Ce.empty(),-1)}}function jR(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=Ce.comparator(n.documentKey,e.documentKey),t!==0?t:$e(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OR="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class LR{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function na(n){if(n.code!==oe.FAILED_PRECONDITION||n.message!==OR)throw n;ye("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&De(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new Z((i,o)=>{this.nextCallback=a=>{this.wrapSuccess(e,a).next(i,o)},this.catchCallback=a=>{this.wrapFailure(t,a).next(i,o)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof Z?t:Z.resolve(t)}catch(t){return Z.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):Z.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):Z.reject(t)}static resolve(e){return new Z((t,i)=>{t(e)})}static reject(e){return new Z((t,i)=>{i(e)})}static waitFor(e){return new Z((t,i)=>{let o=0,a=0,c=!1;e.forEach(d=>{++o,d.next(()=>{++a,c&&a===o&&t()},p=>i(p))}),c=!0,a===o&&t()})}static or(e){let t=Z.resolve(!1);for(const i of e)t=t.next(o=>o?Z.resolve(o):i());return t}static forEach(e,t){const i=[];return e.forEach((o,a)=>{i.push(t.call(this,o,a))}),this.waitFor(i)}static mapArray(e,t){return new Z((i,o)=>{const a=e.length,c=new Array(a);let d=0;for(let p=0;p<a;p++){const m=p;t(e[m]).next(v=>{c[m]=v,++d,d===a&&i(c)},v=>o(v))}})}static doWhile(e,t){return new Z((i,o)=>{const a=()=>{e()===!0?t().next(()=>{a()},o):i()};a()})}}function MR(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function ra(n){return n.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ju{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=i=>this.ie(i),this.se=i=>t.writeSequenceNumber(i))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}Ju.oe=-1;function Zu(n){return n==null}function Du(n){return n===0&&1/n==-1/0}function VR(n){return typeof n=="number"&&Number.isInteger(n)&&!Du(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FR(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=zy(e)),e=UR(n.get(t),e);return zy(e)}function UR(n,e){let t=e;const i=n.length;for(let o=0;o<i;o++){const a=n.charAt(o);switch(a){case"\0":t+="";break;case"":t+="";break;default:t+=a}}return t}function zy(n){return n+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $y(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Ds(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function s_(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ut{constructor(e,t){this.comparator=e,this.root=t||Bt.EMPTY}insert(e,t){return new ut(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Bt.BLACK,null,null))}remove(e){return new ut(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Bt.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const i=this.comparator(e,t.key);if(i===0)return t.value;i<0?t=t.left:i>0&&(t=t.right)}return null}indexOf(e){let t=0,i=this.root;for(;!i.isEmpty();){const o=this.comparator(e,i.key);if(o===0)return t+i.left.size;o<0?i=i.left:(t+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,i)=>(e(t,i),!1))}toString(){const e=[];return this.inorderTraversal((t,i)=>(e.push(`${t}:${i}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new cu(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new cu(this.root,e,this.comparator,!1)}getReverseIterator(){return new cu(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new cu(this.root,e,this.comparator,!0)}}class cu{constructor(e,t,i,o){this.isReverse=o,this.nodeStack=[];let a=1;for(;!e.isEmpty();)if(a=t?i(e.key,t):1,t&&o&&(a*=-1),a<0)e=this.isReverse?e.left:e.right;else{if(a===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Bt{constructor(e,t,i,o,a){this.key=e,this.value=t,this.color=i??Bt.RED,this.left=o??Bt.EMPTY,this.right=a??Bt.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,i,o,a){return new Bt(e??this.key,t??this.value,i??this.color,o??this.left,a??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let o=this;const a=i(e,o.key);return o=a<0?o.copy(null,null,null,o.left.insert(e,t,i),null):a===0?o.copy(null,t,null,null,null):o.copy(null,null,null,null,o.right.insert(e,t,i)),o.fixUp()}removeMin(){if(this.left.isEmpty())return Bt.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let i,o=this;if(t(e,o.key)<0)o.left.isEmpty()||o.left.isRed()||o.left.left.isRed()||(o=o.moveRedLeft()),o=o.copy(null,null,null,o.left.remove(e,t),null);else{if(o.left.isRed()&&(o=o.rotateRight()),o.right.isEmpty()||o.right.isRed()||o.right.left.isRed()||(o=o.moveRedRight()),t(e,o.key)===0){if(o.right.isEmpty())return Bt.EMPTY;i=o.right.min(),o=o.copy(i.key,i.value,null,null,o.right.removeMin())}o=o.copy(null,null,null,null,o.right.remove(e,t))}return o.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Bt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Bt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw De();const e=this.left.check();if(e!==this.right.check())throw De();return e+(this.isRed()?0:1)}}Bt.EMPTY=null,Bt.RED=!0,Bt.BLACK=!1;Bt.EMPTY=new class{constructor(){this.size=0}get key(){throw De()}get value(){throw De()}get color(){throw De()}get left(){throw De()}get right(){throw De()}copy(e,t,i,o,a){return this}insert(e,t,i){return new Bt(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kt{constructor(e){this.comparator=e,this.data=new ut(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,i)=>(e(t),!1))}forEachInRange(e,t){const i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){const o=i.getNext();if(this.comparator(o.key,e[1])>=0)return;t(o.key)}}forEachWhile(e,t){let i;for(i=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Hy(this.data.getIterator())}getIteratorFrom(e){return new Hy(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(i=>{t=t.add(i)}),t}isEqual(e){if(!(e instanceof kt)||this.size!==e.size)return!1;const t=this.data.getIterator(),i=e.data.getIterator();for(;t.hasNext();){const o=t.getNext().key,a=i.getNext().key;if(this.comparator(o,a)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new kt(this.comparator);return t.data=e,t}}class Hy{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rr{constructor(e){this.fields=e,e.sort(zt.comparator)}static empty(){return new rr([])}unionWith(e){let t=new kt(zt.comparator);for(const i of this.fields)t=t.add(i);for(const i of e)t=t.add(i);return new rr(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Bo(this.fields,e.fields,(t,i)=>t.isEqual(i))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o_ extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $t{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(o){try{return atob(o)}catch(a){throw typeof DOMException<"u"&&a instanceof DOMException?new o_("Invalid base64 string: "+a):a}}(e);return new $t(t)}static fromUint8Array(e){const t=function(o){let a="";for(let c=0;c<o.length;++c)a+=String.fromCharCode(o[c]);return a}(e);return new $t(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){const i=new Uint8Array(t.length);for(let o=0;o<t.length;o++)i[o]=t.charCodeAt(o);return i}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return $e(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}$t.EMPTY_BYTE_STRING=new $t("");const BR=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Bi(n){if(Ke(!!n),typeof n=="string"){let e=0;const t=BR.exec(n);if(Ke(!!t),t[1]){let o=t[1];o=(o+"000000000").substr(0,9),e=Number(o)}const i=new Date(n);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:gt(n.seconds),nanos:gt(n.nanos)}}function gt(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function zi(n){return typeof n=="string"?$t.fromBase64String(n):$t.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hp(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="server_timestamp"}function ed(n){const e=n.mapValue.fields.__previous_value__;return hp(e)?ed(e):e}function El(n){const e=Bi(n.mapValue.fields.__local_write_time__.timestampValue);return new Ct(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zR{constructor(e,t,i,o,a,c,d,p,m){this.databaseId=e,this.appId=t,this.persistenceKey=i,this.host=o,this.ssl=a,this.forceLongPolling=c,this.autoDetectLongPolling=d,this.longPollingOptions=p,this.useFetchStreams=m}}class wl{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new wl("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof wl&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uu={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function $i(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?hp(n)?4:HR(n)?9007199254740991:$R(n)?10:11:De()}function Sr(n,e){if(n===e)return!0;const t=$i(n);if(t!==$i(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return El(n).isEqual(El(e));case 3:return function(o,a){if(typeof o.timestampValue=="string"&&typeof a.timestampValue=="string"&&o.timestampValue.length===a.timestampValue.length)return o.timestampValue===a.timestampValue;const c=Bi(o.timestampValue),d=Bi(a.timestampValue);return c.seconds===d.seconds&&c.nanos===d.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(o,a){return zi(o.bytesValue).isEqual(zi(a.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(o,a){return gt(o.geoPointValue.latitude)===gt(a.geoPointValue.latitude)&&gt(o.geoPointValue.longitude)===gt(a.geoPointValue.longitude)}(n,e);case 2:return function(o,a){if("integerValue"in o&&"integerValue"in a)return gt(o.integerValue)===gt(a.integerValue);if("doubleValue"in o&&"doubleValue"in a){const c=gt(o.doubleValue),d=gt(a.doubleValue);return c===d?Du(c)===Du(d):isNaN(c)&&isNaN(d)}return!1}(n,e);case 9:return Bo(n.arrayValue.values||[],e.arrayValue.values||[],Sr);case 10:case 11:return function(o,a){const c=o.mapValue.fields||{},d=a.mapValue.fields||{};if($y(c)!==$y(d))return!1;for(const p in c)if(c.hasOwnProperty(p)&&(d[p]===void 0||!Sr(c[p],d[p])))return!1;return!0}(n,e);default:return De()}}function Tl(n,e){return(n.values||[]).find(t=>Sr(t,e))!==void 0}function zo(n,e){if(n===e)return 0;const t=$i(n),i=$i(e);if(t!==i)return $e(t,i);switch(t){case 0:case 9007199254740991:return 0;case 1:return $e(n.booleanValue,e.booleanValue);case 2:return function(a,c){const d=gt(a.integerValue||a.doubleValue),p=gt(c.integerValue||c.doubleValue);return d<p?-1:d>p?1:d===p?0:isNaN(d)?isNaN(p)?0:-1:1}(n,e);case 3:return qy(n.timestampValue,e.timestampValue);case 4:return qy(El(n),El(e));case 5:return $e(n.stringValue,e.stringValue);case 6:return function(a,c){const d=zi(a),p=zi(c);return d.compareTo(p)}(n.bytesValue,e.bytesValue);case 7:return function(a,c){const d=a.split("/"),p=c.split("/");for(let m=0;m<d.length&&m<p.length;m++){const v=$e(d[m],p[m]);if(v!==0)return v}return $e(d.length,p.length)}(n.referenceValue,e.referenceValue);case 8:return function(a,c){const d=$e(gt(a.latitude),gt(c.latitude));return d!==0?d:$e(gt(a.longitude),gt(c.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return Gy(n.arrayValue,e.arrayValue);case 10:return function(a,c){var d,p,m,v;const E=a.fields||{},w=c.fields||{},S=(d=E.value)===null||d===void 0?void 0:d.arrayValue,R=(p=w.value)===null||p===void 0?void 0:p.arrayValue,j=$e(((m=S==null?void 0:S.values)===null||m===void 0?void 0:m.length)||0,((v=R==null?void 0:R.values)===null||v===void 0?void 0:v.length)||0);return j!==0?j:Gy(S,R)}(n.mapValue,e.mapValue);case 11:return function(a,c){if(a===uu.mapValue&&c===uu.mapValue)return 0;if(a===uu.mapValue)return 1;if(c===uu.mapValue)return-1;const d=a.fields||{},p=Object.keys(d),m=c.fields||{},v=Object.keys(m);p.sort(),v.sort();for(let E=0;E<p.length&&E<v.length;++E){const w=$e(p[E],v[E]);if(w!==0)return w;const S=zo(d[p[E]],m[v[E]]);if(S!==0)return S}return $e(p.length,v.length)}(n.mapValue,e.mapValue);default:throw De()}}function qy(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return $e(n,e);const t=Bi(n),i=Bi(e),o=$e(t.seconds,i.seconds);return o!==0?o:$e(t.nanos,i.nanos)}function Gy(n,e){const t=n.values||[],i=e.values||[];for(let o=0;o<t.length&&o<i.length;++o){const a=zo(t[o],i[o]);if(a)return a}return $e(t.length,i.length)}function $o(n){return Tf(n)}function Tf(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){const i=Bi(t);return`time(${i.seconds},${i.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return zi(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return Ce.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let i="[",o=!0;for(const a of t.values||[])o?o=!1:i+=",",i+=Tf(a);return i+"]"}(n.arrayValue):"mapValue"in n?function(t){const i=Object.keys(t.fields||{}).sort();let o="{",a=!0;for(const c of i)a?a=!1:o+=",",o+=`${c}:${Tf(t.fields[c])}`;return o+"}"}(n.mapValue):De()}function Eu(n){switch($i(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=ed(n);return e?16+Eu(e):16;case 5:return 2*n.stringValue.length;case 6:return zi(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return function(i){return(i.values||[]).reduce((o,a)=>o+Eu(a),0)}(n.arrayValue);case 10:case 11:return function(i){let o=0;return Ds(i.fields,(a,c)=>{o+=a.length+Eu(c)}),o}(n.mapValue);default:throw De()}}function Sf(n){return!!n&&"integerValue"in n}function fp(n){return!!n&&"arrayValue"in n}function Wy(n){return!!n&&"nullValue"in n}function Ky(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function wu(n){return!!n&&"mapValue"in n}function $R(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="__vector__"}function hl(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const e={mapValue:{fields:{}}};return Ds(n.mapValue.fields,(t,i)=>e.mapValue.fields[t]=hl(i)),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=hl(n.arrayValue.values[t]);return e}return Object.assign({},n)}function HR(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dn{constructor(e){this.value=e}static empty(){return new Dn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let i=0;i<e.length-1;++i)if(t=(t.mapValue.fields||{})[e.get(i)],!wu(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=hl(t)}setAll(e){let t=zt.emptyPath(),i={},o=[];e.forEach((c,d)=>{if(!t.isImmediateParentOf(d)){const p=this.getFieldsMap(t);this.applyChanges(p,i,o),i={},o=[],t=d.popLast()}c?i[d.lastSegment()]=hl(c):o.push(d.lastSegment())});const a=this.getFieldsMap(t);this.applyChanges(a,i,o)}delete(e){const t=this.field(e.popLast());wu(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Sr(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let i=0;i<e.length;++i){let o=t.mapValue.fields[e.get(i)];wu(o)&&o.mapValue.fields||(o={mapValue:{fields:{}}},t.mapValue.fields[e.get(i)]=o),t=o}return t.mapValue.fields}applyChanges(e,t,i){Ds(t,(o,a)=>e[o]=a);for(const o of i)delete e[o]}clone(){return new Dn(hl(this.value))}}function a_(n){const e=[];return Ds(n.fields,(t,i)=>{const o=new zt([t]);if(wu(i)){const a=a_(i.mapValue).fields;if(a.length===0)e.push(o);else for(const c of a)e.push(o.child(c))}else e.push(o)}),new rr(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xt{constructor(e,t,i,o,a,c,d){this.key=e,this.documentType=t,this.version=i,this.readTime=o,this.createTime=a,this.data=c,this.documentState=d}static newInvalidDocument(e){return new Xt(e,0,je.min(),je.min(),je.min(),Dn.empty(),0)}static newFoundDocument(e,t,i,o){return new Xt(e,1,t,je.min(),i,o,0)}static newNoDocument(e,t){return new Xt(e,2,t,je.min(),je.min(),Dn.empty(),0)}static newUnknownDocument(e,t){return new Xt(e,3,t,je.min(),je.min(),Dn.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(je.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Dn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Dn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=je.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Xt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Xt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ju{constructor(e,t){this.position=e,this.inclusive=t}}function Qy(n,e,t){let i=0;for(let o=0;o<n.position.length;o++){const a=e[o],c=n.position[o];if(a.field.isKeyField()?i=Ce.comparator(Ce.fromName(c.referenceValue),t.key):i=zo(c,t.data.field(a.field)),a.dir==="desc"&&(i*=-1),i!==0)break}return i}function Yy(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Sr(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ou{constructor(e,t="asc"){this.field=e,this.dir=t}}function qR(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l_{}class At extends l_{constructor(e,t,i){super(),this.field=e,this.op=t,this.value=i}static create(e,t,i){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,i):new WR(e,t,i):t==="array-contains"?new YR(e,i):t==="in"?new XR(e,i):t==="not-in"?new JR(e,i):t==="array-contains-any"?new ZR(e,i):new At(e,t,i)}static createKeyFieldInFilter(e,t,i){return t==="in"?new KR(e,i):new QR(e,i)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(zo(t,this.value)):t!==null&&$i(this.value)===$i(t)&&this.matchesComparison(zo(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return De()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class xr extends l_{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new xr(e,t)}matches(e){return c_(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function c_(n){return n.op==="and"}function u_(n){return GR(n)&&c_(n)}function GR(n){for(const e of n.filters)if(e instanceof xr)return!1;return!0}function xf(n){if(n instanceof At)return n.field.canonicalString()+n.op.toString()+$o(n.value);if(u_(n))return n.filters.map(e=>xf(e)).join(",");{const e=n.filters.map(t=>xf(t)).join(",");return`${n.op}(${e})`}}function d_(n,e){return n instanceof At?function(i,o){return o instanceof At&&i.op===o.op&&i.field.isEqual(o.field)&&Sr(i.value,o.value)}(n,e):n instanceof xr?function(i,o){return o instanceof xr&&i.op===o.op&&i.filters.length===o.filters.length?i.filters.reduce((a,c,d)=>a&&d_(c,o.filters[d]),!0):!1}(n,e):void De()}function h_(n){return n instanceof At?function(t){return`${t.field.canonicalString()} ${t.op} ${$o(t.value)}`}(n):n instanceof xr?function(t){return t.op.toString()+" {"+t.getFilters().map(h_).join(" ,")+"}"}(n):"Filter"}class WR extends At{constructor(e,t,i){super(e,t,i),this.key=Ce.fromName(i.referenceValue)}matches(e){const t=Ce.comparator(e.key,this.key);return this.matchesComparison(t)}}class KR extends At{constructor(e,t){super(e,"in",t),this.keys=f_("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class QR extends At{constructor(e,t){super(e,"not-in",t),this.keys=f_("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function f_(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(i=>Ce.fromName(i.referenceValue))}class YR extends At{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return fp(t)&&Tl(t.arrayValue,this.value)}}class XR extends At{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Tl(this.value.arrayValue,t)}}class JR extends At{constructor(e,t){super(e,"not-in",t)}matches(e){if(Tl(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&!Tl(this.value.arrayValue,t)}}class ZR extends At{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!fp(t)||!t.arrayValue.values)&&t.arrayValue.values.some(i=>Tl(this.value.arrayValue,i))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eA{constructor(e,t=null,i=[],o=[],a=null,c=null,d=null){this.path=e,this.collectionGroup=t,this.orderBy=i,this.filters=o,this.limit=a,this.startAt=c,this.endAt=d,this.ue=null}}function Xy(n,e=null,t=[],i=[],o=null,a=null,c=null){return new eA(n,e,t,i,o,a,c)}function pp(n){const e=Le(n);if(e.ue===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(i=>xf(i)).join(","),t+="|ob:",t+=e.orderBy.map(i=>function(a){return a.field.canonicalString()+a.dir}(i)).join(","),Zu(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(i=>$o(i)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(i=>$o(i)).join(",")),e.ue=t}return e.ue}function mp(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!qR(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!d_(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!Yy(n.startAt,e.startAt)&&Yy(n.endAt,e.endAt)}function If(n){return Ce.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class td{constructor(e,t=null,i=[],o=[],a=null,c="F",d=null,p=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=i,this.filters=o,this.limit=a,this.limitType=c,this.startAt=d,this.endAt=p,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function tA(n,e,t,i,o,a,c,d){return new td(n,e,t,i,o,a,c,d)}function gp(n){return new td(n)}function Jy(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function nA(n){return n.collectionGroup!==null}function fl(n){const e=Le(n);if(e.ce===null){e.ce=[];const t=new Set;for(const a of e.explicitOrderBy)e.ce.push(a),t.add(a.field.canonicalString());const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(c){let d=new kt(zt.comparator);return c.filters.forEach(p=>{p.getFlattenedFilters().forEach(m=>{m.isInequality()&&(d=d.add(m.field))})}),d})(e).forEach(a=>{t.has(a.canonicalString())||a.isKeyField()||e.ce.push(new Ou(a,i))}),t.has(zt.keyField().canonicalString())||e.ce.push(new Ou(zt.keyField(),i))}return e.ce}function Er(n){const e=Le(n);return e.le||(e.le=rA(e,fl(n))),e.le}function rA(n,e){if(n.limitType==="F")return Xy(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(o=>{const a=o.dir==="desc"?"asc":"desc";return new Ou(o.field,a)});const t=n.endAt?new ju(n.endAt.position,n.endAt.inclusive):null,i=n.startAt?new ju(n.startAt.position,n.startAt.inclusive):null;return Xy(n.path,n.collectionGroup,e,n.filters,n.limit,t,i)}}function Rf(n,e,t){return new td(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function nd(n,e){return mp(Er(n),Er(e))&&n.limitType===e.limitType}function p_(n){return`${pp(Er(n))}|lt:${n.limitType}`}function No(n){return`Query(target=${function(t){let i=t.path.canonicalString();return t.collectionGroup!==null&&(i+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(i+=`, filters: [${t.filters.map(o=>h_(o)).join(", ")}]`),Zu(t.limit)||(i+=", limit: "+t.limit),t.orderBy.length>0&&(i+=`, orderBy: [${t.orderBy.map(o=>function(c){return`${c.field.canonicalString()} (${c.dir})`}(o)).join(", ")}]`),t.startAt&&(i+=", startAt: ",i+=t.startAt.inclusive?"b:":"a:",i+=t.startAt.position.map(o=>$o(o)).join(",")),t.endAt&&(i+=", endAt: ",i+=t.endAt.inclusive?"a:":"b:",i+=t.endAt.position.map(o=>$o(o)).join(",")),`Target(${i})`}(Er(n))}; limitType=${n.limitType})`}function rd(n,e){return e.isFoundDocument()&&function(i,o){const a=o.key.path;return i.collectionGroup!==null?o.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(a):Ce.isDocumentKey(i.path)?i.path.isEqual(a):i.path.isImmediateParentOf(a)}(n,e)&&function(i,o){for(const a of fl(i))if(!a.field.isKeyField()&&o.data.field(a.field)===null)return!1;return!0}(n,e)&&function(i,o){for(const a of i.filters)if(!a.matches(o))return!1;return!0}(n,e)&&function(i,o){return!(i.startAt&&!function(c,d,p){const m=Qy(c,d,p);return c.inclusive?m<=0:m<0}(i.startAt,fl(i),o)||i.endAt&&!function(c,d,p){const m=Qy(c,d,p);return c.inclusive?m>=0:m>0}(i.endAt,fl(i),o))}(n,e)}function iA(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function m_(n){return(e,t)=>{let i=!1;for(const o of fl(n)){const a=sA(o,e,t);if(a!==0)return a;i=i||o.field.isKeyField()}return 0}}function sA(n,e,t){const i=n.field.isKeyField()?Ce.comparator(e.key,t.key):function(a,c,d){const p=c.data.field(a),m=d.data.field(a);return p!==null&&m!==null?zo(p,m):De()}(n.field,e,t);switch(n.dir){case"asc":return i;case"desc":return-1*i;default:return De()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class js{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i!==void 0){for(const[o,a]of i)if(this.equalsFn(o,e))return a}}has(e){return this.get(e)!==void 0}set(e,t){const i=this.mapKeyFn(e),o=this.inner[i];if(o===void 0)return this.inner[i]=[[e,t]],void this.innerSize++;for(let a=0;a<o.length;a++)if(this.equalsFn(o[a][0],e))return void(o[a]=[e,t]);o.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i===void 0)return!1;for(let o=0;o<i.length;o++)if(this.equalsFn(i[o][0],e))return i.length===1?delete this.inner[t]:i.splice(o,1),this.innerSize--,!0;return!1}forEach(e){Ds(this.inner,(t,i)=>{for(const[o,a]of i)e(o,a)})}isEmpty(){return s_(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oA=new ut(Ce.comparator);function ni(){return oA}const g_=new ut(Ce.comparator);function al(...n){let e=g_;for(const t of n)e=e.insert(t.key,t);return e}function y_(n){let e=g_;return n.forEach((t,i)=>e=e.insert(t,i.overlayedDocument)),e}function As(){return pl()}function v_(){return pl()}function pl(){return new js(n=>n.toString(),(n,e)=>n.isEqual(e))}const aA=new ut(Ce.comparator),lA=new kt(Ce.comparator);function Be(...n){let e=lA;for(const t of n)e=e.add(t);return e}const cA=new kt($e);function uA(){return cA}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yp(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Du(e)?"-0":e}}function __(n){return{integerValue:""+n}}function dA(n,e){return VR(e)?__(e):yp(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class id{constructor(){this._=void 0}}function hA(n,e,t){return n instanceof Lu?function(o,a){const c={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:o.seconds,nanos:o.nanoseconds}}}};return a&&hp(a)&&(a=ed(a)),a&&(c.fields.__previous_value__=a),{mapValue:c}}(t,e):n instanceof Sl?w_(n,e):n instanceof xl?T_(n,e):function(o,a){const c=E_(o,a),d=Zy(c)+Zy(o.Pe);return Sf(c)&&Sf(o.Pe)?__(d):yp(o.serializer,d)}(n,e)}function fA(n,e,t){return n instanceof Sl?w_(n,e):n instanceof xl?T_(n,e):t}function E_(n,e){return n instanceof Mu?function(i){return Sf(i)||function(a){return!!a&&"doubleValue"in a}(i)}(e)?e:{integerValue:0}:null}class Lu extends id{}class Sl extends id{constructor(e){super(),this.elements=e}}function w_(n,e){const t=S_(e);for(const i of n.elements)t.some(o=>Sr(o,i))||t.push(i);return{arrayValue:{values:t}}}class xl extends id{constructor(e){super(),this.elements=e}}function T_(n,e){let t=S_(e);for(const i of n.elements)t=t.filter(o=>!Sr(o,i));return{arrayValue:{values:t}}}class Mu extends id{constructor(e,t){super(),this.serializer=e,this.Pe=t}}function Zy(n){return gt(n.integerValue||n.doubleValue)}function S_(n){return fp(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}function pA(n,e){return n.field.isEqual(e.field)&&function(i,o){return i instanceof Sl&&o instanceof Sl||i instanceof xl&&o instanceof xl?Bo(i.elements,o.elements,Sr):i instanceof Mu&&o instanceof Mu?Sr(i.Pe,o.Pe):i instanceof Lu&&o instanceof Lu}(n.transform,e.transform)}class mA{constructor(e,t){this.version=e,this.transformResults=t}}class Jr{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Jr}static exists(e){return new Jr(void 0,e)}static updateTime(e){return new Jr(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Tu(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class sd{}function x_(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new R_(n.key,Jr.none()):new Vl(n.key,n.data,Jr.none());{const t=n.data,i=Dn.empty();let o=new kt(zt.comparator);for(let a of e.fields)if(!o.has(a)){let c=t.field(a);c===null&&a.length>1&&(a=a.popLast(),c=t.field(a)),c===null?i.delete(a):i.set(a,c),o=o.add(a)}return new Os(n.key,i,new rr(o.toArray()),Jr.none())}}function gA(n,e,t){n instanceof Vl?function(o,a,c){const d=o.value.clone(),p=tv(o.fieldTransforms,a,c.transformResults);d.setAll(p),a.convertToFoundDocument(c.version,d).setHasCommittedMutations()}(n,e,t):n instanceof Os?function(o,a,c){if(!Tu(o.precondition,a))return void a.convertToUnknownDocument(c.version);const d=tv(o.fieldTransforms,a,c.transformResults),p=a.data;p.setAll(I_(o)),p.setAll(d),a.convertToFoundDocument(c.version,p).setHasCommittedMutations()}(n,e,t):function(o,a,c){a.convertToNoDocument(c.version).setHasCommittedMutations()}(0,e,t)}function ml(n,e,t,i){return n instanceof Vl?function(a,c,d,p){if(!Tu(a.precondition,c))return d;const m=a.value.clone(),v=nv(a.fieldTransforms,p,c);return m.setAll(v),c.convertToFoundDocument(c.version,m).setHasLocalMutations(),null}(n,e,t,i):n instanceof Os?function(a,c,d,p){if(!Tu(a.precondition,c))return d;const m=nv(a.fieldTransforms,p,c),v=c.data;return v.setAll(I_(a)),v.setAll(m),c.convertToFoundDocument(c.version,v).setHasLocalMutations(),d===null?null:d.unionWith(a.fieldMask.fields).unionWith(a.fieldTransforms.map(E=>E.field))}(n,e,t,i):function(a,c,d){return Tu(a.precondition,c)?(c.convertToNoDocument(c.version).setHasLocalMutations(),null):d}(n,e,t)}function yA(n,e){let t=null;for(const i of n.fieldTransforms){const o=e.data.field(i.field),a=E_(i.transform,o||null);a!=null&&(t===null&&(t=Dn.empty()),t.set(i.field,a))}return t||null}function ev(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(i,o){return i===void 0&&o===void 0||!(!i||!o)&&Bo(i,o,(a,c)=>pA(a,c))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class Vl extends sd{constructor(e,t,i,o=[]){super(),this.key=e,this.value=t,this.precondition=i,this.fieldTransforms=o,this.type=0}getFieldMask(){return null}}class Os extends sd{constructor(e,t,i,o,a=[]){super(),this.key=e,this.data=t,this.fieldMask=i,this.precondition=o,this.fieldTransforms=a,this.type=1}getFieldMask(){return this.fieldMask}}function I_(n){const e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const i=n.data.field(t);e.set(t,i)}}),e}function tv(n,e,t){const i=new Map;Ke(n.length===t.length);for(let o=0;o<t.length;o++){const a=n[o],c=a.transform,d=e.data.field(a.field);i.set(a.field,fA(c,d,t[o]))}return i}function nv(n,e,t){const i=new Map;for(const o of n){const a=o.transform,c=t.data.field(o.field);i.set(o.field,hA(a,c,e))}return i}class R_ extends sd{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class vA extends sd{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _A{constructor(e,t,i,o){this.batchId=e,this.localWriteTime=t,this.baseMutations=i,this.mutations=o}applyToRemoteDocument(e,t){const i=t.mutationResults;for(let o=0;o<this.mutations.length;o++){const a=this.mutations[o];a.key.isEqual(e.key)&&gA(a,e,i[o])}}applyToLocalView(e,t){for(const i of this.baseMutations)i.key.isEqual(e.key)&&(t=ml(i,e,t,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(e.key)&&(t=ml(i,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const i=v_();return this.mutations.forEach(o=>{const a=e.get(o.key),c=a.overlayedDocument;let d=this.applyToLocalView(c,a.mutatedFields);d=t.has(o.key)?null:d;const p=x_(c,d);p!==null&&i.set(o.key,p),c.isValidDocument()||c.convertToNoDocument(je.min())}),i}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),Be())}isEqual(e){return this.batchId===e.batchId&&Bo(this.mutations,e.mutations,(t,i)=>ev(t,i))&&Bo(this.baseMutations,e.baseMutations,(t,i)=>ev(t,i))}}class vp{constructor(e,t,i,o){this.batch=e,this.commitVersion=t,this.mutationResults=i,this.docVersions=o}static from(e,t,i){Ke(e.mutations.length===i.length);let o=function(){return aA}();const a=e.mutations;for(let c=0;c<a.length;c++)o=o.insert(a[c].key,i[c].version);return new vp(e,t,i,o)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EA{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wA{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Et,qe;function TA(n){switch(n){default:return De();case oe.CANCELLED:case oe.UNKNOWN:case oe.DEADLINE_EXCEEDED:case oe.RESOURCE_EXHAUSTED:case oe.INTERNAL:case oe.UNAVAILABLE:case oe.UNAUTHENTICATED:return!1;case oe.INVALID_ARGUMENT:case oe.NOT_FOUND:case oe.ALREADY_EXISTS:case oe.PERMISSION_DENIED:case oe.FAILED_PRECONDITION:case oe.ABORTED:case oe.OUT_OF_RANGE:case oe.UNIMPLEMENTED:case oe.DATA_LOSS:return!0}}function A_(n){if(n===void 0)return ti("GRPC error has no .code"),oe.UNKNOWN;switch(n){case Et.OK:return oe.OK;case Et.CANCELLED:return oe.CANCELLED;case Et.UNKNOWN:return oe.UNKNOWN;case Et.DEADLINE_EXCEEDED:return oe.DEADLINE_EXCEEDED;case Et.RESOURCE_EXHAUSTED:return oe.RESOURCE_EXHAUSTED;case Et.INTERNAL:return oe.INTERNAL;case Et.UNAVAILABLE:return oe.UNAVAILABLE;case Et.UNAUTHENTICATED:return oe.UNAUTHENTICATED;case Et.INVALID_ARGUMENT:return oe.INVALID_ARGUMENT;case Et.NOT_FOUND:return oe.NOT_FOUND;case Et.ALREADY_EXISTS:return oe.ALREADY_EXISTS;case Et.PERMISSION_DENIED:return oe.PERMISSION_DENIED;case Et.FAILED_PRECONDITION:return oe.FAILED_PRECONDITION;case Et.ABORTED:return oe.ABORTED;case Et.OUT_OF_RANGE:return oe.OUT_OF_RANGE;case Et.UNIMPLEMENTED:return oe.UNIMPLEMENTED;case Et.DATA_LOSS:return oe.DATA_LOSS;default:return De()}}(qe=Et||(Et={}))[qe.OK=0]="OK",qe[qe.CANCELLED=1]="CANCELLED",qe[qe.UNKNOWN=2]="UNKNOWN",qe[qe.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",qe[qe.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",qe[qe.NOT_FOUND=5]="NOT_FOUND",qe[qe.ALREADY_EXISTS=6]="ALREADY_EXISTS",qe[qe.PERMISSION_DENIED=7]="PERMISSION_DENIED",qe[qe.UNAUTHENTICATED=16]="UNAUTHENTICATED",qe[qe.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",qe[qe.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",qe[qe.ABORTED=10]="ABORTED",qe[qe.OUT_OF_RANGE=11]="OUT_OF_RANGE",qe[qe.UNIMPLEMENTED=12]="UNIMPLEMENTED",qe[qe.INTERNAL=13]="INTERNAL",qe[qe.UNAVAILABLE=14]="UNAVAILABLE",qe[qe.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SA(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xA=new Mi([4294967295,4294967295],0);function rv(n){const e=SA().encode(n),t=new X0;return t.update(e),new Uint8Array(t.digest())}function iv(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),i=e.getUint32(4,!0),o=e.getUint32(8,!0),a=e.getUint32(12,!0);return[new Mi([t,i],0),new Mi([o,a],0)]}class _p{constructor(e,t,i){if(this.bitmap=e,this.padding=t,this.hashCount=i,t<0||t>=8)throw new ll(`Invalid padding: ${t}`);if(i<0)throw new ll(`Invalid hash count: ${i}`);if(e.length>0&&this.hashCount===0)throw new ll(`Invalid hash count: ${i}`);if(e.length===0&&t!==0)throw new ll(`Invalid padding when bitmap length is 0: ${t}`);this.Te=8*e.length-t,this.Ie=Mi.fromNumber(this.Te)}de(e,t,i){let o=e.add(t.multiply(Mi.fromNumber(i)));return o.compare(xA)===1&&(o=new Mi([o.getBits(0),o.getBits(1)],0)),o.modulo(this.Ie).toNumber()}Ee(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Te===0)return!1;const t=rv(e),[i,o]=iv(t);for(let a=0;a<this.hashCount;a++){const c=this.de(i,o,a);if(!this.Ee(c))return!1}return!0}static create(e,t,i){const o=e%8==0?0:8-e%8,a=new Uint8Array(Math.ceil(e/8)),c=new _p(a,o,t);return i.forEach(d=>c.insert(d)),c}insert(e){if(this.Te===0)return;const t=rv(e),[i,o]=iv(t);for(let a=0;a<this.hashCount;a++){const c=this.de(i,o,a);this.Ae(c)}}Ae(e){const t=Math.floor(e/8),i=e%8;this.bitmap[t]|=1<<i}}class ll extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class od{constructor(e,t,i,o,a){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=i,this.documentUpdates=o,this.resolvedLimboDocuments=a}static createSynthesizedRemoteEventForCurrentChange(e,t,i){const o=new Map;return o.set(e,Fl.createSynthesizedTargetChangeForCurrentChange(e,t,i)),new od(je.min(),o,new ut($e),ni(),Be())}}class Fl{constructor(e,t,i,o,a){this.resumeToken=e,this.current=t,this.addedDocuments=i,this.modifiedDocuments=o,this.removedDocuments=a}static createSynthesizedTargetChangeForCurrentChange(e,t,i){return new Fl(i,t,Be(),Be(),Be())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Su{constructor(e,t,i,o){this.Re=e,this.removedTargetIds=t,this.key=i,this.Ve=o}}class C_{constructor(e,t){this.targetId=e,this.me=t}}class k_{constructor(e,t,i=$t.EMPTY_BYTE_STRING,o=null){this.state=e,this.targetIds=t,this.resumeToken=i,this.cause=o}}class sv{constructor(){this.fe=0,this.ge=ov(),this.pe=$t.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=Be(),t=Be(),i=Be();return this.ge.forEach((o,a)=>{switch(a){case 0:e=e.add(o);break;case 2:t=t.add(o);break;case 1:i=i.add(o);break;default:De()}}),new Fl(this.pe,this.ye,e,t,i)}Ce(){this.we=!1,this.ge=ov()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,Ke(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class IA{constructor(e){this.Be=e,this.Le=new Map,this.ke=ni(),this.qe=du(),this.Qe=du(),this.Ke=new ut($e)}$e(e){for(const t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.Ue(t,e.Ve):this.We(t,e.key,e.Ve);for(const t of e.removedTargetIds)this.We(t,e.key,e.Ve)}Ge(e){this.forEachTarget(e,t=>{const i=this.ze(t);switch(e.state){case 0:this.je(t)&&i.De(e.resumeToken);break;case 1:i.Oe(),i.Se||i.Ce(),i.De(e.resumeToken);break;case 2:i.Oe(),i.Se||this.removeTarget(t);break;case 3:this.je(t)&&(i.Ne(),i.De(e.resumeToken));break;case 4:this.je(t)&&(this.He(t),i.De(e.resumeToken));break;default:De()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Le.forEach((i,o)=>{this.je(o)&&t(o)})}Je(e){const t=e.targetId,i=e.me.count,o=this.Ye(t);if(o){const a=o.target;if(If(a))if(i===0){const c=new Ce(a.path);this.We(t,c,Xt.newNoDocument(c,je.min()))}else Ke(i===1);else{const c=this.Ze(t);if(c!==i){const d=this.Xe(e),p=d?this.et(d,e,c):1;if(p!==0){this.He(t);const m=p===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ke=this.Ke.insert(t,m)}}}}}Xe(e){const t=e.me.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:i="",padding:o=0},hashCount:a=0}=t;let c,d;try{c=zi(i).toUint8Array()}catch(p){if(p instanceof o_)return Uo("Decoding the base64 bloom filter in existence filter failed ("+p.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw p}try{d=new _p(c,o,a)}catch(p){return Uo(p instanceof ll?"BloomFilter error: ":"Applying bloom filter failed: ",p),null}return d.Te===0?null:d}et(e,t,i){return t.me.count===i-this.rt(e,t.targetId)?0:2}rt(e,t){const i=this.Be.getRemoteKeysForTarget(t);let o=0;return i.forEach(a=>{const c=this.Be.nt(),d=`projects/${c.projectId}/databases/${c.database}/documents/${a.path.canonicalString()}`;e.mightContain(d)||(this.We(t,a,null),o++)}),o}it(e){const t=new Map;this.Le.forEach((a,c)=>{const d=this.Ye(c);if(d){if(a.current&&If(d.target)){const p=new Ce(d.target.path);this.st(p).has(c)||this.ot(c,p)||this.We(c,p,Xt.newNoDocument(p,e))}a.be&&(t.set(c,a.ve()),a.Ce())}});let i=Be();this.Qe.forEach((a,c)=>{let d=!0;c.forEachWhile(p=>{const m=this.Ye(p);return!m||m.purpose==="TargetPurposeLimboResolution"||(d=!1,!1)}),d&&(i=i.add(a))}),this.ke.forEach((a,c)=>c.setReadTime(e));const o=new od(e,t,this.Ke,this.ke,i);return this.ke=ni(),this.qe=du(),this.Qe=du(),this.Ke=new ut($e),o}Ue(e,t){if(!this.je(e))return;const i=this.ot(e,t.key)?2:0;this.ze(e).Fe(t.key,i),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e)),this.Qe=this.Qe.insert(t.key,this._t(t.key).add(e))}We(e,t,i){if(!this.je(e))return;const o=this.ze(e);this.ot(e,t)?o.Fe(t,1):o.Me(t),this.Qe=this.Qe.insert(t,this._t(t).delete(e)),this.Qe=this.Qe.insert(t,this._t(t).add(e)),i&&(this.ke=this.ke.insert(t,i))}removeTarget(e){this.Le.delete(e)}Ze(e){const t=this.ze(e).ve();return this.Be.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.ze(e).xe()}ze(e){let t=this.Le.get(e);return t||(t=new sv,this.Le.set(e,t)),t}_t(e){let t=this.Qe.get(e);return t||(t=new kt($e),this.Qe=this.Qe.insert(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new kt($e),this.qe=this.qe.insert(e,t)),t}je(e){const t=this.Ye(e)!==null;return t||ye("WatchChangeAggregator","Detected inactive target",e),t}Ye(e){const t=this.Le.get(e);return t&&t.Se?null:this.Be.ut(e)}He(e){this.Le.set(e,new sv),this.Be.getRemoteKeysForTarget(e).forEach(t=>{this.We(e,t,null)})}ot(e,t){return this.Be.getRemoteKeysForTarget(e).has(t)}}function du(){return new ut(Ce.comparator)}function ov(){return new ut(Ce.comparator)}const RA={asc:"ASCENDING",desc:"DESCENDING"},AA={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},CA={and:"AND",or:"OR"};class kA{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Af(n,e){return n.useProto3Json||Zu(e)?e:{value:e}}function Vu(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function b_(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function bA(n,e){return Vu(n,e.toTimestamp())}function wr(n){return Ke(!!n),je.fromTimestamp(function(t){const i=Bi(t);return new Ct(i.seconds,i.nanos)}(n))}function Ep(n,e){return Cf(n,e).canonicalString()}function Cf(n,e){const t=function(o){return new ft(["projects",o.projectId,"databases",o.database])}(n).child("documents");return e===void 0?t:t.child(e)}function N_(n){const e=ft.fromString(n);return Ke(L_(e)),e}function kf(n,e){return Ep(n.databaseId,e.path)}function tf(n,e){const t=N_(e);if(t.get(1)!==n.databaseId.projectId)throw new Ae(oe.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new Ae(oe.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new Ce(D_(t))}function P_(n,e){return Ep(n.databaseId,e)}function NA(n){const e=N_(n);return e.length===4?ft.emptyPath():D_(e)}function bf(n){return new ft(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function D_(n){return Ke(n.length>4&&n.get(4)==="documents"),n.popFirst(5)}function av(n,e,t){return{name:kf(n,e),fields:t.value.mapValue.fields}}function PA(n,e){let t;if("targetChange"in e){e.targetChange;const i=function(m){return m==="NO_CHANGE"?0:m==="ADD"?1:m==="REMOVE"?2:m==="CURRENT"?3:m==="RESET"?4:De()}(e.targetChange.targetChangeType||"NO_CHANGE"),o=e.targetChange.targetIds||[],a=function(m,v){return m.useProto3Json?(Ke(v===void 0||typeof v=="string"),$t.fromBase64String(v||"")):(Ke(v===void 0||v instanceof Buffer||v instanceof Uint8Array),$t.fromUint8Array(v||new Uint8Array))}(n,e.targetChange.resumeToken),c=e.targetChange.cause,d=c&&function(m){const v=m.code===void 0?oe.UNKNOWN:A_(m.code);return new Ae(v,m.message||"")}(c);t=new k_(i,o,a,d||null)}else if("documentChange"in e){e.documentChange;const i=e.documentChange;i.document,i.document.name,i.document.updateTime;const o=tf(n,i.document.name),a=wr(i.document.updateTime),c=i.document.createTime?wr(i.document.createTime):je.min(),d=new Dn({mapValue:{fields:i.document.fields}}),p=Xt.newFoundDocument(o,a,c,d),m=i.targetIds||[],v=i.removedTargetIds||[];t=new Su(m,v,p.key,p)}else if("documentDelete"in e){e.documentDelete;const i=e.documentDelete;i.document;const o=tf(n,i.document),a=i.readTime?wr(i.readTime):je.min(),c=Xt.newNoDocument(o,a),d=i.removedTargetIds||[];t=new Su([],d,c.key,c)}else if("documentRemove"in e){e.documentRemove;const i=e.documentRemove;i.document;const o=tf(n,i.document),a=i.removedTargetIds||[];t=new Su([],a,o,null)}else{if(!("filter"in e))return De();{e.filter;const i=e.filter;i.targetId;const{count:o=0,unchangedNames:a}=i,c=new wA(o,a),d=i.targetId;t=new C_(d,c)}}return t}function DA(n,e){let t;if(e instanceof Vl)t={update:av(n,e.key,e.value)};else if(e instanceof R_)t={delete:kf(n,e.key)};else if(e instanceof Os)t={update:av(n,e.key,e.data),updateMask:zA(e.fieldMask)};else{if(!(e instanceof vA))return De();t={verify:kf(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(i=>function(a,c){const d=c.transform;if(d instanceof Lu)return{fieldPath:c.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(d instanceof Sl)return{fieldPath:c.field.canonicalString(),appendMissingElements:{values:d.elements}};if(d instanceof xl)return{fieldPath:c.field.canonicalString(),removeAllFromArray:{values:d.elements}};if(d instanceof Mu)return{fieldPath:c.field.canonicalString(),increment:d.Pe};throw De()}(0,i))),e.precondition.isNone||(t.currentDocument=function(o,a){return a.updateTime!==void 0?{updateTime:bA(o,a.updateTime)}:a.exists!==void 0?{exists:a.exists}:De()}(n,e.precondition)),t}function jA(n,e){return n&&n.length>0?(Ke(e!==void 0),n.map(t=>function(o,a){let c=o.updateTime?wr(o.updateTime):wr(a);return c.isEqual(je.min())&&(c=wr(a)),new mA(c,o.transformResults||[])}(t,e))):[]}function OA(n,e){return{documents:[P_(n,e.path)]}}function LA(n,e){const t={structuredQuery:{}},i=e.path;let o;e.collectionGroup!==null?(o=i,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(o=i.popLast(),t.structuredQuery.from=[{collectionId:i.lastSegment()}]),t.parent=P_(n,o);const a=function(m){if(m.length!==0)return O_(xr.create(m,"and"))}(e.filters);a&&(t.structuredQuery.where=a);const c=function(m){if(m.length!==0)return m.map(v=>function(w){return{field:Po(w.field),direction:FA(w.dir)}}(v))}(e.orderBy);c&&(t.structuredQuery.orderBy=c);const d=Af(n,e.limit);return d!==null&&(t.structuredQuery.limit=d),e.startAt&&(t.structuredQuery.startAt=function(m){return{before:m.inclusive,values:m.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(m){return{before:!m.inclusive,values:m.position}}(e.endAt)),{ct:t,parent:o}}function MA(n){let e=NA(n.parent);const t=n.structuredQuery,i=t.from?t.from.length:0;let o=null;if(i>0){Ke(i===1);const v=t.from[0];v.allDescendants?o=v.collectionId:e=e.child(v.collectionId)}let a=[];t.where&&(a=function(E){const w=j_(E);return w instanceof xr&&u_(w)?w.getFilters():[w]}(t.where));let c=[];t.orderBy&&(c=function(E){return E.map(w=>function(R){return new Ou(Do(R.field),function(N){switch(N){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(R.direction))}(w))}(t.orderBy));let d=null;t.limit&&(d=function(E){let w;return w=typeof E=="object"?E.value:E,Zu(w)?null:w}(t.limit));let p=null;t.startAt&&(p=function(E){const w=!!E.before,S=E.values||[];return new ju(S,w)}(t.startAt));let m=null;return t.endAt&&(m=function(E){const w=!E.before,S=E.values||[];return new ju(S,w)}(t.endAt)),tA(e,o,c,a,d,"F",p,m)}function VA(n,e){const t=function(o){switch(o){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return De()}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function j_(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":const i=Do(t.unaryFilter.field);return At.create(i,"==",{doubleValue:NaN});case"IS_NULL":const o=Do(t.unaryFilter.field);return At.create(o,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const a=Do(t.unaryFilter.field);return At.create(a,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const c=Do(t.unaryFilter.field);return At.create(c,"!=",{nullValue:"NULL_VALUE"});default:return De()}}(n):n.fieldFilter!==void 0?function(t){return At.create(Do(t.fieldFilter.field),function(o){switch(o){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return De()}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return xr.create(t.compositeFilter.filters.map(i=>j_(i)),function(o){switch(o){case"AND":return"and";case"OR":return"or";default:return De()}}(t.compositeFilter.op))}(n):De()}function FA(n){return RA[n]}function UA(n){return AA[n]}function BA(n){return CA[n]}function Po(n){return{fieldPath:n.canonicalString()}}function Do(n){return zt.fromServerFormat(n.fieldPath)}function O_(n){return n instanceof At?function(t){if(t.op==="=="){if(Ky(t.value))return{unaryFilter:{field:Po(t.field),op:"IS_NAN"}};if(Wy(t.value))return{unaryFilter:{field:Po(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(Ky(t.value))return{unaryFilter:{field:Po(t.field),op:"IS_NOT_NAN"}};if(Wy(t.value))return{unaryFilter:{field:Po(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Po(t.field),op:UA(t.op),value:t.value}}}(n):n instanceof xr?function(t){const i=t.getFilters().map(o=>O_(o));return i.length===1?i[0]:{compositeFilter:{op:BA(t.op),filters:i}}}(n):De()}function zA(n){const e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function L_(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Di{constructor(e,t,i,o,a=je.min(),c=je.min(),d=$t.EMPTY_BYTE_STRING,p=null){this.target=e,this.targetId=t,this.purpose=i,this.sequenceNumber=o,this.snapshotVersion=a,this.lastLimboFreeSnapshotVersion=c,this.resumeToken=d,this.expectedCount=p}withSequenceNumber(e){return new Di(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Di(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Di(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Di(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $A{constructor(e){this.ht=e}}function HA(n){const e=MA({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Rf(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qA{constructor(){this.ln=new GA}addToCollectionParentIndex(e,t){return this.ln.add(t),Z.resolve()}getCollectionParents(e,t){return Z.resolve(this.ln.getEntries(t))}addFieldIndex(e,t){return Z.resolve()}deleteFieldIndex(e,t){return Z.resolve()}deleteAllFieldIndexes(e){return Z.resolve()}createTargetIndexes(e,t){return Z.resolve()}getDocumentsMatchingTarget(e,t){return Z.resolve(null)}getIndexType(e,t){return Z.resolve(0)}getFieldIndexes(e,t){return Z.resolve([])}getNextCollectionGroupToUpdate(e){return Z.resolve(null)}getMinOffset(e,t){return Z.resolve(Ui.min())}getMinOffsetFromCollectionGroup(e,t){return Z.resolve(Ui.min())}updateCollectionGroup(e,t,i){return Z.resolve()}updateIndexEntries(e,t){return Z.resolve()}}class GA{constructor(){this.index={}}add(e){const t=e.lastSegment(),i=e.popLast(),o=this.index[t]||new kt(ft.comparator),a=!o.has(i);return this.index[t]=o.add(i),a}has(e){const t=e.lastSegment(),i=e.popLast(),o=this.index[t];return o&&o.has(i)}getEntries(e){return(this.index[e]||new kt(ft.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lv={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class fn{static withCacheSize(e){return new fn(e,fn.DEFAULT_COLLECTION_PERCENTILE,fn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */fn.DEFAULT_COLLECTION_PERCENTILE=10,fn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,fn.DEFAULT=new fn(41943040,fn.DEFAULT_COLLECTION_PERCENTILE,fn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),fn.DISABLED=new fn(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ho{constructor(e){this.kn=e}next(){return this.kn+=2,this.kn}static qn(){return new Ho(0)}static Qn(){return new Ho(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cv([n,e],[t,i]){const o=$e(n,t);return o===0?$e(e,i):o}class WA{constructor(e){this.Gn=e,this.buffer=new kt(cv),this.zn=0}jn(){return++this.zn}Hn(e){const t=[e,this.jn()];if(this.buffer.size<this.Gn)this.buffer=this.buffer.add(t);else{const i=this.buffer.last();cv(t,i)<0&&(this.buffer=this.buffer.delete(i).add(t))}}get maxValue(){return this.buffer.last()[0]}}class KA{constructor(e,t,i){this.garbageCollector=e,this.asyncQueue=t,this.localStore=i,this.Jn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Yn(6e4)}stop(){this.Jn&&(this.Jn.cancel(),this.Jn=null)}get started(){return this.Jn!==null}Yn(e){ye("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.Jn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Jn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){ra(t)?ye("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",t):await na(t)}await this.Yn(3e5)})}}class QA{constructor(e,t){this.Zn=e,this.params=t}calculateTargetCount(e,t){return this.Zn.Xn(e).next(i=>Math.floor(t/100*i))}nthSequenceNumber(e,t){if(t===0)return Z.resolve(Ju.oe);const i=new WA(t);return this.Zn.forEachTarget(e,o=>i.Hn(o.sequenceNumber)).next(()=>this.Zn.er(e,o=>i.Hn(o))).next(()=>i.maxValue)}removeTargets(e,t,i){return this.Zn.removeTargets(e,t,i)}removeOrphanedDocuments(e,t){return this.Zn.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(ye("LruGarbageCollector","Garbage collection skipped; disabled"),Z.resolve(lv)):this.getCacheSize(e).next(i=>i<this.params.cacheSizeCollectionThreshold?(ye("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),lv):this.tr(e,t))}getCacheSize(e){return this.Zn.getCacheSize(e)}tr(e,t){let i,o,a,c,d,p,m;const v=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(E=>(E>this.params.maximumSequenceNumbersToCollect?(ye("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${E}`),o=this.params.maximumSequenceNumbersToCollect):o=E,c=Date.now(),this.nthSequenceNumber(e,o))).next(E=>(i=E,d=Date.now(),this.removeTargets(e,i,t))).next(E=>(a=E,p=Date.now(),this.removeOrphanedDocuments(e,i))).next(E=>(m=Date.now(),bo()<=Fe.DEBUG&&ye("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${c-v}ms
	Determined least recently used ${o} in `+(d-c)+`ms
	Removed ${a} targets in `+(p-d)+`ms
	Removed ${E} documents in `+(m-p)+`ms
Total Duration: ${m-v}ms`),Z.resolve({didRun:!0,sequenceNumbersCollected:o,targetsRemoved:a,documentsRemoved:E})))}}function YA(n,e){return new QA(n,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XA{constructor(){this.changes=new js(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Xt.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const i=this.changes.get(t);return i!==void 0?Z.resolve(i):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JA{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZA{constructor(e,t,i,o){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=i,this.indexManager=o}getDocument(e,t){let i=null;return this.documentOverlayCache.getOverlay(e,t).next(o=>(i=o,this.remoteDocumentCache.getEntry(e,t))).next(o=>(i!==null&&ml(i.mutation,o,rr.empty(),Ct.now()),o))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(i=>this.getLocalViewOfDocuments(e,i,Be()).next(()=>i))}getLocalViewOfDocuments(e,t,i=Be()){const o=As();return this.populateOverlays(e,o,t).next(()=>this.computeViews(e,t,o,i).next(a=>{let c=al();return a.forEach((d,p)=>{c=c.insert(d,p.overlayedDocument)}),c}))}getOverlayedDocuments(e,t){const i=As();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,Be()))}populateOverlays(e,t,i){const o=[];return i.forEach(a=>{t.has(a)||o.push(a)}),this.documentOverlayCache.getOverlays(e,o).next(a=>{a.forEach((c,d)=>{t.set(c,d)})})}computeViews(e,t,i,o){let a=ni();const c=pl(),d=function(){return pl()}();return t.forEach((p,m)=>{const v=i.get(m.key);o.has(m.key)&&(v===void 0||v.mutation instanceof Os)?a=a.insert(m.key,m):v!==void 0?(c.set(m.key,v.mutation.getFieldMask()),ml(v.mutation,m,v.mutation.getFieldMask(),Ct.now())):c.set(m.key,rr.empty())}),this.recalculateAndSaveOverlays(e,a).next(p=>(p.forEach((m,v)=>c.set(m,v)),t.forEach((m,v)=>{var E;return d.set(m,new JA(v,(E=c.get(m))!==null&&E!==void 0?E:null))}),d))}recalculateAndSaveOverlays(e,t){const i=pl();let o=new ut((c,d)=>c-d),a=Be();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(c=>{for(const d of c)d.keys().forEach(p=>{const m=t.get(p);if(m===null)return;let v=i.get(p)||rr.empty();v=d.applyToLocalView(m,v),i.set(p,v);const E=(o.get(d.batchId)||Be()).add(p);o=o.insert(d.batchId,E)})}).next(()=>{const c=[],d=o.getReverseIterator();for(;d.hasNext();){const p=d.getNext(),m=p.key,v=p.value,E=v_();v.forEach(w=>{if(!a.has(w)){const S=x_(t.get(w),i.get(w));S!==null&&E.set(w,S),a=a.add(w)}}),c.push(this.documentOverlayCache.saveOverlays(e,m,E))}return Z.waitFor(c)}).next(()=>i)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(i=>this.recalculateAndSaveOverlays(e,i))}getDocumentsMatchingQuery(e,t,i,o){return function(c){return Ce.isDocumentKey(c.path)&&c.collectionGroup===null&&c.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):nA(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,i,o):this.getDocumentsMatchingCollectionQuery(e,t,i,o)}getNextDocuments(e,t,i,o){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,i,o).next(a=>{const c=o-a.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,i.largestBatchId,o-a.size):Z.resolve(As());let d=-1,p=a;return c.next(m=>Z.forEach(m,(v,E)=>(d<E.largestBatchId&&(d=E.largestBatchId),a.get(v)?Z.resolve():this.remoteDocumentCache.getEntry(e,v).next(w=>{p=p.insert(v,w)}))).next(()=>this.populateOverlays(e,m,a)).next(()=>this.computeViews(e,p,m,Be())).next(v=>({batchId:d,changes:y_(v)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Ce(t)).next(i=>{let o=al();return i.isFoundDocument()&&(o=o.insert(i.key,i)),o})}getDocumentsMatchingCollectionGroupQuery(e,t,i,o){const a=t.collectionGroup;let c=al();return this.indexManager.getCollectionParents(e,a).next(d=>Z.forEach(d,p=>{const m=function(E,w){return new td(w,null,E.explicitOrderBy.slice(),E.filters.slice(),E.limit,E.limitType,E.startAt,E.endAt)}(t,p.child(a));return this.getDocumentsMatchingCollectionQuery(e,m,i,o).next(v=>{v.forEach((E,w)=>{c=c.insert(E,w)})})}).next(()=>c))}getDocumentsMatchingCollectionQuery(e,t,i,o){let a;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,i.largestBatchId).next(c=>(a=c,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,i,a,o))).next(c=>{a.forEach((p,m)=>{const v=m.getKey();c.get(v)===null&&(c=c.insert(v,Xt.newInvalidDocument(v)))});let d=al();return c.forEach((p,m)=>{const v=a.get(p);v!==void 0&&ml(v.mutation,m,rr.empty(),Ct.now()),rd(t,m)&&(d=d.insert(p,m))}),d})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eC{constructor(e){this.serializer=e,this.Tr=new Map,this.Ir=new Map}getBundleMetadata(e,t){return Z.resolve(this.Tr.get(t))}saveBundleMetadata(e,t){return this.Tr.set(t.id,function(o){return{id:o.id,version:o.version,createTime:wr(o.createTime)}}(t)),Z.resolve()}getNamedQuery(e,t){return Z.resolve(this.Ir.get(t))}saveNamedQuery(e,t){return this.Ir.set(t.name,function(o){return{name:o.name,query:HA(o.bundledQuery),readTime:wr(o.readTime)}}(t)),Z.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tC{constructor(){this.overlays=new ut(Ce.comparator),this.dr=new Map}getOverlay(e,t){return Z.resolve(this.overlays.get(t))}getOverlays(e,t){const i=As();return Z.forEach(t,o=>this.getOverlay(e,o).next(a=>{a!==null&&i.set(o,a)})).next(()=>i)}saveOverlays(e,t,i){return i.forEach((o,a)=>{this.Tt(e,t,a)}),Z.resolve()}removeOverlaysForBatchId(e,t,i){const o=this.dr.get(i);return o!==void 0&&(o.forEach(a=>this.overlays=this.overlays.remove(a)),this.dr.delete(i)),Z.resolve()}getOverlaysForCollection(e,t,i){const o=As(),a=t.length+1,c=new Ce(t.child("")),d=this.overlays.getIteratorFrom(c);for(;d.hasNext();){const p=d.getNext().value,m=p.getKey();if(!t.isPrefixOf(m.path))break;m.path.length===a&&p.largestBatchId>i&&o.set(p.getKey(),p)}return Z.resolve(o)}getOverlaysForCollectionGroup(e,t,i,o){let a=new ut((m,v)=>m-v);const c=this.overlays.getIterator();for(;c.hasNext();){const m=c.getNext().value;if(m.getKey().getCollectionGroup()===t&&m.largestBatchId>i){let v=a.get(m.largestBatchId);v===null&&(v=As(),a=a.insert(m.largestBatchId,v)),v.set(m.getKey(),m)}}const d=As(),p=a.getIterator();for(;p.hasNext()&&(p.getNext().value.forEach((m,v)=>d.set(m,v)),!(d.size()>=o)););return Z.resolve(d)}Tt(e,t,i){const o=this.overlays.get(i.key);if(o!==null){const c=this.dr.get(o.largestBatchId).delete(i.key);this.dr.set(o.largestBatchId,c)}this.overlays=this.overlays.insert(i.key,new EA(t,i));let a=this.dr.get(t);a===void 0&&(a=Be(),this.dr.set(t,a)),this.dr.set(t,a.add(i.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nC{constructor(){this.sessionToken=$t.EMPTY_BYTE_STRING}getSessionToken(e){return Z.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,Z.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wp{constructor(){this.Er=new kt(Ot.Ar),this.Rr=new kt(Ot.Vr)}isEmpty(){return this.Er.isEmpty()}addReference(e,t){const i=new Ot(e,t);this.Er=this.Er.add(i),this.Rr=this.Rr.add(i)}mr(e,t){e.forEach(i=>this.addReference(i,t))}removeReference(e,t){this.gr(new Ot(e,t))}pr(e,t){e.forEach(i=>this.removeReference(i,t))}yr(e){const t=new Ce(new ft([])),i=new Ot(t,e),o=new Ot(t,e+1),a=[];return this.Rr.forEachInRange([i,o],c=>{this.gr(c),a.push(c.key)}),a}wr(){this.Er.forEach(e=>this.gr(e))}gr(e){this.Er=this.Er.delete(e),this.Rr=this.Rr.delete(e)}Sr(e){const t=new Ce(new ft([])),i=new Ot(t,e),o=new Ot(t,e+1);let a=Be();return this.Rr.forEachInRange([i,o],c=>{a=a.add(c.key)}),a}containsKey(e){const t=new Ot(e,0),i=this.Er.firstAfterOrEqual(t);return i!==null&&e.isEqual(i.key)}}class Ot{constructor(e,t){this.key=e,this.br=t}static Ar(e,t){return Ce.comparator(e.key,t.key)||$e(e.br,t.br)}static Vr(e,t){return $e(e.br,t.br)||Ce.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rC{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Dr=1,this.vr=new kt(Ot.Ar)}checkEmpty(e){return Z.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,i,o){const a=this.Dr;this.Dr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const c=new _A(a,t,i,o);this.mutationQueue.push(c);for(const d of o)this.vr=this.vr.add(new Ot(d.key,a)),this.indexManager.addToCollectionParentIndex(e,d.key.path.popLast());return Z.resolve(c)}lookupMutationBatch(e,t){return Z.resolve(this.Cr(t))}getNextMutationBatchAfterBatchId(e,t){const i=t+1,o=this.Fr(i),a=o<0?0:o;return Z.resolve(this.mutationQueue.length>a?this.mutationQueue[a]:null)}getHighestUnacknowledgedBatchId(){return Z.resolve(this.mutationQueue.length===0?-1:this.Dr-1)}getAllMutationBatches(e){return Z.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const i=new Ot(t,0),o=new Ot(t,Number.POSITIVE_INFINITY),a=[];return this.vr.forEachInRange([i,o],c=>{const d=this.Cr(c.br);a.push(d)}),Z.resolve(a)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new kt($e);return t.forEach(o=>{const a=new Ot(o,0),c=new Ot(o,Number.POSITIVE_INFINITY);this.vr.forEachInRange([a,c],d=>{i=i.add(d.br)})}),Z.resolve(this.Mr(i))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,o=i.length+1;let a=i;Ce.isDocumentKey(a)||(a=a.child(""));const c=new Ot(new Ce(a),0);let d=new kt($e);return this.vr.forEachWhile(p=>{const m=p.key.path;return!!i.isPrefixOf(m)&&(m.length===o&&(d=d.add(p.br)),!0)},c),Z.resolve(this.Mr(d))}Mr(e){const t=[];return e.forEach(i=>{const o=this.Cr(i);o!==null&&t.push(o)}),t}removeMutationBatch(e,t){Ke(this.Or(t.batchId,"removed")===0),this.mutationQueue.shift();let i=this.vr;return Z.forEach(t.mutations,o=>{const a=new Ot(o.key,t.batchId);return i=i.delete(a),this.referenceDelegate.markPotentiallyOrphaned(e,o.key)}).next(()=>{this.vr=i})}Bn(e){}containsKey(e,t){const i=new Ot(t,0),o=this.vr.firstAfterOrEqual(i);return Z.resolve(t.isEqual(o&&o.key))}performConsistencyCheck(e){return this.mutationQueue.length,Z.resolve()}Or(e,t){return this.Fr(e)}Fr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Cr(e){const t=this.Fr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iC{constructor(e){this.Nr=e,this.docs=function(){return new ut(Ce.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const i=t.key,o=this.docs.get(i),a=o?o.size:0,c=this.Nr(t);return this.docs=this.docs.insert(i,{document:t.mutableCopy(),size:c}),this.size+=c-a,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const i=this.docs.get(t);return Z.resolve(i?i.document.mutableCopy():Xt.newInvalidDocument(t))}getEntries(e,t){let i=ni();return t.forEach(o=>{const a=this.docs.get(o);i=i.insert(o,a?a.document.mutableCopy():Xt.newInvalidDocument(o))}),Z.resolve(i)}getDocumentsMatchingQuery(e,t,i,o){let a=ni();const c=t.path,d=new Ce(c.child("__id-9223372036854775808__")),p=this.docs.getIteratorFrom(d);for(;p.hasNext();){const{key:m,value:{document:v}}=p.getNext();if(!c.isPrefixOf(m.path))break;m.path.length>c.length+1||jR(DR(v),i)<=0||(o.has(v.key)||rd(t,v))&&(a=a.insert(v.key,v.mutableCopy()))}return Z.resolve(a)}getAllFromCollectionGroup(e,t,i,o){De()}Br(e,t){return Z.forEach(this.docs,i=>t(i))}newChangeBuffer(e){return new sC(this)}getSize(e){return Z.resolve(this.size)}}class sC extends XA{constructor(e){super(),this.hr=e}applyChanges(e){const t=[];return this.changes.forEach((i,o)=>{o.isValidDocument()?t.push(this.hr.addEntry(e,o)):this.hr.removeEntry(i)}),Z.waitFor(t)}getFromCache(e,t){return this.hr.getEntry(e,t)}getAllFromCache(e,t){return this.hr.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oC{constructor(e){this.persistence=e,this.Lr=new js(t=>pp(t),mp),this.lastRemoteSnapshotVersion=je.min(),this.highestTargetId=0,this.kr=0,this.qr=new wp,this.targetCount=0,this.Qr=Ho.qn()}forEachTarget(e,t){return this.Lr.forEach((i,o)=>t(o)),Z.resolve()}getLastRemoteSnapshotVersion(e){return Z.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Z.resolve(this.kr)}allocateTargetId(e){return this.highestTargetId=this.Qr.next(),Z.resolve(this.highestTargetId)}setTargetsMetadata(e,t,i){return i&&(this.lastRemoteSnapshotVersion=i),t>this.kr&&(this.kr=t),Z.resolve()}Un(e){this.Lr.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.Qr=new Ho(t),this.highestTargetId=t),e.sequenceNumber>this.kr&&(this.kr=e.sequenceNumber)}addTargetData(e,t){return this.Un(t),this.targetCount+=1,Z.resolve()}updateTargetData(e,t){return this.Un(t),Z.resolve()}removeTargetData(e,t){return this.Lr.delete(t.target),this.qr.yr(t.targetId),this.targetCount-=1,Z.resolve()}removeTargets(e,t,i){let o=0;const a=[];return this.Lr.forEach((c,d)=>{d.sequenceNumber<=t&&i.get(d.targetId)===null&&(this.Lr.delete(c),a.push(this.removeMatchingKeysForTargetId(e,d.targetId)),o++)}),Z.waitFor(a).next(()=>o)}getTargetCount(e){return Z.resolve(this.targetCount)}getTargetData(e,t){const i=this.Lr.get(t)||null;return Z.resolve(i)}addMatchingKeys(e,t,i){return this.qr.mr(t,i),Z.resolve()}removeMatchingKeys(e,t,i){this.qr.pr(t,i);const o=this.persistence.referenceDelegate,a=[];return o&&t.forEach(c=>{a.push(o.markPotentiallyOrphaned(e,c))}),Z.waitFor(a)}removeMatchingKeysForTargetId(e,t){return this.qr.yr(t),Z.resolve()}getMatchingKeysForTargetId(e,t){const i=this.qr.Sr(t);return Z.resolve(i)}containsKey(e,t){return Z.resolve(this.qr.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M_{constructor(e,t){this.Kr={},this.overlays={},this.$r=new Ju(0),this.Ur=!1,this.Ur=!0,this.Wr=new nC,this.referenceDelegate=e(this),this.Gr=new oC(this),this.indexManager=new qA,this.remoteDocumentCache=function(o){return new iC(o)}(i=>this.referenceDelegate.zr(i)),this.serializer=new $A(t),this.jr=new eC(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Ur=!1,Promise.resolve()}get started(){return this.Ur}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new tC,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let i=this.Kr[e.toKey()];return i||(i=new rC(t,this.referenceDelegate),this.Kr[e.toKey()]=i),i}getGlobalsCache(){return this.Wr}getTargetCache(){return this.Gr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.jr}runTransaction(e,t,i){ye("MemoryPersistence","Starting transaction:",e);const o=new aC(this.$r.next());return this.referenceDelegate.Hr(),i(o).next(a=>this.referenceDelegate.Jr(o).next(()=>a)).toPromise().then(a=>(o.raiseOnCommittedEvent(),a))}Yr(e,t){return Z.or(Object.values(this.Kr).map(i=>()=>i.containsKey(e,t)))}}class aC extends LR{constructor(e){super(),this.currentSequenceNumber=e}}class Tp{constructor(e){this.persistence=e,this.Zr=new wp,this.Xr=null}static ei(e){return new Tp(e)}get ti(){if(this.Xr)return this.Xr;throw De()}addReference(e,t,i){return this.Zr.addReference(i,t),this.ti.delete(i.toString()),Z.resolve()}removeReference(e,t,i){return this.Zr.removeReference(i,t),this.ti.add(i.toString()),Z.resolve()}markPotentiallyOrphaned(e,t){return this.ti.add(t.toString()),Z.resolve()}removeTarget(e,t){this.Zr.yr(t.targetId).forEach(o=>this.ti.add(o.toString()));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,t.targetId).next(o=>{o.forEach(a=>this.ti.add(a.toString()))}).next(()=>i.removeTargetData(e,t))}Hr(){this.Xr=new Set}Jr(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Z.forEach(this.ti,i=>{const o=Ce.fromPath(i);return this.ni(e,o).next(a=>{a||t.removeEntry(o,je.min())})}).next(()=>(this.Xr=null,t.apply(e)))}updateLimboDocument(e,t){return this.ni(e,t).next(i=>{i?this.ti.delete(t.toString()):this.ti.add(t.toString())})}zr(e){return 0}ni(e,t){return Z.or([()=>Z.resolve(this.Zr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Yr(e,t)])}}class Fu{constructor(e,t){this.persistence=e,this.ri=new js(i=>FR(i.path),(i,o)=>i.isEqual(o)),this.garbageCollector=YA(this,t)}static ei(e,t){return new Fu(e,t)}Hr(){}Jr(e){return Z.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}Xn(e){const t=this.nr(e);return this.persistence.getTargetCache().getTargetCount(e).next(i=>t.next(o=>i+o))}nr(e){let t=0;return this.er(e,i=>{t++}).next(()=>t)}er(e,t){return Z.forEach(this.ri,(i,o)=>this.ir(e,i,o).next(a=>a?Z.resolve():t(o)))}removeTargets(e,t,i){return this.persistence.getTargetCache().removeTargets(e,t,i)}removeOrphanedDocuments(e,t){let i=0;const o=this.persistence.getRemoteDocumentCache(),a=o.newChangeBuffer();return o.Br(e,c=>this.ir(e,c,t).next(d=>{d||(i++,a.removeEntry(c,je.min()))})).next(()=>a.apply(e)).next(()=>i)}markPotentiallyOrphaned(e,t){return this.ri.set(t,e.currentSequenceNumber),Z.resolve()}removeTarget(e,t){const i=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,i)}addReference(e,t,i){return this.ri.set(i,e.currentSequenceNumber),Z.resolve()}removeReference(e,t,i){return this.ri.set(i,e.currentSequenceNumber),Z.resolve()}updateLimboDocument(e,t){return this.ri.set(t,e.currentSequenceNumber),Z.resolve()}zr(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Eu(e.data.value)),t}ir(e,t,i){return Z.or([()=>this.persistence.Yr(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const o=this.ri.get(t);return Z.resolve(o!==void 0&&o>i)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sp{constructor(e,t,i,o){this.targetId=e,this.fromCache=t,this.Wi=i,this.Gi=o}static zi(e,t){let i=Be(),o=Be();for(const a of t.docChanges)switch(a.type){case 0:i=i.add(a.doc.key);break;case 1:o=o.add(a.doc.key)}return new Sp(e,t.fromCache,i,o)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lC{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cC{constructor(){this.ji=!1,this.Hi=!1,this.Ji=100,this.Yi=function(){return $T()?8:MR(Jt())>0?6:4}()}initialize(e,t){this.Zi=e,this.indexManager=t,this.ji=!0}getDocumentsMatchingQuery(e,t,i,o){const a={result:null};return this.Xi(e,t).next(c=>{a.result=c}).next(()=>{if(!a.result)return this.es(e,t,o,i).next(c=>{a.result=c})}).next(()=>{if(a.result)return;const c=new lC;return this.ts(e,t,c).next(d=>{if(a.result=d,this.Hi)return this.ns(e,t,c,d.size)})}).next(()=>a.result)}ns(e,t,i,o){return i.documentReadCount<this.Ji?(bo()<=Fe.DEBUG&&ye("QueryEngine","SDK will not create cache indexes for query:",No(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Ji,"documents"),Z.resolve()):(bo()<=Fe.DEBUG&&ye("QueryEngine","Query:",No(t),"scans",i.documentReadCount,"local documents and returns",o,"documents as results."),i.documentReadCount>this.Yi*o?(bo()<=Fe.DEBUG&&ye("QueryEngine","The SDK decides to create cache indexes for query:",No(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Er(t))):Z.resolve())}Xi(e,t){if(Jy(t))return Z.resolve(null);let i=Er(t);return this.indexManager.getIndexType(e,i).next(o=>o===0?null:(t.limit!==null&&o===1&&(t=Rf(t,null,"F"),i=Er(t)),this.indexManager.getDocumentsMatchingTarget(e,i).next(a=>{const c=Be(...a);return this.Zi.getDocuments(e,c).next(d=>this.indexManager.getMinOffset(e,i).next(p=>{const m=this.rs(t,d);return this.ss(t,m,c,p.readTime)?this.Xi(e,Rf(t,null,"F")):this.os(e,m,t,p)}))})))}es(e,t,i,o){return Jy(t)||o.isEqual(je.min())?Z.resolve(null):this.Zi.getDocuments(e,i).next(a=>{const c=this.rs(t,a);return this.ss(t,c,i,o)?Z.resolve(null):(bo()<=Fe.DEBUG&&ye("QueryEngine","Re-using previous result from %s to execute query: %s",o.toString(),No(t)),this.os(e,c,t,PR(o,-1)).next(d=>d))})}rs(e,t){let i=new kt(m_(e));return t.forEach((o,a)=>{rd(e,a)&&(i=i.add(a))}),i}ss(e,t,i,o){if(e.limit===null)return!1;if(i.size!==t.size)return!0;const a=e.limitType==="F"?t.last():t.first();return!!a&&(a.hasPendingWrites||a.version.compareTo(o)>0)}ts(e,t,i){return bo()<=Fe.DEBUG&&ye("QueryEngine","Using full collection scan to execute query:",No(t)),this.Zi.getDocumentsMatchingQuery(e,t,Ui.min(),i)}os(e,t,i,o){return this.Zi.getDocumentsMatchingQuery(e,i,o).next(a=>(t.forEach(c=>{a=a.insert(c.key,c)}),a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uC{constructor(e,t,i,o){this.persistence=e,this._s=t,this.serializer=o,this.us=new ut($e),this.cs=new js(a=>pp(a),mp),this.ls=new Map,this.hs=e.getRemoteDocumentCache(),this.Gr=e.getTargetCache(),this.jr=e.getBundleCache(),this.Ps(i)}Ps(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new ZA(this.hs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.hs.setIndexManager(this.indexManager),this._s.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.us))}}function dC(n,e,t,i){return new uC(n,e,t,i)}async function V_(n,e){const t=Le(n);return await t.persistence.runTransaction("Handle user change","readonly",i=>{let o;return t.mutationQueue.getAllMutationBatches(i).next(a=>(o=a,t.Ps(e),t.mutationQueue.getAllMutationBatches(i))).next(a=>{const c=[],d=[];let p=Be();for(const m of o){c.push(m.batchId);for(const v of m.mutations)p=p.add(v.key)}for(const m of a){d.push(m.batchId);for(const v of m.mutations)p=p.add(v.key)}return t.localDocuments.getDocuments(i,p).next(m=>({Ts:m,removedBatchIds:c,addedBatchIds:d}))})})}function hC(n,e){const t=Le(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",i=>{const o=e.batch.keys(),a=t.hs.newChangeBuffer({trackRemovals:!0});return function(d,p,m,v){const E=m.batch,w=E.keys();let S=Z.resolve();return w.forEach(R=>{S=S.next(()=>v.getEntry(p,R)).next(j=>{const N=m.docVersions.get(R);Ke(N!==null),j.version.compareTo(N)<0&&(E.applyToRemoteDocument(j,m),j.isValidDocument()&&(j.setReadTime(m.commitVersion),v.addEntry(j)))})}),S.next(()=>d.mutationQueue.removeMutationBatch(p,E))}(t,i,e,a).next(()=>a.apply(i)).next(()=>t.mutationQueue.performConsistencyCheck(i)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(i,o,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,function(d){let p=Be();for(let m=0;m<d.mutationResults.length;++m)d.mutationResults[m].transformResults.length>0&&(p=p.add(d.batch.mutations[m].key));return p}(e))).next(()=>t.localDocuments.getDocuments(i,o))})}function F_(n){const e=Le(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Gr.getLastRemoteSnapshotVersion(t))}function fC(n,e){const t=Le(n),i=e.snapshotVersion;let o=t.us;return t.persistence.runTransaction("Apply remote event","readwrite-primary",a=>{const c=t.hs.newChangeBuffer({trackRemovals:!0});o=t.us;const d=[];e.targetChanges.forEach((v,E)=>{const w=o.get(E);if(!w)return;d.push(t.Gr.removeMatchingKeys(a,v.removedDocuments,E).next(()=>t.Gr.addMatchingKeys(a,v.addedDocuments,E)));let S=w.withSequenceNumber(a.currentSequenceNumber);e.targetMismatches.get(E)!==null?S=S.withResumeToken($t.EMPTY_BYTE_STRING,je.min()).withLastLimboFreeSnapshotVersion(je.min()):v.resumeToken.approximateByteSize()>0&&(S=S.withResumeToken(v.resumeToken,i)),o=o.insert(E,S),function(j,N,O){return j.resumeToken.approximateByteSize()===0||N.snapshotVersion.toMicroseconds()-j.snapshotVersion.toMicroseconds()>=3e8?!0:O.addedDocuments.size+O.modifiedDocuments.size+O.removedDocuments.size>0}(w,S,v)&&d.push(t.Gr.updateTargetData(a,S))});let p=ni(),m=Be();if(e.documentUpdates.forEach(v=>{e.resolvedLimboDocuments.has(v)&&d.push(t.persistence.referenceDelegate.updateLimboDocument(a,v))}),d.push(pC(a,c,e.documentUpdates).next(v=>{p=v.Is,m=v.ds})),!i.isEqual(je.min())){const v=t.Gr.getLastRemoteSnapshotVersion(a).next(E=>t.Gr.setTargetsMetadata(a,a.currentSequenceNumber,i));d.push(v)}return Z.waitFor(d).next(()=>c.apply(a)).next(()=>t.localDocuments.getLocalViewOfDocuments(a,p,m)).next(()=>p)}).then(a=>(t.us=o,a))}function pC(n,e,t){let i=Be(),o=Be();return t.forEach(a=>i=i.add(a)),e.getEntries(n,i).next(a=>{let c=ni();return t.forEach((d,p)=>{const m=a.get(d);p.isFoundDocument()!==m.isFoundDocument()&&(o=o.add(d)),p.isNoDocument()&&p.version.isEqual(je.min())?(e.removeEntry(d,p.readTime),c=c.insert(d,p)):!m.isValidDocument()||p.version.compareTo(m.version)>0||p.version.compareTo(m.version)===0&&m.hasPendingWrites?(e.addEntry(p),c=c.insert(d,p)):ye("LocalStore","Ignoring outdated watch update for ",d,". Current version:",m.version," Watch version:",p.version)}),{Is:c,ds:o}})}function mC(n,e){const t=Le(n);return t.persistence.runTransaction("Get next mutation batch","readonly",i=>(e===void 0&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(i,e)))}function gC(n,e){const t=Le(n);return t.persistence.runTransaction("Allocate target","readwrite",i=>{let o;return t.Gr.getTargetData(i,e).next(a=>a?(o=a,Z.resolve(o)):t.Gr.allocateTargetId(i).next(c=>(o=new Di(e,c,"TargetPurposeListen",i.currentSequenceNumber),t.Gr.addTargetData(i,o).next(()=>o))))}).then(i=>{const o=t.us.get(i.targetId);return(o===null||i.snapshotVersion.compareTo(o.snapshotVersion)>0)&&(t.us=t.us.insert(i.targetId,i),t.cs.set(e,i.targetId)),i})}async function Nf(n,e,t){const i=Le(n),o=i.us.get(e),a=t?"readwrite":"readwrite-primary";try{t||await i.persistence.runTransaction("Release target",a,c=>i.persistence.referenceDelegate.removeTarget(c,o))}catch(c){if(!ra(c))throw c;ye("LocalStore",`Failed to update sequence numbers for target ${e}: ${c}`)}i.us=i.us.remove(e),i.cs.delete(o.target)}function uv(n,e,t){const i=Le(n);let o=je.min(),a=Be();return i.persistence.runTransaction("Execute query","readwrite",c=>function(p,m,v){const E=Le(p),w=E.cs.get(v);return w!==void 0?Z.resolve(E.us.get(w)):E.Gr.getTargetData(m,v)}(i,c,Er(e)).next(d=>{if(d)return o=d.lastLimboFreeSnapshotVersion,i.Gr.getMatchingKeysForTargetId(c,d.targetId).next(p=>{a=p})}).next(()=>i._s.getDocumentsMatchingQuery(c,e,t?o:je.min(),t?a:Be())).next(d=>(yC(i,iA(e),d),{documents:d,Es:a})))}function yC(n,e,t){let i=n.ls.get(e)||je.min();t.forEach((o,a)=>{a.readTime.compareTo(i)>0&&(i=a.readTime)}),n.ls.set(e,i)}class dv{constructor(){this.activeTargetIds=uA()}ps(e){this.activeTargetIds=this.activeTargetIds.add(e)}ys(e){this.activeTargetIds=this.activeTargetIds.delete(e)}gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class vC{constructor(){this._o=new dv,this.ao={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,i){}addLocalQueryTarget(e,t=!0){return t&&this._o.ps(e),this.ao[e]||"not-current"}updateQueryState(e,t,i){this.ao[e]=t}removeLocalQueryTarget(e){this._o.ys(e)}isLocalQueryTarget(e){return this._o.activeTargetIds.has(e)}clearQueryState(e){delete this.ao[e]}getAllActiveQueryTargets(){return this._o.activeTargetIds}isActiveQueryTarget(e){return this._o.activeTargetIds.has(e)}start(){return this._o=new dv,Promise.resolve()}handleUserChange(e,t,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _C{uo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hv{constructor(){this.co=()=>this.lo(),this.ho=()=>this.Po(),this.To=[],this.Io()}uo(e){this.To.push(e)}shutdown(){window.removeEventListener("online",this.co),window.removeEventListener("offline",this.ho)}Io(){window.addEventListener("online",this.co),window.addEventListener("offline",this.ho)}lo(){ye("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.To)e(0)}Po(){ye("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.To)e(1)}static p(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let hu=null;function nf(){return hu===null?hu=function(){return 268435456+Math.round(2147483648*Math.random())}():hu++,"0x"+hu.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EC={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wC{constructor(e){this.Eo=e.Eo,this.Ao=e.Ao}Ro(e){this.Vo=e}mo(e){this.fo=e}po(e){this.yo=e}onMessage(e){this.wo=e}close(){this.Ao()}send(e){this.Eo(e)}So(){this.Vo()}bo(){this.fo()}Do(e){this.yo(e)}vo(e){this.wo(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qt="WebChannelConnection";class TC extends class{get Co(){return!1}constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const i=t.ssl?"https":"http",o=encodeURIComponent(this.databaseId.projectId),a=encodeURIComponent(this.databaseId.database);this.Fo=i+"://"+t.host,this.Mo=`projects/${o}/databases/${a}`,this.xo=this.databaseId.database==="(default)"?`project_id=${o}`:`project_id=${o}&database_id=${a}`}Oo(t,i,o,a,c){const d=nf(),p=this.No(t,i.toUriEncodedString());ye("RestConnection",`Sending RPC '${t}' ${d}:`,p,o);const m={"google-cloud-resource-prefix":this.Mo,"x-goog-request-params":this.xo};return this.Bo(m,a,c),this.Lo(t,p,m,o).then(v=>(ye("RestConnection",`Received RPC '${t}' ${d}: `,v),v),v=>{throw Uo("RestConnection",`RPC '${t}' ${d} failed with error: `,v,"url: ",p,"request:",o),v})}ko(t,i,o,a,c,d){return this.Oo(t,i,o,a,c)}Bo(t,i,o){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+ta}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),i&&i.headers.forEach((a,c)=>t[c]=a),o&&o.headers.forEach((a,c)=>t[c]=a)}No(t,i){const o=EC[t];return`${this.Fo}/v1/${i}:${o}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Lo(e,t,i,o){const a=nf();return new Promise((c,d)=>{const p=new J0;p.setWithCredentials(!0),p.listenOnce(Z0.COMPLETE,()=>{try{switch(p.getLastErrorCode()){case _u.NO_ERROR:const v=p.getResponseJson();ye(Qt,`XHR for RPC '${e}' ${a} received:`,JSON.stringify(v)),c(v);break;case _u.TIMEOUT:ye(Qt,`RPC '${e}' ${a} timed out`),d(new Ae(oe.DEADLINE_EXCEEDED,"Request time out"));break;case _u.HTTP_ERROR:const E=p.getStatus();if(ye(Qt,`RPC '${e}' ${a} failed with status:`,E,"response text:",p.getResponseText()),E>0){let w=p.getResponseJson();Array.isArray(w)&&(w=w[0]);const S=w==null?void 0:w.error;if(S&&S.status&&S.message){const R=function(N){const O=N.toLowerCase().replace(/_/g,"-");return Object.values(oe).indexOf(O)>=0?O:oe.UNKNOWN}(S.status);d(new Ae(R,S.message))}else d(new Ae(oe.UNKNOWN,"Server responded with status "+p.getStatus()))}else d(new Ae(oe.UNAVAILABLE,"Connection failed."));break;default:De()}}finally{ye(Qt,`RPC '${e}' ${a} completed.`)}});const m=JSON.stringify(o);ye(Qt,`RPC '${e}' ${a} sending request:`,o),p.send(t,"POST",m,i,15)})}qo(e,t,i){const o=nf(),a=[this.Fo,"/","google.firestore.v1.Firestore","/",e,"/channel"],c=n_(),d=t_(),p={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},m=this.longPollingOptions.timeoutSeconds;m!==void 0&&(p.longPollingTimeout=Math.round(1e3*m)),this.useFetchStreams&&(p.useFetchStreams=!0),this.Bo(p.initMessageHeaders,t,i),p.encodeInitMessageHeaders=!0;const v=a.join("");ye(Qt,`Creating RPC '${e}' stream ${o}: ${v}`,p);const E=c.createWebChannel(v,p);let w=!1,S=!1;const R=new wC({Eo:N=>{S?ye(Qt,`Not sending because RPC '${e}' stream ${o} is closed:`,N):(w||(ye(Qt,`Opening RPC '${e}' stream ${o} transport.`),E.open(),w=!0),ye(Qt,`RPC '${e}' stream ${o} sending:`,N),E.send(N))},Ao:()=>E.close()}),j=(N,O,U)=>{N.listen(O,q=>{try{U(q)}catch(J){setTimeout(()=>{throw J},0)}})};return j(E,ol.EventType.OPEN,()=>{S||(ye(Qt,`RPC '${e}' stream ${o} transport opened.`),R.So())}),j(E,ol.EventType.CLOSE,()=>{S||(S=!0,ye(Qt,`RPC '${e}' stream ${o} transport closed`),R.Do())}),j(E,ol.EventType.ERROR,N=>{S||(S=!0,Uo(Qt,`RPC '${e}' stream ${o} transport errored:`,N),R.Do(new Ae(oe.UNAVAILABLE,"The operation could not be completed")))}),j(E,ol.EventType.MESSAGE,N=>{var O;if(!S){const U=N.data[0];Ke(!!U);const q=U,J=(q==null?void 0:q.error)||((O=q[0])===null||O===void 0?void 0:O.error);if(J){ye(Qt,`RPC '${e}' stream ${o} received error:`,J);const W=J.status;let Q=function(A){const P=Et[A];if(P!==void 0)return A_(P)}(W),k=J.message;Q===void 0&&(Q=oe.INTERNAL,k="Unknown error status: "+W+" with message "+J.message),S=!0,R.Do(new Ae(Q,k)),E.close()}else ye(Qt,`RPC '${e}' stream ${o} received:`,U),R.vo(U)}}),j(d,e_.STAT_EVENT,N=>{N.stat===wf.PROXY?ye(Qt,`RPC '${e}' stream ${o} detected buffering proxy`):N.stat===wf.NOPROXY&&ye(Qt,`RPC '${e}' stream ${o} detected no buffering proxy`)}),setTimeout(()=>{R.bo()},0),R}}function rf(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ad(n){return new kA(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U_{constructor(e,t,i=1e3,o=1.5,a=6e4){this.li=e,this.timerId=t,this.Qo=i,this.Ko=o,this.$o=a,this.Uo=0,this.Wo=null,this.Go=Date.now(),this.reset()}reset(){this.Uo=0}zo(){this.Uo=this.$o}jo(e){this.cancel();const t=Math.floor(this.Uo+this.Ho()),i=Math.max(0,Date.now()-this.Go),o=Math.max(0,t-i);o>0&&ye("ExponentialBackoff",`Backing off for ${o} ms (base delay: ${this.Uo} ms, delay with jitter: ${t} ms, last attempt: ${i} ms ago)`),this.Wo=this.li.enqueueAfterDelay(this.timerId,o,()=>(this.Go=Date.now(),e())),this.Uo*=this.Ko,this.Uo<this.Qo&&(this.Uo=this.Qo),this.Uo>this.$o&&(this.Uo=this.$o)}Jo(){this.Wo!==null&&(this.Wo.skipDelay(),this.Wo=null)}cancel(){this.Wo!==null&&(this.Wo.cancel(),this.Wo=null)}Ho(){return(Math.random()-.5)*this.Uo}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B_{constructor(e,t,i,o,a,c,d,p){this.li=e,this.Yo=i,this.Zo=o,this.connection=a,this.authCredentialsProvider=c,this.appCheckCredentialsProvider=d,this.listener=p,this.state=0,this.Xo=0,this.e_=null,this.t_=null,this.stream=null,this.n_=0,this.r_=new U_(e,t)}i_(){return this.state===1||this.state===5||this.s_()}s_(){return this.state===2||this.state===3}start(){this.n_=0,this.state!==4?this.auth():this.o_()}async stop(){this.i_()&&await this.close(0)}__(){this.state=0,this.r_.reset()}a_(){this.s_()&&this.e_===null&&(this.e_=this.li.enqueueAfterDelay(this.Yo,6e4,()=>this.u_()))}c_(e){this.l_(),this.stream.send(e)}async u_(){if(this.s_())return this.close(0)}l_(){this.e_&&(this.e_.cancel(),this.e_=null)}h_(){this.t_&&(this.t_.cancel(),this.t_=null)}async close(e,t){this.l_(),this.h_(),this.r_.cancel(),this.Xo++,e!==4?this.r_.reset():t&&t.code===oe.RESOURCE_EXHAUSTED?(ti(t.toString()),ti("Using maximum backoff delay to prevent overloading the backend."),this.r_.zo()):t&&t.code===oe.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.P_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.po(t)}P_(){}auth(){this.state=1;const e=this.T_(this.Xo),t=this.Xo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([i,o])=>{this.Xo===t&&this.I_(i,o)},i=>{e(()=>{const o=new Ae(oe.UNKNOWN,"Fetching auth token failed: "+i.message);return this.d_(o)})})}I_(e,t){const i=this.T_(this.Xo);this.stream=this.E_(e,t),this.stream.Ro(()=>{i(()=>this.listener.Ro())}),this.stream.mo(()=>{i(()=>(this.state=2,this.t_=this.li.enqueueAfterDelay(this.Zo,1e4,()=>(this.s_()&&(this.state=3),Promise.resolve())),this.listener.mo()))}),this.stream.po(o=>{i(()=>this.d_(o))}),this.stream.onMessage(o=>{i(()=>++this.n_==1?this.A_(o):this.onNext(o))})}o_(){this.state=5,this.r_.jo(async()=>{this.state=0,this.start()})}d_(e){return ye("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}T_(e){return t=>{this.li.enqueueAndForget(()=>this.Xo===e?t():(ye("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class SC extends B_{constructor(e,t,i,o,a,c){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,i,o,c),this.serializer=a}E_(e,t){return this.connection.qo("Listen",e,t)}A_(e){return this.onNext(e)}onNext(e){this.r_.reset();const t=PA(this.serializer,e),i=function(a){if(!("targetChange"in a))return je.min();const c=a.targetChange;return c.targetIds&&c.targetIds.length?je.min():c.readTime?wr(c.readTime):je.min()}(e);return this.listener.R_(t,i)}V_(e){const t={};t.database=bf(this.serializer),t.addTarget=function(a,c){let d;const p=c.target;if(d=If(p)?{documents:OA(a,p)}:{query:LA(a,p).ct},d.targetId=c.targetId,c.resumeToken.approximateByteSize()>0){d.resumeToken=b_(a,c.resumeToken);const m=Af(a,c.expectedCount);m!==null&&(d.expectedCount=m)}else if(c.snapshotVersion.compareTo(je.min())>0){d.readTime=Vu(a,c.snapshotVersion.toTimestamp());const m=Af(a,c.expectedCount);m!==null&&(d.expectedCount=m)}return d}(this.serializer,e);const i=VA(this.serializer,e);i&&(t.labels=i),this.c_(t)}m_(e){const t={};t.database=bf(this.serializer),t.removeTarget=e,this.c_(t)}}class xC extends B_{constructor(e,t,i,o,a,c){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,i,o,c),this.serializer=a}get f_(){return this.n_>0}start(){this.lastStreamToken=void 0,super.start()}P_(){this.f_&&this.g_([])}E_(e,t){return this.connection.qo("Write",e,t)}A_(e){return Ke(!!e.streamToken),this.lastStreamToken=e.streamToken,Ke(!e.writeResults||e.writeResults.length===0),this.listener.p_()}onNext(e){Ke(!!e.streamToken),this.lastStreamToken=e.streamToken,this.r_.reset();const t=jA(e.writeResults,e.commitTime),i=wr(e.commitTime);return this.listener.y_(i,t)}w_(){const e={};e.database=bf(this.serializer),this.c_(e)}g_(e){const t={streamToken:this.lastStreamToken,writes:e.map(i=>DA(this.serializer,i))};this.c_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IC extends class{}{constructor(e,t,i,o){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=i,this.serializer=o,this.S_=!1}b_(){if(this.S_)throw new Ae(oe.FAILED_PRECONDITION,"The client has already been terminated.")}Oo(e,t,i,o){return this.b_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,c])=>this.connection.Oo(e,Cf(t,i),o,a,c)).catch(a=>{throw a.name==="FirebaseError"?(a.code===oe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new Ae(oe.UNKNOWN,a.toString())})}ko(e,t,i,o,a){return this.b_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([c,d])=>this.connection.ko(e,Cf(t,i),o,c,d,a)).catch(c=>{throw c.name==="FirebaseError"?(c.code===oe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),c):new Ae(oe.UNKNOWN,c.toString())})}terminate(){this.S_=!0,this.connection.terminate()}}class RC{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.D_=0,this.v_=null,this.C_=!0}F_(){this.D_===0&&(this.M_("Unknown"),this.v_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.v_=null,this.x_("Backend didn't respond within 10 seconds."),this.M_("Offline"),Promise.resolve())))}O_(e){this.state==="Online"?this.M_("Unknown"):(this.D_++,this.D_>=1&&(this.N_(),this.x_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.M_("Offline")))}set(e){this.N_(),this.D_=0,e==="Online"&&(this.C_=!1),this.M_(e)}M_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}x_(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.C_?(ti(t),this.C_=!1):ye("OnlineStateTracker",t)}N_(){this.v_!==null&&(this.v_.cancel(),this.v_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AC{constructor(e,t,i,o,a){this.localStore=e,this.datastore=t,this.asyncQueue=i,this.remoteSyncer={},this.B_=[],this.L_=new Map,this.k_=new Set,this.q_=[],this.Q_=a,this.Q_.uo(c=>{i.enqueueAndForget(async()=>{Ls(this)&&(ye("RemoteStore","Restarting streams for network reachability change."),await async function(p){const m=Le(p);m.k_.add(4),await Ul(m),m.K_.set("Unknown"),m.k_.delete(4),await ld(m)}(this))})}),this.K_=new RC(i,o)}}async function ld(n){if(Ls(n))for(const e of n.q_)await e(!0)}async function Ul(n){for(const e of n.q_)await e(!1)}function z_(n,e){const t=Le(n);t.L_.has(e.targetId)||(t.L_.set(e.targetId,e),Ap(t)?Rp(t):ia(t).s_()&&Ip(t,e))}function xp(n,e){const t=Le(n),i=ia(t);t.L_.delete(e),i.s_()&&$_(t,e),t.L_.size===0&&(i.s_()?i.a_():Ls(t)&&t.K_.set("Unknown"))}function Ip(n,e){if(n.U_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(je.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}ia(n).V_(e)}function $_(n,e){n.U_.xe(e),ia(n).m_(e)}function Rp(n){n.U_=new IA({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),ut:e=>n.L_.get(e)||null,nt:()=>n.datastore.serializer.databaseId}),ia(n).start(),n.K_.F_()}function Ap(n){return Ls(n)&&!ia(n).i_()&&n.L_.size>0}function Ls(n){return Le(n).k_.size===0}function H_(n){n.U_=void 0}async function CC(n){n.K_.set("Online")}async function kC(n){n.L_.forEach((e,t)=>{Ip(n,e)})}async function bC(n,e){H_(n),Ap(n)?(n.K_.O_(e),Rp(n)):n.K_.set("Unknown")}async function NC(n,e,t){if(n.K_.set("Online"),e instanceof k_&&e.state===2&&e.cause)try{await async function(o,a){const c=a.cause;for(const d of a.targetIds)o.L_.has(d)&&(await o.remoteSyncer.rejectListen(d,c),o.L_.delete(d),o.U_.removeTarget(d))}(n,e)}catch(i){ye("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),i),await Uu(n,i)}else if(e instanceof Su?n.U_.$e(e):e instanceof C_?n.U_.Je(e):n.U_.Ge(e),!t.isEqual(je.min()))try{const i=await F_(n.localStore);t.compareTo(i)>=0&&await function(a,c){const d=a.U_.it(c);return d.targetChanges.forEach((p,m)=>{if(p.resumeToken.approximateByteSize()>0){const v=a.L_.get(m);v&&a.L_.set(m,v.withResumeToken(p.resumeToken,c))}}),d.targetMismatches.forEach((p,m)=>{const v=a.L_.get(p);if(!v)return;a.L_.set(p,v.withResumeToken($t.EMPTY_BYTE_STRING,v.snapshotVersion)),$_(a,p);const E=new Di(v.target,p,m,v.sequenceNumber);Ip(a,E)}),a.remoteSyncer.applyRemoteEvent(d)}(n,t)}catch(i){ye("RemoteStore","Failed to raise snapshot:",i),await Uu(n,i)}}async function Uu(n,e,t){if(!ra(e))throw e;n.k_.add(1),await Ul(n),n.K_.set("Offline"),t||(t=()=>F_(n.localStore)),n.asyncQueue.enqueueRetryable(async()=>{ye("RemoteStore","Retrying IndexedDB access"),await t(),n.k_.delete(1),await ld(n)})}function q_(n,e){return e().catch(t=>Uu(n,t,e))}async function cd(n){const e=Le(n),t=Hi(e);let i=e.B_.length>0?e.B_[e.B_.length-1].batchId:-1;for(;PC(e);)try{const o=await mC(e.localStore,i);if(o===null){e.B_.length===0&&t.a_();break}i=o.batchId,DC(e,o)}catch(o){await Uu(e,o)}G_(e)&&W_(e)}function PC(n){return Ls(n)&&n.B_.length<10}function DC(n,e){n.B_.push(e);const t=Hi(n);t.s_()&&t.f_&&t.g_(e.mutations)}function G_(n){return Ls(n)&&!Hi(n).i_()&&n.B_.length>0}function W_(n){Hi(n).start()}async function jC(n){Hi(n).w_()}async function OC(n){const e=Hi(n);for(const t of n.B_)e.g_(t.mutations)}async function LC(n,e,t){const i=n.B_.shift(),o=vp.from(i,e,t);await q_(n,()=>n.remoteSyncer.applySuccessfulWrite(o)),await cd(n)}async function MC(n,e){e&&Hi(n).f_&&await async function(i,o){if(function(c){return TA(c)&&c!==oe.ABORTED}(o.code)){const a=i.B_.shift();Hi(i).__(),await q_(i,()=>i.remoteSyncer.rejectFailedWrite(a.batchId,o)),await cd(i)}}(n,e),G_(n)&&W_(n)}async function fv(n,e){const t=Le(n);t.asyncQueue.verifyOperationInProgress(),ye("RemoteStore","RemoteStore received new credentials");const i=Ls(t);t.k_.add(3),await Ul(t),i&&t.K_.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.k_.delete(3),await ld(t)}async function VC(n,e){const t=Le(n);e?(t.k_.delete(2),await ld(t)):e||(t.k_.add(2),await Ul(t),t.K_.set("Unknown"))}function ia(n){return n.W_||(n.W_=function(t,i,o){const a=Le(t);return a.b_(),new SC(i,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,o)}(n.datastore,n.asyncQueue,{Ro:CC.bind(null,n),mo:kC.bind(null,n),po:bC.bind(null,n),R_:NC.bind(null,n)}),n.q_.push(async e=>{e?(n.W_.__(),Ap(n)?Rp(n):n.K_.set("Unknown")):(await n.W_.stop(),H_(n))})),n.W_}function Hi(n){return n.G_||(n.G_=function(t,i,o){const a=Le(t);return a.b_(),new xC(i,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,o)}(n.datastore,n.asyncQueue,{Ro:()=>Promise.resolve(),mo:jC.bind(null,n),po:MC.bind(null,n),p_:OC.bind(null,n),y_:LC.bind(null,n)}),n.q_.push(async e=>{e?(n.G_.__(),await cd(n)):(await n.G_.stop(),n.B_.length>0&&(ye("RemoteStore",`Stopping write stream with ${n.B_.length} pending writes`),n.B_=[]))})),n.G_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cp{constructor(e,t,i,o,a){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=i,this.op=o,this.removalCallback=a,this.deferred=new Vi,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(c=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,i,o,a){const c=Date.now()+i,d=new Cp(e,t,c,o,a);return d.start(i),d}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Ae(oe.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function kp(n,e){if(ti("AsyncQueue",`${e}: ${n}`),ra(n))return new Ae(oe.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mo{static emptySet(e){return new Mo(e.comparator)}constructor(e){this.comparator=e?(t,i)=>e(t,i)||Ce.comparator(t.key,i.key):(t,i)=>Ce.comparator(t.key,i.key),this.keyedMap=al(),this.sortedSet=new ut(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,i)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Mo)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;t.hasNext();){const o=t.getNext().key,a=i.getNext().key;if(!o.isEqual(a))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const i=new Mo;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=t,i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pv{constructor(){this.z_=new ut(Ce.comparator)}track(e){const t=e.doc.key,i=this.z_.get(t);i?e.type!==0&&i.type===3?this.z_=this.z_.insert(t,e):e.type===3&&i.type!==1?this.z_=this.z_.insert(t,{type:i.type,doc:e.doc}):e.type===2&&i.type===2?this.z_=this.z_.insert(t,{type:2,doc:e.doc}):e.type===2&&i.type===0?this.z_=this.z_.insert(t,{type:0,doc:e.doc}):e.type===1&&i.type===0?this.z_=this.z_.remove(t):e.type===1&&i.type===2?this.z_=this.z_.insert(t,{type:1,doc:i.doc}):e.type===0&&i.type===1?this.z_=this.z_.insert(t,{type:2,doc:e.doc}):De():this.z_=this.z_.insert(t,e)}j_(){const e=[];return this.z_.inorderTraversal((t,i)=>{e.push(i)}),e}}class qo{constructor(e,t,i,o,a,c,d,p,m){this.query=e,this.docs=t,this.oldDocs=i,this.docChanges=o,this.mutatedKeys=a,this.fromCache=c,this.syncStateChanged=d,this.excludesMetadataChanges=p,this.hasCachedResults=m}static fromInitialDocuments(e,t,i,o,a){const c=[];return t.forEach(d=>{c.push({type:0,doc:d})}),new qo(e,t,Mo.emptySet(t),c,i,o,!0,!1,a)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&nd(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,i=e.docChanges;if(t.length!==i.length)return!1;for(let o=0;o<t.length;o++)if(t[o].type!==i[o].type||!t[o].doc.isEqual(i[o].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FC{constructor(){this.H_=void 0,this.J_=[]}Y_(){return this.J_.some(e=>e.Z_())}}class UC{constructor(){this.queries=mv(),this.onlineState="Unknown",this.X_=new Set}terminate(){(function(t,i){const o=Le(t),a=o.queries;o.queries=mv(),a.forEach((c,d)=>{for(const p of d.J_)p.onError(i)})})(this,new Ae(oe.ABORTED,"Firestore shutting down"))}}function mv(){return new js(n=>p_(n),nd)}async function BC(n,e){const t=Le(n);let i=3;const o=e.query;let a=t.queries.get(o);a?!a.Y_()&&e.Z_()&&(i=2):(a=new FC,i=e.Z_()?0:1);try{switch(i){case 0:a.H_=await t.onListen(o,!0);break;case 1:a.H_=await t.onListen(o,!1);break;case 2:await t.onFirstRemoteStoreListen(o)}}catch(c){const d=kp(c,`Initialization of query '${No(e.query)}' failed`);return void e.onError(d)}t.queries.set(o,a),a.J_.push(e),e.ea(t.onlineState),a.H_&&e.ta(a.H_)&&bp(t)}async function zC(n,e){const t=Le(n),i=e.query;let o=3;const a=t.queries.get(i);if(a){const c=a.J_.indexOf(e);c>=0&&(a.J_.splice(c,1),a.J_.length===0?o=e.Z_()?0:1:!a.Y_()&&e.Z_()&&(o=2))}switch(o){case 0:return t.queries.delete(i),t.onUnlisten(i,!0);case 1:return t.queries.delete(i),t.onUnlisten(i,!1);case 2:return t.onLastRemoteStoreUnlisten(i);default:return}}function $C(n,e){const t=Le(n);let i=!1;for(const o of e){const a=o.query,c=t.queries.get(a);if(c){for(const d of c.J_)d.ta(o)&&(i=!0);c.H_=o}}i&&bp(t)}function HC(n,e,t){const i=Le(n),o=i.queries.get(e);if(o)for(const a of o.J_)a.onError(t);i.queries.delete(e)}function bp(n){n.X_.forEach(e=>{e.next()})}var Pf,gv;(gv=Pf||(Pf={})).na="default",gv.Cache="cache";class qC{constructor(e,t,i){this.query=e,this.ra=t,this.ia=!1,this.sa=null,this.onlineState="Unknown",this.options=i||{}}ta(e){if(!this.options.includeMetadataChanges){const i=[];for(const o of e.docChanges)o.type!==3&&i.push(o);e=new qo(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.ia?this.oa(e)&&(this.ra.next(e),t=!0):this._a(e,this.onlineState)&&(this.aa(e),t=!0),this.sa=e,t}onError(e){this.ra.error(e)}ea(e){this.onlineState=e;let t=!1;return this.sa&&!this.ia&&this._a(this.sa,e)&&(this.aa(this.sa),t=!0),t}_a(e,t){if(!e.fromCache||!this.Z_())return!0;const i=t!=="Offline";return(!this.options.ua||!i)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}oa(e){if(e.docChanges.length>0)return!0;const t=this.sa&&this.sa.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}aa(e){e=qo.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.ia=!0,this.ra.next(e)}Z_(){return this.options.source!==Pf.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K_{constructor(e){this.key=e}}class Q_{constructor(e){this.key=e}}class GC{constructor(e,t){this.query=e,this.Ea=t,this.Aa=null,this.hasCachedResults=!1,this.current=!1,this.Ra=Be(),this.mutatedKeys=Be(),this.Va=m_(e),this.ma=new Mo(this.Va)}get fa(){return this.Ea}ga(e,t){const i=t?t.pa:new pv,o=t?t.ma:this.ma;let a=t?t.mutatedKeys:this.mutatedKeys,c=o,d=!1;const p=this.query.limitType==="F"&&o.size===this.query.limit?o.last():null,m=this.query.limitType==="L"&&o.size===this.query.limit?o.first():null;if(e.inorderTraversal((v,E)=>{const w=o.get(v),S=rd(this.query,E)?E:null,R=!!w&&this.mutatedKeys.has(w.key),j=!!S&&(S.hasLocalMutations||this.mutatedKeys.has(S.key)&&S.hasCommittedMutations);let N=!1;w&&S?w.data.isEqual(S.data)?R!==j&&(i.track({type:3,doc:S}),N=!0):this.ya(w,S)||(i.track({type:2,doc:S}),N=!0,(p&&this.Va(S,p)>0||m&&this.Va(S,m)<0)&&(d=!0)):!w&&S?(i.track({type:0,doc:S}),N=!0):w&&!S&&(i.track({type:1,doc:w}),N=!0,(p||m)&&(d=!0)),N&&(S?(c=c.add(S),a=j?a.add(v):a.delete(v)):(c=c.delete(v),a=a.delete(v)))}),this.query.limit!==null)for(;c.size>this.query.limit;){const v=this.query.limitType==="F"?c.last():c.first();c=c.delete(v.key),a=a.delete(v.key),i.track({type:1,doc:v})}return{ma:c,pa:i,ss:d,mutatedKeys:a}}ya(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,i,o){const a=this.ma;this.ma=e.ma,this.mutatedKeys=e.mutatedKeys;const c=e.pa.j_();c.sort((v,E)=>function(S,R){const j=N=>{switch(N){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return De()}};return j(S)-j(R)}(v.type,E.type)||this.Va(v.doc,E.doc)),this.wa(i),o=o!=null&&o;const d=t&&!o?this.Sa():[],p=this.Ra.size===0&&this.current&&!o?1:0,m=p!==this.Aa;return this.Aa=p,c.length!==0||m?{snapshot:new qo(this.query,e.ma,a,c,e.mutatedKeys,p===0,m,!1,!!i&&i.resumeToken.approximateByteSize()>0),ba:d}:{ba:d}}ea(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({ma:this.ma,pa:new pv,mutatedKeys:this.mutatedKeys,ss:!1},!1)):{ba:[]}}Da(e){return!this.Ea.has(e)&&!!this.ma.has(e)&&!this.ma.get(e).hasLocalMutations}wa(e){e&&(e.addedDocuments.forEach(t=>this.Ea=this.Ea.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ea=this.Ea.delete(t)),this.current=e.current)}Sa(){if(!this.current)return[];const e=this.Ra;this.Ra=Be(),this.ma.forEach(i=>{this.Da(i.key)&&(this.Ra=this.Ra.add(i.key))});const t=[];return e.forEach(i=>{this.Ra.has(i)||t.push(new Q_(i))}),this.Ra.forEach(i=>{e.has(i)||t.push(new K_(i))}),t}va(e){this.Ea=e.Es,this.Ra=Be();const t=this.ga(e.documents);return this.applyChanges(t,!0)}Ca(){return qo.fromInitialDocuments(this.query,this.ma,this.mutatedKeys,this.Aa===0,this.hasCachedResults)}}class WC{constructor(e,t,i){this.query=e,this.targetId=t,this.view=i}}class KC{constructor(e){this.key=e,this.Fa=!1}}class QC{constructor(e,t,i,o,a,c){this.localStore=e,this.remoteStore=t,this.eventManager=i,this.sharedClientState=o,this.currentUser=a,this.maxConcurrentLimboResolutions=c,this.Ma={},this.xa=new js(d=>p_(d),nd),this.Oa=new Map,this.Na=new Set,this.Ba=new ut(Ce.comparator),this.La=new Map,this.ka=new wp,this.qa={},this.Qa=new Map,this.Ka=Ho.Qn(),this.onlineState="Unknown",this.$a=void 0}get isPrimaryClient(){return this.$a===!0}}async function YC(n,e,t=!0){const i=tE(n);let o;const a=i.xa.get(e);return a?(i.sharedClientState.addLocalQueryTarget(a.targetId),o=a.view.Ca()):o=await Y_(i,e,t,!0),o}async function XC(n,e){const t=tE(n);await Y_(t,e,!0,!1)}async function Y_(n,e,t,i){const o=await gC(n.localStore,Er(e)),a=o.targetId,c=n.sharedClientState.addLocalQueryTarget(a,t);let d;return i&&(d=await JC(n,e,a,c==="current",o.resumeToken)),n.isPrimaryClient&&t&&z_(n.remoteStore,o),d}async function JC(n,e,t,i,o){n.Ua=(E,w,S)=>async function(j,N,O,U){let q=N.view.ga(O);q.ss&&(q=await uv(j.localStore,N.query,!1).then(({documents:k})=>N.view.ga(k,q)));const J=U&&U.targetChanges.get(N.targetId),W=U&&U.targetMismatches.get(N.targetId)!=null,Q=N.view.applyChanges(q,j.isPrimaryClient,J,W);return vv(j,N.targetId,Q.ba),Q.snapshot}(n,E,w,S);const a=await uv(n.localStore,e,!0),c=new GC(e,a.Es),d=c.ga(a.documents),p=Fl.createSynthesizedTargetChangeForCurrentChange(t,i&&n.onlineState!=="Offline",o),m=c.applyChanges(d,n.isPrimaryClient,p);vv(n,t,m.ba);const v=new WC(e,t,c);return n.xa.set(e,v),n.Oa.has(t)?n.Oa.get(t).push(e):n.Oa.set(t,[e]),m.snapshot}async function ZC(n,e,t){const i=Le(n),o=i.xa.get(e),a=i.Oa.get(o.targetId);if(a.length>1)return i.Oa.set(o.targetId,a.filter(c=>!nd(c,e))),void i.xa.delete(e);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(o.targetId),i.sharedClientState.isActiveQueryTarget(o.targetId)||await Nf(i.localStore,o.targetId,!1).then(()=>{i.sharedClientState.clearQueryState(o.targetId),t&&xp(i.remoteStore,o.targetId),Df(i,o.targetId)}).catch(na)):(Df(i,o.targetId),await Nf(i.localStore,o.targetId,!0))}async function ek(n,e){const t=Le(n),i=t.xa.get(e),o=t.Oa.get(i.targetId);t.isPrimaryClient&&o.length===1&&(t.sharedClientState.removeLocalQueryTarget(i.targetId),xp(t.remoteStore,i.targetId))}async function tk(n,e,t){const i=lk(n);try{const o=await function(c,d){const p=Le(c),m=Ct.now(),v=d.reduce((S,R)=>S.add(R.key),Be());let E,w;return p.persistence.runTransaction("Locally write mutations","readwrite",S=>{let R=ni(),j=Be();return p.hs.getEntries(S,v).next(N=>{R=N,R.forEach((O,U)=>{U.isValidDocument()||(j=j.add(O))})}).next(()=>p.localDocuments.getOverlayedDocuments(S,R)).next(N=>{E=N;const O=[];for(const U of d){const q=yA(U,E.get(U.key).overlayedDocument);q!=null&&O.push(new Os(U.key,q,a_(q.value.mapValue),Jr.exists(!0)))}return p.mutationQueue.addMutationBatch(S,m,O,d)}).next(N=>{w=N;const O=N.applyToLocalDocumentSet(E,j);return p.documentOverlayCache.saveOverlays(S,N.batchId,O)})}).then(()=>({batchId:w.batchId,changes:y_(E)}))}(i.localStore,e);i.sharedClientState.addPendingMutation(o.batchId),function(c,d,p){let m=c.qa[c.currentUser.toKey()];m||(m=new ut($e)),m=m.insert(d,p),c.qa[c.currentUser.toKey()]=m}(i,o.batchId,t),await Bl(i,o.changes),await cd(i.remoteStore)}catch(o){const a=kp(o,"Failed to persist write");t.reject(a)}}async function X_(n,e){const t=Le(n);try{const i=await fC(t.localStore,e);e.targetChanges.forEach((o,a)=>{const c=t.La.get(a);c&&(Ke(o.addedDocuments.size+o.modifiedDocuments.size+o.removedDocuments.size<=1),o.addedDocuments.size>0?c.Fa=!0:o.modifiedDocuments.size>0?Ke(c.Fa):o.removedDocuments.size>0&&(Ke(c.Fa),c.Fa=!1))}),await Bl(t,i,e)}catch(i){await na(i)}}function yv(n,e,t){const i=Le(n);if(i.isPrimaryClient&&t===0||!i.isPrimaryClient&&t===1){const o=[];i.xa.forEach((a,c)=>{const d=c.view.ea(e);d.snapshot&&o.push(d.snapshot)}),function(c,d){const p=Le(c);p.onlineState=d;let m=!1;p.queries.forEach((v,E)=>{for(const w of E.J_)w.ea(d)&&(m=!0)}),m&&bp(p)}(i.eventManager,e),o.length&&i.Ma.R_(o),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function nk(n,e,t){const i=Le(n);i.sharedClientState.updateQueryState(e,"rejected",t);const o=i.La.get(e),a=o&&o.key;if(a){let c=new ut(Ce.comparator);c=c.insert(a,Xt.newNoDocument(a,je.min()));const d=Be().add(a),p=new od(je.min(),new Map,new ut($e),c,d);await X_(i,p),i.Ba=i.Ba.remove(a),i.La.delete(e),Np(i)}else await Nf(i.localStore,e,!1).then(()=>Df(i,e,t)).catch(na)}async function rk(n,e){const t=Le(n),i=e.batch.batchId;try{const o=await hC(t.localStore,e);Z_(t,i,null),J_(t,i),t.sharedClientState.updateMutationState(i,"acknowledged"),await Bl(t,o)}catch(o){await na(o)}}async function ik(n,e,t){const i=Le(n);try{const o=await function(c,d){const p=Le(c);return p.persistence.runTransaction("Reject batch","readwrite-primary",m=>{let v;return p.mutationQueue.lookupMutationBatch(m,d).next(E=>(Ke(E!==null),v=E.keys(),p.mutationQueue.removeMutationBatch(m,E))).next(()=>p.mutationQueue.performConsistencyCheck(m)).next(()=>p.documentOverlayCache.removeOverlaysForBatchId(m,v,d)).next(()=>p.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(m,v)).next(()=>p.localDocuments.getDocuments(m,v))})}(i.localStore,e);Z_(i,e,t),J_(i,e),i.sharedClientState.updateMutationState(e,"rejected",t),await Bl(i,o)}catch(o){await na(o)}}function J_(n,e){(n.Qa.get(e)||[]).forEach(t=>{t.resolve()}),n.Qa.delete(e)}function Z_(n,e,t){const i=Le(n);let o=i.qa[i.currentUser.toKey()];if(o){const a=o.get(e);a&&(t?a.reject(t):a.resolve(),o=o.remove(e)),i.qa[i.currentUser.toKey()]=o}}function Df(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const i of n.Oa.get(e))n.xa.delete(i),t&&n.Ma.Wa(i,t);n.Oa.delete(e),n.isPrimaryClient&&n.ka.yr(e).forEach(i=>{n.ka.containsKey(i)||eE(n,i)})}function eE(n,e){n.Na.delete(e.path.canonicalString());const t=n.Ba.get(e);t!==null&&(xp(n.remoteStore,t),n.Ba=n.Ba.remove(e),n.La.delete(t),Np(n))}function vv(n,e,t){for(const i of t)i instanceof K_?(n.ka.addReference(i.key,e),sk(n,i)):i instanceof Q_?(ye("SyncEngine","Document no longer in limbo: "+i.key),n.ka.removeReference(i.key,e),n.ka.containsKey(i.key)||eE(n,i.key)):De()}function sk(n,e){const t=e.key,i=t.path.canonicalString();n.Ba.get(t)||n.Na.has(i)||(ye("SyncEngine","New document in limbo: "+t),n.Na.add(i),Np(n))}function Np(n){for(;n.Na.size>0&&n.Ba.size<n.maxConcurrentLimboResolutions;){const e=n.Na.values().next().value;n.Na.delete(e);const t=new Ce(ft.fromString(e)),i=n.Ka.next();n.La.set(i,new KC(t)),n.Ba=n.Ba.insert(t,i),z_(n.remoteStore,new Di(Er(gp(t.path)),i,"TargetPurposeLimboResolution",Ju.oe))}}async function Bl(n,e,t){const i=Le(n),o=[],a=[],c=[];i.xa.isEmpty()||(i.xa.forEach((d,p)=>{c.push(i.Ua(p,e,t).then(m=>{var v;if((m||t)&&i.isPrimaryClient){const E=m?!m.fromCache:(v=t==null?void 0:t.targetChanges.get(p.targetId))===null||v===void 0?void 0:v.current;i.sharedClientState.updateQueryState(p.targetId,E?"current":"not-current")}if(m){o.push(m);const E=Sp.zi(p.targetId,m);a.push(E)}}))}),await Promise.all(c),i.Ma.R_(o),await async function(p,m){const v=Le(p);try{await v.persistence.runTransaction("notifyLocalViewChanges","readwrite",E=>Z.forEach(m,w=>Z.forEach(w.Wi,S=>v.persistence.referenceDelegate.addReference(E,w.targetId,S)).next(()=>Z.forEach(w.Gi,S=>v.persistence.referenceDelegate.removeReference(E,w.targetId,S)))))}catch(E){if(!ra(E))throw E;ye("LocalStore","Failed to update sequence numbers: "+E)}for(const E of m){const w=E.targetId;if(!E.fromCache){const S=v.us.get(w),R=S.snapshotVersion,j=S.withLastLimboFreeSnapshotVersion(R);v.us=v.us.insert(w,j)}}}(i.localStore,a))}async function ok(n,e){const t=Le(n);if(!t.currentUser.isEqual(e)){ye("SyncEngine","User change. New user:",e.toKey());const i=await V_(t.localStore,e);t.currentUser=e,function(a,c){a.Qa.forEach(d=>{d.forEach(p=>{p.reject(new Ae(oe.CANCELLED,c))})}),a.Qa.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),await Bl(t,i.Ts)}}function ak(n,e){const t=Le(n),i=t.La.get(e);if(i&&i.Fa)return Be().add(i.key);{let o=Be();const a=t.Oa.get(e);if(!a)return o;for(const c of a){const d=t.xa.get(c);o=o.unionWith(d.view.fa)}return o}}function tE(n){const e=Le(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=X_.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=ak.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=nk.bind(null,e),e.Ma.R_=$C.bind(null,e.eventManager),e.Ma.Wa=HC.bind(null,e.eventManager),e}function lk(n){const e=Le(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=rk.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=ik.bind(null,e),e}class Bu{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=ad(e.databaseInfo.databaseId),this.sharedClientState=this.za(e),this.persistence=this.ja(e),await this.persistence.start(),this.localStore=this.Ha(e),this.gcScheduler=this.Ja(e,this.localStore),this.indexBackfillerScheduler=this.Ya(e,this.localStore)}Ja(e,t){return null}Ya(e,t){return null}Ha(e){return dC(this.persistence,new cC,e.initialUser,this.serializer)}ja(e){return new M_(Tp.ei,this.serializer)}za(e){return new vC}async terminate(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Bu.provider={build:()=>new Bu};class ck extends Bu{constructor(e){super(),this.cacheSizeBytes=e}Ja(e,t){Ke(this.persistence.referenceDelegate instanceof Fu);const i=this.persistence.referenceDelegate.garbageCollector;return new KA(i,e.asyncQueue,t)}ja(e){const t=this.cacheSizeBytes!==void 0?fn.withCacheSize(this.cacheSizeBytes):fn.DEFAULT;return new M_(i=>Fu.ei(i,t),this.serializer)}}class jf{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>yv(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=ok.bind(null,this.syncEngine),await VC(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new UC}()}createDatastore(e){const t=ad(e.databaseInfo.databaseId),i=function(a){return new TC(a)}(e.databaseInfo);return function(a,c,d,p){return new IC(a,c,d,p)}(e.authCredentials,e.appCheckCredentials,i,t)}createRemoteStore(e){return function(i,o,a,c,d){return new AC(i,o,a,c,d)}(this.localStore,this.datastore,e.asyncQueue,t=>yv(this.syncEngine,t,0),function(){return hv.p()?new hv:new _C}())}createSyncEngine(e,t){return function(o,a,c,d,p,m,v){const E=new QC(o,a,c,d,p,m);return v&&(E.$a=!0),E}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(o){const a=Le(o);ye("RemoteStore","RemoteStore shutting down."),a.k_.add(5),await Ul(a),a.Q_.shutdown(),a.K_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(t=this.eventManager)===null||t===void 0||t.terminate()}}jf.provider={build:()=>new jf};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uk{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Xa(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Xa(this.observer.error,e):ti("Uncaught Error in snapshot listener:",e.toString()))}eu(){this.muted=!0}Xa(e,t){setTimeout(()=>{this.muted||e(t)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dk{constructor(e,t,i,o,a){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=i,this.databaseInfo=o,this.user=Yt.UNAUTHENTICATED,this.clientId=i_.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=a,this.authCredentials.start(i,async c=>{ye("FirestoreClient","Received user=",c.uid),await this.authCredentialListener(c),this.user=c}),this.appCheckCredentials.start(i,c=>(ye("FirestoreClient","Received new app check token=",c),this.appCheckCredentialListener(c,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Vi;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const i=kp(t,"Failed to shutdown persistence");e.reject(i)}}),e.promise}}async function sf(n,e){n.asyncQueue.verifyOperationInProgress(),ye("FirestoreClient","Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let i=t.initialUser;n.setCredentialChangeListener(async o=>{i.isEqual(o)||(await V_(e.localStore,o),i=o)}),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e}async function _v(n,e){n.asyncQueue.verifyOperationInProgress();const t=await hk(n);ye("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener(i=>fv(e.remoteStore,i)),n.setAppCheckTokenChangeListener((i,o)=>fv(e.remoteStore,o)),n._onlineComponents=e}async function hk(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){ye("FirestoreClient","Using user provided OfflineComponentProvider");try{await sf(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!function(o){return o.name==="FirebaseError"?o.code===oe.FAILED_PRECONDITION||o.code===oe.UNIMPLEMENTED:!(typeof DOMException<"u"&&o instanceof DOMException)||o.code===22||o.code===20||o.code===11}(t))throw t;Uo("Error using user provided cache. Falling back to memory cache: "+t),await sf(n,new Bu)}}else ye("FirestoreClient","Using default OfflineComponentProvider"),await sf(n,new ck(void 0));return n._offlineComponents}async function nE(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(ye("FirestoreClient","Using user provided OnlineComponentProvider"),await _v(n,n._uninitializedComponentsProvider._online)):(ye("FirestoreClient","Using default OnlineComponentProvider"),await _v(n,new jf))),n._onlineComponents}function fk(n){return nE(n).then(e=>e.syncEngine)}async function pk(n){const e=await nE(n),t=e.eventManager;return t.onListen=YC.bind(null,e.syncEngine),t.onUnlisten=ZC.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=XC.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=ek.bind(null,e.syncEngine),t}function mk(n,e,t={}){const i=new Vi;return n.asyncQueue.enqueueAndForget(async()=>function(a,c,d,p,m){const v=new uk({next:w=>{v.eu(),c.enqueueAndForget(()=>zC(a,E));const S=w.docs.has(d);!S&&w.fromCache?m.reject(new Ae(oe.UNAVAILABLE,"Failed to get document because the client is offline.")):S&&w.fromCache&&p&&p.source==="server"?m.reject(new Ae(oe.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):m.resolve(w)},error:w=>m.reject(w)}),E=new qC(gp(d.path),v,{includeMetadataChanges:!0,ua:!0});return BC(a,E)}(await pk(n),n.asyncQueue,e,t,i)),i.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rE(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ev=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gk(n,e,t){if(!t)throw new Ae(oe.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function yk(n,e,t,i){if(e===!0&&i===!0)throw new Ae(oe.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function wv(n){if(!Ce.isDocumentKey(n))throw new Ae(oe.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function Pp(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=function(i){return i.constructor?i.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":De()}function Il(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new Ae(oe.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=Pp(n);throw new Ae(oe.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tv{constructor(e){var t,i;if(e.host===void 0){if(e.ssl!==void 0)throw new Ae(oe.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(t=e.ssl)===null||t===void 0||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new Ae(oe.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}yk("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=rE((i=e.experimentalLongPollingOptions)!==null&&i!==void 0?i:{}),function(a){if(a.timeoutSeconds!==void 0){if(isNaN(a.timeoutSeconds))throw new Ae(oe.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (must not be NaN)`);if(a.timeoutSeconds<5)throw new Ae(oe.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (minimum allowed value is 5)`);if(a.timeoutSeconds>30)throw new Ae(oe.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(i,o){return i.timeoutSeconds===o.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Dp{constructor(e,t,i,o){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=i,this._app=o,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Tv({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Ae(oe.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Ae(oe.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Tv(e),e.credentials!==void 0&&(this._authCredentials=function(i){if(!i)return new SR;switch(i.type){case"firstParty":return new AR(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new Ae(oe.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const i=Ev.get(t);i&&(ye("ComponentProvider","Removing Datastore"),Ev.delete(t),i.terminate())}(this),Promise.resolve()}}function vk(n,e,t,i={}){var o;const a=(n=Il(n,Dp))._getSettings(),c=`${e}:${t}`;if(a.host!=="firestore.googleapis.com"&&a.host!==c&&Uo("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},a),{host:c,ssl:!1})),i.mockUserToken){let d,p;if(typeof i.mockUserToken=="string")d=i.mockUserToken,p=Yt.MOCK_USER;else{d=LT(i.mockUserToken,(o=n._app)===null||o===void 0?void 0:o.options.projectId);const m=i.mockUserToken.sub||i.mockUserToken.user_id;if(!m)throw new Ae(oe.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");p=new Yt(m)}n._authCredentials=new xR(new r_(d,p))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jp{constructor(e,t,i){this.converter=t,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new jp(this.firestore,e,this._query)}}class On{constructor(e,t,i){this.converter=t,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Rl(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new On(this.firestore,e,this._key)}}class Rl extends jp{constructor(e,t,i){super(e,t,gp(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new On(this.firestore,null,new Ce(e))}withConverter(e){return new Rl(this.firestore,e,this._path)}}function Sv(n,e,...t){if(n=Tn(n),arguments.length===1&&(e=i_.newId()),gk("doc","path",e),n instanceof Dp){const i=ft.fromString(e,...t);return wv(i),new On(n,null,new Ce(i))}{if(!(n instanceof On||n instanceof Rl))throw new Ae(oe.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(ft.fromString(e,...t));return wv(i),new On(n.firestore,n instanceof Rl?n.converter:null,new Ce(i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xv{constructor(e=Promise.resolve()){this.Iu=[],this.du=!1,this.Eu=[],this.Au=null,this.Ru=!1,this.Vu=!1,this.mu=[],this.r_=new U_(this,"async_queue_retry"),this.fu=()=>{const i=rf();i&&ye("AsyncQueue","Visibility state changed to "+i.visibilityState),this.r_.Jo()},this.gu=e;const t=rf();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.fu)}get isShuttingDown(){return this.du}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.pu(),this.yu(e)}enterRestrictedMode(e){if(!this.du){this.du=!0,this.Vu=e||!1;const t=rf();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.fu)}}enqueue(e){if(this.pu(),this.du)return new Promise(()=>{});const t=new Vi;return this.yu(()=>this.du&&this.Vu?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Iu.push(e),this.wu()))}async wu(){if(this.Iu.length!==0){try{await this.Iu[0](),this.Iu.shift(),this.r_.reset()}catch(e){if(!ra(e))throw e;ye("AsyncQueue","Operation failed with retryable error: "+e)}this.Iu.length>0&&this.r_.jo(()=>this.wu())}}yu(e){const t=this.gu.then(()=>(this.Ru=!0,e().catch(i=>{this.Au=i,this.Ru=!1;const o=function(c){let d=c.message||"";return c.stack&&(d=c.stack.includes(c.message)?c.stack:c.message+`
`+c.stack),d}(i);throw ti("INTERNAL UNHANDLED ERROR: ",o),i}).then(i=>(this.Ru=!1,i))));return this.gu=t,t}enqueueAfterDelay(e,t,i){this.pu(),this.mu.indexOf(e)>-1&&(t=0);const o=Cp.createAndSchedule(this,e,t,i,a=>this.Su(a));return this.Eu.push(o),o}pu(){this.Au&&De()}verifyOperationInProgress(){}async bu(){let e;do e=this.gu,await e;while(e!==this.gu)}Du(e){for(const t of this.Eu)if(t.timerId===e)return!0;return!1}vu(e){return this.bu().then(()=>{this.Eu.sort((t,i)=>t.targetTimeMs-i.targetTimeMs);for(const t of this.Eu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.bu()})}Cu(e){this.mu.push(e)}Su(e){const t=this.Eu.indexOf(e);this.Eu.splice(t,1)}}class Op extends Dp{constructor(e,t,i,o){super(e,t,i,o),this.type="firestore",this._queue=new xv,this._persistenceKey=(o==null?void 0:o.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new xv(e),this._firestoreClient=void 0,await e}}}function _k(n,e){const t=typeof n=="object"?n:p0(),i=typeof n=="string"?n:"(default)",o=Zf(t,"firestore").getImmediate({identifier:i});if(!o._initialized){const a=jT("firestore");a&&vk(o,...a)}return o}function iE(n){if(n._terminated)throw new Ae(oe.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||Ek(n),n._firestoreClient}function Ek(n){var e,t,i;const o=n._freezeSettings(),a=function(d,p,m,v){return new zR(d,p,m,v.host,v.ssl,v.experimentalForceLongPolling,v.experimentalAutoDetectLongPolling,rE(v.experimentalLongPollingOptions),v.useFetchStreams)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,o);n._componentsProvider||!((t=o.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((i=o.localCache)===null||i===void 0)&&i._onlineComponentProvider)&&(n._componentsProvider={_offline:o.localCache._offlineComponentProvider,_online:o.localCache._onlineComponentProvider}),n._firestoreClient=new dk(n._authCredentials,n._appCheckCredentials,n._queue,a,n._componentsProvider&&function(d){const p=d==null?void 0:d._online.build();return{_offline:d==null?void 0:d._offline.build(p),_online:p}}(n._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Go{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Go($t.fromBase64String(e))}catch(t){throw new Ae(oe.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Go($t.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lp{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new Ae(oe.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new zt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sE{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mp{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Ae(oe.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Ae(oe.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return $e(this._lat,e._lat)||$e(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vp{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(i,o){if(i.length!==o.length)return!1;for(let a=0;a<i.length;++a)if(i[a]!==o[a])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wk=/^__.*__$/;class Tk{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return this.fieldMask!==null?new Os(e,this.data,this.fieldMask,t,this.fieldTransforms):new Vl(e,this.data,t,this.fieldTransforms)}}function oE(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw De()}}class Fp{constructor(e,t,i,o,a,c){this.settings=e,this.databaseId=t,this.serializer=i,this.ignoreUndefinedProperties=o,a===void 0&&this.Fu(),this.fieldTransforms=a||[],this.fieldMask=c||[]}get path(){return this.settings.path}get Mu(){return this.settings.Mu}xu(e){return new Fp(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Ou(e){var t;const i=(t=this.path)===null||t===void 0?void 0:t.child(e),o=this.xu({path:i,Nu:!1});return o.Bu(e),o}Lu(e){var t;const i=(t=this.path)===null||t===void 0?void 0:t.child(e),o=this.xu({path:i,Nu:!1});return o.Fu(),o}ku(e){return this.xu({path:void 0,Nu:!0})}qu(e){return zu(e,this.settings.methodName,this.settings.Qu||!1,this.path,this.settings.Ku)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}Fu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Bu(this.path.get(e))}Bu(e){if(e.length===0)throw this.qu("Document fields must not be empty");if(oE(this.Mu)&&wk.test(e))throw this.qu('Document fields cannot begin and end with "__"')}}class Sk{constructor(e,t,i){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=i||ad(e)}$u(e,t,i,o=!1){return new Fp({Mu:e,methodName:t,Ku:i,path:zt.emptyPath(),Nu:!1,Qu:o},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function xk(n){const e=n._freezeSettings(),t=ad(n._databaseId);return new Sk(n._databaseId,!!e.ignoreUndefinedProperties,t)}function Ik(n,e,t,i,o,a={}){const c=n.$u(a.merge||a.mergeFields?2:0,e,t,o);uE("Data must be an object, but it was:",c,i);const d=lE(i,c);let p,m;if(a.merge)p=new rr(c.fieldMask),m=c.fieldTransforms;else if(a.mergeFields){const v=[];for(const E of a.mergeFields){const w=Rk(e,E,t);if(!c.contains(w))throw new Ae(oe.INVALID_ARGUMENT,`Field '${w}' is specified in your field mask but missing from your input data.`);Ck(v,w)||v.push(w)}p=new rr(v),m=c.fieldTransforms.filter(E=>p.covers(E.field))}else p=null,m=c.fieldTransforms;return new Tk(new Dn(d),p,m)}function aE(n,e){if(cE(n=Tn(n)))return uE("Unsupported field value:",e,n),lE(n,e);if(n instanceof sE)return function(i,o){if(!oE(o.Mu))throw o.qu(`${i._methodName}() can only be used with update() and set()`);if(!o.path)throw o.qu(`${i._methodName}() is not currently supported inside arrays`);const a=i._toFieldTransform(o);a&&o.fieldTransforms.push(a)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.Nu&&e.Mu!==4)throw e.qu("Nested arrays are not supported");return function(i,o){const a=[];let c=0;for(const d of i){let p=aE(d,o.ku(c));p==null&&(p={nullValue:"NULL_VALUE"}),a.push(p),c++}return{arrayValue:{values:a}}}(n,e)}return function(i,o){if((i=Tn(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return dA(o.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){const a=Ct.fromDate(i);return{timestampValue:Vu(o.serializer,a)}}if(i instanceof Ct){const a=new Ct(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:Vu(o.serializer,a)}}if(i instanceof Mp)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof Go)return{bytesValue:b_(o.serializer,i._byteString)};if(i instanceof On){const a=o.databaseId,c=i.firestore._databaseId;if(!c.isEqual(a))throw o.qu(`Document reference is for database ${c.projectId}/${c.database} but should be for database ${a.projectId}/${a.database}`);return{referenceValue:Ep(i.firestore._databaseId||o.databaseId,i._key.path)}}if(i instanceof Vp)return function(c,d){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:c.toArray().map(p=>{if(typeof p!="number")throw d.qu("VectorValues must only contain numeric values.");return yp(d.serializer,p)})}}}}}}(i,o);throw o.qu(`Unsupported field value: ${Pp(i)}`)}(n,e)}function lE(n,e){const t={};return s_(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Ds(n,(i,o)=>{const a=aE(o,e.Ou(i));a!=null&&(t[i]=a)}),{mapValue:{fields:t}}}function cE(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof Ct||n instanceof Mp||n instanceof Go||n instanceof On||n instanceof sE||n instanceof Vp)}function uE(n,e,t){if(!cE(t)||!function(o){return typeof o=="object"&&o!==null&&(Object.getPrototypeOf(o)===Object.prototype||Object.getPrototypeOf(o)===null)}(t)){const i=Pp(t);throw i==="an object"?e.qu(n+" a custom object"):e.qu(n+" "+i)}}function Rk(n,e,t){if((e=Tn(e))instanceof Lp)return e._internalPath;if(typeof e=="string")return dE(n,e);throw zu("Field path arguments must be of type string or ",n,!1,void 0,t)}const Ak=new RegExp("[~\\*/\\[\\]]");function dE(n,e,t){if(e.search(Ak)>=0)throw zu(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Lp(...e.split("."))._internalPath}catch{throw zu(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function zu(n,e,t,i,o){const a=i&&!i.isEmpty(),c=o!==void 0;let d=`Function ${e}() called with invalid data`;t&&(d+=" (via `toFirestore()`)"),d+=". ";let p="";return(a||c)&&(p+=" (found",a&&(p+=` in field ${i}`),c&&(p+=` in document ${o}`),p+=")"),new Ae(oe.INVALID_ARGUMENT,d+n+p)}function Ck(n,e){return n.some(t=>t.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hE{constructor(e,t,i,o,a){this._firestore=e,this._userDataWriter=t,this._key=i,this._document=o,this._converter=a}get id(){return this._key.path.lastSegment()}get ref(){return new On(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new kk(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(fE("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class kk extends hE{data(){return super.data()}}function fE(n,e){return typeof e=="string"?dE(n,e):e instanceof Lp?e._internalPath:e._delegate._internalPath}class bk{convertValue(e,t="none"){switch($i(e)){case 0:return null;case 1:return e.booleanValue;case 2:return gt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(zi(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw De()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const i={};return Ds(e,(o,a)=>{i[o]=this.convertValue(a,t)}),i}convertVectorValue(e){var t,i,o;const a=(o=(i=(t=e.fields)===null||t===void 0?void 0:t.value.arrayValue)===null||i===void 0?void 0:i.values)===null||o===void 0?void 0:o.map(c=>gt(c.doubleValue));return new Vp(a)}convertGeoPoint(e){return new Mp(gt(e.latitude),gt(e.longitude))}convertArray(e,t){return(e.values||[]).map(i=>this.convertValue(i,t))}convertServerTimestamp(e,t){switch(t){case"previous":const i=ed(e);return i==null?null:this.convertValue(i,t);case"estimate":return this.convertTimestamp(El(e));default:return null}}convertTimestamp(e){const t=Bi(e);return new Ct(t.seconds,t.nanos)}convertDocumentKey(e,t){const i=ft.fromString(e);Ke(L_(i));const o=new wl(i.get(1),i.get(3)),a=new Ce(i.popFirst(5));return o.isEqual(t)||ti(`Document ${a} contains a document reference within a different database (${o.projectId}/${o.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),a}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nk(n,e,t){let i;return i=n?t.merge||t.mergeFields?n.toFirestore(e,t):n.toFirestore(e):e,i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pk{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class pE extends hE{constructor(e,t,i,o,a,c){super(e,t,i,o,c),this._firestore=e,this._firestoreImpl=e,this.metadata=a}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Dk(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const i=this._document.data.field(fE("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,t.serverTimestamps)}}}class Dk extends pE{data(e={}){return super.data(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jk(n){n=Il(n,On);const e=Il(n.firestore,Op);return mk(iE(e),n._key).then(t=>Vk(e,n,t))}class Ok extends bk{constructor(e){super(),this.firestore=e}convertBytes(e){return new Go(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new On(this.firestore,null,t)}}function Lk(n,e,t){n=Il(n,On);const i=Il(n.firestore,Op),o=Nk(n.converter,e,t);return Mk(i,[Ik(xk(i),"setDoc",n._key,o,n.converter!==null,t).toMutation(n._key,Jr.none())])}function Mk(n,e){return function(i,o){const a=new Vi;return i.asyncQueue.enqueueAndForget(async()=>tk(await fk(i),o,a)),a.promise}(iE(n),e)}function Vk(n,e,t){const i=t.docs.get(e._key),o=new Ok(n);return new pE(n,o,e._key,i,new Pk(t.hasPendingWrites,t.fromCache),e.converter)}(function(e,t=!0){(function(o){ta=o})(Zo),Fo(new ks("firestore",(i,{instanceIdentifier:o,options:a})=>{const c=i.getProvider("app").getImmediate(),d=new Op(new IR(i.getProvider("auth-internal")),new kR(i.getProvider("app-check-internal")),function(m,v){if(!Object.prototype.hasOwnProperty.apply(m.options,["projectId"]))throw new Ae(oe.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new wl(m.options.projectId,v)}(c,o),c);return a=Object.assign({useFetchStreams:t},a),d._setSettings(a),d},"PUBLIC").setMultipleInstances(!0)),Li(By,"4.7.6",e),Li(By,"4.7.6","esm2017")})();const Fk={apiKey:"AIzaSyAV55IOjDQelBJFI56E5nRjVUc3UeikLiQ",authDomain:"starborne-planner.firebaseapp.com",projectId:"starborne-planner",storageBucket:"starborne-planner.firebasestorage.app",messagingSenderId:"239544020293",appId:"1:239544020293:web:a32ce3fc9517c4c53ea22c"},mE=f0(Fk),tl=_R(mE),Iv=_k(mE),gE=b.createContext(void 0),Ht=()=>{const n=b.useContext(gE);if(n===void 0)throw new Error("useNotification must be used within a NotificationProvider");return n},Ir={SHIPS:"ships",GEAR_INVENTORY:"gear-inventory",ENCOUNTER_NOTES:"encounterNotes",ENGINEERING_STATS:"engineeringStats",SHIP_LOADOUTS:"shipLoadouts",TEAM_LOADOUTS:"teamLoadouts",CHANGELOG_STATE:"changelogState"},yE=b.createContext(void 0),Uk=({children:n})=>{const[e,t]=b.useState(null),[i,o]=b.useState(!0),{addNotification:a}=Ht();b.useEffect(()=>aI(tl,E=>{t(E),o(!1)}),[]);const c=async()=>{const v=new Gr;try{await CI(tl,v)}catch(E){throw console.error("Error signing in with Google:",E),E}},d=async(v,E)=>{try{await iI(tl,v,E)}catch(w){throw console.error("Error signing in with email:",w),w}},p=async(v,E)=>{try{await rI(tl,v,E)}catch(w){throw console.error("Error signing up with email:",w),w}},m=async()=>{try{await lI(tl),Object.values(Ir).forEach(v=>localStorage.removeItem(v)),a("success","Logged out successfully")}catch(v){console.error("Logout failed:",v),a("error","Failed to log out")}};return f.jsx(yE.Provider,{value:{user:e,loading:i,signInWithGoogle:c,signInWithEmail:d,signUpWithEmail:p,signOut:m},children:n})},ud=()=>{const n=b.useContext(yE);if(n===void 0)throw new Error("useAuth must be used within an AuthProvider");return n},Bk=({isOpen:n,onClose:e})=>{const[t,i]=b.useState(!1),[o,a]=b.useState(""),[c,d]=b.useState(""),[p,m]=b.useState(null),[v,E]=b.useState(!1),{signInWithEmail:w,signUpWithEmail:S,signInWithGoogle:R}=ud(),j=async O=>{O.preventDefault(),m(null);try{t?await S(o,c):await w(o,c),e()}catch(U){m(U instanceof Error?U.message:"An error occurred")}},N=async()=>{try{await R(),e()}catch(O){m(O instanceof Error?O.message:"An error occurred")}};return f.jsx(Jo,{isOpen:n,onClose:e,title:v&&t?"Sign Up":"Sign In",children:f.jsxs("div",{className:"space-y-6",children:[p&&f.jsx("div",{className:"text-red-500 text-sm",children:p}),f.jsxs("span",{className:"text-sm text-gray-400",children:["Login is optional, to be able to easely access your data across devices. The app works without it. If you login, your master data will be stored in Google Firebase.",f.jsx("b",{children:"I recommend backing up your data through the home page, before logging in for the first time."})]}),v?f.jsxs("form",{onSubmit:j,className:"space-y-4",children:[f.jsxs("div",{children:[f.jsx("label",{htmlFor:"email",className:"block text-sm font-medium",children:"Email"}),f.jsx("input",{type:"email",id:"email",value:o,onChange:O=>a(O.target.value),className:"mt-1 block w-full rounded border-dark-border bg-dark p-2",required:!0})]}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"password",className:"block text-sm font-medium",children:"Password"}),f.jsx("input",{type:"password",id:"password",value:c,onChange:O=>d(O.target.value),className:"mt-1 block w-full rounded border-dark-border bg-dark p-2",required:!0})]}),f.jsxs("div",{className:"flex flex-col gap-2",children:[f.jsx("button",{type:"submit",className:"w-full px-4 py-2 bg-primary hover:bg-primary-hover text-dark transition-colors rounded",children:t?"Sign Up":"Sign In"}),f.jsx("button",{type:"button",onClick:()=>i(!t),className:"text-sm text-gray-400 hover:text-white",children:t?"Already have an account? Sign in":"Don't have an account? Sign up"}),f.jsx("button",{type:"button",onClick:()=>E(!1),className:"text-sm text-gray-400 hover:text-white",children:" Back to sign in options"})]})]}):f.jsxs("div",{className:"flex flex-col gap-3",children:[f.jsxs("button",{onClick:N,className:"px-4 py-2 bg-white hover:bg-gray-100 text-dark transition-colors rounded flex items-center justify-center gap-2",children:[f.jsx("img",{src:"https://www.google.com/favicon.ico",alt:"Google",className:"w-4 h-4"}),"Continue with Google"]}),f.jsxs("div",{className:"relative",children:[f.jsx("div",{className:"absolute inset-0 flex items-center",children:f.jsx("div",{className:"w-full border-t border-dark-border"})}),f.jsx("div",{className:"relative flex justify-center text-sm",children:f.jsx("span",{className:"px-2 bg-dark-lighter text-gray-400",children:"Or"})})]}),f.jsx("button",{onClick:()=>E(!0),className:"px-4 py-2 bg-primary hover:bg-primary-hover text-dark transition-colors rounded",children:"Continue with Email"})]})]})})},ke=({children:n,variant:e="primary",fullWidth:t=!1,size:i="md",className:o="",...a})=>{const c="transition-colors whitespace-nowrap",d={primary:"text-dark bg-gradient-to-r from-primary to-primary-hover hover:bg-gradient-to-r hover:from-primary-hover hover:to-primary",secondary:"bg-dark border border-gray-600 text-gray-300 hover:bg-dark-border",danger:"bg-gradient-to-r from-red-600 to-red-500 text-gray-300 hover:bg-gradient-to-r hover:from-red-500 hover:to-red-500",link:"text-gray-300 hover:text-white !p-0 bg-dark"},p={xs:"px-2 py-1 text-xxs h-6",sm:"px-2 py-1 text-sm h-8 font-medium",md:"px-4 py-2 h-10 font-medium",lg:"px-6 py-3 h-12 font-medium"};return f.jsx("button",{className:`
                ${c}
                ${d[e]}
                ${p[i]}
                ${t?"w-full":""}
                ${o}
            `,...a,children:n})},zk=()=>{const{user:n,signOut:e}=ud(),[t,i]=b.useState(!1);return n?f.jsxs("div",{className:"flex items-center gap-2",children:[n.photoURL&&f.jsx("img",{src:n.photoURL,alt:n.displayName||n.email||"User",className:"w-8 h-8 rounded-full"}),f.jsx("button",{onClick:()=>e(),className:"px-4 py-2 bg-dark-border hover:bg-dark-border-hover transition-colors",children:"Sign Out"})]}):f.jsxs(f.Fragment,{children:[f.jsx(ke,{onClick:()=>i(!0),className:"px-4 py-2 bg-primary hover:bg-primary-hover text-dark transition-colors w-full text-left",children:"Sign In"}),f.jsx(Bk,{isOpen:t,onClose:()=>i(!1)})]})},$k=()=>{const n=Gi(),[e,t]=b.useState(!1),i=c=>n.pathname===c,o=[{path:"/",label:"Home"},{path:"/ships",label:"Ships"},{path:"/gear",label:"Gear"},{path:"/loadouts",label:"Loadouts"},{path:"/engineering",label:"Engineering"},{path:"/simulation",label:"Simulation"},{path:"/autogear",label:"Autogear"},{path:"/encounters",label:"Encounters"}],a=()=>f.jsxs("div",{className:"space-y-2 flex flex-col h-full",children:[f.jsx("span",{className:"text-xs text-gray-400 hidden lg:block",children:ul}),f.jsxs("h1",{className:" text-xl font-bold mb-8 hidden lg:flex gap-2 items-center",children:[f.jsx("img",{src:uy,alt:"logo",className:"w-8 h-8"}),df]}),f.jsx("nav",{className:"space-y-2",children:o.map(({path:c,label:d})=>f.jsx(er,{to:c,onClick:()=>t(!1),className:`
                            block px-4 py-2
                            transition-all duration-200 ease-in-out
                            transform hover:scale-105
                            ${i(c)?"bg-primary hover:bg-primary-hover text-dark":" hover:bg-dark-border"}
                        `,children:d},c))}),f.jsx("div",{className:"!mt-auto",children:f.jsx(zk,{})})]});return f.jsxs(f.Fragment,{children:[f.jsx("div",{className:"lg:hidden fixed top-0 left-0 right-0 bg-dark px-4 py-3 z-20",role:"banner",children:f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsx("button",{"aria-label":"Open mobile menu",onClick:()=>t(!e),className:" hover:text-white focus:outline-none focus:text-white transition-colors duration-200",children:f.jsx("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e?f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"}):f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})}),f.jsxs("h1",{className:"text-white text-xl font-bold flex items-center gap-2",children:[f.jsx("img",{src:uy,alt:"logo",className:"w-8 h-8"}),df]}),f.jsx("span",{className:"text-xs text-gray-400",children:ul})]})}),f.jsx("div",{"data-testid":"desktop-sidebar",className:"hidden lg:block fixed top-0 left-0 h-full w-64 bg-dark z-20",children:f.jsx("div",{className:"p-4 h-full",children:f.jsx(a,{})})}),f.jsx(n0,{isOpen:e,onClose:()=>t(!1),position:"left",width:"w-64",hideCloseButton:!0,children:f.jsx(a,{})})]})},vE=({tabs:n,activeTab:e,onChange:t})=>f.jsx("div",{className:"mb-4",children:f.jsx("div",{className:"border-b border-gray-700",children:f.jsx("nav",{className:"-mb-px flex space-x-4","aria-label":"Tabs",children:n.map(i=>f.jsx("button",{"aria-label":i.label,onClick:()=>t(i.id),className:`
                                whitespace-nowrap py-3 px-4 border-b-2 font-medium text-sm
                                ${e===i.id?"border-primary text-primary":"border-transparent text-gray-400 hover: hover:border-gray-300"}
                            `,"aria-current":e===i.id?"page":void 0,children:i.label},i.id))})})}),Up=({isVisible:n,children:e,className:t=""})=>{const[i,o]=b.useState({left:0,top:0}),a=b.useRef(null);return b.useEffect(()=>{if(!n||!a.current)return;const c=()=>{var N;const d=a.current;if(!d)return;const p=(N=d.parentElement)==null?void 0:N.getBoundingClientRect();if(!p)return;const m=d.getBoundingClientRect(),v=window.innerHeight-p.bottom,E=p.top,w=v<m.height&&E>m.height?"top":"bottom",S=p.left+p.width/2-m.width/2,R=Math.min(Math.max(0,S),window.innerWidth-m.width),j=w==="top"?p.top-m.height-8:p.bottom+8;o({left:R,top:j})};return c(),window.addEventListener("resize",c),()=>{window.removeEventListener("resize",c)}},[n,e]),n?f.jsx("div",{ref:a,className:`fixed z-50 ${t}`,style:{left:`${i.left}px`,top:`${i.top}px`},children:e}):null},Of=({label:n,checked:e,onChange:t,className:i="",disabled:o=!1,id:a})=>{const c=a||`checkbox-${n.toLowerCase().replace(/\s+/g,"-")}`;return f.jsxs("div",{className:`flex items-center space-x-2 ${i}`,children:[f.jsx("input",{type:"checkbox",id:c,checked:e,onChange:d=>!o&&t(d.target.checked),disabled:o,className:"sr-only"}),f.jsxs("label",{htmlFor:c,className:`
                    flex items-center space-x-2
                    ${o?"opacity-50 cursor-not-allowed":"cursor-pointer"}
                `,children:[f.jsx("div",{role:"presentation",className:`
                        w-4 h-4
                        flex items-center justify-center
                        border
                        transition-all duration-200
                        ${e?"bg-primary border-primary":"border-gray-600 bg-dark"}
                        ${!o&&"hover:border-primary"}
                        focus-within:ring-2 focus-within:ring-primary focus-within:ring-offset-0
                    `,children:f.jsx("div",{className:`text-dark
                        transition-all duration-200
                        ${e?"opacity-100 scale-100":"opacity-0 scale-75"}
                    `,children:e&&f.jsx(Yf,{})})}),f.jsx("span",{className:" select-none",children:n})]})]})},Hk=({label:n,values:e,onChange:t,options:i,className:o="",disabled:a=!1})=>{const c=d=>{const p=e.includes(d)?e.filter(m=>m!==d):[...e,d];t(p)};return f.jsxs("div",{className:o,children:[f.jsx("label",{className:"block text-sm font-medium  mb-2",children:n}),f.jsx("div",{className:"space-y-2",children:i.map(d=>f.jsx(Of,{label:d.label,checked:e.includes(d.value),onChange:()=>c(d.value),disabled:a},d.value))})]})},Ln=({label:n,error:e,labelClassName:t="",className:i="",...o})=>{const a=o.id||o.name||`input-${Math.random().toString(36).substring(2,15)}`;return f.jsxs("div",{className:"space-y-1 grow",children:[n&&f.jsx("label",{className:`block text-sm font-medium  ${t}`,htmlFor:a,children:n}),f.jsx("input",{className:`
                    w-full px-1 md:px-4 py-2 bg-dark-lighter border border-dark-border
                     focus:outline-none focus:ring-2 focus:ring-primary
                     placeholder-gray-500 h-10
                    ${e?"border-red-500":"focus:border-primary"}
                    ${i}
                `,id:a,...o}),e&&f.jsx("p",{className:"text-sm text-red-500",children:e})]})},qk=({current:n,total:e,className:t="",label:i="",percentage:o=0})=>(o=o||Math.min(Math.max(n/e,0),1)*100,f.jsxs("div",{className:`w-full ${t}`,role:"progressbar","aria-valuenow":n,"aria-valuemax":e,children:[i&&f.jsx("label",{className:"text-sm text-gray-400",children:i}),f.jsxs("div",{className:"flex justify-between mb-1",children:[f.jsxs("span",{className:"text-sm text-gray-400",children:["Progress: ",n.toLocaleString()," / ",e.toLocaleString()]}),f.jsxs("span",{className:"text-sm text-gray-400",children:[o,"%"]})]}),f.jsx("div",{className:"w-full bg-gray-700 rounded-full h-2.5",children:f.jsx("div",{className:"bg-blue-600 h-2.5 rounded-full transition-all duration-50","data-testid":"progress-fill",style:{width:`${o}%`}})})]})),Lt=({label:n,error:e,options:t,className:i="",noDefaultSelection:o=!1,defaultOption:a="Select",value:c,onChange:d,disabled:p=!1,id:m,"data-testid":v})=>{var O;const[E,w]=b.useState(!1),S=b.useRef(null),R=m||`select-${Math.random().toString(36).substring(2,15)}`,j=c===""&&o?a:((O=t.find(U=>U.value===c))==null?void 0:O.label)||a;b.useEffect(()=>{const U=q=>{S.current&&!S.current.contains(q.target)&&w(!1)};return document.addEventListener("mousedown",U),()=>document.removeEventListener("mousedown",U)},[]);const N=U=>{if(!p)switch(U.key){case" ":case"Enter":U.preventDefault(),w(!E);break;case"Escape":w(!1);break;case"ArrowDown":if(U.preventDefault(),!E)w(!0);else{const J=(t.findIndex(W=>W.value===c)+1)%t.length;d(t[J].value)}break;case"ArrowUp":if(U.preventDefault(),!E)w(!0);else{const q=t.findIndex(W=>W.value===c),J=q<=0?t.length-1:q-1;d(t[J].value)}break}};return f.jsxs("div",{className:"space-y-1 grow",ref:S,children:[n&&f.jsx("label",{htmlFor:R,"aria-label":n,className:"block text-sm font-medium ",children:n}),f.jsxs("div",{className:"relative",children:[f.jsxs("button",{type:"button",id:R,onClick:()=>!p&&w(!E),onKeyDown:N,"aria-haspopup":"listbox","aria-expanded":E,"aria-labelledby":n?R:void 0,disabled:p,"data-testid":v,className:`
                        w-full px-4 py-2
                        bg-dark-lighter border border-dark-border
                        focus:outline-none focus:ring-2 focus:ring-primary
                         h-10
                        flex items-center justify-between
                        transition-colors duration-150
                        ${e?"border-red-500":"focus:border-primary"}
                        ${p?"opacity-50 cursor-not-allowed":""}
                        ${i}
                    `,children:[f.jsx("span",{className:"whitespace-nowrap overflow-hidden overflow-ellipsis",children:j}),f.jsx("span",{className:"transition-transform duration-200",children:E?f.jsx(e0,{}):f.jsx(Zv,{})})]}),f.jsxs("div",{className:`
                        absolute z-10 min-w-full w-auto
                        bg-dark-lighter border border-dark-border
                        shadow-lg
                        max-h-60 overflow-y-auto overflow-x-hidden
                        transition-all duration-200 origin-top
                        ${E?"opacity-100 scale-100 translate-y-1":"opacity-0 scale-95 translate-y-0 pointer-events-none"}
                    `,role:"listbox",children:[o&&f.jsx("div",{role:"option","aria-selected":c==="",onClick:()=>{d(""),w(!1)},className:`
                                px-4 py-2 cursor-pointer
                                transition-colors duration-150
                                ${c===""?"bg-primary text-dark":" hover:bg-primary hover:text-dark"}
                            `,children:a}),t.map(U=>f.jsx("div",{role:"option","aria-selected":U.value===c,onClick:()=>{d(U.value),w(!1)},className:`
                                px-4 py-2 cursor-pointer
                                transition-colors duration-150
                                ${U.value===c?"bg-primary text-dark":" hover:bg-primary hover:text-dark"}
                            `,children:U.label},U.value))]})]}),e&&f.jsx("p",{className:"text-sm text-red-500",children:e})]})},Gk=({label:n,id:e,value:t,onChange:i,required:o,className:a,...c})=>{const d=e||`textarea-${Math.random().toString(36).substring(2,15)}`;return f.jsxs("div",{className:"flex flex-col",children:[f.jsx("label",{htmlFor:d,className:"text-white text-sm mb-2",children:n}),f.jsx("textarea",{id:d,value:t,onChange:i,required:o,className:`bg-dark-lighter text-white p-2 ${a}`,...c})]})};async function Wk(n){const e=i0[n.toUpperCase().replace(" ","_")];return e?{baseStats:{hp:e.hp,attack:e.attack,defence:e.defense,hacking:e.hacking,security:e.security,crit:e.critRate,critDamage:e.critDamage,speed:e.speed,healModifier:0},faction:e.faction.toUpperCase().replace(" ","_"),type:e.role.toUpperCase(),rarity:e.rarity.toLowerCase(),affinity:e.affinity.toUpperCase()}:null}const $u=({stats:n,onChange:e,maxStats:t,allowedStats:i,excludedStats:o=[]})=>{const a=(m,v,E)=>{var R;const w=[...n],S=w[m];if(v==="name"){const O=(((R=i==null?void 0:i[E])==null?void 0:R.allowedTypes)||Rt[E].allowedTypes).filter(U=>!(o!=null&&o.some(q=>q.name===E&&q.type===U)))[0];w[m]={...S,name:E,type:O}}else v==="type"?o!=null&&o.some(N=>N.name===S.name&&N.type===E)||(w[m]={...S,type:E}):w[m]={...S,[v]:v==="value"?Number(E):E};e(w)},c=()=>{var m;if(n.length<t){const v=Object.keys(i||Rt)[0],E=(((m=i==null?void 0:i[v])==null?void 0:m.allowedTypes)||["flat"])[0],w={name:v,type:E,value:0};e([...n,w])}},d=m=>{const v=n.filter((E,w)=>w!==m);e(v)},p=Object.entries(i||Rt).filter(([m,v])=>{var E;return((E=v.allowedTypes)==null?void 0:E.length)&&m!=="healModifier"}).map(([m,v])=>{var w;const E=(w=v.allowedTypes)==null?void 0:w.filter(S=>!o.some(R=>R.name===m&&R.type===S));return{value:m,label:Rt[m].label,allowedTypes:E==null?void 0:E.map(S=>({value:S,label:S.charAt(0).toUpperCase()+S.slice(1)}))}}).filter(m=>m.allowedTypes&&m.allowedTypes.length>0);return f.jsxs("div",{className:"space-y-4",children:[n.map((m,v)=>{var E;return f.jsxs("div",{className:"flex gap-4 items-end w-full",children:[f.jsxs("div",{className:"grid grid-cols-3 gap-4 items-end w-full",children:[f.jsx(Lt,{label:"Stat",value:m.name,onChange:w=>a(v,"name",w),options:p,className:"w-full"}),f.jsx(Ln,{type:"number",label:"Value",value:m.value,onChange:w=>a(v,"value",w.target.value),className:"w-full"}),f.jsx(Lt,{label:"Type",value:m.type,onChange:w=>a(v,"type",w),options:((E=p.find(w=>w.value===m.name))==null?void 0:E.allowedTypes)||[],className:"w-full"})]}),f.jsx(ke,{"aria-label":"Remove stat",variant:"danger",onClick:()=>d(v),children:f.jsx(rn,{})})]},v)}),n.length<t&&f.jsx(ke,{variant:"secondary",onClick:c,type:"button","aria-label":"Add stat",children:"Add Stat"})]})},Rv={hp:0,attack:0,defence:0,hacking:0,security:0,crit:0,critDamage:0,speed:0,healModifier:0},Kk=[{value:"chemical",label:"Chemical"},{value:"electric",label:"Electric"},{value:"thermal",label:"Thermal"},{value:"antimatter",label:"Antimatter"}],_E=({onSubmit:n,editingShip:e})=>{const[t,i]=b.useState((e==null?void 0:e.name)||""),[o,a]=b.useState((e==null?void 0:e.baseStats)||Rv),[c,d]=b.useState((e==null?void 0:e.faction)||""),[p,m]=b.useState((e==null?void 0:e.type)||""),[v,E]=b.useState((e==null?void 0:e.rarity)||""),[w,S]=b.useState((e==null?void 0:e.refits)||[]),[R,j]=b.useState((e==null?void 0:e.implants)||[]),[N,O]=b.useState(!1),[U,q]=b.useState(null),{addNotification:J}=Ht(),[W,Q]=b.useState(e==null?void 0:e.affinity);b.useEffect(()=>{e&&(i(e.name),a(e.baseStats),d(e.faction),m(e.type),E(e.rarity),S(e.refits),j(e.implants),Q(e.affinity))},[e]);const k=async ee=>{ee.preventDefault();const ue={id:(e==null?void 0:e.id)||Date.now().toString(),name:t,faction:c,type:p,rarity:v,affinity:W,baseStats:o,equipment:(e==null?void 0:e.equipment)||{},equipmentLocked:(e==null?void 0:e.equipmentLocked)||!1,refits:w,implants:R};try{await n(ue),i(""),a(Rv),d(""),m(""),E(""),S([]),j([])}catch(he){J("error","Failed to save ship data"),console.error("Error saving ship:",he)}},x=async()=>{if(t){O(!0),q(null);try{const ee=await Wk(t);if(!ee){q("Could not find ship data. If it's a newer ship, I may not have it in the database yet.");return}a(ee.baseStats),d(ee.faction),m(ee.type),E(ee.rarity),Q(ee.affinity),J("success","Ship data fetched successfully")}catch(ee){q("Failed to fetch ship data. If it's a newer ship, I may not have it in the database yet."),console.error("Error fetching ship data:",ee),J("error","Failed to fetch ship data. If it's a newer ship, I may not have it in the database yet.")}finally{O(!1)}}},A=Object.entries(lt).map(([ee,ue])=>({value:ee,label:ue.name})),P=Object.entries(tr).map(([ee,ue])=>({value:ee,label:ue.name})),M=Object.entries(jn).map(([ee,ue])=>({value:ue.value,label:ue.label})),V=ee=>{window.confirm("Are you sure you want to remove this implant?")&&j(R.filter((ue,he)=>he!==ee))},D=ee=>{window.confirm("Are you sure you want to remove this refit?")&&S(w.filter((ue,he)=>he!==ee))};return f.jsxs("form",{onSubmit:k,className:"space-y-6  bg-dark p-6",children:[f.jsx("h2",{className:"text-2xl font-bold ",children:e?"Edit Ship":"Create New Ship"}),f.jsxs("div",{className:"space-y-2",children:[f.jsxs("div",{className:"flex gap-4",children:[f.jsx("div",{className:"flex-1",children:f.jsx(Ln,{label:"Ship Name",value:t,onChange:ee=>{i(ee.target.value),q(null)},required:!0,placeholder:"Enter ship name",error:U?" ":""})}),f.jsx("div",{className:"flex items-end",children:f.jsx(ke,{"aria-label":"Fetch ship data",type:"button",variant:"primary",onClick:ee=>{ee.preventDefault(),x()},disabled:!t||N,className:"relative",children:N?f.jsxs(f.Fragment,{children:[f.jsx("span",{className:"opacity-0",children:"Fetch Data"}),f.jsx("div",{className:"absolute inset-0 flex items-center justify-center",role:"status",children:f.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"})})]}):"Fetch Data"})})]}),U&&f.jsx("div",{className:"text-red-500 text-sm mt-1",children:U})]}),f.jsxs("div",{className:"flex flex-row flex-wrap gap-4",children:[f.jsx(Lt,{label:"Faction",value:c,onChange:ee=>d(ee),options:P,noDefaultSelection:!0,defaultOption:"Select Faction"}),f.jsx(Lt,{label:"Type",value:p,onChange:ee=>m(ee),options:A,noDefaultSelection:!0,defaultOption:"Select Type"}),f.jsx(Lt,{label:"Affinity",value:W||"",onChange:ee=>Q(ee),options:Kk,noDefaultSelection:!0,defaultOption:"Select Affinity"})]}),f.jsx(Lt,{label:"Rarity",value:v,onChange:ee=>E(ee),options:M,noDefaultSelection:!0,defaultOption:"Select Rarity"}),f.jsxs("div",{className:"space-y-4",children:[f.jsx("h3",{className:"text-lg font-medium ",children:"Base Stats"}),f.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:Object.entries(o).map(([ee,ue])=>ee!=="healModifier"&&f.jsx(Ln,{type:"number",label:Rt[ee].label,value:ue,onChange:he=>a(re=>({...re,[ee]:Number(he.target.value)})),min:"0"},ee))})]}),f.jsxs("div",{className:"space-y-4",children:[f.jsx("h3",{className:"text-lg font-medium ",children:"Refits"}),w==null?void 0:w.map((ee,ue)=>f.jsxs("div",{className:"p-4 border border-gray-700  space-y-4 relative",children:[f.jsx("div",{className:"absolute top-2 right-4",children:f.jsx(ke,{"aria-label":"Delete refit",variant:"danger",onClick:()=>D(ue),children:f.jsx(rn,{})})}),f.jsx($u,{stats:ee.stats,onChange:he=>{const re=[...w];re[ue]={...ee,stats:he},S(re)},maxStats:2})]},ue)),(w==null?void 0:w.length)<6&&f.jsx(ke,{"aria-label":"Add refit",type:"button",variant:"primary",onClick:()=>S([...w,{stats:[]}]),children:"Add Refit"})]}),f.jsxs("div",{className:"space-y-4",children:[f.jsx("h3",{className:"text-lg font-medium ",children:"Implants"}),R==null?void 0:R.map((ee,ue)=>f.jsxs("div",{className:"p-4 border border-gray-700  space-y-4 relative",children:[f.jsx("div",{className:"absolute top-2 right-4",children:f.jsx(ke,{"aria-label":"Delete implant",variant:"danger",onClick:()=>V(ue),children:f.jsx(rn,{})})}),f.jsx($u,{stats:ee.stats,onChange:he=>{const re=[...R];re[ue]={...ee,stats:he},j(re)},maxStats:2})]},ue)),(R==null?void 0:R.length)<5&&f.jsx(ke,{"aria-label":"Add implant",type:"button",variant:"primary",onClick:()=>j([...R,{stats:[]}]),children:"Add Implant"})]}),f.jsx("div",{className:"flex justify-end pt-4",children:f.jsx(ke,{"aria-label":e?"Save Changes":"Create Ship",type:"submit",children:e?"Save Changes":"Create Ship"})})]})},Lf={async saveUserData(n,e){try{const t=Sv(Iv,"users",n);await Lk(t,e,{merge:!0})}catch(t){throw console.error("Error saving to Firebase:",t),t}},async getUserData(n){try{const e=Sv(Iv,"users",n),t=await jk(e);return t.exists()?t.data():null}catch(e){throw console.error("Error getting data from Firebase:",e),e}}};function Wo(n){const{key:e,defaultValue:t}=n,{user:i}=ud(),[o,a]=b.useState(()=>{const w=localStorage.getItem(e);if(w)try{const S=JSON.parse(w);if(Array.isArray(S)&&S.length>0)return S}catch(S){console.error("Error parsing local data:",S)}return t}),[c,d]=b.useState(!0),{addNotification:p}=Ht(),m=b.useRef(i==null?void 0:i.uid),v=b.useCallback(async()=>{d(!0);try{if(i!=null&&i.uid){const w=await Lf.getUserData(i.uid);if(w!=null&&w[e]){const S=w[e];a(S),localStorage.setItem(e,JSON.stringify(S))}}}catch(w){console.error("Error loading data:",w),p("error","Failed to load data")}finally{d(!1)}},[e,i==null?void 0:i.uid,p]);b.useEffect(()=>{m.current!==(i==null?void 0:i.uid)&&(i?v():(localStorage.removeItem(e),a(t)),m.current=i==null?void 0:i.uid)},[i,v,e,t]),b.useEffect(()=>{v()},[]);const E=async w=>{try{localStorage.setItem(e,JSON.stringify(w)),a(w),i!=null&&i.uid&&await Lf.saveUserData(i.uid,{[e]:w})}catch(S){console.error("Error saving data:",S),p("error","Failed to save to cloud storage")}};return{data:o,setData:w=>E(typeof w=="function"?w(o):w),loading:c,reload:v}}const Qk=Ir.GEAR_INVENTORY,Cr=()=>{const{data:n=[],setData:e,loading:t,reload:i}=Wo({key:Qk,defaultValue:[]}),o=b.useCallback(async c=>{try{await e(c)}catch(d){throw console.error("Error saving inventory:",d),d}},[e]),a=b.useCallback(c=>c?n==null?void 0:n.find(d=>d.id===c):void 0,[n]);return b.useEffect(()=>{const c=d=>{const p=d.detail.gear,m=n==null?void 0:n.map(v=>v.id===p.id?p:v);m&&o(m)};return window.addEventListener("updateInventory",c),()=>{window.removeEventListener("updateInventory",c)}},[n,o]),{inventory:n,loading:t,error:null,setInventory:e,saveInventory:o,loadInventory:i,getGearPiece:a}},pn=(n,e,t,i=[],o=[],a)=>{const c={base:{...n},afterRefits:{...n},afterEngineering:{...n},afterGear:{...n},afterSets:{...n},final:{...n}};return i.forEach(v=>{v.stats.forEach(E=>m(E,c.afterRefits,n))}),Object.assign(c.afterEngineering,c.afterRefits),a&&a.stats.forEach(v=>m(v,c.afterEngineering,n)),Object.assign(c.afterGear,c.afterEngineering),Object.values(e).forEach(v=>{if(!v)return;const E=t(v);E&&(m(E.mainStat,c.afterGear,c.afterEngineering),E.subStats.forEach(w=>m(w,c.afterGear,c.afterEngineering)))}),Object.assign(c.afterSets,c.afterGear),d(),Object.assign(c.final,c.afterSets),o.forEach(v=>{v.stats.forEach(E=>m(E,c.final,c.afterEngineering))}),c;function d(){const v=p();Object.entries(v).forEach(([E,w])=>{const S=Math.floor(w/2);if(S===0)return;const R=Object.values(e).map(j=>j&&t(j)).find(j=>j&&j.setBonus&&yt[j.setBonus].name===E);if(!(!R||!R.setBonus||!yt[R.setBonus].stats))for(let j=0;j<S;j++)yt[R.setBonus].stats.forEach(N=>m(N,c.afterSets,c.afterEngineering))})}function p(){const v={};return Object.values(e).forEach(E=>{if(!E)return;const w=t(E);!(w!=null&&w.setBonus)||!yt[w.setBonus].name||(v[yt[w.setBonus].name]=(v[yt[w.setBonus].name]||0)+1)}),v}function m(v,E,w){if(["crit","critDamage","healModifier"].includes(v.name))E[v.name]=(E[v.name]||0)+v.value;else if(v.type==="percentage"){const j=w[v.name]*(v.value/100);E[v.name]+=j}else E[v.name]=(E[v.name]||0)+v.value}},Yk=Ir.ENGINEERING_STATS,sa=()=>{const{data:n={stats:[]},setData:e}=Wo({key:Yk,defaultValue:{stats:[]}}),t=b.useCallback(c=>{e(c)},[e]),i=b.useCallback(c=>{e({stats:n.stats.filter(d=>d.shipType!==c)})},[n,e]),o=b.useCallback(()=>{const c=Object.entries(Rt).filter(([d,p])=>p.engineeringAllowedTypes).map(([d,p])=>[d,{allowedTypes:p.engineeringAllowedTypes}]);return Object.fromEntries(c)},[]),a=b.useCallback(c=>c==="SUPPORTER_BUFFER"?n.stats.find(d=>d.shipType==="SUPPORTER"):n.stats.find(d=>d.shipType===c),[n]);return{engineeringStats:n,saveEngineeringStats:t,deleteEngineeringStats:i,getAllAllowedStats:o,getEngineeringStatsForShipType:a}},Xk=["crit","critDamage","healModifier"],Mf=({stats:n,comparisonStats:e,title:t,className:i=""})=>{const o=["hp","attack","defence","hacking","security","crit","critDamage","speed","healModifier"];return f.jsxs("div",{className:`bg-dark space-y-2 ${i}`,"data-testid":"stat-list",children:[t&&f.jsx("h3",{className:"text-lg font-semibold",children:t}),o.map(a=>{const c=n[a];if(a==="healModifier"&&c<=0)return null;const d=e==null?void 0:e[a],p=d!==void 0?c-d:void 0;return f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsx("span",{className:"capitalize",children:Rt[a].label}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsxs("span",{children:[Math.round(c),Xk.includes(a)?"%":""]}),p!==void 0&&p!==0&&f.jsxs("span",{className:p>0?"text-green-500":"text-red-500",children:["(",p>0?"+":"",Math.round(p),")"]})]})]},a)})]})},nl=(n,e)=>{const t={};return Object.keys(n).forEach(i=>{const o=i,a=n[o]||0,c=e[o]||0,d=a-c;d!==0&&(t[o]=d)}),t},rl=n=>(n=Math.round(n),n>0?`+${n}`:n.toString()),Jk=({breakdown:n})=>{const e=["hp","attack","defence","hacking","security","crit","critDamage","speed","healModifier"],t=nl(n.afterRefits,n.base),i=nl(n.afterEngineering,n.afterRefits),o=nl(n.afterGear,n.afterEngineering),a=nl(n.afterSets,n.afterGear),c=nl(n.final,n.afterSets);return f.jsx("div",{className:"pb-4",children:f.jsxs("table",{className:"w-full text-xs table-auto",children:[f.jsx("thead",{children:f.jsxs("tr",{className:"border-b border-gray-600 text-left",children:[f.jsx("th",{className:"font-bold p-1 border-r border-gray-600",children:"Stat"}),f.jsx("th",{className:"font-bold p-1",children:"Base"}),f.jsx("th",{className:"font-bold p-1",children:"Refits"}),f.jsx("th",{className:"font-bold p-1 border-r border-gray-600",children:"Eng."}),f.jsx("th",{className:"font-bold p-1",children:"Gear"}),f.jsx("th",{className:"font-bold p-1",children:"Sets"}),f.jsx("th",{className:"font-bold p-1",children:"Impl."}),f.jsx("th",{className:"font-bold p-1 border-l border-gray-600",children:"Final"})]})}),f.jsx("tbody",{children:e.map(d=>{const p=n.base[d]||0,m=t[d],v=i[d],E=o[d],w=a[d],S=c[d],R=n.final[d];return!p&&!m&&!v&&!E&&!w&&!S&&!R?null:f.jsxs("tr",{className:`${d!=="speed"?"border-b border-gray-600":""}`,children:[f.jsx("td",{className:"p-1 border-r border-gray-600",children:Rt[d].shortLabel}),f.jsx("td",{className:"p-1 text-gray-400",children:p||"-"}),f.jsx("td",{className:`p-1 ${m?"text-yellow-400":""}`,children:m?rl(m):"-"}),f.jsx("td",{className:`p-1 border-r border-gray-600 ${v?"text-blue-400":""}`,children:v?rl(v):"-"}),f.jsx("td",{className:`p-1 ${E?"text-green-400":""}`,children:E?rl(E):"-"}),f.jsx("td",{className:`p-1 ${w?"text-emerald-400":""}`,children:w?rl(w):"-"}),f.jsx("td",{className:`p-1 ${S?"text-purple-400":""}`,children:S?rl(S):"-"}),f.jsx("td",{className:"p-1 border-l border-gray-600",children:R?Math.round(R):"-"})]},d)})})]})})},Vf=b.memo(({iconUrl:n,name:e,className:t})=>f.jsx("img",{src:n,alt:e,className:`w-4 ${t}`}));Vf.displayName="ShipImage";const Zk=({affinity:n})=>{switch(n){case"chemical":return"filter-chemical";case"electric":return"filter-electric";case"thermal":return"filter-thermal";case"antimatter":return"filter-antimatter";default:return""}},Ff=b.memo(({ship:n,variant:e="full"})=>f.jsxs("div",{children:[f.jsxs("div",{className:"flex items-center gap-1 min-h-[28px]",children:[n.type&&lt[n.type]&&f.jsx(Vf,{iconUrl:lt[n.type].iconUrl,name:lt[n.type].name,className:`${n.affinity?Zk({affinity:n.affinity}):""}`}),n.faction&&tr[n.faction]&&f.jsx(Vf,{iconUrl:tr[n.faction].iconUrl,name:tr[n.faction].name}),f.jsx("span",{className:`${e==="compact"?"text-sm":"lg:text-sm"} font-secondary ${jn[n.rarity||"common"].textColor}`,children:n.name})]}),f.jsx("div",{className:"flex items-center gap-1",children:Array.from({length:6},(t,i)=>f.jsx("span",{className:`text-xs tracking-tightest ${i<n.refits.length?"text-yellow-400":"text-gray-300"}`,children:""},i))})]}));Ff.displayName="Header";const Al=b.memo(({ship:n,variant:e="full",onEdit:t,onRemove:i,selected:o,onClick:a,children:c,onLockEquipment:d})=>{var E;const{getGearPiece:p}=Cr(),{getEngineeringStatsForShipType:m}=sa(),v=b.useMemo(()=>pn(n.baseStats,n.equipment,p,n.refits,n.implants,m(n.type)),[n.baseStats,n.equipment,p,n.refits,n.implants,m,n.type]);return e==="compact"?f.jsxs("div",{className:`flex-grow p-3 bg-dark border ${jn[n.rarity||"common"].borderColor} ${o?"border-2":""} ${a?"cursor-pointer hover:bg-dark-lighter":""}`,onClick:a,children:[f.jsx(Ff,{ship:n,variant:"compact"}),c]}):f.jsxs("div",{className:`flex flex-col flex-grow bg-dark border ${jn[n.rarity||"common"].borderColor} ${o?"border-2":""} ${a?"cursor-pointer hover:bg-dark-lighter":""}`,onClick:a,children:[f.jsxs("div",{className:`px-4 py-2 border-b ${jn[n.rarity||"common"].borderColor} flex justify-between items-center`,children:[f.jsx(Ff,{ship:n}),(t||i||d)&&f.jsxs("div",{className:"flex gap-1",children:[d&&f.jsx(ke,{"aria-label":n.equipmentLocked?"Unlock equipment":"Lock equipment",variant:"secondary",size:"sm",onClick:async()=>{try{await d(n)}catch(w){console.error("Failed to update lock state:",w)}},children:n.equipmentLocked?f.jsx(ET,{}):f.jsx(wT,{})}),t&&f.jsx(ke,{"aria-label":"Edit ship",variant:"secondary",size:"sm",onClick:w=>{w.stopPropagation(),t(n)},children:f.jsx(Wu,{})}),i&&f.jsx(ke,{"aria-label":"Remove ship",variant:"danger",size:"sm",onClick:w=>{w.stopPropagation(),i(n.id)},children:f.jsx(rn,{})})]})]}),c,f.jsx("div",{className:"px-4 relative flex-grow",children:f.jsxs("div",{className:"space-y-1 text-sm",children:[n.implants&&e==="full"&&f.jsxs("div",{className:"flex justify-between text-gray-300 border-b py-1 border-dark-lighter",children:[f.jsx("span",{children:"Implants:"}),f.jsx("span",{children:(E=n.implants)==null?void 0:E.length})]}),f.jsx("div",{className:"flex items-center justify-between",children:f.jsxs("div",{className:"flex-grow",children:[e==="full"&&f.jsx(Mf,{stats:v.final}),e==="extended"&&f.jsx(Jk,{breakdown:v})]})}),e!=="extended"&&f.jsx(er,{to:`/ships/${n.id}`,className:"ml-auto w-min block pt-2 pb-4",children:f.jsxs(ke,{"aria-label":"View ship details",variant:"secondary",className:"flex items-center",size:"xs",children:[f.jsx(t0,{})," ",f.jsx("span",{className:"ml-1",children:"Details"})]})})]})})]})});Al.displayName="ShipDisplay";const e2=Ir.SHIPS,Vn=({getGearPiece:n}={})=>{const{data:e=[],setData:t,loading:i}=Wo({key:e2,defaultValue:[]}),[o,a]=b.useState(),c=b.useCallback(async(N,O,U)=>{if(t(e.map(q=>{if(q.id!==N&&q.equipmentLocked&&Object.entries(q.equipment).some(([J,W])=>W===U))return q;if(q.id!==N&&!q.equipmentLocked&&Object.entries(q.equipment).some(([J,W])=>W===U)){const J={...q.equipment};return Object.entries(J).forEach(([W,Q])=>{Q===U&&delete J[W]}),{...q,equipment:J}}return q.id===N?{...q,equipment:{...q.equipment,[O]:U}}:q})),n){const q=n(U);if(q){const J={...q,shipId:N},W=new CustomEvent("updateInventory",{detail:{gear:J}});window.dispatchEvent(W)}}},[e,n,t]),d=b.useCallback((N,O)=>{t(e.map(U=>{if(U.id===N){const q={...U.equipment};return delete q[O],{...U,equipment:q}}return U}))},[e,t]),p=b.useCallback(async N=>{t(e.filter(O=>O.id!==N))},[e,t]),m=b.useCallback(async N=>{const O=e.some(U=>U.id===N.id)?e.map(U=>U.id===N.id?N:U):[...e,N];await t(O),a(void 0)},[e,t]),v=b.useCallback(N=>e.find(O=>O.id===N),[e]),E=b.useCallback(async N=>{const O=e.map(U=>U.id===N.id?{...N}:U);await t(O)},[e,t]),w=b.useCallback(async N=>{try{const O=!N.equipmentLocked;return await E({...N,equipmentLocked:O}),O}catch(O){throw console.error("Failed to update equipment lock state:",O),O}},[E]),S=b.useCallback(()=>{if(!n)return;const N=e.map(O=>{const U={...O.equipment};let q=!1;return Object.entries(U).forEach(([J,W])=>{if(W){const Q=n(W);(!Q||Q.shipId&&Q.shipId!==O.id)&&(delete U[J],q=!0)}}),q?{...O,equipment:U}:O});JSON.stringify(N)!==JSON.stringify(e)&&t(N)},[e,n,t]);b.useEffect(()=>{n&&!i&&S()},[n,i,S]);const R=b.useCallback(async N=>{t(e.map(O=>O.id===N?(Object.entries(O.equipment).filter(([q,J])=>J).map(([q,J])=>J).forEach(q=>{if(n){const J=n(q);if(J){const W=new CustomEvent("updateInventory",{detail:{gear:{...J,shipId:""}}});window.dispatchEvent(W)}}}),{...O,equipment:{}}):O))},[e,t,n]),j=b.useCallback(async(N,O)=>{t(e.map(U=>{if(O.filter(({gearId:J})=>e.some(W=>W.id!==N&&W.equipmentLocked&&Object.values(W.equipment).includes(J))).length>0)return U;if(U.id===N){const J={...U.equipment};return O.forEach(({slot:W,gearId:Q})=>{J[W]=Q}),{...U,equipment:J}}if(!U.equipmentLocked){const J={...U.equipment};let W=!1;if(Object.entries(J).forEach(([Q,k])=>{O.some(x=>x.gearId===k)&&(delete J[Q],W=!0)}),W)return{...U,equipment:J}}return U})),n&&O.forEach(({gearId:U})=>{const q=n(U);if(q){const J=new CustomEvent("updateInventory",{detail:{gear:{...q,shipId:N}}});window.dispatchEvent(J)}})},[e,t,n]);return{ships:e,loading:i,editingShip:o,setEditingShip:a,handleEquipGear:c,handleRemoveGear:d,handleRemoveShip:p,handleSaveShip:m,getShipById:v,updateShip:E,validateGearAssignments:S,handleLockEquipment:w,handleUnequipAllGear:R,handleEquipMultipleGear:j}},Hu=({stats:n,className:e="",title:t})=>n.length===0?null:f.jsxs("div",{className:`space-y-2 ${e}`,children:[t&&f.jsx("h3",{className:"text-lg font-semibold mb-2",children:t}),f.jsx("div",{className:"space-y-2",children:n.map((i,o)=>f.jsxs("div",{className:"flex justify-between items-center bg-dark-lighter px-3 py-1.5",children:[i.value!==0&&f.jsxs(f.Fragment,{children:[f.jsx("span",{children:Rt[i.name].label}),f.jsxs("span",{children:[i.value,i.type==="percentage"?"%":""]})]}),i.value===0&&f.jsx("span",{className:"text-gray-400",children:"No stats added"})]},`${i.name}-${o}`))})]}),dd=b.memo(({gear:n,showDetails:e=!0,mode:t="manage",onRemove:i,onEdit:o,onEquip:a,className:c=""})=>{const{getShipById:d}=Vn(),p=n.shipId?d(n.shipId):void 0,m=b.useMemo(()=>yt[n.setBonus].iconUrl,[n.setBonus]),v=b.useMemo(()=>jn[n.rarity],[n.rarity]),E=b.useCallback(()=>{i==null||i(n.id)},[n.id,i]),w=b.useCallback(()=>{o==null||o(n)},[n,o]),S=b.useCallback(()=>{a==null||a(n)},[n,a]);return f.jsxs("div",{className:`bg-dark shadow-md border ${v.borderColor} overflow-hidden flex-grow flex flex-col min-w-[230px] ${c}`,children:[f.jsxs("div",{className:`px-4 py-2 border-b ${v.textColor} ${v.borderColor} flex justify-between items-center`,children:[f.jsxs("div",{children:[f.jsxs("div",{className:"capitalize flex items-center gap-2",children:[f.jsx("img",{src:m,alt:n.setBonus,className:"w-6 h-auto"}),f.jsx("span",{className:"font-secondary",children:n.slot})]}),f.jsxs("div",{className:"flex items-center",children:[f.jsxs("span",{className:"text-yellow-400 text-sm",children:[" ",n.stars]}),f.jsxs("div",{className:"text-sm ps-3",children:["Lvl ",n.level]})]})]}),t==="manage"?f.jsxs("div",{className:"flex gap-2",children:[o&&f.jsx(ke,{"aria-label":"Edit gear piece",variant:"secondary",size:"sm",className:"ms-auto",onClick:w,children:f.jsx(Wu,{})}),i&&f.jsx(ke,{"aria-label":"Remove gear piece",variant:"danger",size:"sm",onClick:E,children:f.jsx(rn,{})})]}):a&&f.jsx(ke,{"aria-label":"Equip gear piece",variant:"primary",size:"sm",onClick:S,children:f.jsx(Yf,{})})]}),e&&f.jsxs("div",{className:"p-4 pb-2 space-y-4 flex-grow",children:[f.jsxs("div",{className:"bg-dark-lighter p-3",children:[f.jsx("div",{className:"text-sm text-gray-400 mb-1",children:"Main Stat"}),f.jsxs("div",{className:"font-medium capitalize ",children:[Rt[n.mainStat.name].label,": ",n.mainStat.value,n.mainStat.type==="percentage"?"%":""]})]}),n.subStats.length>0&&f.jsxs("div",{children:[f.jsx("div",{className:"text-sm text-gray-400 mb-2",children:"Sub Stats"}),f.jsx(Hu,{stats:n.subStats})]}),p&&f.jsxs("span",{className:"text-xxs text-gray-500",children:[" ","Equipped by: ",p.name]})]})]})},(n,e)=>n.gear.id===e.gear.id&&n.mode===e.mode&&n.showDetails===e.showDetails);dd.displayName="GearPieceDisplay";const hd=b.memo(({slotKey:n,gear:e,hoveredGear:t,onSelect:i,onRemove:o,onHover:a})=>{var c;return e?f.jsxs("div",{className:"relative",children:[f.jsxs("div",{className:`w-16 h-16 bg-dark-lighter border ${jn[e.rarity].borderColor} relative group ${i?"cursor-pointer":""} flex items-end justify-center`,onClick:()=>i&&i(n),onMouseEnter:()=>a(e),onMouseLeave:()=>a(null),children:[f.jsx("div",{className:"absolute top-1 left-1",children:f.jsx("img",{src:(c=yt[e.setBonus])==null?void 0:c.iconUrl,alt:e.setBonus,className:"w-5"})}),f.jsxs("div",{className:"text-xs  font-bold",children:[Rt[e.mainStat.name].shortLabel,e.mainStat.type==="percentage"?"%":""]}),f.jsxs("span",{className:"text-xs text-yellow-400 absolute top-1 right-1 text-center",children:[" ",e.stars]}),o&&f.jsx(ke,{"aria-label":"Remove gear piece",variant:"danger",size:"sm",onClick:()=>o&&o(n),className:"absolute -top-2 -right-2 rounded-full hidden group-hover:block",children:f.jsx(rn,{})})]}),f.jsx(Up,{isVisible:t===e,children:f.jsx(dd,{gear:e})})]}):f.jsx(ke,{variant:"secondary","aria-label":"Equip gear piece",onClick:()=>i&&i(n),className:"w-16 h-16 bg-dark-lighter border border-dark-border flex items-center justify-center hover:bg-dark-border transition-colors",children:f.jsx("span",{className:"text-xs text-gray-400 capitalize",children:"equip"})})});hd.displayName="GearSlot";const t2=({options:n,currentSort:e,onSort:t})=>f.jsx(f.Fragment,{children:f.jsxs("div",{className:"flex gap-2 items-end",children:[f.jsx(Lt,{label:"Sort by",value:e.field,onChange:i=>{t({field:i,direction:"asc"})},options:n,className:"text-xs"}),f.jsx(ke,{"aria-label":"Toggle sort direction",variant:"secondary",className:"w-12",onClick:()=>{t({field:e.field,direction:e.direction==="asc"?"desc":"asc"})},children:e.direction==="asc"?f.jsx(e0,{}):f.jsx(Zv,{})})]})}),EE=({filters:n,isOpen:e,onToggle:t,onClear:i,hasActiveFilters:o,sortOptions:a,sort:c,setSort:d})=>f.jsxs(f.Fragment,{children:[f.jsxs("div",{className:"flex justify-between items-center flex-wrap -mt-8",children:[o&&f.jsx("div",{className:"flex flex-wrap gap-2 me-2 order-2 md:order-unset w-full pt-2",children:n.map(p=>p.values.map(m=>{var v;return f.jsx("div",{className:"flex justify-between items-center",children:f.jsx(ke,{"aria-label":`Remove ${p.label} filter`,className:"relative flex items-center",variant:"secondary",onClick:()=>p.onChange([...p.values.filter(E=>E!==m)]),children:f.jsxs("div",{className:"flex items-center",children:[f.jsxs("div",{className:"flex flex-col items-start mr-3",children:[f.jsx("span",{className:"text-xxs",children:p.label}),f.jsx("span",{className:"text-xs",children:(v=p.options.find(E=>E.value===m))==null?void 0:v.label})]}),f.jsx(rn,{})]})})},m)}))}),f.jsx(ke,{variant:"secondary",className:"ml-auto",onClick:t,"aria-label":"Filter",children:f.jsx(_T,{})})]}),f.jsx(n0,{isOpen:e,onClose:t,title:"Filters",children:f.jsxs("div",{className:"space-y-4",children:[a&&c&&d&&f.jsx(t2,{options:a,currentSort:c,onSort:d}),n.map(p=>f.jsx(Hk,{label:p.label,values:p.values,onChange:p.onChange,options:p.options},p.id)),o&&f.jsx("div",{className:"pt-4",children:f.jsx(ke,{"aria-label":"Clear filters",variant:"secondary",fullWidth:!0,onClick:i,children:"Clear Filters"})})]})})]}),Av={sort:{field:"id",direction:"desc"},filters:{factions:[],shipTypes:[],rarities:[],sets:[],types:[],equipped:""}};function wE(n){const[e,t]=b.useState(()=>{const o=localStorage.getItem(n);return o?JSON.parse(o):Av});return b.useEffect(()=>{localStorage.setItem(n,JSON.stringify(e))},[e,n]),{state:e,setState:t,clearFilters:()=>{t(Av),localStorage.removeItem(n)}}}const Bp=({inventory:n,onRemove:e,onEdit:t,onEquip:i,mode:o="manage"})=>{var U,q,J;const[a,c]=Hf.useState(!1),{state:d,setState:p,clearFilters:m}=wE("gear-inventory-filters"),v=(((U=d.filters.sets)==null?void 0:U.length)??0)>0||(((q=d.filters.types)==null?void 0:q.length)??0)>0||(((J=d.filters.rarities)==null?void 0:J.length)??0)>0||(d.filters.equipped??"")!=="",E=b.useMemo(()=>n.filter(W=>{var P,M,V,D,ee,ue;const Q=(((P=d.filters.sets)==null?void 0:P.length)??0)===0||(((M=d.filters.sets)==null?void 0:M.includes(W.setBonus))??!1),k=(((V=d.filters.types)==null?void 0:V.length)??0)===0||(((D=d.filters.types)==null?void 0:D.includes(W.slot))??!1),x=(((ee=d.filters.rarities)==null?void 0:ee.length)??0)===0||(((ue=d.filters.rarities)==null?void 0:ue.includes(W.rarity))??!1),A=d.filters.equipped==="equipped"?W.shipId!==""&&W.shipId!==void 0:d.filters.equipped==="unequipped"?W.shipId===""||W.shipId===void 0:!0;return Q&&k&&x&&A}),[n,d.filters]),w=b.useMemo(()=>{const W=new Set(n.map(Q=>Q.setBonus));return Array.from(W).sort((Q,k)=>yt[Q].name.localeCompare(yt[k].name))},[n]),S=b.useMemo(()=>{const W=new Set(n.map(Q=>Q.slot));return Array.from(W).sort((Q,k)=>Ue[Q].label.localeCompare(Ue[k].label))},[n]),R=b.useMemo(()=>{const W=new Set(n.map(Q=>Q.rarity));return r0(Array.from(W))},[n]),j=[{id:"set",label:"Sets",values:d.filters.sets??[],onChange:W=>p(Q=>({...Q,filters:{...Q.filters,sets:W}})),options:w.map(W=>({value:W,label:yt[W].name}))},{id:"type",label:"Slots",values:d.filters.types??[],onChange:W=>p(Q=>({...Q,filters:{...Q.filters,types:W}})),options:S.map(W=>({value:W,label:Ue[W].label}))},{id:"rarity",label:"Rarity",values:d.filters.rarities??[],onChange:W=>p(Q=>({...Q,filters:{...Q.filters,rarities:W}})),options:R.map(W=>({value:W,label:jn[W].label}))},{id:"equipped",label:"Equipped",values:d.filters.equipped?[d.filters.equipped]:[],onChange:W=>{const Q=W[0]===d.filters.equipped?"":W[0];p(k=>({...k,filters:{...k.filters,equipped:Q}}))},options:[{value:"equipped",label:"Equipped to a ship"},{value:"unequipped",label:"Not equipped to a ship"}]}],N=[{value:"id",label:"Date Added"},{value:"setBonus",label:"Set"},{value:"level",label:"Level"},{value:"stars",label:"Stars"},{value:"rarity",label:"Rarity"}],O=b.useMemo(()=>[...E].sort((Q,k)=>{switch(d.sort.field){case"setBonus":return d.sort.direction==="asc"?yt[Q.setBonus].name.localeCompare(yt[k.setBonus].name):yt[k.setBonus].name.localeCompare(yt[Q.setBonus].name);case"level":return d.sort.direction==="asc"?Q.level-k.level:k.level-Q.level;case"stars":return d.sort.direction==="asc"?Q.stars-k.stars:k.stars-Q.stars;case"rarity":return d.sort.direction==="asc"?vr.indexOf(k.rarity)-vr.indexOf(Q.rarity):vr.indexOf(Q.rarity)-vr.indexOf(k.rarity);default:return d.sort.direction==="asc"?k.id.localeCompare(Q.id):Q.id.localeCompare(k.id)}}),[E,d.sort]);return f.jsxs("div",{className:"space-y-6",children:[f.jsxs("div",{className:"flex flex-col",children:[O.length>0&&f.jsxs("span",{className:"text-sm text-gray-400",children:["Showing ",O.length," gear pieces"]}),f.jsx(EE,{filters:j,isOpen:a,onToggle:()=>c(!a),onClear:m,hasActiveFilters:v,sortOptions:N,sort:d.sort,setSort:W=>p(Q=>({...Q,sort:W}))})]}),O.length===0?f.jsx("div",{className:"text-center py-8 text-gray-400 bg-dark-lighter border-2 border-dashed",children:n.length===0?"No gear pieces added yet":"No matching gear pieces found"}):f.jsx("div",{className:`grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 ${o==="manage"?"xl:grid-cols-4":""} gap-4`,children:O.map(W=>f.jsx(dd,{gear:W,mode:o,onEdit:t,onRemove:e,onEquip:i},W.id))})]})},zp=(n,e)=>b.useMemo(()=>{const t={};return Object.entries(n).forEach(([i,o])=>{if(o){const a=e(o);t[o]=a}}),t},[n,e]),TE=(n,e)=>b.useMemo(()=>{const t=Object.values(n).reduce((i,o)=>{if(!o)return i;const a=e[o];return a!=null&&a.setBonus&&(i[a.setBonus]=(i[a.setBonus]||0)+1),i},{});return Object.entries(t).flatMap(([i,o])=>{var c;const a=Math.floor(o/(((c=yt[i])==null?void 0:c.minPieces)||2));return Array(a).fill(i)})},[n,e]);function n2(n,e){return b.useMemo(()=>{const t={},i={};return Object.values((n==null?void 0:n.equipment)||{}).forEach(o=>{if(!o)return;const a=e[o];a!=null&&a.setBonus&&(t[a.setBonus]=(t[a.setBonus]||0)+1,i[a.setBonus]||(i[a.setBonus]=[]),i[a.setBonus].push(a))}),Object.entries(t).filter(([o,a])=>a<2).flatMap(([o])=>i[o]||[])},[n==null?void 0:n.equipment,e])}const SE=({ship:n,allShips:e,hoveredGear:t,availableGear:i,getGearPiece:o,onEdit:a,onRemove:c,onLockEquipment:d,onEquipGear:p,onRemoveGear:m,onHoverGear:v,onUnequipAll:E,variant:w="full"})=>{var A;const[S,R]=b.useState(null),[j,N]=b.useState(!1),[O,U]=b.useState(null),{addNotification:q}=Ht(),J=zp(n.equipment,o),W=TE(n.equipment,J),Q=()=>{E(n.id),q("success",`Unequipped all gear on ${n.name}`)},k=P=>{const M=e.find(V=>V.equipmentLocked&&V.id!==n.id&&Object.values(V.equipment).includes(P.id));if(M){q("error",`This gear is locked to ${M.name}. Please unlock the ship's equipment first.`);return}P.shipId&&P.shipId!==n.id?(U(P),N(!0)):S&&(p(n.id,S,P.id),R(null),q("success",`Equipped ${P.slot} on ${n.name}`))},x=()=>{O&&S&&(p(n.id,S,O.id),R(null),q("success",`Equipped ${O.slot} on ${n.name}`),U(null))};return f.jsxs(f.Fragment,{children:[f.jsx(Al,{ship:n,onEdit:a,onRemove:c,onLockEquipment:d,variant:w,children:f.jsxs("div",{className:"p-4 bg-dark",children:[f.jsx("div",{className:"grid grid-cols-3 gap-2 w-fit mx-auto",children:Object.entries(Ue).map(([P,M])=>f.jsx(hd,{slotKey:P,gear:J[n.equipment[P]||""],hoveredGear:t,onSelect:R,onRemove:V=>m(n.id,V),onHover:v},P))}),f.jsxs("div",{className:"flex items-center gap-2 pt-3",children:[W&&f.jsxs(f.Fragment,{children:[f.jsx("span",{className:"text-xs text-gray-400",children:"Gear Sets:"}),W.map((P,M)=>f.jsx("img",{src:yt[P].iconUrl,alt:P,className:"w-5"},`${P}-${M}`))]}),Object.values(n.equipment)&&f.jsx(ke,{"aria-label":"Unequip all gear",className:"ml-auto",variant:"secondary",size:"xs",onClick:Q,children:"Unequip All"})]})]})}),f.jsx(Jo,{isOpen:S!==null,onClose:()=>R(null),title:`Select ${S} for ${n.name}`,children:f.jsx(Bp,{inventory:i.filter(P=>S&&P.slot===S),mode:"select",onEquip:k,onRemove:()=>{},onEdit:()=>{}})}),f.jsx(Nl,{isOpen:j,onClose:()=>{N(!1),U(null)},onConfirm:x,title:"Move Gear",message:`This ${O==null?void 0:O.slot} is currently equipped on ${((A=e.find(P=>P.id===(O==null?void 0:O.shipId)))==null?void 0:A.name)||"another ship"}. Would you like to move it to ${n.name} instead?`,confirmLabel:"Move",cancelLabel:"Cancel"})]})},r2=({ships:n,onRemove:e,onEdit:t,onEquipGear:i,onRemoveGear:o,onLockEquipment:a,onUnequipAll:c,availableGear:d})=>{var V,D,ee;const[p,m]=b.useState(null),[v,E]=b.useState(!1),{state:w,setState:S,clearFilters:R}=wE("ship-inventory-filters"),j=(((V=w.filters.factions)==null?void 0:V.length)??0)>0||(((D=w.filters.shipTypes)==null?void 0:D.length)??0)>0||(((ee=w.filters.rarities)==null?void 0:ee.length)??0)>0,N=ue=>{S(he=>({...he,filters:{...he.filters,factions:ue}}))},O=ue=>{S(he=>({...he,filters:{...he.filters,shipTypes:ue}}))},U=ue=>{S(he=>({...he,filters:{...he.filters,rarities:ue}}))},q=ue=>{S(he=>({...he,sort:ue}))},J=b.useMemo(()=>n.filter(ue=>{var fe,le,z,X,pe,xe;const he=(((fe=w.filters.factions)==null?void 0:fe.length)??0)===0||(((le=w.filters.factions)==null?void 0:le.includes(ue.faction))??!1),re=(((z=w.filters.shipTypes)==null?void 0:z.length)??0)===0||(((X=w.filters.shipTypes)==null?void 0:X.includes(ue.type))??!1),ae=(((pe=w.filters.rarities)==null?void 0:pe.length)??0)===0||(((xe=w.filters.rarities)==null?void 0:xe.includes(ue.rarity))??!1);return he&&re&&ae}),[n,w.filters]),W=b.useMemo(()=>{const ue=new Set(n.map(he=>he.faction));return Array.from(ue).sort((he,re)=>tr[he].name.localeCompare(tr[re].name))},[n]),Q=b.useMemo(()=>{const ue=new Set(n.map(he=>he.type));return Array.from(ue).sort((he,re)=>lt[he].name.localeCompare(lt[re].name))},[n]),k=b.useMemo(()=>{const ue=new Set(n.map(he=>he.rarity));return r0(Array.from(ue))},[n]),{getGearPiece:x}=Cr(),A=[{id:"faction",label:"Factions",values:w.filters.factions??[],onChange:N,options:W.map(ue=>({value:ue,label:tr[ue].name}))},{id:"shipType",label:"Ship Type",values:w.filters.shipTypes??[],onChange:O,options:Q.map(ue=>({value:ue,label:lt[ue].name}))},{id:"rarity",label:"Rarity",values:w.filters.rarities??[],onChange:U,options:k.map(ue=>({value:ue,label:jn[ue].label}))}],P=[{value:"id",label:"Date Added"},{value:"name",label:"Name"},{value:"type",label:"Type"},{value:"faction",label:"Faction"},{value:"rarity",label:"Rarity"},{value:"gearCount",label:"Gear"}],M=b.useMemo(()=>[...J].sort((he,re)=>{switch(w.sort.field){case"type":return w.sort.direction==="asc"?lt[he.type].name.localeCompare(lt[re.type].name):lt[re.type].name.localeCompare(lt[he.type].name);case"faction":return w.sort.direction==="asc"?tr[he.faction].name.localeCompare(tr[re.faction].name):tr[re.faction].name.localeCompare(tr[he.faction].name);case"rarity":return w.sort.direction==="asc"?vr.indexOf(re.rarity)-vr.indexOf(he.rarity):vr.indexOf(he.rarity)-vr.indexOf(re.rarity);case"gearCount":{const ae=Object.values(he.equipment).filter(Boolean).length,fe=Object.values(re.equipment).filter(Boolean).length;return w.sort.direction==="asc"?ae-fe:fe-ae}case"name":return w.sort.direction==="asc"?he.name.localeCompare(re.name):re.name.localeCompare(he.name);default:return w.sort.direction==="asc"?he.id.localeCompare(re.id):re.id.localeCompare(he.id)}}),[J,w.sort]);return f.jsxs("div",{className:"space-y-6",children:[f.jsxs("div",{className:"flex flex-col",children:[M.length>0&&f.jsxs("span",{className:"text-sm text-gray-400 ",children:["Showing ",M.length," ships"]}),f.jsx(EE,{filters:A,isOpen:v,onToggle:()=>E(!v),onClear:R,hasActiveFilters:j,sortOptions:P,sort:w.sort,setSort:q})]}),M.length===0?f.jsx("div",{className:"text-center py-8 text-gray-400 bg-dark-lighter  border-2 border-dashed",children:n.length===0?"No ships created yet":"No matching ships found"}):f.jsx(f.Fragment,{children:f.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:M.map(ue=>f.jsx(SE,{ship:ue,allShips:n,hoveredGear:p,availableGear:d,getGearPiece:x,onEdit:t,onRemove:e,onLockEquipment:a,onEquipGear:i,onRemoveGear:o,onUnequipAll:c,onHoverGear:m},ue.id))})})]})},i2=()=>{const{inventory:n}=Cr(),[e,t]=b.useState(!1),[i,o]=b.useState(!1),[a,c]=b.useState(null),d=b.useCallback(W=>n.find(Q=>Q.id===W),[n]),{ships:p,loading:m,editingShip:v,handleRemoveShip:E,handleEquipGear:w,handleRemoveGear:S,handleSaveShip:R,setEditingShip:j,handleLockEquipment:N,handleUnequipAllGear:O}=Vn({getGearPiece:d}),{addNotification:U}=Ht(),q=async W=>{c(p.find(Q=>Q.id===W)||null),o(!0)},J=async()=>{if(!a)return;const W=Object.entries(a.equipment).map(([Q,k])=>k?S(a.id,Q):Promise.resolve());await Promise.all(W),await E(a.id),U("success","Ship removed successfully"),c(null)};return m?f.jsx("div",{className:"flex items-center justify-center",children:f.jsx("div",{className:"animate-pulse text-xl",children:"Loading ships..."})}):f.jsxs(Tr,{title:"Ship Management",description:"Manage your ships and their equipment.",action:{label:e?"Hide Form":"Create",onClick:()=>{v&&j(void 0),t(!e)},variant:e?"secondary":"primary"},children:[f.jsx(Cs,{isVisible:e||!!v,children:f.jsx(_E,{onSubmit:async W=>{await R(W),t(!1),window.scrollTo({top:0,behavior:"smooth"}),j(void 0),U("success","Ship saved successfully")},editingShip:v})}),f.jsx(r2,{ships:p,onRemove:q,onEdit:W=>{j(W),t(!0),window.scrollTo({top:0,behavior:"smooth"})},onLockEquipment:async W=>{const Q=await N(W);U("success",`Equipment lock state on ${W.name} set to ${Q}`)},onEquipGear:w,onRemoveGear:S,onUnequipAll:O,availableGear:n}),f.jsx(Nl,{isOpen:i,onClose:()=>{o(!1),c(null)},onConfirm:J,title:"Delete Ship",message:a!=null&&a.equipment&&Object.values(a.equipment).some(W=>W)?`This ship has equipped gear that will be unequipped. Are you sure you want to delete ${a.name}?`:`Are you sure you want to delete ${a==null?void 0:a.name}?`,confirmLabel:"Delete",cancelLabel:"Cancel"})]})},s2={1:{0:1,1:2,2:3,3:4,4:5,5:6,6:7,7:8,8:8,9:9,10:10,11:11,12:12,13:14,14:16,15:18,16:20},2:{0:2,1:3,2:4,3:5,4:6,5:7,6:8,7:9,8:9,9:10,10:11,11:12,12:14,13:17,14:20,15:22,16:25},3:{0:3,1:4,2:5,3:6,4:6,5:8,6:10,7:12,8:13,9:14,10:15,11:16,12:18,13:20,14:22,15:24,16:25},4:{0:5,1:6,2:7,3:8,4:10,5:11,6:12,7:13,8:15,9:17,10:19,11:20,12:21,13:24,14:27,15:29,16:30},5:{0:8,1:9,2:10,3:11,4:14,5:15,6:16,7:17,8:20,9:22,10:24,11:26,12:29,13:31,14:33,15:35,16:40},6:{0:12,1:14,2:16,3:18,4:21,5:23,6:25,7:27,8:30,9:32,10:34,11:36,12:39,13:42,14:45,15:47,16:50}},o2={1:{0:10,1:12,2:14,3:16,4:20,5:23,6:26,7:29,8:35,9:40,10:45,11:50,12:55,13:65,14:75,15:85,16:100},2:{0:20,1:24,2:28,3:32,4:40,5:46,6:52,7:58,8:70,9:80,10:90,11:100,12:110,13:130,14:150,15:170,16:200},3:{0:40,1:48,2:56,3:64,4:80,5:92,6:104,7:116,8:140,9:160,10:180,11:200,12:220,13:260,14:300,15:340,16:400},4:{0:60,1:72,2:84,3:96,4:120,5:138,6:156,7:174,8:210,9:234,10:258,11:282,12:330,13:360,14:390,15:420,16:600},5:{0:80,1:96,2:112,3:128,4:160,5:184,6:208,7:232,8:280,9:312,10:344,11:376,12:440,13:480,14:520,15:560,16:800},6:{0:100,1:120,2:140,3:160,4:200,5:230,6:260,7:290,8:350,9:390,10:430,11:470,12:550,13:600,14:650,15:700,16:1e3}},a2={1:{0:0,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0,9:0,10:0,11:0,12:0,13:0,14:0,15:0,16:0},2:{0:0,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0,9:0,10:0,11:0,12:0,13:0,14:0,15:0,16:0},3:{0:200,1:240,2:280,3:320,4:400,5:464,6:528,7:592,8:720,9:816,10:912,11:1008,12:1200,13:1320,14:1440,15:1560,16:2e3},4:{0:300,1:360,2:420,3:480,4:600,5:696,6:792,7:888,8:1080,9:1224,10:1368,11:1512,12:1800,13:1980,14:2160,15:2340,16:3e3},5:{0:400,1:480,2:560,3:640,4:800,5:928,6:1056,7:1184,8:1440,9:1632,10:1824,11:2016,12:2400,13:2640,14:2880,15:3120,16:4e3},6:{0:500,1:600,2:700,3:800,4:1e3,5:1160,6:1320,7:1480,8:1800,9:2040,10:2280,11:2520,12:3e3,13:3300,14:3600,15:3900,16:5e3}},l2={1:{0:2,1:4,2:6,3:8,4:10,5:11,6:12,7:13,8:13,9:14,10:15,11:16,12:24,13:26,14:28,15:30,16:20},2:{0:0,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0,9:0,10:0,11:0,12:0,13:0,14:0,15:0,16:0},3:{0:4,1:6,2:8,3:10,4:12,5:14,6:16,7:18,8:26,9:29,10:32,11:35,12:41,13:44,14:47,15:50,16:40},4:{0:6,1:8,2:10,3:12,4:15,5:18,6:21,7:24,8:26,9:29,10:32,11:35,12:41,13:44,14:47,15:50,16:60},5:{0:8,1:10,2:12,3:14,4:18,5:21,6:24,7:27,8:33,9:36,10:39,11:42,12:48,13:52,14:56,15:60,16:80},6:{0:10,1:12,2:14,3:16,4:20,5:24,6:28,7:32,8:33,9:36,10:39,11:42,12:55,13:60,14:65,15:70,16:100}},c2={3:{0:5,1:6,2:7,3:8,4:10,5:11,6:12,7:13,8:14,9:15,10:16,11:17,12:20,13:22,14:24,15:26,16:30},4:{0:6,1:7,2:8,3:9,4:11,5:12,6:13,7:14,8:16,9:18,10:20,11:22,12:25,13:27,14:29,15:31,16:35},5:{0:8,1:9,2:10,3:11,4:14,5:15,6:16,7:17,8:20,9:22,10:24,11:26,12:29,13:31,14:33,15:35,16:40},6:{0:10,1:11,2:12,3:13,4:16,5:17,6:18,7:19,8:22,9:24,10:26,11:28,12:34,13:37,14:40,15:43,16:50}};function xE(n,e,t,i){var a;let o;return e==="percentage"?o=s2:n==="hp"?o=a2:n==="speed"?o=c2:n==="hacking"||n==="security"?o=l2:o=o2,(a=o[t])!=null&&a[i]?o[t][i]:0}const u2=({onSubmit:n,editingPiece:e})=>{const[t,i]=b.useState((e==null?void 0:e.slot)||"weapon"),[o,a]=b.useState((e==null?void 0:e.mainStat)||{name:"attack",value:0,type:"flat"}),[c,d]=b.useState((e==null?void 0:e.subStats)||[]),[p,m]=b.useState((e==null?void 0:e.rarity)||"rare"),[v,E]=b.useState((e==null?void 0:e.stars)||1),[w,S]=b.useState((e==null?void 0:e.setBonus)||"FORTITUDE"),[R,j]=b.useState((e==null?void 0:e.level)||0),N=b.useRef(!0);b.useEffect(()=>{e&&(i(e.slot),a(e.mainStat),d(e.subStats),m(e.rarity),E(e.stars),S(e.setBonus),j(e.level))},[e]);const O=x=>IT[x],U=x=>Rt[x].allowedTypes;b.useEffect(()=>{if(!e){const x=O(t);x.includes(o.name)||a({name:x[0],value:0,type:"flat"})}},[t,e,o.name,o.value]),b.useEffect(()=>{if(!e&&!N.current){const x=xE(o.name,o.type,v,R);x!==o.value&&a(A=>({...A,value:x}))}},[v,R,o.name,o.type,o.value,e]),b.useEffect(()=>{N.current=!1},[]);const q=b.useCallback(x=>{if(x.name){const A=Rt[x.name].allowedTypes;x.type=A.includes(o.type)?o.type:A[0]}if(x.value!==void 0){const A=Rt[x.name||o.name],P=x.type||o.type;x.value=Math.min(x.value,A.maxValue[P])}a(A=>({...A,...x}))},[o.type,o.name]),J=x=>{x.preventDefault();const A=c.map(M=>{if(M.name===o.name)return{...M,type:o.type==="flat"?"percentage":"flat"};const V=Rt[M.name].allowedTypes;return V.includes(M.type)?M:{...M,type:V[0]}}),P={id:(e==null?void 0:e.id)||Date.now().toString(),slot:t,mainStat:o,subStats:A,setBonus:w,stars:v,rarity:p,level:R,shipId:(e==null?void 0:e.shipId)||""};n(P),d([]),E(1),j(0),i("weapon"),a({name:"attack",value:0,type:"flat"}),m("rare"),S("FORTITUDE")},W=Object.entries(yt).map(([x,A])=>({value:x,label:A.name})),Q=Object.entries(jn).map(([x,A])=>({value:x,label:A.label})),k=Object.entries(Ue).map(([x,A])=>({value:x,label:A.label}));return f.jsxs("form",{onSubmit:J,className:"space-y-6  bg-dark p-6",children:[f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[f.jsx(Lt,{label:"Set Bonus",value:w,onChange:x=>S(x),options:W}),f.jsx(Lt,{label:"Slot",value:t,onChange:x=>i(x),options:k}),f.jsx(Lt,{label:"Stars",value:v.toString(),onChange:x=>E(Number(x)),options:[1,2,3,4,5,6].map(x=>({value:x.toString(),label:`${x} `}))}),f.jsx(Ln,{type:"number",label:"Level",value:R,min:0,max:16,onChange:x=>j(Math.min(16,Math.max(0,Number(x.target.value))))}),f.jsx(Lt,{label:"Rarity",value:p,onChange:x=>m(x),options:Q}),f.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[f.jsx(Lt,{label:"Main Stat",value:o.name,onChange:x=>q({name:x}),options:O(t).map(x=>({value:x,label:Rt[x].label})),"data-testid":"main-stat-select"}),f.jsx(Ln,{label:"Main Stat Value",type:"number",value:o.value,onChange:x=>q({value:Number(x.target.value)}),className:"w-32",labelClassName:"invisible"}),(t==="sensor"||t==="software"||t==="thrusters")&&f.jsx(Lt,{value:o.type,onChange:x=>q({type:x}),options:U(o.name).map(x=>({value:x,label:x.charAt(0).toUpperCase()+x.slice(1)})),className:"w-32"})]})]}),f.jsxs("div",{className:"space-y-4",children:[f.jsx("h4",{className:"text-sm font-medium ",children:"Sub Stats"}),f.jsx($u,{stats:c,onChange:d,maxStats:4,excludedStats:[{name:o.name,type:o.type}]})]}),f.jsx("div",{className:"flex justify-end pt-4",children:f.jsx(ke,{"aria-label":e?"Save gear piece":"Add gear piece",type:"submit",children:e?"Save Gear Piece":"Add Gear Piece"})})]})};function IE(n){return 88.3505*Math.exp(-Math.pow((4.5552-Math.log10(n))/1.3292,2))}function RE(n,e){const t=IE(e);return n*(100/(100-t))}function AE(n){const t=1+(n.crit>=100?1:n.crit/100)*((n.critDamage||0)/100);return(n.attack||0)*t}function Ko(n,e,t,i){let o=0;for(const c of e){const d=n[c.stat]||0;if(c.minLimit&&d<c.minLimit){const p=(c.minLimit-d)/c.minLimit;o+=p*100}if(c.maxLimit&&d>c.maxLimit){const p=(d-c.maxLimit)/c.maxLimit;o+=p*100}}let a=0;if(t)switch(t){case"Attacker":a=h2(n);break;case"Defender":a=f2(n);break;case"Debuffer":a=p2(n);break;case"Supporter":a=m2(n);break;case"Supporter(Buffer)":a=g2(n,i);break}else a=d2(n,e);return Math.max(0,a*(1-o/100))}function d2(n,e){let t=0;return e.forEach((i,o)=>{const a=n[i.stat]||0,c=RT[i.stat]||1,d=a/c,p=Math.pow(2,e.length-o-1);t+=d*i.weight*p}),t}function h2(n){return AE(n)}function f2(n){return RE(n.hp||0,n.defence||0)}function p2(n){const e=n.hacking||0;return AE(n)*e}function m2(n){const e=(n.hp||0)*.15,i=1+(n.crit>=100?1:(n.crit||0)/100)*((n.critDamage||0)/100),o=n.healModifier||0;return e*i*(1+o/100)}function g2(n,e){const t=n.speed||0,i=(e==null?void 0:e.BOOST)||0,o=RE(n.hp||0,n.defence||0);let a;t<=180?a=t*10:a=180*10+Math.sqrt(t-180)*20;let c=0;i>=4&&(c=3e3);const d=Math.sqrt(o)*2;return a+c+d}function Qo(n,e,t,i,o,a){const c=pn(n.baseStats,e,i,n.refits,n.implants,o(n.type)),d={};return Object.values(e).forEach(m=>{if(!m)return;const v=i(m);v!=null&&v.setBonus&&(d[v.setBonus]=(d[v.setBonus]||0)+1)}),Ko(c.final,t,a,d)}const cl={hp:{flat:{min:250,max:500},percentage:{min:4,max:7}},attack:{flat:{min:50,max:100},percentage:{min:4,max:7}},defence:{flat:{min:50,max:100},percentage:{min:4,max:7}},hacking:{flat:{min:5,max:8}},security:{flat:{min:5,max:8}},speed:{flat:{min:5,max:8}},crit:{percentage:{min:4,max:7}},critDamage:{percentage:{min:4,max:7}},healModifier:{percentage:{min:4,max:7}}},y2={rare:{increases:[4,8],additions:[12,16],initialSubstats:2},epic:{increases:[4,8,12],additions:[16],initialSubstats:3},legendary:{increases:[4,8,12,16],additions:[],initialSubstats:4}};function v2(n,e){const t=[];return Object.entries(Rt).forEach(([i,o])=>{const a=i;if(a===e.name)return;const c=o.allowedTypes.filter(d=>!n.some(p=>p.name===a&&p.type===d));c.length>0&&t.push({name:a,types:c})}),t}function _2(n,e){var a;const t=(a=cl[n.name])==null?void 0:a[n.type];if(!t)return 0;const{min:i,max:o}=t;switch(e){case"rare":return i;case"epic":return Math.floor((i+o)/2);case"legendary":return o;default:return 0}}function E2(n,e=16){if(n.level>=e)return n;const t=y2[n.rarity];if(!t)return n;const i={...n},o=xE(n.mainStat.name,n.mainStat.type,n.stars,e);i.mainStat={...n.mainStat,value:o};const a=[...n.subStats],c=[];for(let d=n.level+4;d<=e;d+=4)c.push(d);return c.forEach(d=>{var p;if(t.additions.includes(d)){const m=v2(a,n.mainStat);if(m.length>0){const v=m[Math.floor(Math.random()*m.length)],E=v.types[Math.floor(Math.random()*v.types.length)];if((p=cl[v.name])!=null&&p[E]){const w=Math.floor(cl[v.name][E].min+Math.random()*(cl[v.name][E].max-cl[v.name][E].min));a.push({name:v.name,type:E,value:w})}}}else if(t.increases.includes(d)){const m=Math.floor(Math.random()*a.length),v=a[m],E=_2(v,n.rarity);E>0&&(a[m]={...v,value:v.value+E})}}),i.subStats=a,i.level=e,i}function Cv(n){return pn({hp:2e4,attack:5e3,defence:3e3,hacking:150,security:50,speed:80,crit:50,critDamage:0,healModifier:0},{[n.slot]:n.id},t=>t===n.id?n:void 0,[],[],void 0).final}function w2(n,e,t=3){return n.filter(a=>a.level<16&&["rare","epic","legendary"].includes(a.rarity)).map(a=>{const c=Cv(a),d=Ko(c,[],e),p=Array.from({length:10},()=>{const v=E2(a),E=Cv(v),w=Ko(E,[],e);return{piece:v,score:w}}),m=p.reduce((v,E)=>v+E.score,0)/p.length;return{piece:a,currentScore:d,potentialScore:m,improvement:m-d}}).sort((a,c)=>c.improvement/c.currentScore-a.improvement/a.currentScore).slice(0,t)}const T2=["text-yellow-500","text-gray-400","text-amber-600"],S2=({inventory:n,shipRoles:e})=>f.jsxs("div",{className:"space-y-8",children:[f.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Gear Upgrade Analysis (EXPERIMENTAL)"}),f.jsx("span",{className:"text-sm text-gray-400",children:"This analysis tries to find the 3 best gear upgrades for each ship role, by simulating upgrading each piece to 16, 10 different times, and averaging the results. The results are percentages of improvement to the role score over the current level of the piece."}),e.map(t=>{const i=w2(n,lt[t].name);return i.length===0?null:f.jsxs("div",{className:"space-y-4 bg-dark p-4",children:[f.jsx("h3",{className:"text-lg font-medium",children:lt[t].name}),f.jsx("span",{className:"text-sm text-gray-400",children:lt[t].description}),f.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:i.map((o,a)=>f.jsxs("div",{className:"space-y-2",children:[f.jsx(dd,{gear:o.piece}),f.jsx("div",{className:"text-sm px-4 pb-4",children:f.jsxs("div",{className:`flex justify-between ${T2[a]}`,children:[f.jsx("span",{children:"Average improvement:"}),f.jsxs("span",{children:[Math.round(o.improvement/o.currentScore*100),"%"]})]})})]},o.piece.id))})]},t)})]}),x2=()=>{const{inventory:n,loading:e,error:t,saveInventory:i}=Cr(),[o,a]=b.useState(),[c,d]=b.useState(!1),{addNotification:p}=Ht(),{ships:m}=Vn(),[v,E]=b.useState(!1),[w,S]=b.useState(null),[R,j]=b.useState(!1),[N,O]=b.useState("inventory"),U=[{id:"inventory",label:"Inventory"},{id:"analysis",label:"Upgrade Analysis"}];b.useEffect(()=>{(async()=>{const x=n.map(A=>{if(A.shipId){const P=m.find(M=>M.id===A.shipId);if(!P||!Object.values(P.equipment).includes(A.id))return{...A,shipId:""}}return A});JSON.stringify(x)!==JSON.stringify(n)&&await i(x)})()},[n,m,i]);const q=async k=>{const x=n.find(A=>A.id===k);j(!!(x!=null&&x.shipId)),S(k),E(!0)},J=async k=>{const x=n.filter(A=>A.id!==k);await i(x),p("success","Gear piece removed successfully"),S(null),E(!1)},W=k=>{window.scrollTo({top:0,behavior:"smooth"}),a(k),d(!0)},Q=async k=>{let x;o?x=n.map(A=>A.id===k.id?k:A):x=[...n,k],await i(x),a(void 0),d(!1),window.scrollTo({top:0,behavior:"smooth"}),p("success","Gear piece saved successfully")};return e?f.jsx(Tr,{title:"Gear Management",children:f.jsx("div",{className:"flex items-center justify-center",children:f.jsx("div",{className:"animate-pulse text-xl ",children:"Loading inventory..."})})}):f.jsxs(Tr,{title:"Gear Management",description:"Manage your gear and its stats.",action:{label:c?"Hide Form":"Create",onClick:()=>{o&&a(void 0),d(!c)},variant:c?"secondary":"primary"},children:[t&&f.jsx("div",{className:"mb-6 p-4 bg-red-100 border border-red-400 text-red-700",children:t}),f.jsx(Cs,{isVisible:c||!!o,children:f.jsx(u2,{onSubmit:Q,editingPiece:o})}),f.jsx(vE,{tabs:U,activeTab:N,onChange:O}),N==="inventory"?f.jsx(f.Fragment,{children:f.jsx(Bp,{inventory:n,onRemove:q,onEdit:W})}):f.jsx(S2,{inventory:n,shipRoles:Object.keys(lt)}),f.jsx(Nl,{isOpen:v,onClose:()=>{E(!1),S(null)},onConfirm:()=>w&&J(w),title:"Delete Gear Piece",message:R?"This gear piece is currently equipped. Are you sure you want to delete it?":"Are you sure you want to delete this gear piece?",confirmLabel:"Delete",cancelLabel:"Cancel"})]})},Vo=1e3,I2=15e3,R2=170,A2=.15;function Uf(n,e){switch(e){case"Attacker":return Bf(n);case"Defender":return kv(n);case"Debuffer":return C2(n);case"Supporter":return k2(n);case"Supporter(Buffer)":return{...kv(n),speed:n.speed};default:return Bf(n)}}function Bf(n){let e=0,t=0,i=1/0,o=0;for(let a=0;a<Vo;a++){const c=b2(n);e+=c,t=Math.max(t,c),i=Math.min(i,c),c>n.attack&&o++}return{averageDamage:Math.round(e/Vo),highestHit:Math.round(t),lowestHit:Math.round(i),critRate:Math.round(o/Vo*100)/100}}function kv(n){const e=IE(n.defence||0),t=(n.hp||0)*(100/(100-e)),i=I2*((100-e)/100),o=Math.floor(t/i);return{effectiveHP:Math.round(t),attacksWithstood:o,damageReduction:Math.round(e*100)/100}}function C2(n){const e=n.hacking||0,t=Math.min(100,Math.max(0,e-R2)),i=Bf(n);return{hackSuccessRate:Math.round(t*100)/100,averageDamage:i.averageDamage,highestHit:i.highestHit,lowestHit:i.lowestHit,critRate:i.critRate}}function k2(n){let e=0,t=0,i=1/0,o=0;const a=(n.hp||0)*A2,c=1+(n.healModifier||0)/100;for(let d=0;d<Vo;d++){const p=N2(a,c,n);e+=p,t=Math.max(t,p),i=Math.min(i,p),p>a&&o++}return{averageHealing:Math.round(e/Vo),highestHeal:Math.round(t),lowestHeal:Math.round(i),critRate:Math.round(o/Vo*100)/100}}function b2(n){const e=n.attack||0;return Math.random()*100<=(n.crit||0)?e*(1+(n.critDamage||0)/100):e}function N2(n,e,t){const o=Math.random()*100<=(t.crit||0);let a=n;return o&&(a=n*(1+(t.critDamage||0)/100)),a*e}const CE=({currentSimulation:n,suggestedSimulation:e,role:t})=>{const i=(m,v=!1)=>f.jsxs(f.Fragment,{children:[f.jsxs("div",{children:[f.jsx("span",{className:"text-gray-400",children:"Average Damage:"}),f.jsxs("span",{className:"ml-2",children:[m.averageDamage,v&&e&&f.jsxs("span",{className:`ml-2 ${e.averageDamage>n.averageDamage?"text-green-500":"text-red-500"}`,children:["(",((e.averageDamage-n.averageDamage)/n.averageDamage*100).toFixed(1),"%)"]})]})]}),f.jsxs("div",{children:[f.jsx("span",{className:"text-gray-400",children:"Highest Hit:"}),f.jsx("span",{className:"ml-2",children:m.highestHit})]}),f.jsxs("div",{children:[f.jsx("span",{className:"text-gray-400",children:"Lowest Hit:"}),f.jsx("span",{className:"ml-2",children:m.lowestHit})]}),m.critRate&&f.jsxs("div",{children:[f.jsx("span",{className:"text-gray-400",children:"Crit Rate:"}),f.jsxs("span",{className:"ml-2",children:[m.critRate*100,"%"]})]})]}),o=(m,v=!1)=>{var E;return f.jsxs(f.Fragment,{children:[f.jsxs("div",{children:[f.jsx("span",{className:"text-gray-400",children:"Effective HP:"}),f.jsxs("span",{className:"ml-2",children:[(E=m.effectiveHP)==null?void 0:E.toLocaleString(),v&&e&&f.jsxs("span",{className:`ml-2 ${e.effectiveHP>n.effectiveHP?"text-green-500":"text-red-500"}`,children:["(",((e.effectiveHP-n.effectiveHP)/n.effectiveHP*100).toFixed(1),"%)"]})]})]}),f.jsxs("div",{children:[f.jsx("span",{className:"text-gray-400",children:"Damage Reduction:"}),f.jsxs("span",{className:"ml-2",children:[m.damageReduction,"%",v&&e&&f.jsxs("span",{className:`ml-2 ${e.damageReduction>n.damageReduction?"text-green-500":"text-red-500"}`,children:["(",(e.damageReduction-n.damageReduction).toFixed(1),"%)"]})]})]}),f.jsxs("div",{children:[f.jsx("span",{className:"text-gray-400",children:"Attacks Withstood:"}),f.jsxs("span",{className:"ml-2",children:[m.attacksWithstood,v&&e&&f.jsxs("span",{className:`ml-2 ${e.attacksWithstood>n.attacksWithstood?"text-green-500":"text-red-500"}`,children:["(",((e.attacksWithstood-n.attacksWithstood)/n.attacksWithstood*100).toFixed(1),"%)"]})]})]})]})},a=(m,v=!1)=>f.jsxs(f.Fragment,{children:[f.jsxs("div",{children:[f.jsx("span",{className:"text-gray-400",children:"Hack Success Rate:"}),f.jsxs("span",{className:"ml-2",children:[m.hackSuccessRate,"%",v&&e&&f.jsxs("span",{className:`ml-2 ${e.hackSuccessRate>n.hackSuccessRate?"text-green-500":"text-red-500"}`,children:["(",((e.hackSuccessRate-n.hackSuccessRate)/n.hackSuccessRate*100).toFixed(1),"%)"]})]})]}),f.jsxs("div",{children:[f.jsx("span",{className:"text-gray-400",children:"Average Damage:"}),f.jsxs("span",{className:"ml-2",children:[m.averageDamage,v&&e&&f.jsxs("span",{className:`ml-2 ${e.averageDamage>n.averageDamage?"text-green-500":"text-red-500"}`,children:["(",((e.averageDamage-n.averageDamage)/n.averageDamage*100).toFixed(1),"%)"]})]})]})]}),c=(m,v=!1)=>{var E,w,S;return f.jsxs(f.Fragment,{children:[f.jsxs("div",{children:[f.jsx("span",{className:"text-gray-400",children:"Average Healing:"}),f.jsxs("span",{className:"ml-2",children:[(E=m.averageHealing)==null?void 0:E.toLocaleString(),v&&e&&f.jsxs("span",{className:`ml-2 ${e.averageHealing>n.averageHealing?"text-green-500":"text-red-500"}`,children:["(",((e.averageHealing-n.averageHealing)/n.averageHealing*100).toFixed(1),"%)"]})]})]}),f.jsxs("div",{children:[f.jsx("span",{className:"text-gray-400",children:"Highest Heal:"}),f.jsxs("span",{className:"ml-2",children:[(w=m.highestHeal)==null?void 0:w.toLocaleString(),v&&e&&f.jsxs("span",{className:`ml-2 ${e.highestHeal>n.highestHeal?"text-green-500":"text-red-500"}`,children:["(",((e.highestHeal-n.highestHeal)/n.highestHeal*100).toFixed(1),"%)"]})]})]}),f.jsxs("div",{children:[f.jsx("span",{className:"text-gray-400",children:"Lowest Heal:"}),f.jsxs("span",{className:"ml-2",children:[(S=m.lowestHeal)==null?void 0:S.toLocaleString(),v&&e&&f.jsxs("span",{className:`ml-2 ${e.lowestHeal>n.lowestHeal?"text-green-500":"text-red-500"}`,children:["(",((e.lowestHeal-n.lowestHeal)/n.lowestHeal*100).toFixed(1),"%)"]})]})]})]})},d=(m,v=!1)=>{var E;return f.jsxs(f.Fragment,{children:[f.jsxs("div",{children:[f.jsx("span",{className:"text-gray-400",children:"Speed:"}),f.jsx("span",{className:"ml-2",children:m.speed})]}),f.jsxs("div",{children:[f.jsx("span",{className:"text-gray-400",children:"Effective HP:"}),f.jsxs("span",{className:"ml-2",children:[(E=m.effectiveHP)==null?void 0:E.toLocaleString(),v&&e&&f.jsxs("span",{className:`ml-2 ${e.effectiveHP>n.effectiveHP?"text-green-500":"text-red-500"}`,children:["(",((e.effectiveHP-n.effectiveHP)/n.effectiveHP*100).toFixed(1),"%)"]})]})]}),f.jsxs("div",{children:[f.jsx("span",{className:"text-gray-400",children:"Damage Reduction:"}),f.jsxs("span",{className:"ml-2",children:[m.damageReduction,"%",v&&e&&f.jsxs("span",{className:`ml-2 ${e.damageReduction>n.damageReduction?"text-green-500":"text-red-500"}`,children:["(",(e.damageReduction-n.damageReduction).toFixed(1),"%)"]})]})]})]})},p=(m,v=!1)=>{switch(t){case"Defender":return o(m,v);case"Debuffer":return a(m,v);case"Supporter":return c(m,v);case"Supporter(Buffer)":return d(m,v);default:return i(m,v)}};return f.jsxs("div",{className:`grid grid-cols-1 ${e?"md:grid-cols-2":""} gap-4 mt-4 `,children:[f.jsx("div",{children:f.jsxs("div",{className:"bg-dark p-4 space-y-2",children:[f.jsx("h3",{className:"text-lg font-semibold",children:"Current Configuration"}),f.jsx("div",{className:"flex flex-col gap-2",children:p(n)})]})}),e&&f.jsx("div",{children:f.jsxs("div",{className:"bg-dark p-4 space-y-2",children:[f.jsx("h3",{className:"text-lg font-semibold",children:"Suggested Configuration"}),f.jsx("div",{className:"flex flex-col gap-2",children:p(e,!0)})]})})]})},zl=({selected:n,onSelect:e,variant:t="compact",sortDirection:i="asc"})=>{const[o,a]=b.useState(!1),{ships:c}=Vn(),[d,p]=b.useState("");return f.jsxs("div",{className:"space-y-4",children:[f.jsx(ke,{"aria-label":n?"Select another Ship":"Select a Ship",variant:"secondary",onClick:()=>a(!0),fullWidth:!0,children:n?"Select another Ship":"Select a Ship"}),n&&f.jsx(Al,{ship:n,variant:t}),f.jsxs(Jo,{isOpen:o,onClose:()=>a(!1),title:"Select a Ship",fullHeight:!0,children:[f.jsx(Ln,{className:"mb-4",placeholder:"Search ships",value:d,onChange:m=>p(m.target.value)}),f.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[c.length===0&&f.jsx("p",{children:"No ships available"}),c.filter(m=>m.name.toLowerCase().includes(d.toLowerCase())).sort((m,v)=>{const E=Object.keys(m.equipment??{}).length,w=Object.keys(v.equipment??{}).length;return i==="asc"?E-w:w-E}).map(m=>f.jsx(Al,{ship:m,variant:"compact",selected:(n==null?void 0:n.id)===m.id,onClick:()=>{e(m),a(!1)}},m.id))]})]})]})},P2=({selectedShip:n,selectedRole:e,onShipSelect:t,onRoleSelect:i,onRunSimulation:o})=>f.jsxs("div",{className:"space-y-4",children:[f.jsx("h3",{className:"text-xl font-bold ",children:"Settings"}),f.jsx(zl,{onSelect:t,selected:n,variant:"compact",sortDirection:"desc"}),f.jsx("div",{className:"p-4 bg-dark space-y-2",children:f.jsx(Lt,{label:"Ship Role",options:Object.values(lt).map(a=>({value:a.name,label:`${a.name} (${a.description})`})),value:e,onChange:a=>i(a)})}),f.jsx(ke,{"aria-label":"Run Simulation",variant:"primary",onClick:o,disabled:!n,fullWidth:!0,children:"Run Simulation"}),f.jsx(D2,{})]}),D2=()=>f.jsxs("p",{className:"text-gray-400 text-sm",children:["This simulates scenarios with the selected ship and gear.",f.jsx("br",{}),"It will only use 100% damage hits, no ship specific attacks are used.",f.jsx("br",{}),"For defenders, it will take hits from an enemy with 15000 attack and 170 security.",f.jsx("br",{}),"For debuffers, it will also try to hack an enemy with 170 security.",f.jsx("br",{}),"For supporters, it will heal an ally with using 15% of their max HP."]}),j2=()=>{const{getShipById:n}=Vn(),[e,t]=b.useState(""),[i,o]=b.useState("Attacker"),{getGearPiece:a}=Cr(),{getEngineeringStatsForShipType:c}=sa(),[d,p]=b.useState(null),m=n(e),v=()=>{const w=n(e);if(!w)return;const S=pn(w.baseStats,w.equipment,a,w.refits,w.implants,c(w.type)),R=Uf(S.final,i);p(R)},E=w=>{o(w),p(null)};return f.jsx(Tr,{title:"Simulation",description:"Simulate simplified attacks, hacks, heals, and defence with your ships and gear.",children:f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[f.jsx(P2,{selectedShip:m||null,selectedRole:i,onShipSelect:w=>t(w.id),onRoleSelect:E,onRunSimulation:v}),d&&f.jsx(CE,{currentSimulation:d,role:i})]})})};var Is=(n=>(n.TwoPass="twoPass",n.SetFirst="setFirst",n.BeamSearch="beamSearch",n.Genetic="genetic",n.BruteForce="bruteForce",n))(Is||{});const bv={twoPass:{name:"Two-Pass Algorithm",description:"Fast algorithm that first optimizes stats, then looks for set opportunities"},setFirst:{name:"Set-First Approach",description:"Prioritizes completing gear sets before individual stat optimization"},beamSearch:{name:"Beam Search",description:"Balanced approach keeping multiple possible configurations in consideration"},genetic:{name:"Genetic Algorithm",description:"Evolution-inspired approach for finding optimal gear combinations"},bruteForce:{name:"Brute Force",description:"Tries every possible combination to find the absolute best gear setup (may crash browser)"}};class $l{constructor(){ht(this,"progressCallback");ht(this,"totalOperations",0);ht(this,"currentOperation",0);ht(this,"PROGRESS_UPDATE_INTERVAL",5e4)}filterInventory(e,t,i=!1){return i?e.filter(o=>!o.shipId||o.shipId===t):e}setProgressCallback(e){this.progressCallback=e}updateProgress(){if(this.progressCallback&&this.totalOperations>0){const e=Math.min(this.currentOperation,this.totalOperations),t=Math.round(e/this.totalOperations*100);this.progressCallback({current:e,total:this.totalOperations,percentage:t})}}initializeProgress(e){this.totalOperations=e,this.currentOperation=0,this.updateProgress()}incrementProgress(){this.currentOperation++,this.updateProgress()}completeProgress(){this.progressCallback&&(this.currentOperation=this.totalOperations,this.progressCallback({current:this.totalOperations,total:this.totalOperations,percentage:100}))}}class O2 extends $l{constructor(){super(...arguments);ht(this,"name","Beam Search");ht(this,"description","Balanced approach keeping multiple possible configurations in consideration");ht(this,"BEAM_WIDTH",10)}async findOptimalGear(t,i,o,a,c,d,p){const m=this.filterInventory(o,t.id,p);let v=0;Object.keys(Ue).forEach(S=>{const R=S,j=m.filter(N=>N.slot===R);v+=j.length*this.BEAM_WIDTH}),this.initializeProgress(v);let E=[{equipment:{},score:0}];for(const[S]of Object.entries(Ue)){const R=S;E=await this.processSlot(R,E,m,t,i,a,c,d)}this.completeProgress();const w=E[0];return Object.entries(w.equipment).filter(S=>S[1]!==void 0).map(([S,R])=>({slotName:S,gearId:R,score:w.score}))}async processSlot(t,i,o,a,c,d,p,m){const v=[],E=o.filter(S=>S.slot===t&&!Object.values(i[0].equipment).includes(S.id));for(const S of i)for(const R of E){const j={...S.equipment,[t]:R.id},N=pn(a.baseStats,j,d,a.refits,a.implants,p(a.type)),O=this.calculateConfigurationScore(N.final,c,j,d,m);v.push({equipment:j,score:O}),this.incrementProgress()}const w=v.sort((S,R)=>R.score-S.score).slice(0,this.BEAM_WIDTH);return await new Promise(S=>setTimeout(S,0)),w}calculateConfigurationScore(t,i,o,a,c){const d={};return Object.values(o).forEach(m=>{if(!m)return;const v=a(m);v!=null&&v.setBonus&&(d[v.setBonus]=(d[v.setBonus]||0)+1)}),Ko(t,i,c,d)}}class L2 extends $l{constructor(){super(...arguments);ht(this,"name","Two-Pass Algorithm");ht(this,"description","Fast algorithm that first optimizes stats, then looks for set opportunities")}async findOptimalGear(t,i,o,a,c,d,p){const m=this.filterInventory(o,t.id,p),v=Object.keys(Ue).length*m.length+m.filter(S=>S.setBonus).length;this.initializeProgress(v);const E=await this.firstPass(t,i,m,a,c,d),w=await this.secondPass(t,i,m,E,a,c,d);return this.completeProgress(),Object.entries(w).filter(S=>S[1]!==void 0).map(([S,R])=>({slotName:S,gearId:R,score:0}))}async firstPass(t,i,o,a,c,d){const p={};return Object.entries(Ue).forEach(([m,v])=>{const E=m;let w=-1/0,S;o.filter(R=>R.slot===E).forEach(R=>{const j={...p,[E]:R.id},N=pn(t.baseStats,j,a,t.refits,t.implants,c(t.type)),O=this.calculateStatScore(N.final,i,d);O>w&&(w=O,S=R.id),this.incrementProgress()}),S&&(p[E]=S)}),p}async secondPass(t,i,o,a,c,d,p){const m=this.countSets(a,c);return this.findPotentialSets(o,a,c).forEach(({setName:E,pieces:w})=>{if(m[E]===1){const S=this.evaluateEquipment(t,a,i,c,d,p);w.forEach(R=>{const j={...a};j[R.slot]=R.id,this.evaluateEquipment(t,j,i,c,d,p)>S&&(a[R.slot]=R.id),this.incrementProgress()})}}),a}countSets(t,i){const o={};return Object.values(t).forEach(a=>{if(!a)return;const c=i(a);c!=null&&c.setBonus&&(o[c.setBonus]=(o[c.setBonus]||0)+1)}),o}findPotentialSets(t,i,o){const a={};return t.forEach(c=>{c.setBonus&&(a[c.setBonus]||(a[c.setBonus]=[]),a[c.setBonus].push(c))}),Object.entries(a).map(([c,d])=>({setName:c,pieces:d})).filter(({setName:c})=>Object.values(i).filter(p=>{const m=p?o(p):void 0;return(m==null?void 0:m.setBonus)===c}).length===1)}calculateStatScore(t,i,o,a){return Ko(t,i,o,a)}evaluateEquipment(t,i,o,a,c,d){return Qo(t,i,o,a,c,d)}}class M2 extends $l{constructor(){super(...arguments);ht(this,"name","Genetic Algorithm");ht(this,"description","Evolution-inspired approach for finding optimal gear combinations");ht(this,"POPULATION_SIZE",1e3);ht(this,"GENERATIONS",30);ht(this,"MUTATION_RATE",.1);ht(this,"ELITE_SIZE",5)}async findOptimalGear(t,i,o,a,c,d,p){const m=this.filterInventory(o,t.id,p),v=this.POPULATION_SIZE*this.GENERATIONS;this.initializeProgress(v);let E=this.initializePopulation(m);E=this.evaluatePopulation(E,t,i,a,c,d);for(let S=0;S<this.GENERATIONS;S++){const R=[];for(R.push(...E.slice(0,this.ELITE_SIZE));R.length<this.POPULATION_SIZE;){const j=this.selectParent(E),N=this.selectParent(E),O=this.crossover(j,N);this.mutate(O,m),R.push(O),this.incrementProgress()}E=this.evaluatePopulation(R,t,i,a,c,d),await new Promise(j=>setTimeout(j,0))}this.completeProgress();const w=E[0];return Object.entries(w.equipment).filter(S=>S[1]!==void 0).map(([S,R])=>({slotName:S,gearId:R,score:w.fitness}))}initializePopulation(t){const i=[];for(let o=0;o<this.POPULATION_SIZE;o++){const a={};Object.keys(Ue).forEach(c=>{const d=c,p=t.filter(m=>m.slot===d);if(p.length>0){const m=p[Math.floor(Math.random()*p.length)];a[d]=m.id}}),i.push({equipment:a,fitness:0})}return i}evaluatePopulation(t,i,o,a,c,d){return t.map(p=>({...p,fitness:this.calculateFitness(p.equipment,i,o,a,c,d)})).sort((p,m)=>m.fitness-p.fitness)}calculateFitness(t,i,o,a,c,d){return Qo(i,t,o,a,c,d)}selectParent(t){return Array(3).fill(null).map(()=>t[Math.floor(Math.random()*t.length)]).reduce((a,c)=>c.fitness>a.fitness?c:a)}crossover(t,i){const o={};return Object.keys(Ue).forEach(a=>{const c=a;o[c]=Math.random()<.5?t.equipment[c]:i.equipment[c]}),{equipment:o,fitness:0}}mutate(t,i){Object.keys(Ue).forEach(o=>{const a=o;if(Math.random()<this.MUTATION_RATE){const c=i.filter(d=>d.slot===a);if(c.length>0){const d=c[Math.floor(Math.random()*c.length)];t.equipment[a]=d.id}}})}}class V2 extends $l{constructor(){super(...arguments);ht(this,"name","Set-First Approach");ht(this,"description","Prioritizes completing gear sets before individual stat optimization")}async findOptimalGear(t,i,o,a,c,d,p){const m=this.filterInventory(o,t.id,p),v=this.groupInventoryBySets(m,t,i,a,c),E=v.length*m.length+Object.keys(Ue).length;this.initializeProgress(E);const w={},S=new Set;for(const R of v)(await this.findBestSetCombination(R.pieces,S,t,i,w,a,c,d)).forEach(N=>{w[N.slot]=N.id,S.add(N.slot)}),this.incrementProgress();return await this.fillRemainingSlots(w,S,m,t,i,a,c,d),this.completeProgress(),Object.entries(w).filter(R=>R[1]!==void 0).map(([R,j])=>({slotName:R,gearId:j,score:0}))}groupInventoryBySets(t,i,o,a,c){const d={};return t.forEach(p=>{p.setBonus&&(d[p.setBonus]||(d[p.setBonus]=[]),d[p.setBonus].push(p))}),Object.entries(d).map(([p,m])=>{const v=this.evaluateSetPotential(m,i,o,a,c);return{setName:p,pieces:m,score:v}}).filter(p=>p.pieces.length>=2).sort((p,m)=>m.score-p.score)}evaluateSetPotential(t,i,o,a,c){const d=new Set(t.map(m=>m.slot)),p={};return d.forEach(m=>{const v=t.filter(E=>E.slot===m).reduce((E,w)=>{const S=pn(i.baseStats,{...p,[m]:w.id},a,i.refits,i.implants,c(i.type)),R=this.calculateStatScore(S.final,o);return!E||R>E.score?{piece:w,score:R}:E},null);v&&(p[m]=v.piece.id)}),Qo(i,p,o,a,c)}findBestSetCombination(t,i,o,a,c,d,p,m){if(t.map(S=>S.slot).filter(S=>!i.has(S)).length<2)return[];const E=[];let w=-1/0;for(let S=0;S<t.length;S++)for(let R=S+1;R<t.length;R++){const j=t[S],N=t[R];if(j.slot===N.slot||i.has(j.slot)||i.has(N.slot))continue;const O={...c,[j.slot]:j.id,[N.slot]:N.id},U=pn(o.baseStats,O,d,o.refits,o.implants,p(o.type)),q=this.calculateStatScore(U.final,a,m)*1.15;q>w&&(w=q,E.length=0,E.push(j,N))}return E}async fillRemainingSlots(t,i,o,a,c,d,p,m){for(const v of Object.keys(Ue)){const E=v;if(i.has(E)){this.incrementProgress();continue}let w=-1/0,S;o.filter(R=>R.slot===E).forEach(R=>{const j={...t,[E]:R.id},N=pn(a.baseStats,j,d,a.refits,a.implants,p(a.type)),O=this.calculateStatScore(N.final,c,m);O>w&&(w=O,S=R.id)}),S&&(t[E]=S,i.add(E)),this.incrementProgress()}}calculateStatScore(t,i,o,a){return Ko(t,i,o,a)}}class F2 extends $l{constructor(){super(...arguments);ht(this,"name","Brute Force");ht(this,"description","Tries every possible combination to find the absolute best gear setup");ht(this,"scoreCache",new Map);ht(this,"BATCH_SIZE",5e4)}async findOptimalGear(t,i,o,a,c,d,p){const m=this.filterInventory(o,t.id,p);this.scoreCache.clear();const v=this.groupAndFilterInventory(m,d);this.initializeProgress(this.calculateTotalCombinations(v));const E=await this.findBestConfiguration(t,i,v,{},this.getOptimizedSlotOrder(v),a,c,d);return Object.entries(E.equipment).filter(w=>w[1]!==void 0).map(([w,S])=>({slotName:w,gearId:S,score:E.score}))}getOptimizedSlotOrder(t){return Object.entries(t).sort(([,i],[,o])=>i.length-o.length).map(([i])=>i)}calculateTotalCombinations(t){return Object.values(t).reduce((i,o)=>i*o.length,1)}groupAndFilterInventory(t,i){const o={};return Object.keys(Ue).forEach(a=>{o[a]=[]}),t.forEach(a=>{i&&!this.isGearRelevantForRole(a,i)||o[a.slot].push(a)}),o}isGearRelevantForRole(t,i){const a={Attacker:["attack","crit","critDamage"],Defender:["hp","defence"],Debuffer:["hacking","attack","crit","critDamage"],Supporter:["hp","healModifier","crit","critDamage"],SupporterBuffer:["speed","hp","defence"]}[i]||[],c=t.subStats.map(d=>d.name);return c.push(t.mainStat.name),a.some(d=>c.includes(d))}getCacheKey(t){return JSON.stringify(t)}findBestConfiguration(t,i,o,a,c,d,p,m){return new Promise(v=>{let E=0,w={equipment:{},score:-1/0};const S=()=>{const R=(N,O)=>{if(O.length===0){this.incrementProgress(),E++;const W=this.getCacheKey(N);if(this.scoreCache.has(W)){const k=this.scoreCache.get(W);return k>w.score&&(w={equipment:{...N},score:k}),!1}const Q=Qo(t,N,i,d,p,m);return this.scoreCache.set(W,Q),Q>w.score&&(w={equipment:{...N},score:Q}),!1}const[U,...q]=O,J=o[U];for(const W of J){if(Object.values(N).includes(W.id))continue;const Q={...N,[U]:W.id};if(R(Q,q))return!0;if(E>=this.BATCH_SIZE)return E=0,!0}return R(N,q)};R(a,c)&&this.currentOperation<this.totalOperations?setTimeout(S,0):v(w)};S()})}}const U2={[Is.BeamSearch]:new O2,[Is.TwoPass]:new L2,[Is.Genetic]:new M2,[Is.SetFirst]:new V2,[Is.BruteForce]:new F2};function B2(n){return U2[n]}const of=["attack","defence","hp","speed","crit","critDamage","healModifier","hacking","security"],z2=({onAdd:n,existingPriorities:e,hideWeight:t,hideMaxLimit:i,hideMinLimit:o})=>{const[a,c]=b.useState(of[0]),[d,p]=b.useState(""),[m,v]=b.useState(""),[E,w]=b.useState(1),S=R=>{R.preventDefault(),n({stat:a,maxLimit:i?void 0:d?Number(d):void 0,minLimit:o?void 0:m?Number(m):void 0,weight:t?1:E}),p(""),v(""),t||w(e.length>0?e.length+1:1),c(of[0])};return f.jsxs("form",{onSubmit:S,className:"space-y-4 bg-dark p-4",role:"form",children:[f.jsx("div",{className:"space-y-2",children:f.jsx(Lt,{label:"Stat",value:a,onChange:R=>c(R),options:of.map(R=>({value:R,label:Rt[R].label}))})}),f.jsxs("div",{className:"space-y-2 grid grid-cols-2 gap-4 items-end",children:[!o&&f.jsx(Ln,{label:"Min Limit (Optional)",type:"number",value:m,onChange:R=>v(R.target.value),placeholder:"min value"}),!i&&f.jsx(Ln,{label:"Max Limit (Optional)",type:"number",value:d,onChange:R=>p(R.target.value),placeholder:"max value"})]}),!t&&f.jsx(Ln,{label:"Weight",type:"number",value:E,onChange:R=>w(Number(R.target.value)),placeholder:"Enter weight",className:"mt-4"}),f.jsx(ke,{"aria-label":"Add priority",type:"submit",variant:"secondary",fullWidth:!0,children:"Add Priority"})]})},$2=({selectedShip:n,selectedShipRole:e,selectedAlgorithm:t,priorities:i,ignoreEquipped:o,showSecondaryRequirements:a,onShipSelect:c,onRoleSelect:d,onAlgorithmSelect:p,onAddPriority:m,onRemovePriority:v,onFindOptimalGear:E,onIgnoreEquippedChange:w,onToggleSecondaryRequirements:S})=>f.jsxs("div",{className:"space-y-4",children:[f.jsx("h3",{className:"text-xl font-bold ",children:"Settings"}),f.jsx(zl,{onSelect:c,selected:n}),f.jsxs("div",{className:"p-4 bg-dark space-y-2",children:[f.jsx("span",{className:" text-sm",children:"Predefined Strategies (Experimental)"}),f.jsx(Lt,{"data-testid":"role-select",options:Object.values(lt).map(R=>({value:R.name,label:`${R.name} (${R.description})`})),value:e||"",onChange:R=>d(R),noDefaultSelection:!0,defaultOption:"Manual"})]}),e&&f.jsxs("div",{className:"p-4 bg-dark",children:[f.jsx(Of,{label:"Add secondary requirements",checked:a,onChange:S}),f.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Add additional minimum/maximum stat requirements to the predefined role. For example higher hacking, speed targets, cap crit going over 100%. These are soft capped and will penalize the score relatively if not met."})]}),(e===null||e===""||a)&&f.jsx(z2,{onAdd:m,existingPriorities:i,hideWeight:a}),i.length>0&&f.jsxs("div",{className:"bg-dark p-4 space-y-2 ",children:[f.jsx("h3",{className:"text-lg font-semibold",children:"Priority List"}),i.map((R,j)=>f.jsxs("div",{className:"flex items-center",children:[f.jsxs("span",{children:[Rt[R.stat].label," (",R.minLimit?`Min: ${R.minLimit}`:"",R.minLimit&&R.maxLimit?", ":"",R.maxLimit?` Max: ${R.maxLimit}`:"",R.weight!==1?` (Weight: ${R.weight})`:"",") "]}),f.jsx(ke,{"aria-label":"Remove priority",variant:"danger",size:"sm",onClick:()=>v(j),className:"ml-auto",children:f.jsx(rn,{})})]},j))]}),f.jsxs("div",{className:"space-y-2 p-4 bg-dark",children:[f.jsx("span",{className:" text-sm",children:"Algorithm"}),f.jsx(Lt,{"data-testid":"algorithm-select",options:Object.entries(bv).map(([R,{name:j}])=>({value:R,label:j})),value:t,onChange:R=>p(R)}),f.jsx("p",{className:"text-sm text-gray-400",children:bv[t].description})]}),f.jsxs("div",{className:"p-4 bg-dark",children:[f.jsx(Of,{label:"Ignore currently equipped gear",checked:o,onChange:R=>w(R)}),f.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"When checked, the algorithm will ignore gear that is currently equipped on other ships"})]}),f.jsx(ke,{"aria-label":"Find optimal gear",variant:"primary",onClick:E,disabled:!n||(e===""||e===null)&&i.length===0,fullWidth:!0,children:"Find Optimal Gear"})]}),H2=({suggestions:n,getGearPiece:e,hoveredGear:t,onHover:i,onEquip:o})=>{const a=c=>n.find(d=>d.slotName===c);return f.jsxs("div",{className:"bg-dark-lighter py-4 md:pt-0",children:[f.jsx("div",{className:"flex justify-between items-center mb-4",children:f.jsx("h3",{className:"text-xl font-semibold ",children:"Suggested Gear"})}),f.jsx("div",{className:"grid grid-cols-3 gap-2 bg-dark p-4",children:xT.map(c=>{const d=a(c);return f.jsx("div",{className:"flex items-center justify-center",children:f.jsx(hd,{slotKey:c,gear:d?e(d.gearId):void 0,hoveredGear:t,onHover:i})},c)})}),f.jsx("div",{className:"flex justify-end pt-4",children:f.jsx(ke,{"aria-label":"Equip all suggestions",variant:"primary",onClick:o,children:"Equip All Suggestions"})})]})},q2=()=>{const{getGearPiece:n,inventory:e,saveInventory:t}=Cr(),{getShipById:i,handleEquipGear:o,ships:a,handleEquipMultipleGear:c}=Vn(),{addNotification:d}=Ht(),[p,m]=b.useState(""),[v,E]=b.useState(null),[w,S]=b.useState([]),[R,j]=b.useState([]),[N,O]=b.useState(null),{getEngineeringStatsForShipType:U}=sa(),[q,J]=b.useState(Is.Genetic),[W,Q]=b.useState(null),[k,x]=b.useState(null),[A,P]=b.useState(null),[M,V]=b.useState(!0),[D,ee]=b.useState(!1),[ue,he]=b.useState(null),re=i(p),[ae,fe]=b.useState(!1),le=be=>{S([...w,be])},z=be=>{S(w.filter((Qe,Ve)=>Ve!==be))},X=async()=>{if(!re)return;P(null),j([]);const be=B2(q);be.setProgressCallback(P);const Qe=e.filter(bt=>{if(bt.shipId){const ii=a.find(Yi=>Yi.id===bt.shipId);return bt.shipId===re.id||ii&&!ii.equipmentLocked}return!0}),Ve=await Promise.resolve(be.findOptimalGear(re,w,Qe,n,U,v||void 0,M)),et=me(),st=pe(Ve);et&&st&&(Q(Uf(et.final,v)),x(Uf(st.final,v))),j(Ve)},pe=be=>{if(!re)return null;const Qe={...re.equipment};return be.forEach(Ve=>{Qe[Ve.slotName]=Ve.gearId}),pn(re.baseStats,Qe,n,re.refits,re.implants,U(re.type))},xe=()=>{if(!re)return;const be=R.map(Qe=>{const Ve=n(Qe.gearId);if(Ve!=null&&Ve.shipId&&Ve.shipId!==re.id){const et=i(Ve.shipId);if(et)return{fromShip:et.name,slot:Ue[Qe.slotName].label,toShip:re.name}}return null}).filter(Qe=>Qe!==null);be.length>0?(ee(!0),he(f.jsxs("div",{className:"space-y-2 ",children:[f.jsx("p",{children:"The following gear will be moved:"}),f.jsx("ul",{className:"list-disc pl-4 space-y-1",children:be.map((Qe,Ve)=>f.jsxs("li",{children:[Qe.slot," from"," ",f.jsx("span",{className:"font-semibold",children:Qe.fromShip})]},Ve))}),f.jsx("p",{className:"mt-4",children:"Do you want to continue?"})]}))):se()},se=()=>{if(!re)return;const be=R.map(Ve=>({slot:Ve.slotName,gearId:Ve.gearId}));c(re.id,be);const Qe=e.map(Ve=>be.find(st=>st.gearId===Ve.id)?{...Ve,shipId:re.id}:Ve.shipId===re.id&&!be.some(bt=>bt.gearId===Ve.id)?{...Ve,shipId:""}:Ve);t(Qe),d("success","Suggested gear equipped successfully"),j([]),P(null),ee(!1)},me=()=>re?pn(re.baseStats,re.equipment,n,re.refits,re.implants,U(re.type)):null,Te=be=>{E(be),fe(!1),Q(null),x(null)},_e=me(),Oe=pe(R);return f.jsxs(Tr,{title:"Autogear",description:"Find the best gear for your ship.",children:[f.jsxs("div",{className:"md:grid md:grid-cols-2 gap-4",children:[f.jsx($2,{selectedShip:re||null,selectedShipRole:v,selectedAlgorithm:q,priorities:w,ignoreEquipped:M,onIgnoreEquippedChange:V,onShipSelect:be=>m(be.id),onRoleSelect:Te,onAlgorithmSelect:J,onAddPriority:le,onRemovePriority:z,onFindOptimalGear:X,showSecondaryRequirements:ae,onToggleSecondaryRequirements:fe}),R.length>0&&f.jsx(H2,{suggestions:R,getGearPiece:n,hoveredGear:N,onHover:O,onEquip:xe}),A&&f.jsx("div",{className:"col-span-2 p-4 bg-dark",children:f.jsx(qk,{current:A.current,total:A.total,percentage:A.percentage})})]}),W&&k&&R.length>0&&f.jsx(CE,{currentSimulation:W,suggestedSimulation:k,role:v}),_e&&Oe&&R.length>0&&f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 ",children:[f.jsx(Mf,{stats:_e.final,title:"Current Stats",className:"p-4"}),f.jsx(Mf,{stats:Oe.final,comparisonStats:_e.final,title:"Stats with Suggested Gear",className:"p-4"})]}),f.jsx(Nl,{isOpen:D,onClose:()=>ee(!1),onConfirm:se,title:"Move Gear",message:ue,confirmLabel:"Move",cancelLabel:"Cancel"})]})},G2=({initialStats:n,onSubmit:e})=>{const[t,i]=b.useState((n==null?void 0:n.shipType)||Object.keys(lt)[0]),[o,a]=b.useState((n==null?void 0:n.stats)||[]),{getAllAllowedStats:c,engineeringStats:d}=sa(),m=Object.entries(lt).filter(([S])=>S==="SUPPORTER_BUFFER"?!1:(n==null?void 0:n.shipType)===S||!d.stats.some(R=>R.shipType===S)).map(([S,R])=>({value:S,label:R.name})),v=()=>{i(Object.keys(lt)[0]),a([])};b.useEffect(()=>{n?(i(n.shipType),a(n.stats)):v()},[n]);const E=S=>{a(S)},w=S=>{S.preventDefault(),e({shipType:t,stats:o}),n||v()};return f.jsxs("form",{onSubmit:w,className:"bg-dark p-6",children:[f.jsx("div",{className:"mb-4",children:f.jsx(Lt,{label:"Ship Type",value:t,onChange:S=>i(S),options:m})}),f.jsx($u,{stats:o,onChange:E,maxStats:5,allowedStats:c()}),f.jsx(ke,{"aria-label":"Save engineering stats",type:"submit",className:"mt-6",variant:"primary",children:"Save Engineering Stats"})]})},W2=({stats:n,onEdit:e,onDelete:t})=>n.length===0?f.jsx("div",{className:"text-center py-8 text-gray-400 bg-dark-lighter border-2 border-dashed",children:"No engineering stats found."}):f.jsxs(f.Fragment,{children:[f.jsx("h3",{className:"text-xl font-semibold mb-4",children:"Existing Engineering Stats"}),f.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 xl:grid-cols-4 gap-4",children:n.map(i=>f.jsxs("div",{className:"bg-dark mb-4 border border-gray-600",children:[f.jsxs("div",{className:"flex justify-between items-center px-4 py-2 border-b border-gray-600",children:[f.jsx("h3",{className:"text-lg font-medium",children:lt[i.shipType].name}),f.jsx(ke,{"aria-label":"Edit engineering stats",variant:"secondary",size:"sm",className:"ms-auto me-2",onClick:()=>{e(i),window.scrollTo({top:0,behavior:"smooth"})},children:f.jsx(Wu,{})}),f.jsx(ke,{"aria-label":"Delete engineering stats",variant:"danger",size:"sm",onClick:()=>t(i.shipType),children:f.jsx(rn,{})})]}),f.jsxs("div",{className:"p-4 space-y-4 flex-grow",children:[f.jsx("div",{className:"text-sm text-gray-400 mb-2",children:"Engineering Stats"}),f.jsx("div",{className:"space-y-2",children:f.jsx(Hu,{stats:i.stats})})]})]},i.shipType))})]}),K2=()=>{const{engineeringStats:n,saveEngineeringStats:e}=sa(),[t,i]=b.useState(),[o,a]=b.useState(!1),{addNotification:c}=Ht(),d=m=>{const v={stats:n.stats.filter(E=>E.shipType!==m.shipType).concat(m)};e(v),t?c("success","Engineering stats updated successfully"):c("success","Engineering stats added successfully"),i(void 0)},p=m=>{const v={stats:n.stats.filter(E=>E.shipType!==m)};e(v),(t==null?void 0:t.shipType)===m&&i(void 0),c("success","Engineering stats deleted successfully")};return f.jsxs(Tr,{title:"Engineering Stats Management",description:"Manage your engineering stats.",action:{label:o?"Hide Form":"Create",onClick:()=>{t&&i(void 0),a(!o)},variant:o?"secondary":"primary"},children:[f.jsx(Cs,{isVisible:o||!!t,children:f.jsx(G2,{initialStats:t,onSubmit:m=>{d(m),window.scrollTo({top:0,behavior:"smooth"})}})}),f.jsx("div",{className:"space-y-4 ",children:f.jsx(W2,{stats:n.stats,onEdit:m=>{i(m),window.scrollTo({top:0,behavior:"smooth"})},onDelete:p})})]})},Q2=Ir.SHIP_LOADOUTS,Y2=Ir.TEAM_LOADOUTS,X2=()=>{const{addNotification:n}=Ht(),{data:e=[],setData:t}=Wo({key:Q2,defaultValue:[]}),{data:i=[],setData:o}=Wo({key:Y2,defaultValue:[]}),a=b.useCallback(async w=>{const S={...w,id:crypto.randomUUID(),createdAt:Date.now()};await t([...e,S]),n("success","Loadout added")},[e,t,n]),c=b.useCallback(async(w,S)=>{const R=e.map(j=>j.id===w?{...j,equipment:S}:j);await t(R),n("success","Loadout updated")},[e,t,n]),d=b.useCallback(async w=>{await t(e.filter(S=>S.id!==w)),n("success","Loadout deleted")},[e,t,n]),p=b.useCallback(w=>{const S=new Set;for(const R of w)for(const j of Object.values(R.equipment)){if(S.has(j))return!1;S.add(j)}return!0},[]),m=b.useCallback(async w=>{if(!p(w.shipLoadouts))throw new Error("Invalid team loadout: Duplicate gear pieces detected");const S={...w,id:crypto.randomUUID(),createdAt:Date.now()};await o([...i,S]),n("success","Team loadout added")},[i,o,p,n]),v=b.useCallback(async(w,S)=>{if(!p(S))throw new Error("Invalid team loadout: Duplicate gear pieces detected");const R=i.map(j=>j.id===w?{...j,shipLoadouts:S}:j);await o(R),n("success","Team loadout updated")},[i,o,p,n]),E=b.useCallback(async w=>{await o(i.filter(S=>S.id!==w)),n("success","Team loadout deleted")},[i,o,n]);return{loadouts:e,addLoadout:a,updateLoadout:c,deleteLoadout:d,teamLoadouts:i,addTeamLoadout:m,updateTeamLoadout:v,deleteTeamLoadout:E}},J2=({onSubmit:n,existingNames:e})=>{const[t,i]=b.useState(""),[o,a]=b.useState(null),[c,d]=b.useState(null),p=v=>{if(v.preventDefault(),v.stopPropagation(),!!o){if(e.includes(t.trim())){d("A loadout with this name already exists");return}n({name:t.trim(),shipId:o.id,equipment:o.equipment}),i(""),a(null),d(null)}},m=v=>{i(v.target.value),d(null)};return f.jsxs("form",{onSubmit:p,className:"space-y-4 bg-dark p-4",children:[f.jsx("div",{children:f.jsx(Ln,{label:"Loadout Name",type:"text",value:t,onChange:m,required:!0,error:c||void 0})}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium ",children:"Select Ship"}),f.jsx(zl,{onSelect:a,selected:o,sortDirection:"desc"})]}),f.jsx("div",{className:"flex justify-end gap-2",children:f.jsx(ke,{"aria-label":"Create loadout",type:"submit",disabled:!o||!t.trim(),children:"Create Loadout"})})]})},kE=({name:n,ship:e,equipment:t,availableGear:i,getGearPiece:o,onEquip:a,onDelete:c,showControls:d=!0})=>{const[p,m]=b.useState(null),[v,E]=b.useState(null),w=zp(t,o),S=TE(t,w),{handleEquipGear:R}=Vn(),{saveInventory:j}=Cr(),{addNotification:N}=Ht(),O=()=>{if(!a)return;const U=new Map,q=new Set;Object.entries(t).forEach(([W,Q])=>{if(q.has(Q)){N("warning",`Skipped duplicate gear assignment for ${W}`);return}const k=o(Q);if(!k){N("error",`Gear piece ${Q} not found in inventory`);return}if(k.shipId&&k.shipId!==e.id){const x=k.shipId;N("info",`Unequipped ${W} from ship ${x}`)}U.set(Q,e.id),q.add(Q),R(e.id,W,Q)});const J=i.map(W=>{const Q=U.get(W.id);return Q!==void 0?{...W,shipId:Q}:W});j(J),N("success","Loadout equipped successfully"),a()};return f.jsxs(f.Fragment,{children:[n&&f.jsx("div",{className:"flex justify-between items-center mb-4",children:f.jsx("div",{children:n&&f.jsx("h3",{className:"text-lg font-medium ",children:n})})}),f.jsxs(Al,{ship:e,variant:"compact",children:[d&&f.jsxs("div",{className:"flex gap-2 -mt-10",children:[a&&f.jsx(ke,{"aria-label":"Equip loadout",variant:"primary",className:"ms-auto",size:"sm",onClick:O,children:f.jsx(Yf,{})}),c&&f.jsx(ke,{"aria-label":"Delete loadout",variant:"danger",size:"sm",onClick:c,children:f.jsx(rn,{})})]}),f.jsxs("div",{className:`p-4 mt-3 -mx-3 bg-dark border-t ${jn[e.rarity||"common"].borderColor}`,children:[f.jsx("div",{className:"grid grid-cols-3 gap-2 w-fit mx-auto",children:Object.entries(Ue).map(([U,q])=>f.jsx(hd,{slotKey:U,gear:w[t[U]||""],hoveredGear:v,onSelect:m,onHover:E},U))}),S&&S.length>0&&f.jsxs("div",{className:"flex items-center gap-2 pt-3",children:[f.jsx("span",{className:"text-xs text-gray-400",children:"Sets:"}),S.map((U,q)=>f.jsx("img",{src:yt[U].iconUrl,alt:U,className:"w-5"},`${U}-${q}`))]})]})]}),f.jsx(Jo,{isOpen:p!==null,onClose:()=>m(null),title:`Select ${p} for ${e.name} loadout`,children:f.jsx(Bp,{inventory:i.filter(U=>p&&U.slot===p),mode:"select",onEquip:()=>{p&&(O(),m(null))},onRemove:()=>{},onEdit:()=>{}})})]})},Z2=({loadouts:n,onUpdate:e,onDelete:t,getGearPiece:i,availableGear:o})=>{const{handleEquipGear:a,ships:c}=Vn();return n.length===0?f.jsx("div",{className:"text-center py-8 text-gray-400 bg-dark-lighter border-2 border-dashed",children:'No loadouts created yet. Create one by clicking the "New Loadout" button above.'}):f.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:n.map(d=>{const p=c.find(m=>m.id===d.shipId);return p?f.jsx("div",{className:"flex flex-col",children:f.jsx(kE,{name:d.name,ship:p,equipment:d.equipment,availableGear:o,getGearPiece:i,onEquip:()=>{Object.entries(d.equipment).forEach(([m,v])=>{a(d.shipId,m,v)})},onUpdate:m=>e(d.id,m),onDelete:()=>t(d.id)})},d.id):null})})},eb=({onSubmit:n,existingNames:e})=>{const[t,i]=b.useState(""),[o,a]=b.useState([null,null,null,null,null]),[c,d]=b.useState(null),p=(v,E)=>{const w=[...o];w[E]=v,a(w)},m=v=>{if(v.preventDefault(),v.stopPropagation(),o.some(w=>!w))return;if(e.includes(t.trim())){d("A team loadout with this name already exists");return}const E=o.map((w,S)=>({position:S+1,shipId:w.id,equipment:w.equipment}));n({name:t,shipLoadouts:E}),i(""),a([null,null,null,null,null]),d(null)};return f.jsxs("form",{onSubmit:m,className:"space-y-4 bg-dark p-4",children:[f.jsx("div",{children:f.jsx(Ln,{label:"Team Loadout Name",type:"text",value:t,onChange:v=>i(v.target.value),required:!0,error:c||void 0})}),o.map((v,E)=>f.jsx("div",{children:f.jsx(zl,{selected:v,onSelect:w=>p(w,E),sortDirection:"desc"})},E)),f.jsx("div",{className:"flex justify-end gap-2",children:f.jsx(ke,{"aria-label":"Create team loadout",type:"submit",disabled:o.some(v=>!v)||!t,children:"Create Team Loadout"})})]})},tb=({teamLoadout:n,ships:e,availableGear:t,getGearPiece:i,onUpdate:o,onDelete:a})=>{const{handleEquipGear:c}=Vn(),{saveInventory:d}=Cr(),{addNotification:p}=Ht(),m=()=>{const E=new Map,w=new Set;n.shipLoadouts.forEach(R=>{Object.entries(R.equipment).forEach(([j,N])=>{if(w.has(N)){p("warning",`Skipped duplicate gear assignment for ${j}`);return}const O=i(N);if(!O){p("error",`Gear piece ${N} not found in inventory`);return}if(O.shipId&&O.shipId!==R.shipId){const U=e.find(q=>q.id===O.shipId);U&&p("info",`Unequipped ${j} from ${U.name}`)}E.set(N,R.shipId),w.add(N),c(R.shipId,j,N)})});const S=t.map(R=>{const j=E.get(R.id);return j!==void 0?{...R,shipId:j}:R});d(S),p("success","Team loadout equipped successfully")},v=(E,w)=>{const S=n.shipLoadouts.map(R=>R.position===E?{...R,equipment:w}:R);try{o(n.id,S)}catch(R){alert(R instanceof Error?R.message:"An error occurred")}};return f.jsxs("div",{className:"border-b border-gray-700 pb-8",children:[f.jsxs("div",{className:"flex justify-between items-center mb-4",children:[f.jsx("h3",{className:"text-lg font-medium ",children:n.name}),f.jsxs("div",{className:"flex gap-2",children:[f.jsx(ke,{"aria-label":"Equip team loadout",variant:"primary",size:"sm",onClick:m,children:"Equip Team"}),f.jsx(ke,{"aria-label":"Delete loadout",variant:"danger",size:"sm",onClick:()=>a(n.id),children:f.jsx(rn,{})})]})]}),f.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:n.shipLoadouts.map(E=>{const w=e.find(S=>S.id===E.shipId);return w?f.jsx(kE,{ship:w,equipment:E.equipment,availableGear:t,getGearPiece:i,onUpdate:S=>v(E.position,S),showControls:!1},E.position):null})})]})},nb=()=>{const[n,e]=b.useState(!1),[t,i]=b.useState("individual"),{loadouts:o,addLoadout:a,updateLoadout:c,deleteLoadout:d,teamLoadouts:p,addTeamLoadout:m,updateTeamLoadout:v,deleteTeamLoadout:E}=X2(),{getGearPiece:w,inventory:S}=Cr(),{ships:R}=Vn(),{addNotification:j}=Ht(),N=o.map(U=>U.name),O=p.map(U=>U.name);return f.jsxs(Tr,{title:"Loadouts",description:"Manage your ship gear loadouts, save your favorite setups for easy access.",action:{label:n?"Hide Form":`New ${t==="individual"?"Loadout":"Team"}`,onClick:()=>e(!n),variant:n?"secondary":"primary"},children:[f.jsx(vE,{tabs:[{id:"individual",label:"Individual Loadouts"},{id:"team",label:"Team Loadouts"}],activeTab:t,onChange:U=>{i(U),e(!1)}}),t==="individual"?f.jsxs(f.Fragment,{children:[f.jsx(Cs,{isVisible:n,children:f.jsx(J2,{onSubmit:U=>{a(U),e(!1),window.scrollTo({top:0,behavior:"smooth"}),j("success","Loadout created successfully")},existingNames:N})}),f.jsx(Z2,{loadouts:o,onUpdate:c,onDelete:d,getGearPiece:w,availableGear:S})]}):f.jsxs(f.Fragment,{children:[f.jsx(Cs,{isVisible:n,children:f.jsx(eb,{onSubmit:U=>{try{m(U),e(!1),window.scrollTo({top:0,behavior:"smooth"}),j("success","Team loadout created successfully")}catch(q){j("error",q instanceof Error?q.message:"Failed to create team loadout")}},existingNames:O})}),f.jsxs("div",{className:"grid grid-cols-1 gap-6",children:[p.map(U=>f.jsx(tb,{teamLoadout:U,ships:R,availableGear:S,getGearPiece:w,onUpdate:v,onDelete:E},U.id)),p.length===0&&f.jsx("div",{className:"text-center py-8 text-gray-400 bg-dark-lighter border-2 border-dashed",children:'No team loadouts created yet. Create one by clicking the "New Team" button above.'})]})]})]})},rb=({isOpen:n,onClose:e,entries:t,lastSeenVersion:i})=>{const o=(a,c)=>{const[d,p,m]=a.split("."),[v,E,w]=c.split(".");return parseInt(d)>parseInt(v)||parseInt(d)===parseInt(v)&&parseInt(p)>parseInt(E)||parseInt(d)===parseInt(v)&&parseInt(p)===parseInt(E)&&parseInt(m)>parseInt(w)};return f.jsx(Jo,{isOpen:n,onClose:e,title:"What's New",children:f.jsx("div",{className:"overflow-y-auto max-h-[60vh]",children:t.map(a=>f.jsx("div",{children:o(a.version,i)&&f.jsxs("div",{className:"mb-6 ",children:[f.jsxs("h3",{className:"font-bold mb-2",children:["Version ",a.version," - ",a.date,o(a.version,i)&&f.jsx("span",{className:"ml-2 text-xs bg-blue-500  px-2 py-1",children:"New"})]}),f.jsx("ul",{className:"list-disc list-inside space-y-1",children:a.changes.map((c,d)=>f.jsx("li",{children:c},d))})]})},a.version))})})},ib=({children:n})=>{const[e,t]=b.useState([]),i=b.useCallback(a=>{t(c=>c.filter(d=>d.id!==a))},[]),o=b.useCallback((a,c,d=5e3)=>{const p=Date.now().toString()+Math.random().toString(36).substring(2,15),m={id:p,type:a,message:c,duration:d};t(v=>[...v,m]),d>0&&setTimeout(()=>{i(p)},d)},[i]);return f.jsx(gE.Provider,{value:{notifications:e,addNotification:o,removeNotification:i},children:n})},sb=({notification:n,onClose:e})=>{const t="flex items-center p-4  shadow-lg mb-2 text-white",i={success:"bg-green-500",error:"bg-red-500",info:"bg-blue-500",warning:"bg-yellow-500"};return f.jsxs("div",{className:`${t} ${i[n.type]}`,children:[f.jsx("span",{className:"flex-grow",children:n.message}),f.jsx("button",{onClick:()=>e(n.id),"aria-label":"Close notification",className:"ml-4 text-white hover:",children:f.jsx(rn,{})})]})},ob=()=>{const{notifications:n,removeNotification:e}=Ht();return f.jsx("div",{className:"fixed top-4 right-4 z-50 w-96 space-y-2",role:"complementary",children:n.map(t=>f.jsx(sb,{notification:t,onClose:e},t.id))})},ab=["ships"],lb=()=>{ab.forEach(n=>{const e=localStorage.getItem(n);if(e)try{const t=JSON.parse(e);let i=!1;Array.isArray(t)?t.forEach(o=>{o.faction==="TIANSHAO"&&(o.faction="TIANCHAO",i=!0)}):t.faction==="TIANSHAO"&&(t.faction="TIANCHAO",i=!0),i&&localStorage.setItem(n,JSON.stringify(t))}catch(t){console.error(`Error migrating faction data for ${n}:`,t)}})},cb=()=>{const n=localStorage.getItem("ships");if(n)try{const e=JSON.parse(n);let t=!1;const i=e.map(o=>{if(o.affinity)return o;const a=i0[o.name.toUpperCase().replace(/ /g,"_")];return a!=null&&a.affinity?(t=!0,{...o,affinity:a.affinity.toLowerCase()}):o});t&&localStorage.setItem("ships",JSON.stringify(i))}catch(e){console.error("Error during affinity migration:",e)}},ub=({isActive:n,isSelected:e,children:t,className:i="",...o})=>f.jsx("button",{className:`
                w-full aspect-[1.15/1] relative
                transform scale-[1.15]
                ${i}
            `,...o,children:f.jsx("div",{className:`
                    absolute inset-0
                    clip-hex transition-colors duration-200
                    flex items-center justify-center
                    transform rotate-[30deg]
                    ${n?"bg-primary":"bg-dark-lighter"}
                    ${e?"bg-yellow-500":""}
                    hover:bg-white
                `,children:f.jsx("div",{className:"clip-hex transform scale-95 bg-dark w-full h-full",children:f.jsx("div",{className:"transform rotate-[-30deg] w-full h-full flex items-center justify-center",children:t})})})}),bE=({formation:n,onPositionSelect:e,selectedPosition:t,onRemoveShip:i})=>{const{ships:o}=Vn(),a=[["T1","T2","T3","T4"],["M1","M2","M3","M4"],["B1","B2","B3","B4"]],c=d=>{const p=n.find(m=>m.position===d);return p?o.find(m=>m.id===p.shipId):null};return f.jsxs("div",{className:"grid p-4 pb-6 ml-[9.5%]",role:"grid",children:[a.map((d,p)=>f.jsx("div",{className:`grid grid-cols-4 ${p===1?"ml-[-12.5%] mr-[12.5%]":""}`,children:d.map(m=>{const v=c(m);return f.jsx(ub,{onClick:E=>{E.ctrlKey||E.metaKey?i==null||i(m):e==null||e(m)},isActive:!!v,isSelected:t===m,children:f.jsxs("div",{className:"flex flex-col items-center",children:[f.jsx("span",{className:"text-xs ",children:m}),v&&f.jsxs(f.Fragment,{children:[f.jsx("span",{className:"text-white text-xs mt-1 px-1 truncate max-w-full",children:v.name}),f.jsx("span",{className:"flex items-center gap-1",children:Array.from({length:6},(E,w)=>f.jsx("span",{className:`text-xs tracking-tightest ${w<v.refits.length?"text-yellow-400":"text-gray-300"}`,children:""},w))})]})]})},m)})},p)),i&&f.jsx("div",{className:"text-xs text-gray-400 mt-6",children:"Tip: Ctrl+Click to remove a ship"})]})},db=({onSubmit:n,initialEncounter:e})=>{const[t,i]=b.useState(""),[o,a]=b.useState([]),[c,d]=b.useState(),[p,m]=b.useState("");b.useEffect(()=>{e?(i(e.name),a(e.formation),m(e.description||"")):(i(""),a([]),m(""))},[e]);const v=S=>{S.preventDefault();const R={id:(e==null?void 0:e.id)||Date.now().toString(),name:t,formation:o,createdAt:(e==null?void 0:e.createdAt)||Date.now(),description:p};n(R),i(""),a([]),m(""),d(void 0)},E=S=>{c&&(a(R=>[...R.filter(N=>N.position!==c),{shipId:S.id,position:c}]),d(void 0))},w=S=>{a(R=>R.filter(j=>j.position!==S)),d(void 0)};return f.jsxs("div",{className:"space-y-4",children:[f.jsxs("form",{onSubmit:v,className:"bg-dark-light space-y-4",children:[f.jsxs("div",{className:"flex items-end space-x-2 w-full",children:[f.jsx(Ln,{label:"Encounter Name",type:"text",id:"name",value:t,onChange:S=>i(S.target.value),required:!0}),f.jsxs(ke,{type:"submit",variant:"primary",children:[e?"Update":"Save"," Encounter"]})]}),f.jsx(Gk,{label:"Description",id:"description",value:p,onChange:S=>m(S.target.value)})]}),f.jsxs("div",{className:"bg-dark-light space-y-4 max-w-[700px] mx-auto py-6",children:[f.jsx(bE,{formation:o,onPositionSelect:d,selectedPosition:c,onRemoveShip:w}),c&&f.jsxs("div",{className:"mt-4",children:[f.jsxs("h3",{className:"text-white text-sm mb-2",children:["Select ship for position ",c,":"]}),f.jsx(zl,{selected:null,onSelect:E,variant:"compact",sortDirection:"desc"})]})]})]})};var af={exports:{}},Nv;function hb(){return Nv||(Nv=1,function(n){(function(e){var t=q(),i=J(),o=W(),a=Q(),c={imagePlaceholder:void 0,cacheBust:!1},d={toSvg:p,toPng:v,toJpeg:E,toBlob:w,toPixelData:m,impl:{fontFaces:o,images:a,util:t,inliner:i,options:{}}};n.exports=d;function p(k,x){return x=x||{},S(x),Promise.resolve(k).then(function(P){return j(P,x.filter,!0)}).then(N).then(O).then(A).then(function(P){return U(P,x.width||t.width(k),x.height||t.height(k))});function A(P){return x.bgcolor&&(P.style.backgroundColor=x.bgcolor),x.width&&(P.style.width=x.width+"px"),x.height&&(P.style.height=x.height+"px"),x.style&&Object.keys(x.style).forEach(function(M){P.style[M]=x.style[M]}),P}}function m(k,x){return R(k,x||{}).then(function(A){return A.getContext("2d").getImageData(0,0,t.width(k),t.height(k)).data})}function v(k,x){return R(k,x||{}).then(function(A){return A.toDataURL()})}function E(k,x){return x=x||{},R(k,x).then(function(A){return A.toDataURL("image/jpeg",x.quality||1)})}function w(k,x){return R(k,x||{}).then(t.canvasToBlob)}function S(k){typeof k.imagePlaceholder>"u"?d.impl.options.imagePlaceholder=c.imagePlaceholder:d.impl.options.imagePlaceholder=k.imagePlaceholder,typeof k.cacheBust>"u"?d.impl.options.cacheBust=c.cacheBust:d.impl.options.cacheBust=k.cacheBust}function R(k,x){return p(k,x).then(t.makeImage).then(t.delay(100)).then(function(P){var M=A(k);return M.getContext("2d").drawImage(P,0,0),M});function A(P){var M=document.createElement("canvas");if(M.width=x.width||t.width(P),M.height=x.height||t.height(P),x.bgcolor){var V=M.getContext("2d");V.fillStyle=x.bgcolor,V.fillRect(0,0,M.width,M.height)}return M}}function j(k,x,A){if(!A&&x&&!x(k))return Promise.resolve();return Promise.resolve(k).then(P).then(function(D){return M(k,D,x)}).then(function(D){return V(k,D)});function P(D){return D instanceof HTMLCanvasElement?t.makeImage(D.toDataURL()):D.cloneNode(!1)}function M(D,ee,ue){var he=D.childNodes;if(he.length===0)return Promise.resolve(ee);return re(ee,t.asArray(he),ue).then(function(){return ee});function re(ae,fe,le){var z=Promise.resolve();return fe.forEach(function(X){z=z.then(function(){return j(X,le)}).then(function(pe){pe&&ae.appendChild(pe)})}),z}}function V(D,ee){if(!(ee instanceof Element))return ee;return Promise.resolve().then(ue).then(he).then(re).then(ae).then(function(){return ee});function ue(){fe(window.getComputedStyle(D),ee.style);function fe(le,z){le.cssText?z.cssText=le.cssText:X(le,z);function X(pe,xe){t.asArray(pe).forEach(function(se){xe.setProperty(se,pe.getPropertyValue(se),pe.getPropertyPriority(se))})}}}function he(){[":before",":after"].forEach(function(le){fe(le)});function fe(le){var z=window.getComputedStyle(D,le),X=z.getPropertyValue("content");if(X===""||X==="none")return;var pe=t.uid();ee.className=ee.className+" "+pe;var xe=document.createElement("style");xe.appendChild(se(pe,le,z)),ee.appendChild(xe);function se(me,Te,_e){var Oe="."+me+":"+Te,be=_e.cssText?Qe(_e):Ve(_e);return document.createTextNode(Oe+"{"+be+"}");function Qe(et){var st=et.getPropertyValue("content");return et.cssText+" content: "+st+";"}function Ve(et){return t.asArray(et).map(st).join("; ")+";";function st(bt){return bt+": "+et.getPropertyValue(bt)+(et.getPropertyPriority(bt)?" !important":"")}}}}}function re(){D instanceof HTMLTextAreaElement&&(ee.innerHTML=D.value),D instanceof HTMLInputElement&&ee.setAttribute("value",D.value)}function ae(){ee instanceof SVGElement&&(ee.setAttribute("xmlns","http://www.w3.org/2000/svg"),ee instanceof SVGRectElement&&["width","height"].forEach(function(fe){var le=ee.getAttribute(fe);le&&ee.style.setProperty(fe,le)}))}}}function N(k){return o.resolveAll().then(function(x){var A=document.createElement("style");return k.appendChild(A),A.appendChild(document.createTextNode(x)),k})}function O(k){return a.inlineAll(k).then(function(){return k})}function U(k,x,A){return Promise.resolve(k).then(function(P){return P.setAttribute("xmlns","http://www.w3.org/1999/xhtml"),new XMLSerializer().serializeToString(P)}).then(t.escapeXhtml).then(function(P){return'<foreignObject x="0" y="0" width="100%" height="100%">'+P+"</foreignObject>"}).then(function(P){return'<svg xmlns="http://www.w3.org/2000/svg" width="'+x+'" height="'+A+'">'+P+"</svg>"}).then(function(P){return"data:image/svg+xml;charset=utf-8,"+P})}function q(){return{escape:ae,parseExtension:x,mimeType:A,dataAsUrl:re,isDataUrl:P,canvasToBlob:V,resolveUrl:D,getAndEncode:he,uid:ee(),delay:fe,asArray:le,escapeXhtml:z,makeImage:ue,width:X,height:pe};function k(){var se="application/font-woff",me="image/jpeg";return{woff:se,woff2:se,ttf:"application/font-truetype",eot:"application/vnd.ms-fontobject",png:"image/png",jpg:me,jpeg:me,gif:"image/gif",tiff:"image/tiff",svg:"image/svg+xml"}}function x(se){var me=/\.([^\.\/]*?)$/g.exec(se);return me?me[1]:""}function A(se){var me=x(se).toLowerCase();return k()[me]||""}function P(se){return se.search(/^(data:)/)!==-1}function M(se){return new Promise(function(me){for(var Te=window.atob(se.toDataURL().split(",")[1]),_e=Te.length,Oe=new Uint8Array(_e),be=0;be<_e;be++)Oe[be]=Te.charCodeAt(be);me(new Blob([Oe],{type:"image/png"}))})}function V(se){return se.toBlob?new Promise(function(me){se.toBlob(me)}):M(se)}function D(se,me){var Te=document.implementation.createHTMLDocument(),_e=Te.createElement("base");Te.head.appendChild(_e);var Oe=Te.createElement("a");return Te.body.appendChild(Oe),_e.href=me,Oe.href=se,Oe.href}function ee(){var se=0;return function(){return"u"+me()+se++;function me(){return("0000"+(Math.random()*Math.pow(36,4)<<0).toString(36)).slice(-4)}}}function ue(se){return new Promise(function(me,Te){var _e=new Image;_e.onload=function(){me(_e)},_e.onerror=Te,_e.src=se})}function he(se){var me=3e4;return d.impl.options.cacheBust&&(se+=(/\?/.test(se)?"&":"?")+new Date().getTime()),new Promise(function(Te){var _e=new XMLHttpRequest;_e.onreadystatechange=Qe,_e.ontimeout=Ve,_e.responseType="blob",_e.timeout=me,_e.open("GET",se,!0),_e.send();var Oe;if(d.impl.options.imagePlaceholder){var be=d.impl.options.imagePlaceholder.split(/,/);be&&be[1]&&(Oe=be[1])}function Qe(){if(_e.readyState===4){if(_e.status!==200){Oe?Te(Oe):et("cannot fetch resource: "+se+", status: "+_e.status);return}var st=new FileReader;st.onloadend=function(){var bt=st.result.split(/,/)[1];Te(bt)},st.readAsDataURL(_e.response)}}function Ve(){Oe?Te(Oe):et("timeout of "+me+"ms occured while fetching resource: "+se)}function et(st){console.error(st),Te("")}})}function re(se,me){return"data:"+me+";base64,"+se}function ae(se){return se.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1")}function fe(se){return function(me){return new Promise(function(Te){setTimeout(function(){Te(me)},se)})}}function le(se){for(var me=[],Te=se.length,_e=0;_e<Te;_e++)me.push(se[_e]);return me}function z(se){return se.replace(/#/g,"%23").replace(/\n/g,"%0A")}function X(se){var me=xe(se,"border-left-width"),Te=xe(se,"border-right-width");return se.scrollWidth+me+Te}function pe(se){var me=xe(se,"border-top-width"),Te=xe(se,"border-bottom-width");return se.scrollHeight+me+Te}function xe(se,me){var Te=window.getComputedStyle(se).getPropertyValue(me);return parseFloat(Te.replace("px",""))}}function J(){var k=/url\(['"]?([^'"]+?)['"]?\)/g;return{inlineAll:M,shouldProcess:x,impl:{readUrls:A,inline:P}};function x(V){return V.search(k)!==-1}function A(V){for(var D=[],ee;(ee=k.exec(V))!==null;)D.push(ee[1]);return D.filter(function(ue){return!t.isDataUrl(ue)})}function P(V,D,ee,ue){return Promise.resolve(D).then(function(re){return ee?t.resolveUrl(re,ee):re}).then(ue||t.getAndEncode).then(function(re){return t.dataAsUrl(re,t.mimeType(D))}).then(function(re){return V.replace(he(D),"$1"+re+"$3")});function he(re){return new RegExp(`(url\\(['"]?)(`+t.escape(re)+`)(['"]?\\))`,"g")}}function M(V,D,ee){if(ue())return Promise.resolve(V);return Promise.resolve(V).then(A).then(function(he){var re=Promise.resolve(V);return he.forEach(function(ae){re=re.then(function(fe){return P(fe,ae,D,ee)})}),re});function ue(){return!x(V)}}}function W(){return{resolveAll:k,impl:{readAll:x}};function k(){return x().then(function(A){return Promise.all(A.map(function(P){return P.resolve()}))}).then(function(A){return A.join(`
`)})}function x(){return Promise.resolve(t.asArray(document.styleSheets)).then(P).then(A).then(function(V){return V.map(M)});function A(V){return V.filter(function(D){return D.type===CSSRule.FONT_FACE_RULE}).filter(function(D){return i.shouldProcess(D.style.getPropertyValue("src"))})}function P(V){var D=[];return V.forEach(function(ee){try{t.asArray(ee.cssRules||[]).forEach(D.push.bind(D))}catch(ue){console.log("Error while reading CSS rules from "+ee.href,ue.toString())}}),D}function M(V){return{resolve:function(){var ee=(V.parentStyleSheet||{}).href;return i.inlineAll(V.cssText,ee)},src:function(){return V.style.getPropertyValue("src")}}}}}function Q(){return{inlineAll:x,impl:{newImage:k}};function k(A){return{inline:P};function P(M){return t.isDataUrl(A.src)?Promise.resolve():Promise.resolve(A.src).then(M||t.getAndEncode).then(function(V){return t.dataAsUrl(V,t.mimeType(A.src))}).then(function(V){return new Promise(function(D,ee){A.onload=D,A.onerror=ee,A.src=V})})}}function x(A){if(!(A instanceof Element))return Promise.resolve(A);return P(A).then(function(){return A instanceof HTMLImageElement?k(A).inline():Promise.all(t.asArray(A.childNodes).map(function(M){return x(M)}))});function P(M){var V=M.style.getPropertyValue("background");return V?i.inlineAll(V).then(function(D){M.style.setProperty("background",D,M.style.getPropertyPriority("background"))}).then(function(){return M}):Promise.resolve(M)}}}})()}(af)),af.exports}var fb=hb();const pb=zf(fb),mb=({encounters:n,onEdit:e,onDelete:t})=>{const{addNotification:i}=Ht(),o=async a=>{const c=document.getElementById(`encounter-${a}`);if(c)try{const d=await pb.toBlob(c,{filter:p=>p.textContent!==""});await navigator.clipboard.write([new ClipboardItem({"image/png":d})]),i("success","Copied to clipboard!")}catch(d){console.error("Failed to copy image:",d),i("error","Failed to copy image")}};return f.jsxs("div",{className:"space-y-4",children:[f.jsx("h2",{className:"text-xl font-semibold text-white mb-4",children:"Saved Encounters"}),n.length>0?f.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",role:"encounter-list",children:n.map(a=>f.jsxs("div",{id:`encounter-${a.id}`,className:"space-y-4 border border-dark-border bg-dark",role:"article",children:[f.jsxs("div",{className:"flex justify-between items-start py-2 px-4 border-b border-dark-border",children:[f.jsx("h3",{className:"text-lg font-medium text-white",children:a.name}),f.jsxs("div",{className:"flex gap-2",children:[f.jsx(ke,{variant:"secondary",size:"sm",onClick:()=>o(a.id),"aria-label":"Copy as Image",children:f.jsx(vT,{})}),f.jsx(ke,{variant:"secondary",size:"sm",onClick:()=>e(a),"aria-label":"Edit Encounter",children:f.jsx(Wu,{})}),f.jsx(ke,{"aria-label":"Delete Encounter",variant:"danger",size:"sm",onClick:()=>t(a.id),children:f.jsx(rn,{})})]})]}),a.description&&f.jsx("p",{className:"text-white text-sm px-4",children:a.description}),f.jsx(bE,{formation:a.formation})]},a.id))}):f.jsx("div",{className:"text-center py-8 text-gray-400 bg-dark-lighter  border-2 border-dashed",children:"No encounters found"})]})},gb=Ir.ENCOUNTER_NOTES,yb=()=>{const{data:n=[],setData:e,loading:t}=Wo({key:gb,defaultValue:[]}),i=b.useCallback(c=>{const d={...c,id:Date.now().toString(),createdAt:Date.now()};e([...n,d])},[n,e]),o=b.useCallback(c=>{const d=n.map(p=>p.id===c.id?c:p);e(d)},[n,e]),a=b.useCallback(c=>{const d=n.filter(p=>p.id!==c);e(d)},[n,e]);return{encounters:n,isLoading:t,addEncounter:i,updateEncounter:o,deleteEncounter:a}},vb=()=>{const{encounters:n,addEncounter:e,updateEncounter:t,deleteEncounter:i}=yb(),{addNotification:o}=Ht(),[a,c]=b.useState(null),[d,p]=b.useState(null),[m,v]=b.useState(!1),E=j=>{a?(t(j),c(null),o("success","Encounter Updated")):(e(j),o("success","Encounter Added")),v(!1)},w=j=>{c(j),v(!0)},S=j=>{p(j)},R=()=>{d&&(i(d),(a==null?void 0:a.id)===d&&(c(null),v(!1))),o("success","Encounter Deleted")};return f.jsxs(Tr,{title:"Encounter Notes",description:"Save and manage your successful fleet formations for different encounters",action:{label:m?"Hide Form":"Add Encounter",onClick:()=>{a&&c(null),v(!m)},variant:m?"secondary":"primary"},children:[f.jsx(Cs,{isVisible:m,children:f.jsxs("div",{className:"bg-dark p-4 mb-6",children:[f.jsx("h2",{className:"text-xl font-semibold text-white mb-4",children:a?"Edit Encounter":"Add New Encounter"}),f.jsx(db,{onSubmit:E,initialEncounter:a})]})}),f.jsx(mb,{encounters:n,onEdit:w,onDelete:S}),f.jsx(Nl,{isOpen:!!d,onClose:()=>p(null),onConfirm:R,title:"Delete Encounter",message:"Are you sure you want to delete this encounter? This action cannot be undone.",confirmLabel:"Delete"})]})},Pv=Object.values(Ir),_b=()=>{const{addNotification:n}=Ht(),{user:e}=ud(),t=Hf.useRef(null),i=()=>{try{const c={};Pv.forEach(v=>{const E=localStorage.getItem(v);E&&(c[v]=E)});const d=new Blob([JSON.stringify(c,null,2)],{type:"application/json"}),p=URL.createObjectURL(d),m=document.createElement("a");m.href=p,m.download=`starborne-planner-backup-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(m),m.click(),document.body.removeChild(m),URL.revokeObjectURL(p),n("success","Backup created successfully")}catch(c){console.error("Backup failed:",c),n("error","Failed to create backup")}},o=async c=>{var m;const d=(m=c.target.files)==null?void 0:m[0];if(!d)return;const p=new FileReader;p.onload=async v=>{var E;try{const w=JSON.parse((E=v.target)==null?void 0:E.result);if(Object.entries(w).forEach(([S,R])=>{Pv.includes(S)&&R&&localStorage.setItem(S,R)}),e!=null&&e.uid)try{const S={};Object.entries(w).forEach(([R,j])=>{j&&(S[R]=JSON.parse(j))}),await Lf.saveUserData(e.uid,S),n("success","Data restored and synced to cloud storage")}catch(S){console.error("Failed to sync with Firebase:",S),n("warning","Data restored locally but failed to sync to cloud")}else n("success","Data restored locally");n("info","Please refresh the page to see the changes")}catch(w){console.error("Restore failed:",w),n("error","Failed to restore backup")}},p.readAsText(d),c.target.value=""},a=()=>{var c;(c=t.current)==null||c.click()};return f.jsxs("div",{className:"flex items-center gap-4",children:[f.jsx(ke,{variant:"secondary",onClick:i,"aria-label":"Backup data",children:"Backup Data"}),f.jsxs("div",{children:[f.jsx("input",{ref:t,type:"file",accept:".json",onChange:o,className:"hidden"}),f.jsx(ke,{variant:"secondary",onClick:a,"aria-label":"Restore data",children:"Restore Data"})]})]})},Eb=()=>f.jsxs("div",{className:"space-y-8",children:[f.jsxs("section",{className:"space-y-4",children:[f.jsxs("h1",{className:"text-3xl font-bold text-gray-100",children:["Welcome to the ",df]}),f.jsx("p",{children:"Build, customize, simulate, and calculate the best gear for your fleet with our comprehensive ship management tools."})]}),f.jsxs("section",{className:"space-y-4",children:[f.jsx("h2",{className:"text-2xl font-bold text-gray-100",children:"Quick Start Guide"}),f.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:[f.jsxs("div",{className:"bg-dark p-4 ",children:[f.jsx("h3",{className:"text-xl font-semibold text-gray-100 mb-2",children:"1. Add Ships"}),f.jsxs("p",{children:["Start by visiting the"," ",f.jsx(er,{to:"/ships",className:"text-primary hover:text-primary-hover",children:"Ships"})," ","page to create and manage your fleet."]})]}),f.jsxs("div",{className:"bg-dark p-4 ",children:[f.jsx("h3",{className:"text-xl font-semibold text-gray-100 mb-2",children:"2. Add Gear"}),f.jsxs("p",{children:["Configure your equipment in the"," ",f.jsx(er,{to:"/gear",className:"text-primary hover:text-primary-hover",children:"Gear"})," ","section."]})]}),f.jsxs("div",{className:"bg-dark p-4 ",children:[f.jsx("h3",{className:"text-xl font-semibold text-gray-100 mb-2",children:"3. Gear Up"}),f.jsxs("p",{children:["Let the app calculate the best gear for your fleet with the"," ",f.jsx(er,{to:"/autogear",className:"text-primary hover:text-primary-hover",children:"Autogear Tool"})]})]})]})]}),f.jsxs("section",{className:"space-y-4",children:[f.jsx("h2",{className:"text-2xl font-bold text-gray-100",children:"Features"}),f.jsxs("ul",{className:"list-disc list-inside  space-y-2",children:[f.jsx("li",{children:f.jsx("b",{children:"Automated gear optimization"})}),f.jsx("li",{children:"Ship builder with comprehensive customization options"}),f.jsx("li",{children:"Gear management system"}),f.jsx("li",{children:"Combat simulation tools"}),f.jsx("li",{children:"Loadout saving and sharing, for saving gear setups, for individual ships or teams"}),f.jsx("li",{children:"Encounter notes and tracking, for saving and sharing fleet formations"}),f.jsx("li",{children:"Engineering stats, I just wanted to achieve 100% stat coverage"})]})]}),f.jsxs("section",{className:"space-y-4",children:[f.jsx("h2",{className:"text-2xl font-bold text-gray-100",children:"Coming Soon"}),f.jsx("div",{className:"bg-dark p-4 ",children:f.jsxs("ul",{className:"list-disc list-inside  space-y-2",children:[f.jsx("li",{children:"Enhanced simulation features"}),f.jsx("li",{children:"Fleet management improvements"}),f.jsx("li",{children:"Additional customization options"}),f.jsx("li",{children:"More statistical analysis tools"})]})})]}),f.jsxs("section",{className:"space-y-4",children:[f.jsx("h2",{className:"text-2xl font-bold text-gray-100",children:"Feedback"}),f.jsx("p",{children:"Please provide feedback on the app, or any suggestions for improvements. I'm open to any suggestions, as I'm running out of ideas of stuff to implement."}),f.jsxs("p",{children:["Contact me directly on Discord at ",f.jsx("b",{children:"alvbert"}),", or in the"," ",f.jsx(er,{to:"https://discord.com/invite/playfrontiers",className:"text-primary hover:text-primary-hover",children:"Starborne Frontiers"})," ","discord server, my"," ",f.jsx(er,{to:"https://discord.com/channels/973311773920862308/1315988554534486036",className:"text-primary hover:text-primary-hover",children:"Autogearing forum thread"})]}),f.jsxs("p",{children:["This whole project is also open source, and you can find the code on"," ",f.jsx(er,{to:"https://github.com/TheSusort/starborne-frontiers-calculator",className:"text-primary hover:text-primary-hover",children:"GitHub"}),". Feel free to contribute to the project, adding issues, or even just use it as a base for your own project."]})]}),f.jsxs("section",{className:"bg-dark p-4",children:[f.jsx("h2",{className:"text-lg font-bold mb-4",children:"Backup & Restore"}),f.jsxs("p",{className:"text-sm mb-4",children:["Create and restore your gear and ship data from a backup file. This is useful if you want to migrate your data to a new device, or if you want to backup your data.",f.jsx("br",{}),f.jsx("br",{})," If you just want to test the app, you can use this"," ",f.jsx(er,{to:"https://pastebin.com/m0TMcQZA",className:"text-primary hover:text-primary-hover",children:"Pastebin link"})," ","to get the data, and save it as a json file to restore."]}),f.jsx(_b,{})]})]}),Dv=["Why did the sun go to school? To get brighter!","What kind of music do planets like? Nep-tunes!","What do you call a star that doesn't shower? A smelly dwarf!","Why did the asteroid go to the doctor? It had asteroid belt problems!","What did Mars say to Saturn? Give me a ring sometime!","Why don't aliens eat M&Ms? They're looking for life on Mars bars!","What do you call a black hole that's a neat freak? A vacuum cleaner!","How do astronauts organize a party? They planet!","What did the meteorologist say to the falling star? Nice to meteor!","Why did the constellation go to the doctor? It had Orion's Belt!","What's an astronaut's favorite part of the computer? The space bar!","Why don't planets like online shopping? They prefer space-ship delivery!","What do you call a star that's a bit too bright? A supernova!","I'm not saying earth's sky is the prettiest, but it's up there! (My wife made this one)","What do you call a space wizard? A shooting star!","What kind of pictures do astronauts take? Selfie-ites!","Why did the sun skip college? It already has millions of degrees!","What do you call a space outlaw? A rocket-eer!","How does the solar system hold up its pants? With an asteroid belt!",`What did the astronomer say when he walked into a wall? "At least the sky's the limit!"`,"Why did the astronaut break up with the satellite? She needed some space!","What do planets use to download music? Neptune!","Why did the astronaut leave the party? Because there was no atmosphere!","What do you call an alien with three eyes? An aliiien!","How does the alien style its hair? With a comet!","What do you call a ripped space cow? The Milky Whey!","What kind of songs do planets sing? Nep-tunes!","What did the alien say to the garden? Take me to your weeder!","What do you call a space station's favorite meal? Launch!","How do aliens serve dinner? On flying saucers!",`What did the Moon say to the Sun? "You're the light of my life!"`,"Why don't Martians have birthday parties? They're already in their space year!","What do you call a star that's always complaining? A SOL-ar whiner!","How do astronauts handle conflict? They apollo-gize!","What's an astronaut's favorite social media? MySpace!","Why did the telescope go to the optometrist? It needed some space-tacles!","What do you call a star that sneezes? A pulsar!","How do planets stay warm? They use space heaters!",`What did Mars say to Venus? "You're out of this world!"`],jv=()=>Dv[Math.floor(Math.random()*Dv.length)],wb=()=>{const[n,e]=b.useState(!1),[t,i]=b.useState(jv()),o=()=>{i(jv()),e(!0)};return f.jsx("div",{className:"fixed bottom-4 right-4 z-50",children:f.jsxs("div",{className:"relative",children:[f.jsx("button",{className:"w-8 h-8 rounded-full bg-primary hover:bg-primary-hover flex items-center justify-center text-white transition-colors duration-200",onMouseEnter:o,onMouseLeave:()=>e(!1),"aria-label":"Show random joke",children:f.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),f.jsx(Up,{isVisible:n,className:"w-72 bg-dark border border-dark-border p-4 shadow-lg",children:f.jsx("p",{children:t})})]})})};function Ov(n,e,t,i){const o=Qo(t,n,[],e,i,lt[t.type].name),a=pn(t.baseStats,n,e,t.refits,t.implants,i(t.type)).final,c=[];let d=0;return Object.entries(Ue).forEach(([p])=>{const m=n[p];if(!m||!e(m))return;const E={...n};delete E[p];const w=Qo(t,E,[],e,i,lt[t.type].name),S=o-w;d+=Math.max(0,S);const R=pn(t.baseStats,E,e,t.refits,t.implants,i(t.type)).final,j=[];Object.entries(a).forEach(([N,O])=>{const U=R[N]||0,q=O-U;if(q!==0){const J=q/(O-t.baseStats[N])*100;j.push({statName:N,value:q,percentage:isFinite(J)?J:0})}}),c.push({slotName:p,absoluteScore:S,relativeScore:0,primaryStats:j.filter(N=>N.value!==0).sort((N,O)=>Math.abs(O.percentage)-Math.abs(N.percentage))})}),c.forEach(p=>{p.relativeScore=d>0?Math.max(0,p.absoluteScore)/d*100:0}),c.sort((p,m)=>m.absoluteScore-p.absoluteScore)}const Tb={ATTACKER:["crit","critDamage","attack","speed"],DEFENDER:["hp","defence","security"],SUPPORTER:["hp","crit","critDamage","healModifier"],SUPPORTER_BUFFER:["speed","hp","defence"],DEBUFFER:["hacking","speed","attack","crit","critDamage"]};function Sb(n,e){return e.crit<95&&!n.subStats.some(t=>t.name==="crit")?{title:"Low crit rate",reason:"Consider finding a new piece with more crit rate substats"}:null}function xb(n,e,t,i,o){const a=Tb[e.type],c=n.subStats.filter(v=>a.includes(v.name)),d={reasons:[]};["epic","legendary"].includes(n.rarity)||d.reasons.push({title:"Low rarity",reason:`An epic or legendary ${n.slot} piece would have more substats`}),n.stars<=4&&d.reasons.push({title:"Low stars",reason:`A higher star ${n.slot} piece would have more main stat`}),c.length<2&&d.reasons.push({title:"Low relevant substat count",reason:`Only ${c.length} relevant substat${c.length===1?"":"s"}`});const p=Object.values(e.equipment).filter(v=>{var E;return v&&((E=i(v))==null?void 0:E.setBonus)==="boost"}).length,m=Sb(n,t);switch(e.type){case"SUPPORTER":n.setBonus!=="repair"&&d.reasons.push({title:"Not a repair piece",reason:`Consider finding a new ${n.slot} with the repair set`});case"ATTACKER":case"DEBUFFER":m&&d.reasons.push(m);break;case"SUPPORTER_BUFFER":p<4&&n.setBonus!=="boost"&&o.relativeScore<Ue[n.slot].expectedContribution&&d.reasons.push({title:"Boost set bonus not found",reason:"Consider investing in the Boost set for boosters."});break}return d}const Lv={ATTACKER:["ATTACK","CRITICAL","ABYSSAL_ASSULT","AMBUSH"],DEFENDER:["DEFENSE","FORTITUDE","ABYSSAL_SAFEGUARD","ABYSSAL_WARD","PROTECTION"],SUPPORTER:["REPAIR","FORTITUDE","CRITICAL","ABYSSAL_SAFEGUARD"],SUPPORTER_BUFFER:["BOOST","SPEED","FORTITUDE","AMBUSH"],DEBUFFER:["HACKING","ABYSSAL_BREACH","ATTACK","CRITICAL","ABYSSAL_ASSULT","AMBUSH"]};function Ib(n,e,t,i,o,a){const c=[];return n.forEach(d=>{const p=e[d.slotName];if(!p)return;const m=t(p);if(!m)return;const v=m.setBonus&&Lv[i.type].includes(m.setBonus);if(d.relativeScore<Ue[d.slotName].expectedContribution-1){const R=xb(m,i,o,t,d);c.push({slotName:d.slotName,currentLevel:m.level,priority:d.relativeScore,reasons:R.reasons||"Consider replacing this piece with a piece with more contribution"})}const E=["sensor","software","thrusters"].includes(d.slotName),w=Ue[d.slotName].expectedContribution,S=c.find(R=>R.slotName===d.slotName);if(m.level<16){const R=d.relativeScore;let j;E&&R<w?j=`${Ue[d.slotName].label} provides percentage-based stats but is underperforming`:!E&&m.level<12?j="Level up to increase flat stat bonus":j="Minor improvements available",S?S.reasons.push({title:"Low level",reason:j}):c.push({slotName:d.slotName,currentLevel:m.level,priority:d.relativeScore,reasons:[{title:"Low level",reason:j}]})}if(a.length>0&&!v){const R=a.filter(j=>j.setBonus!==m.setBonus);if(R.length>0){const j=R.reduce((N,O)=>O.setBonus&&Lv[i.type].includes(O.setBonus)?O:N,R[0]);S?S.reasons.push({title:"Not optimal set bonus",reason:`Switching to a ${yt[j.setBonus].name} ${Ue[d.slotName].label} could improve your score, as it will provide an extra set bonus`}):c.push({slotName:d.slotName,currentLevel:m.level,reasons:[{title:"Not optimal set bonus",reason:`Switching to a ${yt[j.setBonus].name} ${Ue[d.slotName].label} could improve your score, as it will provide an extra set bonus`}]})}}}),c.sort((d,p)=>d.priority!==void 0&&p.priority!==void 0&&Ue[d.slotName].expectedContribution-d.priority!==Ue[p.slotName].expectedContribution-p.priority?Ue[p.slotName].expectedContribution-p.priority-(Ue[d.slotName].expectedContribution-d.priority):d.priority===void 0||p.priority===void 0?-1:0)}const Rb=({suggestions:n})=>{const[e,t]=b.useState({}),[i,o]=b.useState({}),a=(d,p)=>{o(m=>({...m,[d]:p})),t(m=>({...m,[d]:!0}))},c=d=>{t(p=>({...p,[d]:!1}))};return n.length===0?null:f.jsxs("section",{className:"bg-dark p-4",children:[f.jsx("h3",{className:"font-semibold",children:"Upgrade Suggestions (EXPERIMENTAL)"}),f.jsx("p",{className:"text-xs text-gray-400 mb-4",children:f.jsx("span",{children:"These are suggestions for upgrading your gear, based on the gear contribution and the ship's final score."})}),f.jsx("div",{className:"space-y-3",children:n.map(d=>f.jsxs("div",{className:`p-3 border-l-4 ${d.priority<Ue[d.slotName].expectedContribution-5?"border-red-500 bg-red-900/20":d.priority<Ue[d.slotName].expectedContribution-2?"border-yellow-500 bg-yellow-900/20":"border-blue-500 bg-blue-900/20"}`,children:[f.jsxs("div",{className:"mb-1 flex flex-wrap",children:[f.jsx("span",{className:"font-medium",children:Ue[d.slotName].label}),d.currentLevel!==16&&f.jsxs("span",{className:"text-sm ml-auto",children:["Level ",d.currentLevel,"  16"]}),d.priority&&f.jsxs("span",{className:"block text-xs w-full",children:[d.priority.toFixed(1),"% is a"," ",d.priority<Ue[d.slotName].expectedContribution-5?"very":d.priority<Ue[d.slotName].expectedContribution-2?"":"fairly"," ","low contribution for a ",Ue[d.slotName].label," ","piece"]})]}),f.jsx("ul",{className:"text-sm text-gray-400 list-disc ml-4",children:d.reasons.map((p,m)=>{const v=`${d.slotName}-${m}`;return f.jsxs("li",{children:[f.jsxs("span",{className:"text-xs inline-flex items-center",onMouseEnter:()=>a(v,p.reason),onMouseLeave:()=>c(v),children:[p.title," ",f.jsx(t0,{})]}),f.jsx(Up,{isVisible:e[v]||!1,children:f.jsx("span",{className:"text-gray-400 bg-dark-lighter p-2 border border-gray-300 block",children:i[v]})})]},m)})})]},d.slotName))})]})},Ab=({contributions:n})=>!n||n.length===0?null:f.jsxs("div",{className:"p-4 bg-dark",children:[f.jsx("h3",{className:"font-semibold",children:"Gear Contribution"}),f.jsx("p",{className:"text-xs text-gray-400 mb-4",children:"The chart below shows the relative contribution of each gear piece and its stats to the ship's final score. Score is calculated differently for each ship type."}),n.map(e=>f.jsxs("div",{className:"mb-3",children:[f.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[f.jsx("span",{children:Ue[e.slotName].label}),f.jsxs("span",{className:"text-gray-400",children:[e.relativeScore>.1?e.relativeScore.toFixed(1):"<0.1","%"]})]}),f.jsx("div",{className:"w-full bg-dark-lighter h-2 overflow-hidden",children:f.jsx("div",{className:"h-full bg-blue-500",style:{width:`${Math.max(0,Math.min(100,e.relativeScore))}%`}})}),f.jsx("div",{className:"mt-1 text-xs text-gray-400 flex flex-wrap gap-2",children:e.primaryStats.filter(t=>t.percentage>=.1).sort((t,i)=>i.percentage-t.percentage).map(t=>f.jsxs("span",{children:[t.statName,":"," ",t.percentage>.1?t.percentage.toFixed(1):"<0.1","%"]},t.statName))})]},e.slotName))]}),Cb=()=>{const[n,e]=b.useState(null),[t,i]=b.useState(!1),[o,a]=b.useState(void 0),{shipId:c}=ww(),d=Wv(),{inventory:p,getGearPiece:m}=Cr(),{ships:v,updateShip:E,handleRemoveShip:w,handleLockEquipment:S,handleUnequipAllGear:R}=Vn({getGearPiece:m}),{getEngineeringStatsForShipType:j}=sa(),{addNotification:N}=Ht(),O=v.find(Q=>Q.id===c),U=zp((O==null?void 0:O.equipment)||{},m),q=n2(O||{},U);if(!O)return f.jsx(Tr,{title:"Ship Not Found",action:{label:"Back to Ships",onClick:()=>d("/ships"),variant:"secondary"},children:f.jsx("div",{className:"text-center text-gray-400",children:"The requested ship could not be found."})});const J=Ov(O.equipment,m,O,j),W=Ib(J,O.equipment,m,O,pn(O.baseStats,O.equipment,m,O.refits,O.implants,j(O.type)).final,q);return f.jsxs(Tr,{title:`${O.name} Details`,action:{label:"Back to Ships",onClick:()=>d("/ships"),variant:"secondary"},children:[f.jsx(Cs,{isVisible:t||!!o,children:f.jsx(_E,{onSubmit:async Q=>{await E(Q),i(!1),window.scrollTo({top:0,behavior:"smooth"}),a(void 0),N("success","Ship saved successfully")},editingShip:o})}),f.jsxs("div",{className:"grid lg:grid-cols-2 gap-6",children:[f.jsxs("div",{className:"space-y-6",children:[f.jsx(SE,{variant:"extended",ship:O,allShips:v,hoveredGear:n,availableGear:p,getGearPiece:m,onRemove:Q=>{w(Q),d("/ships")},onLockEquipment:async Q=>{await S(Q)},onEquipGear:(Q,k,x)=>{const A={...O};A.equipment[k]=x,E(A)},onRemoveGear:(Q,k)=>{const x={...O};delete x.equipment[k],E(x)},onUnequipAll:()=>{R(O.id)},onHoverGear:e,onEdit:()=>{i(!0),a(O),window.scrollTo({top:0,behavior:"smooth"})}}),f.jsxs("section",{className:"bg-dark p-4",children:[f.jsxs("h3",{className:"mb-4",children:["Refits (",O.refits.length,"/6)"]}),O.refits.length>0?f.jsx("div",{className:"space-y-2",children:O.refits.map((Q,k)=>f.jsx(Hu,{stats:Q.stats,className:"p-2 bg-dark-lighter"},k))}):f.jsx("p",{className:"text-gray-400",children:"No refits installed"})]}),f.jsxs("section",{className:"bg-dark p-4",children:[f.jsxs("h3",{className:"mb-4",children:["Implants (",O.implants.length,")"]}),O.implants.length>0?f.jsx("div",{className:"space-y-2",children:O.implants.map((Q,k)=>f.jsx(Hu,{stats:Q.stats,className:"p-2 bg-dark-lighter"},k))}):f.jsx("p",{className:"text-gray-400",children:"No implants installed"})]})]}),f.jsxs("div",{className:"space-y-6",children:[f.jsx(Ab,{contributions:Ov(O.equipment,m,O,j)}),f.jsx(Rb,{suggestions:W})]})]})]})},NE=()=>typeof window<"u",PE=()=>!(!NE()||!window.hj),lf=(n,...e)=>{if(NE()&&window.hj)return window.hj(n,...e);throw Error("Hotjar is not available, make sure init has been called.")},kb=(n,e,t)=>{if(!((i,o,a)=>{try{const c=document.getElementById(o)||document.createElement("script");return c.id=o,c.nonce=a,c.innerText=i,c.crossOrigin="anonymous",document.head.appendChild(c),!0}catch{return!1}})(`(function(h,o,t,j,a,r){h.hj=h.hj||function(){(h.hj.q=h.hj.q||[]).push(arguments)};h._hjSettings={hjid:${n},hjsv:${e},hjdebug:${(t==null?void 0:t.debug)||!1}};a=o.getElementsByTagName('head')[0];r=o.createElement('script');r.async=1;r.src=t+h._hjSettings.hjid+j+h._hjSettings.hjsv;a.appendChild(r);})(window,document,'https://static.hotjar.com/c/hotjar-','.js?sv=');`,"hotjar-init-script",t==null?void 0:t.nonce)||!PE())throw Error("Failed to initialize Hotjar tracking script.")},bb={init:(n,e,t)=>{try{return kb(n,e,t),!0}catch(i){return console.error("Error:",i),!1}},event:n=>{try{return lf("event",n),!0}catch(e){return console.error("Error:",e),!1}},identify:(n,e)=>{try{return lf("identify",n,e),!0}catch(t){return console.error("Error:",t),!1}},stateChange:n=>{try{return lf("stateChange",n),!0}catch(e){return console.error("Error:",e),!1}},isReady:PE},Nb=5241833,Pb=6;bb.init(Nb,Pb);lb();cb();const Db=()=>{const[n,e]=b.useState(!1),[t,i]=b.useState(ul);b.useEffect(()=>{var d;const a=localStorage.getItem(Ir.CHANGELOG_STATE);let c;a&&((d=JSON.parse(a))!=null&&d.lastSeenVersion.match(/^\d+\.\d+\.\d+$/))?c={lastSeenVersion:JSON.parse(a).lastSeenVersion}:c={lastSeenVersion:"0.0.0"},c.lastSeenVersion!==ul&&(e(!0),i(c.lastSeenVersion))},[]);const o=()=>{e(!1),localStorage.setItem(Ir.CHANGELOG_STATE,JSON.stringify({lastSeenVersion:ul}))};return f.jsx(ib,{children:f.jsx(Uk,{children:f.jsx(aT,{children:f.jsxs("main",{className:"flex",children:[f.jsx($k,{}),f.jsx("div",{className:"flex-1 lg:pl-64 max-w-full bg-dark-lighter",children:f.jsxs("div",{className:"min-h-screen py-8 px-4 mt-14 lg:mt-0 flex flex-col overflow-x-hidden",children:[f.jsx("div",{className:"max-w-7xl mx-auto w-full flex-grow",children:f.jsxs(Mw,{children:[f.jsx(gr,{path:"/ships",element:f.jsx(i2,{})}),f.jsx(gr,{path:"/gear",element:f.jsx(x2,{})}),f.jsx(gr,{path:"/simulation",element:f.jsx(j2,{})}),f.jsx(gr,{path:"/autogear",element:f.jsx(q2,{})}),f.jsx(gr,{path:"/engineering",element:f.jsx(K2,{})}),f.jsx(gr,{path:"/loadouts",element:f.jsx(nb,{})}),f.jsx(gr,{path:"/encounters",element:f.jsx(vb,{})}),f.jsx(gr,{path:"/",element:f.jsx(Eb,{})}),f.jsx(gr,{path:"/ships/:shipId",element:f.jsx(Cb,{})})]})}),f.jsx(wb,{}),f.jsxs("footer",{className:"text-center text-xs mt-auto pt-5",children:["Made with  by ",ST]})]})}),f.jsx(rb,{isOpen:n,onClose:o,entries:TT,lastSeenVersion:t}),f.jsx(ob,{})]})})})})},jb=q1.createRoot(document.getElementById("root"));jb.render(f.jsx(Hf.StrictMode,{children:f.jsx(Db,{})}));
