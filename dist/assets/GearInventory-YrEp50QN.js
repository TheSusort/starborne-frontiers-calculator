import{j as t,m as _,B as y,Q as k,U as L,C as U,V as J,W,X as $,G as d,l as C,s as Q,R as V,f as j}from"./ui-D2YqbPcu.js";import{a as p,e as X}from"./vendor-BhvhDhpY.js";import{G as Y}from"./GearPieceDisplay-BCww8SQc.js";const z=({options:l,currentSort:n,onSort:o})=>t.jsx(t.Fragment,{children:t.jsxs("div",{className:"flex gap-2 items-end",children:[t.jsx(_,{label:"Sort by",value:n.field,onChange:u=>{o({field:u,direction:"asc"})},options:l,className:"text-xs"}),t.jsx(y,{"aria-label":"Toggle sort direction",variant:"secondary",className:"w-12",onClick:()=>{o({field:n.field,direction:n.direction==="asc"?"desc":"asc"})},children:n.direction==="asc"?t.jsx(k,{}):t.jsx(L,{})})]})}),H=({filters:l,isOpen:n,onToggle:o,onClear:u,hasActiveFilters:c,sortOptions:f,sort:h,setSort:a})=>t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"flex justify-between items-center flex-wrap -mt-8",children:[c&&t.jsx("div",{className:"flex flex-wrap gap-2 me-2 order-2 md:order-unset w-full pt-2",children:l.map(i=>i.values.map(x=>{var g;return t.jsx("div",{className:"flex justify-between items-center",children:t.jsx(y,{"aria-label":`Remove ${i.label} filter`,className:"relative flex items-center",variant:"secondary",onClick:()=>i.onChange([...i.values.filter(m=>m!==x)]),children:t.jsxs("div",{className:"flex items-center",children:[t.jsxs("div",{className:"flex flex-col items-start mr-3",children:[t.jsx("span",{className:"text-xxs",children:i.label}),t.jsx("span",{className:"text-xs",children:(g=i.options.find(m=>m.value===x))==null?void 0:g.label})]}),t.jsx(U,{})]})})},x)}))}),t.jsx(y,{variant:"secondary",className:"ml-auto",onClick:o,"aria-label":"Filter",children:t.jsx(J,{})})]}),t.jsx(W,{isOpen:n,onClose:o,title:"Filters",children:t.jsxs("div",{className:"space-y-4",children:[f&&h&&a&&t.jsx(z,{options:f,currentSort:h,onSort:a}),l.map(i=>t.jsx($,{label:i.label,values:i.values,onChange:i.onChange,options:i.options},i.id)),c&&t.jsx("div",{className:"pt-4",children:t.jsx(y,{"aria-label":"Clear filters",variant:"secondary",fullWidth:!0,onClick:u,children:"Clear Filters"})})]})})]}),O={sort:{field:"id",direction:"desc"},filters:{factions:[],shipTypes:[],rarities:[],sets:[],types:[],equipped:""}};function K(l){const[n,o]=p.useState(()=>{const c=localStorage.getItem(l);return c?JSON.parse(c):O});return p.useEffect(()=>{localStorage.setItem(l,JSON.stringify(n))},[n,l]),{state:n,setState:o,clearFilters:()=>{o(O),localStorage.removeItem(l)}}}const te=({inventory:l,onRemove:n,onEdit:o,onEquip:u,mode:c="manage"})=>{var b,S,N;const[f,h]=X.useState(!1),{state:a,setState:i,clearFilters:x}=K("gear-inventory-filters"),g=(((b=a.filters.sets)==null?void 0:b.length)??0)>0||(((S=a.filters.types)==null?void 0:S.length)??0)>0||(((N=a.filters.rarities)==null?void 0:N.length)??0)>0||(a.filters.equipped??"")!=="",m=p.useMemo(()=>l.filter(e=>{var q,I,R,F,E,w;const s=(((q=a.filters.sets)==null?void 0:q.length)??0)===0||(((I=a.filters.sets)==null?void 0:I.includes(e.setBonus))??!1),r=(((R=a.filters.types)==null?void 0:R.length)??0)===0||(((F=a.filters.types)==null?void 0:F.includes(e.slot))??!1),M=(((E=a.filters.rarities)==null?void 0:E.length)??0)===0||(((w=a.filters.rarities)==null?void 0:w.includes(e.rarity))??!1),P=a.filters.equipped==="equipped"?e.shipId!==""&&e.shipId!==void 0:a.filters.equipped==="unequipped"?e.shipId===""||e.shipId===void 0:!0;return s&&r&&M&&P}),[l,a.filters]),A=p.useMemo(()=>{const e=new Set(l.map(s=>s.setBonus));return Array.from(e).sort((s,r)=>d[s].name.localeCompare(d[r].name))},[l]),T=p.useMemo(()=>{const e=new Set(l.map(s=>s.slot));return Array.from(e).sort((s,r)=>C[s].label.localeCompare(C[r].label))},[l]),B=p.useMemo(()=>{const e=new Set(l.map(s=>s.rarity));return Q(Array.from(e))},[l]),G=[{id:"set",label:"Sets",values:a.filters.sets??[],onChange:e=>i(s=>({...s,filters:{...s.filters,sets:e}})),options:A.map(e=>({value:e,label:d[e].name}))},{id:"type",label:"Slots",values:a.filters.types??[],onChange:e=>i(s=>({...s,filters:{...s.filters,types:e}})),options:T.map(e=>({value:e,label:C[e].label}))},{id:"rarity",label:"Rarity",values:a.filters.rarities??[],onChange:e=>i(s=>({...s,filters:{...s.filters,rarities:e}})),options:B.map(e=>({value:e,label:V[e].label}))},{id:"equipped",label:"Equipped",values:a.filters.equipped?[a.filters.equipped]:[],onChange:e=>{const s=e[0]===a.filters.equipped?"":e[0];i(r=>({...r,filters:{...r.filters,equipped:s}}))},options:[{value:"equipped",label:"Equipped to a ship"},{value:"unequipped",label:"Not equipped to a ship"}]}],D=[{value:"id",label:"Date Added"},{value:"setBonus",label:"Set"},{value:"level",label:"Level"},{value:"stars",label:"Stars"},{value:"rarity",label:"Rarity"}],v=p.useMemo(()=>[...m].sort((s,r)=>{switch(a.sort.field){case"setBonus":return a.sort.direction==="asc"?d[s.setBonus].name.localeCompare(d[r.setBonus].name):d[r.setBonus].name.localeCompare(d[s.setBonus].name);case"level":return a.sort.direction==="asc"?s.level-r.level:r.level-s.level;case"stars":return a.sort.direction==="asc"?s.stars-r.stars:r.stars-s.stars;case"rarity":return a.sort.direction==="asc"?j.indexOf(r.rarity)-j.indexOf(s.rarity):j.indexOf(s.rarity)-j.indexOf(r.rarity);default:return a.sort.direction==="asc"?r.id.localeCompare(s.id):s.id.localeCompare(r.id)}}),[m,a.sort]);return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex flex-col",children:[v.length>0&&t.jsxs("span",{className:"text-sm text-gray-400",children:["Showing ",v.length," gear pieces"]}),t.jsx(H,{filters:G,isOpen:f,onToggle:()=>h(!f),onClear:x,hasActiveFilters:g,sortOptions:D,sort:a.sort,setSort:e=>i(s=>({...s,sort:e}))})]}),v.length===0?t.jsx("div",{className:"text-center py-8 text-gray-400 bg-dark-lighter border-2 border-dashed",children:l.length===0?"No gear pieces added yet":"No matching gear pieces found"}):t.jsx("div",{className:`grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 ${c==="manage"?"xl:grid-cols-4":""} gap-4`,children:v.map(e=>t.jsx(Y,{gear:e,mode:c,onEdit:o,onRemove:n,onEquip:u},e.id))})]})};export{H as F,te as G,K as u};
